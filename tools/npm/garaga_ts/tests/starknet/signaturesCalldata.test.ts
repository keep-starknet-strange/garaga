import * as garaga from "../../src/node/index";
import { CurveId } from "../../src/node/definitions";

describe('Signatures Getting calldata', () => {

  test("should get calldata from Schnorr signature", async () => {

    await garaga.init();

    const rx = 2035568083744286872562076170424183686789303771874924387134332885848716527973n;
    const s = 16951964772773949134099030503529813788531799557122970289125566478359203530341n;
    const e = 12379944220159143227935478555737246072763864785692867509458453554537054077909n;
    const px = 1460015317007179873453105936321786126342173668635633375793615328879270166120n;
    const py = 11788876621134198315085358602693659440838178818373737092676489706543309378340n;
    const curveId = CurveId.BN254;

    const schnorrCalldata = garaga.schnorrCalldataBuilder(rx, s, e, px, py, true, curveId);

    console.log("schnorrCalldata", schnorrCalldata);

  });

  test("should get calldata from ECDSA signature", async () => {

    await garaga.init();

    const r = 17830031845148496611971159596372798561444562703217806657239186935632770088766n;
    const s = 15775553683756501243755332794094542682114105716241054629352056498655356866971n;
    const v = 0;
    const px = 11329275913325725487970330398927775211322605183390088341941803765401909426169n;
    const py = 8682249405907851087539181920418463468320177419465741864050204044014651446009n;
    const z = 7590902656267229106356493910512635750747848737569325419577764035270226305644n;
    const curveId = CurveId.BN254;

    const ecdsaCalldata = garaga.ecdsaCalldataBuilder(r, s, v, px, py, z, true, curveId);

    console.log("ecdsaCalldata", ecdsaCalldata);

  });

});
