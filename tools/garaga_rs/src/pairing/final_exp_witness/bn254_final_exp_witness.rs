use crate::definitions::BN254PrimeField;
use lambdaworks_math::elliptic_curve::short_weierstrass::curves::bn_254::field_extension::{
    Degree12ExtensionField, Degree2ExtensionField, Degree6ExtensionField,
};
use lambdaworks_math::field::element::FieldElement;

// Helper function to square a value n times
#[inline]
fn square_n(
    base: &FieldElement<Degree12ExtensionField>,
    n: usize,
) -> FieldElement<Degree12ExtensionField> {
    let mut result = base.clone();
    for _ in 0..n {
        result = result.square();
    }
    result
}

/// Optimized exponentiation using addition chain (generated by addchain)
fn pow_exp(base: &FieldElement<Degree12ExtensionField>) -> FieldElement<Degree12ExtensionField> {
    let _10 = base.square();
    let _11 = base * &_10;
    let _101 = &_10 * &_11;
    let _111 = &_10 * &_101;
    let _1001 = &_10 * &_111;
    let _1011 = &_10 * &_1001;
    let _1101 = &_10 * &_1011;
    let _1111 = &_10 * &_1101;
    let _10001 = &_10 * &_1111;
    let _10011 = &_10 * &_10001;
    let _10101 = &_10 * &_10011;
    let _10111 = &_10 * &_10101;
    let _11001 = &_10 * &_10111;
    let _11011 = &_10 * &_11001;
    let _11101 = &_10 * &_11011;
    let _11111 = &_10 * &_11101;
    let _100001 = &_10 * &_11111;
    let _100011 = &_10 * &_100001;
    let _100101 = &_10 * &_100011;
    let _100111 = &_10 * &_100101;
    let _101001 = &_10 * &_100111;
    let _101011 = &_10 * &_101001;
    let _101101 = &_10 * &_101011;
    let _101111 = &_10 * &_101101;
    let _110001 = &_10 * &_101111;
    let _110011 = &_10 * &_110001;
    let _110101 = &_10 * &_110011;
    let _110111 = &_10 * &_110101;
    let _111001 = &_10 * &_110111;
    let _111011 = &_10 * &_111001;
    let _111101 = &_10 * &_111011;
    let _111111 = &_10 * &_111101;
    let _1000001 = &_10 * &_111111;
    let _1000011 = &_10 * &_1000001;
    let _1000101 = &_10 * &_1000011;
    let _1000111 = &_10 * &_1000101;
    let _1001001 = &_10 * &_1000111;
    let _1001011 = &_10 * &_1001001;
    let _1001101 = &_10 * &_1001011;
    let _1001111 = &_10 * &_1001101;
    let _1010001 = &_10 * &_1001111;
    let _1010011 = &_10 * &_1010001;
    let _1010101 = &_10 * &_1010011;
    let _1010111 = &_10 * &_1010101;
    let _1011001 = &_10 * &_1010111;
    let _1011011 = &_10 * &_1011001;
    let _1011101 = &_10 * &_1011011;
    let _1011111 = &_10 * &_1011101;
    let _1100001 = &_10 * &_1011111;
    let _1100011 = &_10 * &_1100001;
    let _1100101 = &_10 * &_1100011;
    let _1100111 = &_10 * &_1100101;
    let _1101001 = &_10 * &_1100111;
    let _1101011 = &_10 * &_1101001;
    let _1101101 = &_10 * &_1101011;
    let _1101111 = &_10 * &_1101101;
    let _1110001 = &_10 * &_1101111;
    let _1110011 = &_10 * &_1110001;
    let _1110101 = &_10 * &_1110011;
    let _1110111 = &_10 * &_1110101;
    let _1111001 = &_10 * &_1110111;
    let _1111011 = &_10 * &_1111001;
    let _1111101 = &_10 * &_1111011;
    let _1111111 = &_10 * &_1111101;
    let _11111110 = _1111111.square();
    let _11111111 = base * &_11111110;
    let i81 = &(square_n(&(&(square_n(&(&_1111101 * &_11111111), 4)) * &_10111), 8)) * &_100001;
    let i105 = square_n(&(&(square_n(&(&square_n(&i81, 7) * &_111001), 9)) * &_1001011), 6);
    let i125 = &(square_n(&(&(square_n(&(&_100111 * &i105), 9)) * &_1001001), 8)) * &_101001;
    let i150 = square_n(&(&(square_n(&(&square_n(&i125, 8) * &_1110101), 7)) * &_1001111), 8);
    let i168 = &(square_n(&(&(square_n(&(&_1001011 * &i150), 6)) * &_101001), 9)) * &_1011001;
    let i192 = square_n(&(&(square_n(&(&square_n(&i168, 6) * &_11001), 4)) * base), 12);
    let i209 = &(square_n(&(&(square_n(&(&_110111 * &i192), 6)) * &_10011), 8)) * &_10101;
    let i236 = square_n(&(&(square_n(&(&square_n(&i209, 9) * &_1110001), 9)) * &_1011111), 7);
    let i256 = &(square_n(&(&(square_n(&(&_1101 * &i236), 9)) * &_110101), 8)) * &_1000101;
    let i281 = square_n(&(&(square_n(&(&square_n(&i256, 6) * &_101101), 11)) * &_110001), 6);
    let i307 = &(square_n(&(&(square_n(&(&_11111 * &i281), 17)) * &_1010111), 6)) * &_110011;
    let i337 = square_n(&(&(square_n(&(&square_n(&i307, 6) * &_11011), 12)) * &_11111111), 10);
    let i356 = &(square_n(&(&(square_n(&(&_10101 * &i337), 7)) * &_10101), 9)) * &_1110011;
    let i384 = square_n(&(&(square_n(&(&square_n(&i356, 10) * &_1000101), 8)) * &_100001), 8);
    let i399 = &(square_n(&(&(square_n(&(&_1100111 * &i384), 6)) * &_101011), 6)) * &_10011;
    let i427 = square_n(&(&(square_n(&(&square_n(&i399, 8) * &_111011), 9)) * &_11111), 9);
    let i437 = &(square_n(&(&(&_11111111 * &i427).square() * base), 6)) * &_111;
    let i466 = square_n(&(&(square_n(&(&square_n(&i437, 11) * &_1001011), 6)) * &_110001), 10);
    let i484 = &(square_n(&(&(square_n(&(&_1100111 * &i466), 7)) * &_1001101), 8)) * &_1100111;
    let i510 = square_n(&(&(square_n(&(&square_n(&i484, 6) * &_11011), 9)) * &_110111), 9);
    let i527 = &(square_n(&(&(square_n(&(&_1111011 * &i510), 4)) * &_1101), 10)) * &_1101111;
    let i557 = square_n(&(&(square_n(&(&square_n(&i527, 5) * &_11011), 13)) * &_101111), 10);
    let i577 = &(square_n(&(&(square_n(&(&_1110011 * &i557), 10)) * &_1000101), 7)) * &_1000011;
    let i598 = square_n(&(&(square_n(&(&square_n(&i577, 7) * &_1010101), 6)) * &_11111), 6);
    let i613 = &(square_n(&(&(square_n(&(&_1001 * &i598), 10)) * &_100101), 2)) * base;
    let i644 = square_n(&(&(square_n(&(&square_n(&i613, 9) * &_11111111), 9)) * &_1110111), 11);
    let i661 = &(square_n(&(&(square_n(&(&_1100011 * &i644), 6)) * &_110011), 8)) * &_1110011;
    let i684 = square_n(&(&(square_n(&(&square_n(&i661, 7) * &_1000101), 7)) * &_1110001), 7);
    let i700 = &(square_n(&(&(square_n(&(&_1001111 * &i684), 9)) * &_1000101), 4)) * &_11;
    let i727 = square_n(&(&(square_n(&(&square_n(&i700, 12) * &_1001101), 3)) * &_101), 10);
    let i746 = &(square_n(&(&(square_n(&(&_1101 * &i727), 10)) * &_1001011), 6)) * &_110001;
    let i772 = square_n(&(&(square_n(&(&square_n(&i746, 8) * &_110111), 8)) * &_110011), 8);
    let i790 = &(square_n(&(&(&_1001011 * &i772).square() * base), 14)) * &_1101011;
    let i815 = square_n(&(&(square_n(&(&square_n(&i790, 8) * &_1000111), 5)) * &_10101), 10);
    let i834 = &(square_n(&(&(square_n(&(&_1000101 * &i815), 6)) * &_11101), 10)) * &_100111;
    let i856 = square_n(&(&(square_n(&(&square_n(&i834, 5) * &_1101), 10)) * &_100011), 5);
    let i876 = &(square_n(&(&(square_n(&(&_1011 * &i856), 9)) * &_110111), 8)) * &_1010011;
    let i900 = square_n(&(&(square_n(&(&square_n(&i876, 7) * &_1000001), 7)) * &_110101), 8);
    let i925 = &(square_n(&(&(square_n(&(&_1101101 * &i900), 11)) * &_1111101), 11)) * &_1010101;
    let i953 = square_n(&(&(square_n(&(&square_n(&i925, 7) * &_1001111), 9)) * &_1000111), 10);
    let i971 = &(square_n(&(&(square_n(&(&_1111011 * &i953), 8)) * &_1100111), 7)) * &_1011011;
    let i996 = square_n(&(&(square_n(&(&square_n(&i971, 8) * &_1011111), 7)) * &_101001), 8);
    let i1012 = &(square_n(&(&(square_n(&(&_110001 * &i996), 5)) * &_1101), 8)) * &_10011;
    let i1037 = square_n(&(&(square_n(&(&square_n(&i1012, 9) * &_1001101), 6)) * &_110101), 8);
    let i1055 = &(square_n(&(&(square_n(&(&_1101111 * &i1037), 8)) * &_1110101), 7)) * &_101001;
    let i1081 = square_n(&(&(square_n(&(&square_n(&i1055, 10) * &_1001101), 7)) * &_1010001), 7);
    let i1098 = &(square_n(&(&(square_n(&(&_1111101 * &i1081), 5)) * &_10101), 9)) * &_100111;
    let i1125 = square_n(&(&(square_n(&(&square_n(&i1098, 7) * &_11111), 8)) * &_110111), 10);
    let i1144 = &(square_n(&(&(square_n(&(&_101111 * &i1125), 8)) * &_1000111), 8)) * &_1111101;
    let i1169 = square_n(&(&(square_n(&(&square_n(&i1144, 5) * &_10001), 12)) * &_110101), 6);
    let i1189 = &(square_n(&(&(square_n(&(&_11011 * &i1169), 10)) * &_1110101), 7)) * &_1010111;
    let i1217 = square_n(&(&(square_n(&(&square_n(&i1189, 7) * &_111101), 12)) * &_1101011), 7);
    let i1236 = &(square_n(&(&(square_n(&(&_101111 * &i1217), 8)) * &_1001001), 8)) * &_1001011;
    let i1267 = square_n(&(&(square_n(&(&square_n(&i1236, 12) * &_1100001), 10)) * &_100011), 7);
    let i1287 = &(square_n(&(&(square_n(&(&_100111 * &i1267), 10)) * &_1011011), 7)) * &_1001001;
    let i1309 = square_n(&(&(square_n(&(&square_n(&i1287, 7) * &_1101111), 7)) * &_1101011), 6);
    let i1329 = &(square_n(&(&(square_n(&(&_10001 * &i1309), 8)) * &_111011), 9)) * &_1010001;
    let i1351 = square_n(&(&(square_n(&(&square_n(&i1329, 7) * &_1100011), 8)) * &_1001101), 5);
    let i1374 = &(square_n(&(&(square_n(&(&_10111 * &i1351), 13)) * &_1111001), 7)) * &_1011001;
    let i1398 = square_n(&(&(square_n(&(&square_n(&i1374, 7) * &_1010101), 7)) * &_1101001), 8);
    let i1417 = &(square_n(&(&(square_n(&(&_110011 * &i1398), 6)) * &_1011), 10)) * &_1001011;
    let i1444 = square_n(&(&(square_n(&(&square_n(&i1417, 8) * &_1111101), 4)) * &_101), 13);
    let i1463 = &(square_n(&(&(square_n(&(&_1100101 * &i1444), 7)) * &_1000101), 9)) * &_100111;
    let i1491 = square_n(&(&(square_n(&(&square_n(&i1463, 8) * &_1101101), 10)) * &_1001011), 8);
    let i1509 = &(square_n(&(&(square_n(&(&_1000011 * &i1491), 9)) * &_110101), 6)) * &_10111;
    let i1539 = square_n(&(&(square_n(&(&square_n(&i1509, 9) * &_110111), 9)) * &_111101), 10);
    let i1558 = &(square_n(&(&(square_n(&(&_101011 * &i1539), 2)) * base), 14)) * &_1111101;
    let i1585 = square_n(&(&(square_n(&(&square_n(&i1558, 7) * &_1101), 10)) * &_101111), 8);
    let i1610 = &(square_n(&(&(square_n(&(&_1110001 * &i1585), 15)) * &_1011101), 7)) * &_1101001;
    let i1637 = square_n(&(&(square_n(&(&square_n(&i1610, 6) * &_11001), 9)) * &_101011), 10);
    let i1654 = &(square_n(&(&(&_1001111 * &i1637).square() * base), 13)) * &_1011001;
    let i1678 = square_n(&(&(square_n(&(&square_n(&i1654, 4) * &_1111), 9)) * &_111011), 9);
    let i1695 = &(square_n(&(&(square_n(&(&_1011011 * &i1678), 6)) * &_110011), 8)) * &_1101;
    let i1725 = square_n(&(&(square_n(&(&square_n(&i1695, 10) * &_1101011), 7)) * &_1010001), 11);
    let i1746 = &(square_n(&(&(square_n(&(&_1111001 * &i1725), 6)) * &_100011), 12)) * &_1111111;
    let i1769 = square_n(&(&(square_n(&(&square_n(&i1746, 8) * &_1000111), 7)) * &_1010001), 6);
    let i1788 = &(square_n(&(&(square_n(&(&_110101 * &i1769), 8)) * &_1011001), 8)) * &_110111;
    let i1812 = square_n(&(&(square_n(&(&square_n(&i1788, 10) * &_1110011), 6)) * &_101011), 6);
    let i1834 = &(square_n(&(&(square_n(&(&_11111 * &i1812), 8)) * &_101101), 11)) * &_1111001;
    let i1863 = square_n(&(&(square_n(&(&square_n(&i1834, 9) * &_10111), 10)) * &_1000111), 8);
    let i1880 = &(square_n(&(&(square_n(&(&_1011001 * &i1863), 5)) * &_11011), 9)) * &_1000001;
    let i1907 = square_n(&(&(square_n(&(&square_n(&i1880, 2) * &_11), 16)) * &_1100011), 7);
    let i1923 = &(square_n(&(&(square_n(&(&_1001001 * &i1907), 7)) * &_1100111), 6)) * &_110111;
    let i1950 = square_n(&(&(square_n(&(&square_n(&i1923, 8) * &_1111011), 10)) * &_1100111), 7);
    let i1971 = &(square_n(&(&(square_n(&(&_11011 * &i1950), 6)) * &_111), 12)) * &_101101;
    let i1994 = square_n(&(&(square_n(&(&square_n(&i1971, 8) * &_1001001), 7)) * &_1101111), 6);
    let i2016 = &(square_n(&(&(square_n(&(&_110011 * &i1994), 10)) * &_100101), 9)) * &_1101001;
    let i2041 = square_n(&(&(square_n(&(&square_n(&i2016, 7) * &_1110101), 6)) * &_10101), 10);
    let i2060 = &(square_n(&(&(square_n(&(&_1100001 * &i2041), 7)) * &_1000101), 9)) * &_110101;
    let i2085 = square_n(&(&(square_n(&(&square_n(&i2060, 5) * &_1101), 11)) * &_1100111), 7);
    let i2103 = &(square_n(&(&(square_n(&(&_1010011 * &i2085), 6)) * &_100001), 9)) * &_1000111;
    let i2129 = square_n(&(&(square_n(&(&square_n(&i2103, 5) * &_11011), 9)) * &_1100011), 10);
    let i2146 = &(square_n(&(&(square_n(&(&_1001011 * &i2129), 7)) * &_1110011), 7)) * &_101111;
    let i2167 = square_n(&(&(square_n(&(&square_n(&i2146, 6) * &_11101), 9)) * &_1010111), 4);
    let i2195 = &(square_n(&(&(square_n(&(base * &i2167), 16)) * &_101111), 9)) * &_100011;
    let i2220 = square_n(&(&(square_n(&(&square_n(&i2195, 7) * &_11101), 8)) * &_111111), 8);
    let i2238 = &(square_n(&(&(square_n(&(&_1011101 * &i2220), 6)) * &_10001), 9)) * &_1100011;
    let i2264 = square_n(&(&(square_n(&(&square_n(&i2238, 7) * &_1101111), 8)) * &_1001001), 9);
    let i2283 = &(square_n(&(&(square_n(&(&_10011 * &i2264), 9)) * &_1111011), 7)) * &_1110111;
    let i2308 = square_n(&(&(square_n(&(&square_n(&i2283, 7) * &_1110101), 7)) * &_1101111), 9);
    let i2327 = &(square_n(&(&(square_n(&(&_10001 * &i2308), 8)) * &_100111), 8)) * &_1001011;
    let i2351 = square_n(&(&(square_n(&(&square_n(&i2327, 5) * &_10101), 9)) * &_1110101), 8);
    let i2371 = &(square_n(&(&(square_n(&(&_1010011 * &i2351), 7)) * &_1101111), 10)) * &_1010011;
    let i2402 = square_n(&(&(square_n(&(&square_n(&i2371, 13) * &_1010111), 9)) * &_1010001), 7);
    let i2420 = &(square_n(&(&(square_n(&(&_1111101 * &i2402), 7)) * &_110001), 8)) * &_1001001;
    let i2446 = square_n(&(&(&square_n(&i2420, 7) * &_1001101).square() * base), 16);
    let i2465 = &(square_n(&(&(square_n(&(&_111011 * &i2446), 8)) * &_1010011), 8)) * &_1111011;
    let i2492 = square_n(&(&(square_n(&(&square_n(&i2465, 8) * &_1011111), 8)) * &_111001), 9);
    let i2511 = &(square_n(&(&(square_n(&(&_100001 * &i2492), 8)) * &_1100101), 8)) * &_1010011;
    let i2542 = square_n(&(&(square_n(&(&square_n(&i2511, 9) * &_1010111), 9)) * &_1001), 11);
    let i2562 = &(square_n(&(&(square_n(&(&_10111 * &i2542), 9)) * &_1111111), 8)) * &_1010111;
    let i2585 = square_n(&(&(square_n(&(&square_n(&i2562, 6) * &_110001), 8)) * &_1010001), 7);
    let i2607 = &(square_n(&(&(square_n(&(&_1100101 * &i2585), 7)) * &_1011001), 12)) * &_1000011;
    let i2635 = square_n(&(&(square_n(&(&square_n(&i2607, 6) * &_110111), 11)) * &_1110111), 9);
    let i2656 = &(square_n(&(&(square_n(&(&_110111 * &i2635), 6)) * &_1111), 12)) * &_1000011;
    let i2679 = square_n(&(&(square_n(&(&square_n(&i2656, 7) * &_1101101), 5)) * &_10111), 9);
    let i2691 = &(&(square_n(&(&_101001 * &i2679), 8)) * &_1110001).square() * base;
    let i2720 = square_n(&(&(square_n(&(&square_n(&i2691, 14) * &_1100001), 6)) * &_111101), 7);
    let i2740 = &(square_n(&(&(square_n(&(&_110101 * &i2720), 11)) * &_1110001), 6)) * &_111011;
    let i2770 = square_n(&(&(square_n(&(&square_n(&i2740, 9) * &_1110011), 12)) * &_1000101), 7);
    let i2788 = &(square_n(&(&(square_n(&(&_101101 * &i2770), 6)) * &_10101), 9)) * &_1001001;
    let i2811 = square_n(&(&(square_n(&(&square_n(&i2788, 4) * &_1001), 10)) * &_1100011), 7);
    let i2829 = &(square_n(&(&(square_n(&(&_1011001 * &i2811), 5)) * &_11111), 10)) * &_1101011;
    let i2853 = square_n(&(&(square_n(&(&square_n(&i2829, 6) * &_11011), 9)) * &_110001), 7);
    let i2866 = &(&(square_n(&(&_11111 * &i2853), 9)) * &_1101111).square() * base;
    let i2896 = square_n(&(&(square_n(&(&square_n(&i2866, 12) * &_111011), 8)) * &_110101), 8);
    let i2915 = &(square_n(&(&(square_n(&(&_1000101 * &i2896), 7)) * &_11101), 9)) * &_1111101;
    let i2941 = square_n(&(&(square_n(&(&square_n(&i2915, 9) * &_1001011), 6)) * &_10011), 9);
    let i2957 = &(square_n(&(&(square_n(&(&_1110001 * &i2941), 6)) * &_111101), 7)) * &_10111;
    let i2984 = square_n(&(&(square_n(&(&square_n(&i2957, 9) * &_111011), 8)) * &_100111), 8);
    let i3001 = &(square_n(&(&(square_n(&(&_1001101 * &i2984), 6)) * &_110011), 8)) * &_1001111;
    let i3025 = square_n(&(&(square_n(&(&square_n(&i3001, 8) * &_1001001), 6)) * &_100111), 8);
    let i3040 = &(square_n(&(&(square_n(&(&_1110011 * &i3025), 5)) * &_10011), 7)) * &_10101;
    let i3065 = square_n(&(&(square_n(&(&square_n(&i3040, 9) * &_1111001), 7)) * &_1101001), 7);
    let i3085 = &(square_n(&(&(square_n(&(&_1111011 * &i3065), 8)) * &_101101), 9)) * &_1000001;
    let i3110 = square_n(&(&(square_n(&(&square_n(&i3085, 8) * &_111001), 8)) * &_1011101), 7);
    let i3126 = &(square_n(&(&(square_n(&(&_1111011 * &i3110), 5)) * &_10001), 8)) * &_110111;
    let i3150 = square_n(&(&(square_n(&(&square_n(&i3126, 8) * &_1000101), 6)) * &_101111), 8);
    let i3168 = &(square_n(&(&(square_n(&(&_1101011 * &i3150), 2)) * &_11), 13)) * &_1110011;
    let i3191 = square_n(&(&(square_n(&(&square_n(&i3168, 7) * &_1000001), 5)) * &_10011), 9);
    let i3207 = &(square_n(&(&(square_n(&(&_1111101 * &i3191), 7)) * &_1010011), 6)) * &_110011;
    let i3232 = square_n(&(&(square_n(&(&square_n(&i3207, 8) * &_1010011), 5)) * &_1011), 10);
    let i3251 = &(square_n(&(&(square_n(&(&_1110101 * &i3232), 10)) * &_1101111), 6)) * &_110001;
    let i3282 = square_n(&(&(square_n(&(&square_n(&i3251, 12) * &_100011), 9)) * &_1011011), 8);
    let i3299 = &(square_n(&(&(square_n(&(&_1001011 * &i3282), 6)) * &_100111), 8)) * &_1100011;
    let i3324 = square_n(&(&(square_n(&(&square_n(&i3299, 7) * &_1011111), 7)) * &_1101101), 9);
    let i3341 = &(square_n(&(&(square_n(&(&_10001 * &i3324), 10)) * &_1101001), 4)) * &_1111;
    let i3372 = square_n(&(&(square_n(&(&square_n(&i3341, 12) * &_100101), 8)) * &_1000001), 9);
    let i3391 = &(square_n(&(&(square_n(&(&_1100111 * &i3372), 9)) * &_1010111), 7)) * &_1000001;
    let i3415 = square_n(&(&(square_n(&(&square_n(&i3391, 2) * &_11), 11)) * &_11111111), 9);
    let i3433 = &(square_n(&(&(square_n(&(&_1111101 * &i3415), 5)) * &_1101), 10)) * &_1101111;
    let i3456 = square_n(&(&(square_n(&(&square_n(&i3433, 6) * &_11001), 8)) * &_11001), 7);
    let i3477 = &(square_n(&(&(square_n(&(&_111 * &i3456), 11)) * &_100101), 7)) * &_11;
    square_n(&i3477, 5)
}

/// Optimized exponentiation using addition chain (generated by addchain)
fn pow_exp0(base: &FieldElement<Degree12ExtensionField>) -> FieldElement<Degree12ExtensionField> {
    let _10 = base.square();
    let _11 = base * &_10;
    let _101 = &_10 * &_11;
    let _111 = &_10 * &_101;
    let _1001 = &_10 * &_111;
    let _1011 = &_10 * &_1001;
    let _1101 = &_10 * &_1011;
    let _1111 = &_10 * &_1101;
    let _10001 = &_10 * &_1111;
    let _10011 = &_10 * &_10001;
    let _10101 = &_10 * &_10011;
    let _10111 = &_10 * &_10101;
    let _11001 = &_10 * &_10111;
    let _11011 = &_10 * &_11001;
    let _11101 = &_10 * &_11011;
    let _11111 = &_10 * &_11101;
    let _100001 = &_10 * &_11111;
    let _100011 = &_10 * &_100001;
    let _100101 = &_10 * &_100011;
    let _100111 = &_10 * &_100101;
    let _101001 = &_10 * &_100111;
    let _101011 = &_10 * &_101001;
    let _101101 = &_10 * &_101011;
    let _101111 = &_10 * &_101101;
    let _110001 = &_10 * &_101111;
    let _110011 = &_10 * &_110001;
    let _110101 = &_10 * &_110011;
    let _110111 = &_10 * &_110101;
    let _111001 = &_10 * &_110111;
    let _111011 = &_10 * &_111001;
    let _111101 = &_10 * &_111011;
    let _111111 = &_10 * &_111101;
    let _1000001 = &_10 * &_111111;
    let _1000011 = &_10 * &_1000001;
    let _1000101 = &_10 * &_1000011;
    let _1000111 = &_10 * &_1000101;
    let _1001001 = &_10 * &_1000111;
    let _1001011 = &_10 * &_1001001;
    let _1001101 = &_10 * &_1001011;
    let _1001111 = &_10 * &_1001101;
    let _1010001 = &_10 * &_1001111;
    let _1010011 = &_10 * &_1010001;
    let _1010101 = &_10 * &_1010011;
    let _1010111 = &_10 * &_1010101;
    let _1011001 = &_10 * &_1010111;
    let _1011011 = &_10 * &_1011001;
    let _1011101 = &_10 * &_1011011;
    let _1011111 = &_10 * &_1011101;
    let _1100001 = &_10 * &_1011111;
    let _1100011 = &_10 * &_1100001;
    let _1100101 = &_10 * &_1100011;
    let _1100111 = &_10 * &_1100101;
    let _1101001 = &_10 * &_1100111;
    let _1101011 = &_10 * &_1101001;
    let _1101101 = &_10 * &_1101011;
    let _1101111 = &_10 * &_1101101;
    let _1110001 = &_10 * &_1101111;
    let _1110011 = &_10 * &_1110001;
    let _1110101 = &_10 * &_1110011;
    let _1110111 = &_10 * &_1110101;
    let _1111001 = &_10 * &_1110111;
    let _1111011 = &_10 * &_1111001;
    let _1111101 = &_10 * &_1111011;
    let _1111111 = &_10 * &_1111101;
    let _11100010 = &_1100011 * &_1111111;
    let _11111111 = &_11101 * &_11100010;
    let i67 = _11100010.square();
    let i94 = square_n(&(&(square_n(&(&square_n(&i67, 10) * &_1010101), 7)) * &_1100001), 7);
    let i118 = &(square_n(&(&(square_n(&(&_1000011 * &i94), 8)) * &_111011), 13)) * &_101011;
    let i146 = square_n(&(&(square_n(&(&square_n(&i118, 8) * &_1101111), 8)) * &_110111), 10);
    let i165 = &(square_n(&(&(square_n(&(&_1010111 * &i146), 11)) * &_1110111), 5)) * &_1011;
    let i191 = square_n(&(&(square_n(&(&square_n(&i165, 6) * &_101), 10)) * &_111001), 8);
    let i212 = &(square_n(&(&(square_n(&(&_100101 * &i191), 5)) * &_11), 13)) * &_1100011;
    let i243 = square_n(&(&(square_n(&(&square_n(&i212, 10) * &_111), 11)) * &_1011011), 8);
    let i261 = &(square_n(&(&(square_n(&(&_1100001 * &i243), 4)) * &_1111), 11)) * &_110101;
    let i287 = square_n(&(&(square_n(&(&square_n(&i261, 6) * &_10111), 9)) * &_1010101), 9);
    let i308 = &(square_n(&(&(square_n(&(&_10011 * &i287), 9)) * &_100001), 9)) * &_100011;
    let i334 = square_n(&(&(square_n(&(&square_n(&i308, 9) * &_1100001), 8)) * &_101101), 7);
    let i359 = &(square_n(&(&(square_n(&(&_1011 * &i334), 13)) * &_1100011), 9)) * &_100111;
    let i384 = square_n(&(&(square_n(&(&square_n(&i359, 9) * &_1101001), 5)) * &_10001), 9);
    let i402 = &(square_n(&(&(square_n(&(&_100101 * &i384), 9)) * &_1010001), 6)) * &_100011;
    let i426 = square_n(&(&(square_n(&(&square_n(&i402, 9) * &_1100001), 9)) * &_1001011), 4);
    let i445 = &(square_n(&(&(square_n(&(&_1101 * &i426), 7)) * &_1101), 9)) * &_101001;
    let i469 = square_n(&(&(square_n(&(&square_n(&i445, 8) * &_1101001), 5)) * &_10011), 9);
    let i489 = &(square_n(&(&(square_n(&(&_1111101 * &i469), 9)) * &_1111101), 8)) * &_1110101;
    let i515 = square_n(&(&(square_n(&(&square_n(&i489, 7) * &_111011), 10)) * &_100011), 7);
    let i532 = &(square_n(&(&(square_n(&(&_111001 * &i515), 5)) * &_1101), 9)) * &_111;
    let i561 = square_n(&(&(square_n(&(&square_n(&i532, 11) * &_11111111), 8)) * &_1111001), 8);
    let i576 = &(square_n(&(&(square_n(&(&_1010111 * &i561), 5)) * &_11101), 7)) * &_1001;
    let i602 = square_n(&(&(square_n(&(&square_n(&i576, 10) * &_1011001), 7)) * &_1111001), 7);
    let i625 = &(square_n(&(&(square_n(&(&_11001 * &i602), 9)) * &_101101), 11)) * &_111101;
    let i649 = square_n(&(&(square_n(&(&square_n(&i625, 6) * &_10011), 6)) * &_101), 10);
    let i671 = &(square_n(&(&(square_n(&(&_10111 * &i649), 11)) * &_1101101), 8)) * &_1111001;
    let i696 = square_n(&(&(square_n(&(&square_n(&i671, 9) * &_1000001), 7)) * &_1101101), 7);
    let i716 = &(square_n(&(&(square_n(&(&_1100111 * &i696), 7)) * &_10001), 10)) * &_1100011;
    let i737 = square_n(&(&(square_n(&(&square_n(&i716, 6) * &_100111), 8)) * &_1101101), 5);
    let i762 = &(square_n(&(&(square_n(&(&_11101 * &i737), 8)) * &_10101), 14)) * &_1111001;
    let i787 = square_n(&(&(square_n(&(&square_n(&i762, 7) * &_1001011), 8)) * &_1000011), 8);
    let i805 = &(square_n(&(&(square_n(&(&_1011101 * &i787), 9)) * &_110111), 6)) * &_10001;
    let i830 = square_n(&(&(square_n(&(&square_n(&i805, 6) * &_1111), 10)) * &_1010101), 7);
    let i847 = &(square_n(&(&(square_n(&(&_1011001 * &i830), 8)) * &_1011111), 6)) * &_1001;
    let i872 = square_n(&(&(square_n(&(&square_n(&i847, 5) * &_11), 11)) * &_110111), 7);
    let i887 = &(square_n(&(&(square_n(&(&_100101 * &i872), 5)) * &_1011), 7)) * &_1011;
    let i913 = square_n(&(&(square_n(&(&square_n(&i887, 10) * &_1011011), 6)) * &_10101), 8);
    let i936 = &(square_n(&(&(square_n(&(&_111001 * &i913), 8)) * &_1001001), 12)) * &_1110111;
    let i965 = square_n(&(&(square_n(&(&square_n(&i936, 10) * &_101111), 8)) * &_10001), 9);
    let i984 = &(square_n(&(&(square_n(&(&_1010011 * &i965), 7)) * &_1111011), 9)) * &_1010001;
    let i1004 = square_n(&(&(square_n(&(&square_n(&i984, 6) * &_10011), 9)) * &_1010111), 3);
    let i1023 = &(square_n(&(&(square_n(&(&_111 * &i1004), 10)) * &_110001), 6)) * &_11101;
    let i1051 = square_n(&(&(square_n(&(&square_n(&i1023, 11) * &_1001), 8)) * &_1011011), 7);
    let i1071 = &(square_n(&(&(square_n(&(&_1010001 * &i1051), 7)) * &_1101111), 10)) * &_111011;
    let i1099 = square_n(&(&(square_n(&(&square_n(&i1071, 9) * &_1111001), 6)) * &_101001), 11);
    let i1118 = &(square_n(&(&(square_n(&(&_101111 * &i1099), 9)) * &_1011001), 7)) * &_1000001;
    let i1143 = square_n(&(&(square_n(&(&square_n(&i1118, 9) * &_1000011), 7)) * &_111101), 7);
    let i1162 = &(square_n(&(&(square_n(&(&_111001 * &i1143), 4)) * &_11), 12)) * &_1100101;
    let i1187 = square_n(&(&(square_n(&(&square_n(&i1162, 4) * &_1001), 11)) * &_110011), 8);
    let i1205 = &(square_n(&(&(square_n(&(&_1100101 * &i1187), 4)) * &_1101), 11)) * &_1101011;
    let i1231 = square_n(&(&(square_n(&(&square_n(&i1205, 7) * &_1010101), 8)) * &_11111), 9);
    let i1248 = &(square_n(&(&(square_n(&(&_1100101 * &i1231), 5)) * &_1011), 9)) * &_111011;
    let i1272 = square_n(&(&(square_n(&(&square_n(&i1248, 8) * &_1010111), 7)) * &_100101), 7);
    let i1292 = &(square_n(&(&(square_n(&(&_110001 * &i1272), 8)) * &_1110011), 9)) * &_1111011;
    let i1317 = square_n(&(&(square_n(&(&square_n(&i1292, 9) * &_1010011), 5)) * &_10011), 9);
    let i1336 = &(square_n(&(&(square_n(&(&_1111001 * &i1317), 6)) * &_10001), 10)) * &_1111001;
    let i1357 = square_n(&(&(square_n(&(&square_n(&i1336, 7) * &_1001101), 7)) * &_1110001), 5);
    let i1382 = &(square_n(&(&(square_n(&(&_11011 * &i1357), 9)) * &_1001001), 13)) * &_1100111;
    let i1407 = square_n(&(&(square_n(&(&square_n(&i1382, 8) * &_1110011), 6)) * &_101011), 9);
    let i1423 = &(square_n(&(&(square_n(&(&_100111 * &i1407), 7)) * &_101001), 6)) * &_11101;
    let i1458 = square_n(&(&(square_n(&(&square_n(&i1423, 8) * &_111001), 14)) * &_1101001), 11);
    let i1478 = &(square_n(&(&(square_n(&(&_1100011 * &i1458), 8)) * &_110111), 9)) * &_1001111;
    let i1498 = square_n(&(&(square_n(&(&square_n(&i1478, 4) * &_11), 12)) * &_1010011), 2);
    let i1519 = &(square_n(&(&(square_n(&(&_11 * &i1498), 12)) * &_1110101), 6)) * &_110111;
    let i1544 = square_n(&(&(square_n(&(&square_n(&i1519, 10) * &_1010101), 7)) * &_1011101), 6);
    let i1559 = &(square_n(&(&(square_n(&(&_111011 * &i1544), 8)) * &_1100111), 4)) * &_111;
    let i1594 = square_n(&(&(square_n(&(&square_n(&i1559, 12) * &_111), 10)) * &_11101), 11);
    let i1610 = &(square_n(&(&(square_n(&(&_1001111 * &i1594), 8)) * &_1010011), 5)) * &_10101;
    let i1636 = square_n(&(&(square_n(&(&square_n(&i1610, 10) * &_1001111), 11)) * &_1010111), 3);
    let i1658 = &(square_n(&(&(square_n(&(&_101 * &i1636), 11)) * &_1011001), 8)) * &_101101;
    let i1680 = square_n(&(&(square_n(&(&square_n(&i1658, 8) * &_1001111), 7)) * &_1001111), 5);
    let i1700 = &(square_n(&(&(square_n(&(&_1011 * &i1680), 10)) * &_1111001), 7)) * &_1000101;
    let i1727 = square_n(&(&(square_n(&(&square_n(&i1700, 7) * &_1001101), 9)) * &_111011), 9);
    let i1744 = &(square_n(&(&(square_n(&(&_1000111 * &i1727), 7)) * &_1000111), 7)) * &_1011001;
    let i1766 = square_n(&(&(square_n(&(&square_n(&i1744, 6) * &_101001), 8)) * &_1101101), 6);
    let i1784 = &(square_n(&(&(square_n(&(&_100101 * &i1766), 9)) * &_1000111), 6)) * &_110101;
    let i1812 = square_n(&(&(square_n(&(&square_n(&i1784, 9) * &_1100111), 7)) * &_110001), 10);
    let i1828 = &(square_n(&(&(square_n(&(&_1101111 * &i1812), 7)) * &_1101001), 6)) * &_100011;
    let i1854 = square_n(&(&(square_n(&(&square_n(&i1828, 6) * &_10011), 10)) * &_1000111), 8);
    let i1876 = &(square_n(&(&(square_n(&(&_1110001 * &i1854), 12)) * &_100011), 7)) * &_101;
    let i1918 = square_n(&(&(square_n(&(&square_n(&i1876, 20) * &_111011), 11)) * &_10001), 9);
    let i1937 = &(square_n(&(&(square_n(&(&_1011001 * &i1918), 6)) * &_110001), 10)) * &_110101;
    let i1962 = square_n(&(&(square_n(&(&square_n(&i1937, 8) * &_110111), 4)) * &_111), 11);
    let i1978 = &(square_n(&(&(square_n(&(&_1001101 * &i1962), 7)) * &_1000011), 6)) * &_101111;
    let i2002 = square_n(&(&(square_n(&(&square_n(&i1978, 8) * &_1000001), 7)) * &_1110001), 7);
    let i2019 = &(square_n(&(&(square_n(&(&_1111001 * &i2002), 7)) * &_1001101), 7)) * &_101001;
    let i2043 = square_n(&(&(square_n(&(&square_n(&i2019, 10) * &_1010111), 6)) * &_111011), 6);
    let i2061 = &(square_n(&(&(square_n(&(&_11111 * &i2043), 8)) * &_110001), 7)) * &_110001;
    let i2084 = square_n(&(&(square_n(&(&square_n(&i2061, 8) * &_1010111), 2)) * base), 11);
    let i2103 = &(square_n(&(&(square_n(&(&_10111 * &i2084), 9)) * &_1000011), 7)) * &_1011001;
    let i2126 = square_n(&(&(square_n(&(&square_n(&i2103, 7) * &_1011011), 5)) * &_11101), 9);
    let i2144 = &(square_n(&(&(square_n(&(&_101001 * &i2126), 8)) * &_1110011), 7)) * &_1100011;
    let i2173 = square_n(&(&(square_n(&(&square_n(&i2144, 9) * &_1110111), 8)) * &_1010011), 10);
    let i2184 = &(&(square_n(&(&_1110001 * &i2173), 7)) * &_1110001).square() * base;
    let i2216 = square_n(&(&(square_n(&(&square_n(&i2184, 14) * &_111101), 9)) * &_1110001), 7);
    let i2233 = &(square_n(&(&(square_n(&(&_1001011 * &i2216), 7)) * &_111001), 7)) * &_11111;
    let i2259 = square_n(&(&(square_n(&(&square_n(&i2233, 10) * &_1100111), 7)) * &_1101111), 7);
    let i2280 = &(square_n(&(&(square_n(&(&_1011011 * &i2259), 10)) * &_1001), 8)) * &_1100101;
    let i2305 = square_n(&(&(square_n(&(&square_n(&i2280, 7) * &_1110011), 6)) * &_100001), 10);
    let i2327 = &(square_n(&(&(square_n(&(&_101011 * &i2305), 13)) * &_1000101), 6)) * &_1011;
    let i2354 = square_n(&(&(square_n(&(&square_n(&i2327, 10) * &_110111), 7)) * &_100111), 8);
    let i2374 = &(square_n(&(&(square_n(&(&_1100101 * &i2354), 7)) * &_1100101), 10)) * &_1011111;
    let i2402 = square_n(&(&(square_n(&(&square_n(&i2374, 12) * &_1000011), 7)) * &_1110001), 7);
    let i2421 = &(square_n(&(&(square_n(&(&_1011101 * &i2402), 8)) * &_1011011), 8)) * &_1101111;
    let i2446 = square_n(&(&(square_n(&(&square_n(&i2421, 5) * &_11101), 9)) * &_10011), 9);
    let i2461 = &(square_n(&(&(square_n(&(&_1111001 * &i2446), 5)) * &_10101), 7)) * &_10111;
    let i2494 = square_n(&(&(square_n(&(&square_n(&i2461, 11) * &_100101), 10)) * &_101), 10);
    let i2519 = &(square_n(&(&(square_n(&(&_110011 * &i2494), 8)) * &_101001), 14)) * &_1100111;
    let i2543 = square_n(&(&(square_n(&(&square_n(&i2519, 9) * &_1000011), 4)) * &_1001), 9);
    let i2561 = &(square_n(&(&(square_n(&(&_110101 * &i2543), 8)) * &_1010011), 7)) * &_1100011;
    let i2586 = square_n(&(&(square_n(&(&square_n(&i2561, 5) * &_1001), 6)) * &_101), 12);
    let i2614 = &(square_n(&(&(square_n(&(&_11011 * &i2586), 13)) * &_101), 12)) * &_1101101;
    let i2641 = square_n(&(&(square_n(&(&square_n(&i2614, 4) * &_101), 14)) * &_1000001), 7);
    let i2658 = &(square_n(&(&(square_n(&(&_111011 * &i2641), 6)) * &_10011), 8)) * &_11011;
    let i2684 = square_n(&(&(square_n(&(&square_n(&i2658, 8) * &_10111), 9)) * &_1010001), 7);
    let i2702 = &(square_n(&(&(square_n(&(&_111001 * &i2684), 8)) * &_1010101), 7)) * &_1000111;
    let i2726 = square_n(&(&(square_n(&(&square_n(&i2702, 4) * &_1011), 10)) * &_1000101), 8);
    let i2741 = &(square_n(&(&(square_n(&(&_1011101 * &i2726), 6)) * &_110001), 6)) * &_11011;
    let i2767 = square_n(&(&(square_n(&(&square_n(&i2741, 9) * &_1000111), 9)) * &_1100001), 6);
    let i2792 = &(square_n(&(&(square_n(&(&_111111 * &i2767), 9)) * &_1101011), 13)) * &_111011;
    let i2820 = square_n(&(&(square_n(&(&square_n(&i2792, 8) * &_1111101), 6)) * &_11101), 12);
    let i2837 = &(square_n(&(&(square_n(&(&_1110101 * &i2820), 2)) * &_11), 12)) * &_1101001;
    let i2862 = square_n(&(&(square_n(&(&square_n(&i2837, 8) * &_110101), 8)) * &_1001101), 7);
    let i2878 = &(square_n(&(&(square_n(&(&_1110101 * &i2862), 8)) * &_1011001), 5)) * &_10111;
    let i2910 = square_n(&(&(square_n(&(&square_n(&i2878, 8) * &_11), 13)) * &_1011101), 9);
    let i2932 = &(square_n(&(&(square_n(&(&_1011101 * &i2910), 10)) * &_1111111), 9)) * &_1010111;
    let i2956 = square_n(&(&(square_n(&(&square_n(&i2932, 8) * &_1110001), 4)) * &_1001), 10);
    let i2972 = &(square_n(&(&(square_n(&(&_1101001 * &i2956), 6)) * &_11001), 7)) * &_1001;
    let i3000 = square_n(&(&(square_n(&(&square_n(&i2972, 9) * &_100011), 7)) * &_101001), 10);
    let i3019 = &(square_n(&(&(square_n(&(&_11111 * &i3000), 9)) * &_1010111), 7)) * &_1000101;
    let i3046 = square_n(&(&(square_n(&(&square_n(&i3019, 7) * &_100011), 11)) * &_1111101), 7);
    let i3065 = &(square_n(&(&(square_n(&(&_1000001 * &i3046), 7)) * &_1111011), 9)) * &_1010111;
    let i3094 = square_n(&(&(square_n(&(&square_n(&i3065, 14) * &_1001101), 8)) * &_1001101), 5);
    let i3115 = &(square_n(&(&(square_n(&(&_1111 * &i3094), 8)) * &_11011), 10)) * &_1111101;
    let i3140 = square_n(&(&(square_n(&(&square_n(&i3115, 7) * &_100111), 9)) * &_1101111), 7);
    let i3160 = &(square_n(&(&(square_n(&(&_101001 * &i3140), 9)) * &_1010101), 8)) * &_1110111;
    let i3182 = square_n(&(&(square_n(&(&square_n(&i3160, 7) * &_1000111), 6)) * &_100101), 7);
    let i3202 = &(square_n(&(&(square_n(&(&_111101 * &i3182), 5)) * &_1001), 12)) * &_1111001;
    let i3225 = square_n(&(&(square_n(&(&square_n(&i3202, 5) * &_10101), 9)) * &_1000111), 7);
    let i3243 = &(square_n(&(&(square_n(&(&_1010011 * &i3225), 7)) * &_1001111), 8)) * &_1100011;
    let i3266 = square_n(&(&(square_n(&(&square_n(&i3243, 7) * &_1101101), 6)) * &_10111), 8);
    let i3284 = &(square_n(&(&(square_n(&(&_110111 * &i3266), 7)) * &_111111), 8)) * &_1011001;
    let i3309 = square_n(&(&(square_n(&(&square_n(&i3284, 7) * &_1011011), 8)) * &_101111), 8);
    let i3326 = &(square_n(&(&(square_n(&(&_1010001 * &i3309), 4)) * &_1101), 10)) * &_1001111;
    let i3354 = square_n(&(&(square_n(&(&square_n(&i3326, 7) * &_1100011), 8)) * &_1000011), 11);
    let i3369 = &(square_n(&(&(square_n(&(&_1111011 * &i3354), 3)) * &_11), 9)) * &_11111111;
    let i3396 = square_n(&(&(square_n(&(&square_n(&i3369, 12) * &_1000111), 7)) * &_11111), 6);
    let i3421 = &(square_n(&(&(square_n(&(&_111 * &i3396), 11)) * &_1110001), 11)) * &_10101;
    let i3449 = square_n(&(&(square_n(&(&square_n(&i3421, 12) * &_1101001), 5)) * &_10011), 9);
    let i3470 = &(square_n(&(&(square_n(&(&_111101 * &i3449), 11)) * &_1100001), 7)) * &_1100101;
    &i3470.square() * base
}

/// Optimized exponentiation using addition chain (generated by addchain)
fn pow_r_m_d_inv(base: &FieldElement<Degree12ExtensionField>) -> FieldElement<Degree12ExtensionField> {
    let _10 = base.square();
    let _11 = base * &_10;
    let _100 = base * &_11;
    let _101 = base * &_100;
    let _111 = &_10 * &_101;
    let _1001 = &_10 * &_111;
    let _1011 = &_10 * &_1001;
    let _1101 = &_10 * &_1011;
    let _1111 = &_10 * &_1101;
    let _10001 = &_10 * &_1111;
    let _10011 = &_10 * &_10001;
    let _10101 = &_10 * &_10011;
    let _10111 = &_10 * &_10101;
    let _11001 = &_10 * &_10111;
    let _11011 = &_10 * &_11001;
    let _11101 = &_10 * &_11011;
    let _11111 = &_10 * &_11101;
    let _100001 = &_10 * &_11111;
    let _100011 = &_10 * &_100001;
    let _100101 = &_10 * &_100011;
    let _100111 = &_10 * &_100101;
    let _101001 = &_10 * &_100111;
    let _101011 = &_10 * &_101001;
    let _101101 = &_10 * &_101011;
    let _101111 = &_10 * &_101101;
    let _110001 = &_10 * &_101111;
    let _110011 = &_10 * &_110001;
    let _110101 = &_10 * &_110011;
    let _110111 = &_10 * &_110101;
    let _111001 = &_10 * &_110111;
    let _111011 = &_10 * &_111001;
    let _111101 = &_10 * &_111011;
    let _111111 = &_10 * &_111101;
    let _1000001 = &_10 * &_111111;
    let _1000011 = &_10 * &_1000001;
    let _1000101 = &_10 * &_1000011;
    let _1000111 = &_10 * &_1000101;
    let _1001001 = &_10 * &_1000111;
    let _1001011 = &_10 * &_1001001;
    let _1001101 = &_10 * &_1001011;
    let _1001111 = &_10 * &_1001101;
    let _1010001 = &_10 * &_1001111;
    let _1010011 = &_10 * &_1010001;
    let _1010101 = &_10 * &_1010011;
    let _1010111 = &_10 * &_1010101;
    let _1011001 = &_10 * &_1010111;
    let _1011011 = &_10 * &_1011001;
    let _1011101 = &_10 * &_1011011;
    let _1011111 = &_10 * &_1011101;
    let _1100001 = &_10 * &_1011111;
    let _1100011 = &_10 * &_1100001;
    let _1100101 = &_10 * &_1100011;
    let _1100111 = &_10 * &_1100101;
    let _1101001 = &_10 * &_1100111;
    let _1101011 = &_10 * &_1101001;
    let _1101101 = &_10 * &_1101011;
    let _1101111 = &_10 * &_1101101;
    let _1110001 = &_10 * &_1101111;
    let _1110011 = &_10 * &_1110001;
    let _1110101 = &_10 * &_1110011;
    let _1110111 = &_10 * &_1110101;
    let _1111001 = &_10 * &_1110111;
    let _1111011 = &_10 * &_1111001;
    let _1111101 = &_10 * &_1111011;
    let _1111111 = &_10 * &_1111101;
    let _10000001 = &_10 * &_1111111;
    let _10000011 = &_10 * &_10000001;
    let _10000101 = &_10 * &_10000011;
    let _10000111 = &_10 * &_10000101;
    let _10001001 = &_10 * &_10000111;
    let _10001011 = &_10 * &_10001001;
    let _10001101 = &_10 * &_10001011;
    let _10001111 = &_10 * &_10001101;
    let _10010001 = &_10 * &_10001111;
    let _10010011 = &_10 * &_10010001;
    let _10010101 = &_10 * &_10010011;
    let _10010111 = &_10 * &_10010101;
    let _10011001 = &_10 * &_10010111;
    let _10011011 = &_10 * &_10011001;
    let _10011101 = &_10 * &_10011011;
    let _10011111 = &_10 * &_10011101;
    let _10100001 = &_10 * &_10011111;
    let _10100011 = &_10 * &_10100001;
    let _10100101 = &_10 * &_10100011;
    let _10100111 = &_10 * &_10100101;
    let _10101001 = &_10 * &_10100111;
    let _10101011 = &_10 * &_10101001;
    let _10101101 = &_10 * &_10101011;
    let _10101111 = &_10 * &_10101101;
    let _10110001 = &_10 * &_10101111;
    let _10110011 = &_10 * &_10110001;
    let _10110101 = &_10 * &_10110011;
    let _10110111 = &_10 * &_10110101;
    let _10111001 = &_10 * &_10110111;
    let _10111011 = &_10 * &_10111001;
    let _10111101 = &_10 * &_10111011;
    let _10111111 = &_10 * &_10111101;
    let _11000001 = &_10 * &_10111111;
    let _11000011 = &_10 * &_11000001;
    let _11000101 = &_10 * &_11000011;
    let _11000111 = &_10 * &_11000101;
    let _11001001 = &_10 * &_11000111;
    let _11001011 = &_10 * &_11001001;
    let _11001101 = &_10 * &_11001011;
    let _11001111 = &_10 * &_11001101;
    let _11010001 = &_10 * &_11001111;
    let _11010011 = &_10 * &_11010001;
    let _11010111 = &_100 * &_11010011;
    let _11011001 = &_10 * &_11010111;
    let _11011011 = &_10 * &_11011001;
    let _11011101 = &_10 * &_11011011;
    let _11011111 = &_10 * &_11011101;
    let _11100001 = &_10 * &_11011111;
    let _11100011 = &_10 * &_11100001;
    let _11100101 = &_10 * &_11100011;
    let _11100111 = &_10 * &_11100101;
    let _11101001 = &_10 * &_11100111;
    let _11101011 = &_10 * &_11101001;
    let _11101101 = &_10 * &_11101011;
    let _11101111 = &_10 * &_11101101;
    let _11110001 = &_10 * &_11101111;
    let _11110011 = &_10 * &_11110001;
    let _11110101 = &_10 * &_11110011;
    let _11110111 = &_10 * &_11110101;
    let _11111001 = &_10 * &_11110111;
    let _11111011 = &_10 * &_11111001;
    let _11111101 = &_10 * &_11111011;
    let _11111111 = &_10 * &_11111101;
    let i146 = &(square_n(&(&(square_n(&(&_11 * &_11111111), 7)) * &_10100011), 8)) * &_11010011;
    let i174 = square_n(&(&(square_n(&(&square_n(&i146, 9) * &_1110011), 9)) * &_10101001), 8);
    let i199 = &(square_n(&(&(square_n(&(&_101011 * &i174), 11)) * &_100011), 11)) * &_11100011;
    let i229 = square_n(&(&(square_n(&(&square_n(&i199, 8) * &_10011011), 8)) * &_11000001), 12);
    let i255 = &(square_n(&(&(square_n(&(&_11110111 * &i229), 9)) * &_10000111), 14)) * &_10100001;
    let i278 = square_n(&(&(square_n(&(&square_n(&i255, 5) * &_11101), 9)) * &_10101), 7);
    let i298 = &(square_n(&(&(square_n(&(&_1011 * &i278), 10)) * &_100011), 7)) * &_11111;
    let i330 = square_n(&(&(square_n(&(&square_n(&i298, 12) * &_10111111), 8)) * &_1000011), 10);
    let i352 = &(square_n(&(&(square_n(&(&_1011111 * &i330), 8)) * &_1100001), 11)) * &_11111111;
    let i387 = square_n(&(&(square_n(&(&square_n(&i352, 10) * &_11011001), 10)) * &_10001), 13);
    let i411 = &(square_n(&(&(square_n(&(&_1000111 * &i387), 6)) * &_10111), 15)) * &_1101101;
    let i441 = square_n(&(&(square_n(&(&square_n(&i411, 12) * &_11100011), 7)) * &_1111011), 9);
    let i461 = &(square_n(&(&(square_n(&(&_11111011 * &i441), 8)) * &_11111011), 9)) * &_10101011;
    let i490 = square_n(&(&(square_n(&(&square_n(&i461, 11) * &_10111111), 9)) * &_10011011), 7);
    let i508 = &(square_n(&(&(square_n(&(&_1100111 * &i490), 8)) * &_1101111), 7)) * &_101111;
    let i537 = square_n(&(&(square_n(&(&square_n(&i508, 10) * &_11000011), 6)) * &_11011), 11);
    let i560 = &(square_n(&(&(square_n(&(&_10111111 * &i537), 9)) * &_10010101), 11)) * &_10100101;
    let i587 = square_n(&(&(square_n(&(&square_n(&i560, 9) * &_1001101), 9)) * &_1100001), 7);
    let i609 = &(square_n(&(&(square_n(&(&_110111 * &i587), 7)) * &_10111), 12)) * &_11101;
    let i638 = square_n(&(&(square_n(&(&square_n(&i609, 11) * &_11100111), 6)) * &_100111), 10);
    let i660 = &(square_n(&(&(square_n(&(&_100111 * &i638), 12)) * &_10110011), 7)) * &_1111101;
    let i686 = square_n(&(&(square_n(&(&square_n(&i660, 12) * &_10100101), 8)) * &_11110011), 4);
    let i710 = &(square_n(&(&(square_n(&(&_1001 * &i686), 13)) * &_10001011), 8)) * &_1001101;
    let i737 = square_n(&(&(square_n(&(&square_n(&i710, 5) * &_1001), 12)) * &_10100011), 8);
    let i755 = &(square_n(&(&(square_n(&(&_10001101 * &i737), 7)) * &_1010101), 8)) * &_1001001;
    let i788 = square_n(&(&(square_n(&(&square_n(&i755, 5) * &_1011), 13)) * &_1001001), 13);
    let i806 = &(square_n(&(&(square_n(&(&_10110011 * &i788), 8)) * &_11001101), 7)) * &_1010011;
    let i838 = square_n(&(&(square_n(&(&square_n(&i806, 11) * &_1101111), 10)) * &_10000001), 9);
    let i860 = &(square_n(&(&(square_n(&(&_10111011 * &i838), 11)) * &_11100111), 8)) * &_11101011;
    let i884 = square_n(&(&(square_n(&(&square_n(&i860, 2) * &_11), 13)) * &_1010101), 7);
    let i912 = &(square_n(&(&(square_n(&(&_101101 * &i884), 12)) * &_10101011), 13)) * &_111011;
    let i937 = square_n(&(&(square_n(&(&square_n(&i912, 7) * &_11101), 7)) * &_1111), 9);
    let i962 = &(square_n(&(&(square_n(&(&_10011 * &i937), 10)) * &_100001), 12)) * &_101011;
    let i993 = square_n(&(&(square_n(&(&square_n(&i962, 10) * &_11100011), 10)) * &_10111011), 9);
    let i1013 = &(square_n(&(&(square_n(&(&_11001111 * &i993), 10)) * &_10101101), 7)) * &_1001111;
    let i1041 = square_n(&(&(square_n(&(&square_n(&i1013, 10) * &_11110011), 8)) * &_10001001), 8);
    let i1060 = &(square_n(&(&(square_n(&(&_10011101 * &i1041), 8)) * &_10001001), 8)) * &_1101011;
    let i1092 = square_n(&(&(square_n(&(&square_n(&i1060, 7) * &_111011), 12)) * &_1000101), 11);
    let i1116 = &(square_n(&(&(square_n(&(&_10011011 * &i1092), 10)) * &_111001), 11)) * &_10111011;
    let i1151 = square_n(&(&(square_n(&(&square_n(&i1116, 11) * &_10111011), 10)) * &_11011011), 12);
    let i1173 = &(square_n(&(&(square_n(&(&_10011111 * &i1151), 12)) * &_11100111), 7)) * &_1000111;
    let i1204 = square_n(&(&(square_n(&(&square_n(&i1173, 9) * &_10001111), 10)) * &_11110001), 10);
    let i1223 = &(square_n(&(&(square_n(&(&_10001001 * &i1204), 8)) * &_10000011), 8)) * &_10001001;
    let i1250 = square_n(&(&(square_n(&(&square_n(&i1223, 6) * &_100111), 11)) * &_10011011), 8);
    let i1273 = &(square_n(&(&(square_n(&(&_11101001 * &i1250), 13)) * &_1110111), 7)) * &_100011;
    let i1304 = square_n(&(&(square_n(&(&square_n(&i1273, 11) * &_1100001), 9)) * &_11110111), 9);
    let i1324 = &(square_n(&(&(square_n(&(&_1011011 * &i1304), 10)) * &_11100001), 7)) * &_1100011;
    let i1352 = square_n(&(&(square_n(&(&square_n(&i1324, 9) * &_11010001), 8)) * &_11000111), 9);
    let i1378 = &(square_n(&(&(square_n(&(&_10010101 * &i1352), 14)) * &_11010001), 9)) * &_1001101;
    let i1409 = square_n(&(&(square_n(&(&square_n(&i1378, 8) * &_1010001), 12)) * &_1011011), 9);
    let i1430 = &(square_n(&(&(square_n(&(&_1101111 * &i1409), 8)) * &_111101), 10)) * &_1010011;
    let i1460 = square_n(&(&(square_n(&(&square_n(&i1430, 12) * &_10101101), 8)) * &_10011011), 8);
    let i1485 = &(square_n(&(&(square_n(&(&_10100001 * &i1460), 8)) * &_10001111), 14)) * &_1111101;
    let i1511 = square_n(&(&(square_n(&(&square_n(&i1485, 7) * &_100011), 9)) * &_1000111), 8);
    let i1532 = &(square_n(&(&(square_n(&(&_1100001 * &i1511), 9)) * &_1110011), 9)) * &_11110001;
    let i1559 = square_n(&(&(square_n(&(&square_n(&i1532, 7) * &_1100111), 10)) * &_11101101), 8);
    let i1579 = &(square_n(&(&(square_n(&(&_1101101 * &i1559), 8)) * &_11001), 9)) * &_110001;
    let i1613 = square_n(&(&(square_n(&(&square_n(&i1579, 9) * &_1000011), 10)) * &_1000011), 13);
    let i1640 = &(square_n(&(&(square_n(&(&_11001101 * &i1613), 12)) * &_1110001), 12)) * &_10101011;
    let i1666 = square_n(&(&(square_n(&(&square_n(&i1640, 4) * &_1011), 12)) * &_10111011), 8);
    let i1685 = &(square_n(&(&(square_n(&(&_11011011 * &i1666), 7)) * &_1010101), 9)) * &_11101101;
    let i1712 = square_n(&(&(square_n(&(&square_n(&i1685, 8) * &_11001011), 7)) * &_1111101), 10);
    let i1732 = &(square_n(&(&(square_n(&(&_11100101 * &i1712), 7)) * &_1101011), 10)) * &_10101101;
    let i1759 = square_n(&(&(square_n(&(&square_n(&i1732, 8) * &_1000001), 9)) * &_11001011), 8);
    let i1778 = &(square_n(&(&(square_n(&(&_11001011 * &i1759), 3)) * &_111), 13)) * &_11011111;
    let i1809 = square_n(&(&(square_n(&(&square_n(&i1778, 8) * &_100011), 12)) * &_11100111), 9);
    let i1827 = &(square_n(&(&(square_n(&(&_10001111 * &i1809), 6)) * &_110101), 9)) * &_1111111;
    let i1854 = square_n(&(&(square_n(&(&square_n(&i1827, 10) * &_10111101), 8)) * &_10001101), 7);
    let i1877 = &(square_n(&(&(square_n(&(&_1101011 * &i1854), 10)) * &_11101101), 10)) * &_10001111;
    let i1900 = square_n(&(&(square_n(&(&square_n(&i1877, 9) * &_11110101), 8)) * &_11000111), 4);
    let i1922 = &(square_n(&(&(square_n(&(&_1111 * &i1900), 12)) * &_10110111), 7)) * &_10001;
    let i1945 = square_n(&(&(square_n(&(&square_n(&i1922, 12) * &_11101001), 6)) * &_111101), 3);
    let i1970 = &(square_n(&(&(square_n(&(base * &i1945), 14)) * &_1101011), 8)) * &_111011;
    let i1997 = square_n(&(&(square_n(&(&square_n(&i1970, 11) * &_11011001), 7)) * &_1100001), 7);
    let i2018 = &(square_n(&(&(square_n(&(&_110001 * &i1997), 10)) * &_11000111), 8)) * &_11110111;
    let i2044 = square_n(&(&(square_n(&(&square_n(&i2018, 6) * &_11011), 12)) * &_10110011), 6);
    let i2067 = &(square_n(&(&(square_n(&(&_11111 * &i2044), 11)) * &_1101101), 9)) * &_10110011;
    let i2093 = square_n(&(&(square_n(&(&square_n(&i2067, 8) * &_11010001), 5)) * &_10011), 11);
    let i2112 = &(square_n(&(&(square_n(&(&_10001001 * &i2093), 5)) * &_11001), 11)) * &_11011111;
    let i2138 = square_n(&(&(square_n(&(&square_n(&i2112, 8) * &_11001001), 8)) * &_11111001), 8);
    let i2160 = &(square_n(&(&(square_n(&(&_10101111 * &i2138), 11)) * &_10111001), 8)) * &_1001001;
    let i2189 = square_n(&(&(square_n(&(&square_n(&i2160, 10) * &_11100111), 9)) * &_10111101), 8);
    let i2210 = &(square_n(&(&(square_n(&(&_11101011 * &i2189), 8)) * &_1111001), 10)) * &_1100001;
    let i2238 = square_n(&(&(square_n(&(&square_n(&i2210, 9) * &_11010111), 10)) * &_10100011), 7);
    let i2258 = &(square_n(&(&(square_n(&(&_1111101 * &i2238), 9)) * &_11000011), 8)) * &_1001001;
    let i2284 = square_n(&(&(square_n(&(&square_n(&i2258, 9) * &_1000001), 12)) * &_11001001), 3);
    let i2312 = &(square_n(&(&(square_n(&(&_111 * &i2284), 18)) * &_10011001), 7)) * &_1010111;
    let i2340 = square_n(&(&(square_n(&(&square_n(&i2312, 9) * &_11100001), 8)) * &_11110101), 9);
    let i2359 = &(square_n(&(&(square_n(&(&_10011011 * &i2340), 8)) * &_10000011), 8)) * &_1001101;
    let i2387 = square_n(&(&(square_n(&(&square_n(&i2359, 8) * &_100111), 9)) * &_1100001), 9);
    let i2409 = &(square_n(&(&(square_n(&(&_10100011 * &i2387), 8)) * &_1000011), 11)) * &_10001;
    let i2451 = square_n(&(&(square_n(&(&square_n(&i2409, 18) * &_1111001), 9)) * &_111001), 13);
    let i2469 = &(square_n(&(&(square_n(&(&_11101011 * &i2451), 7)) * &_1011101), 8)) * &_1001101;
    let i2491 = square_n(&(&(square_n(&(&square_n(&i2469, 10) * &_10000111), 8)) * &_11001001), 2);
    let i2515 = &(square_n(&(&(square_n(&(&_11 * &i2491), 13)) * &_1011011), 8)) * &_1010101;
    let i2544 = square_n(&(&(square_n(&(&square_n(&i2515, 9) * &_100011), 9)) * &_111101), 9);
    let i2568 = &(square_n(&(&(square_n(&(&_10001 * &i2544), 14)) * &_10010011), 7)) * &_1001101;
    let i2599 = square_n(&(&(square_n(&(&square_n(&i2568, 3) * base), 18)) * &_110011), 8);
    let i2618 = &(square_n(&(&(square_n(&(&_110011 * &i2599), 10)) * &_10100111), 6)) * &_11011;
    let i2648 = square_n(&(&(square_n(&(&square_n(&i2618, 8) * &_11101), 12)) * &_10101111), 8);
    let i2671 = &(square_n(&(&(square_n(&(&_101101 * &i2648), 10)) * &_10101111), 10)) * &_11100101;
    let i2696 = square_n(&(&(square_n(&(&square_n(&i2671, 7) * &_110111), 10)) * &_10110001), 6);
    let i2716 = &(square_n(&(&(square_n(&(&_101101 * &i2696), 11)) * &_10001001), 6)) * &_1001;
    let i2749 = square_n(&(&(square_n(&(&square_n(&i2716, 9) * &_11101), 12)) * &_101011), 10);
    let i2769 = &(square_n(&(&(square_n(&(&_100001 * &i2749), 11)) * &_10001111), 6)) * &_101001;
    let i2800 = square_n(&(&(square_n(&(&square_n(&i2769, 12) * &_10111101), 8)) * &_10111011), 9);
    let i2820 = &(square_n(&(&(square_n(&(&_101101 * &i2800), 10)) * &_10101001), 7)) * &_1110011;
    let i2849 = square_n(&(&(square_n(&(&square_n(&i2820, 9) * &_10000001), 7)) * &_101011), 11);
    let i2869 = &(square_n(&(&(square_n(&(&_10110101 * &i2849), 8)) * &_1110101), 9)) * &_10001101;
    let i2895 = square_n(&(&(square_n(&(&square_n(&i2869, 8) * &_11111001), 8)) * &_1110101), 8);
    let i2918 = &(square_n(&(&(square_n(&(&_1111 * &i2895), 6)) * &_11), 14)) * &_1011111;
    let i2939 = square_n(&(&(square_n(&(&square_n(&i2918, 5) * &_1111), 11)) * &_1100101), 3);
    let i2968 = &(square_n(&(&(square_n(&(&_11 * &i2939), 13)) * &_1011011), 13)) * &_10001001;
    let i2994 = square_n(&(&(square_n(&(&square_n(&i2968, 8) * &_10000111), 8)) * &_10100001), 8);
    let i3013 = &(square_n(&(&(square_n(&(&_11001101 * &i2994), 8)) * &_1000111), 8)) * &_1101111;
    let i3042 = square_n(&(&(square_n(&(&square_n(&i3013, 11) * &_10010001), 8)) * &_1011001), 8);
    let i3064 = &(square_n(&(&(square_n(&(&_100001 * &i3042), 9)) * &_1101001), 10)) * &_11010011;
    let i3092 = square_n(&(&(square_n(&(&square_n(&i3064, 8) * &_11110011), 8)) * &_110111), 10);
    let i3114 = &(square_n(&(&(square_n(&(&_101111 * &i3092), 11)) * &_11100001), 8)) * &_10000111;
    let i3140 = square_n(&(&(square_n(&(&square_n(&i3114, 5) * &_10111), 12)) * &_10111111), 7);
    let i3165 = &(square_n(&(&(square_n(&(&_1110011 * &i3140), 10)) * &_11110111), 12)) * &_10110011;
    let i3191 = square_n(&(&(square_n(&(&square_n(&i3165, 8) * &_10111111), 7)) * &_1010011), 9);
    let i3212 = &(square_n(&(&(square_n(&(&_1100101 * &i3191), 9)) * &_10000001), 9)) * &_10101101;
    let i3239 = square_n(&(&(square_n(&(&square_n(&i3212, 6) * &_11011), 11)) * &_10111101), 8);
    let i3258 = &(square_n(&(&(square_n(&(&_11100001 * &i3239), 7)) * &_1111001), 9)) * &_1110111;
    let i3287 = square_n(&(&(square_n(&(&square_n(&i3258, 10) * &_11111001), 6)) * &_10011), 11);
    let i3308 = &(square_n(&(&(square_n(&(&_11110101 * &i3287), 7)) * &_100101), 11)) * &_11101111;
    let i3344 = square_n(&(&(square_n(&(&square_n(&i3308, 11) * &_1100111), 10)) * &_1110001), 13);
    let i3365 = &(square_n(&(&(square_n(&(&_1100011 * &i3344), 12)) * &_11110111), 6)) * &_111011;
    let i3399 = square_n(&(&(square_n(&(&square_n(&i3365, 12) * &_10010001), 7)) * &_1110101), 13);
    let i3418 = &(square_n(&(&(square_n(&(&_11100101 * &i3399), 7)) * &_1010111), 9)) * &_1100111;
    let i3444 = square_n(&(&(square_n(&(&square_n(&i3418, 9) * &_11110101), 9)) * &_1010011), 6);
    let i3470 = &(square_n(&(&(square_n(&(&_10001 * &i3444), 9)) * &_101101), 14)) * &_1101001;
    let i3497 = square_n(&(&(square_n(&(&square_n(&i3470, 9) * &_10100101), 4)) * &_101), 12);
    let i3515 = &(square_n(&(&(square_n(&(&_1010001 * &i3497), 3)) * base), 12)) * &_11011;
    let i3551 = square_n(&(&(square_n(&(&square_n(&i3515, 14) * &_11011001), 12)) * &_1101011), 8);
    let i3570 = &(square_n(&(&(square_n(&(&_1101111 * &i3551), 9)) * &_10110111), 7)) * &_110001;
    let i3604 = square_n(&(&(square_n(&(&square_n(&i3570, 10) * &_11110111), 8)) * &_11111111), 14);
    let i3623 = &(square_n(&(&(square_n(&(&_10101001 * &i3604), 9)) * &_11010001), 7)) * &_1011011;
    let i3650 = square_n(&(&(square_n(&(&square_n(&i3623, 9) * &_10100111), 4)) * &_1111), 12);
    let i3676 = &(square_n(&(&(square_n(&(&_100101 * &i3650), 15)) * &_10011111), 8)) * &_11001011;
    let i3706 = square_n(&(&(square_n(&(&square_n(&i3676, 9) * &_11000101), 8)) * &_11101111), 11);
    let i3726 = &(square_n(&(&(square_n(&(&_11101101 * &i3706), 6)) * &_100101), 11)) * &_10001011;
    let i3753 = square_n(&(&(square_n(&(&square_n(&i3726, 7) * &_1010001), 9)) * &_1011001), 9);
    let i3771 = &(square_n(&(&(square_n(&(&_10001001 * &i3753), 8)) * &_11101011), 7)) * &_1000101;
    let i3804 = square_n(&(&(square_n(&(&square_n(&i3771, 11) * &_1010011), 8)) * &_1001111), 12);
    let i3825 = &(square_n(&(&(square_n(&(&_1101111 * &i3804), 10)) * &_11111101), 8)) * &_1100111;
    let i3852 = square_n(&(&(square_n(&(&square_n(&i3825, 8) * &_1000001), 3)) * &_11), 14);
    let i3867 = &(square_n(&(&(square_n(&(&_10101101 * &i3852), 8)) * &_10011001), 4)) * &_1011;
    let i3895 = square_n(&(&(square_n(&(&square_n(&i3867, 14) * &_11110011), 8)) * &_10101001), 4);
    let i3919 = &(square_n(&(&(square_n(&(&_1101 * &i3895), 11)) * &_110111), 10)) * &_11011111;
    let i3946 = square_n(&(&(square_n(&(&square_n(&i3919, 9) * &_10010011), 6)) * &_10101), 10);
    let i3967 = &(square_n(&(&(square_n(&(&_1101001 * &i3946), 12)) * &_10011011), 6)) * &_110111;
    let i3998 = square_n(&(&(square_n(&(&square_n(&i3967, 10) * &_11000111), 6)) * &_11011), 13);
    let i4017 = &(square_n(&(&(square_n(&(&_11010111 * &i3998), 7)) * &_1001001), 9)) * &_11100011;
    let i4047 = square_n(&(&(square_n(&(&square_n(&i4017, 8) * &_11101), 11)) * &_11111011), 9);
    let i4063 = &(square_n(&(&(square_n(&(&_10111111 * &i4047), 8)) * &_10100011), 5)) * &_1101;
    let i4093 = square_n(&(&(square_n(&(&square_n(&i4063, 11) * &_1110001), 9)) * &_10111101), 8);
    let i4113 = &(square_n(&(&(square_n(&(&_10111011 * &i4093), 9)) * &_10001101), 8)) * &_10100001;
    let i4143 = square_n(&(&(square_n(&(&square_n(&i4113, 9) * &_11111001), 11)) * &_10111111), 8);
    let i4168 = &(square_n(&(&(square_n(&(&_11111001 * &i4143), 5)) * &_111), 17)) * &_10001001;
    let i4191 = square_n(&(&(square_n(&(&square_n(&i4168, 4) * &_1001), 12)) * &_1111001), 5);
    let i4217 = &(square_n(&(&(square_n(&(&_1001 * &i4191), 14)) * &_10111101), 9)) * &_11111111;
    let i4245 = square_n(&(&(square_n(&(&square_n(&i4217, 8) * &_10101011), 8)) * &_10101101), 10);
    let i4267 = &(square_n(&(&(square_n(&(&_101111 * &i4245), 11)) * &_110011), 8)) * &_101101;
    let i4294 = square_n(&(&(square_n(&(&square_n(&i4267, 9) * &_1100001), 9)) * &_10111001), 7);
    let i4317 = &(square_n(&(&(square_n(&(&_100001 * &i4294), 12)) * &_11110001), 8)) * &_10101101;
    let i4345 = square_n(&(&(square_n(&(&square_n(&i4317, 11) * &_10111011), 7)) * &_1111011), 8);
    let i4366 = &(square_n(&(&(square_n(&(&_1101101 * &i4345), 10)) * &_10100101), 8)) * &_1110111;
    let i4396 = square_n(&(&(square_n(&(&square_n(&i4366, 11) * &_11100101), 4)) * &_111), 13);
    let i4418 = &(square_n(&(&(square_n(&(&_1100011 * &i4396), 9)) * &_111111), 10)) * &_10010011;
    let i4446 = square_n(&(&(square_n(&(&square_n(&i4418, 9) * &_11111011), 8)) * &_1111111), 9);
    let i4462 = &(square_n(&(&(square_n(&(&_10010101 * &i4446), 8)) * &_10010101), 5)) * &_10011;
    let i4495 = square_n(&(&(square_n(&(&square_n(&i4462, 11) * &_1101101), 8)) * &_1000111), 12);
    let i4514 = &(square_n(&(&(square_n(&(&_11000001 * &i4495), 8)) * &_1101111), 8)) * &_1100001;
    let i4543 = square_n(&(&(square_n(&(&square_n(&i4514, 10) * &_10011101), 8)) * &_11000001), 9);
    let i4562 = &(square_n(&(&(square_n(&(&_1010011 * &i4543), 7)) * &_111111), 9)) * &_101001;
    let i4589 = square_n(&(&(square_n(&(&square_n(&i4562, 10) * &_11010001), 9)) * &_11110111), 6);
    let i4609 = &(square_n(&(&(square_n(&(&_111001 * &i4589), 4)) * &_11), 13)) * &_1001001;
    let i4637 = square_n(&(&(square_n(&(&square_n(&i4609, 8) * &_1010001), 9)) * &_11101011), 9);
    let i4658 = &(square_n(&(&(square_n(&(&_10100101 * &i4637), 10)) * &_11100101), 8)) * &_10001;
    let i4686 = square_n(&(&(square_n(&(&square_n(&i4658, 11) * &_10011011), 8)) * &_10001011), 7);
    let i4706 = &(square_n(&(&(square_n(&(&_1111111 * &i4686), 7)) * &_100011), 10)) * &_1101011;
    let i4732 = square_n(&(&(square_n(&(&square_n(&i4706, 9) * &_10010001), 5)) * &_10011), 10);
    let i4760 = &(square_n(&(&(square_n(&(&_10001 * &i4732), 17)) * &_10000101), 8)) * &_11001111;
    let i4787 = square_n(&(&(square_n(&(&square_n(&i4760, 7) * &_1000111), 9)) * &_11011011), 9);
    let i4806 = &(square_n(&(&(square_n(&(&_10011101 * &i4787), 6)) * &_101101), 10)) * &_111001;
    let i4834 = square_n(&(&(square_n(&(&square_n(&i4806, 10) * &_11111), 9)) * &_110011), 7);
    let i4863 = &(square_n(&(&(square_n(&(&_10101 * &i4834), 11)) * &_1111), 15)) * &_11111011;
    let i4889 = square_n(&(&(square_n(&(&square_n(&i4863, 7) * &_1001101), 6)) * &_11001), 11);
    let i4914 = &(square_n(&(&(square_n(&(&_11110111 * &i4889), 13)) * &_1111111), 9)) * &_10000011;
    let i4942 = square_n(&(&(square_n(&(&square_n(&i4914, 10) * &_11100011), 10)) * &_11010011), 6);
    let i4959 = &(square_n(&(&(square_n(&(&_111011 * &i4942), 10)) * &_11111111), 4)) * &_1001;
    let i4991 = square_n(&(&(square_n(&(&square_n(&i4959, 12) * &_10111111), 8)) * &_110001), 10);
    let i5010 = &(square_n(&(&(square_n(&(&_11001111 * &i4991), 6)) * &_111111), 10)) * &_11011;
    let i5033 = square_n(&(&(square_n(&(&square_n(&i5010, 11) * &_11110001), 7)) * &_1111111), 3);
    let i5060 = &(square_n(&(&(square_n(&(&_11 * &i5033), 13)) * &_1010001), 11)) * &_11101111;
    let i5088 = square_n(&(&(square_n(&(&square_n(&i5060, 6) * &_101111), 11)) * &_11010111), 9);
    let i5109 = &(square_n(&(&(square_n(&(&_10101101 * &i5088), 11)) * &_11011001), 7)) * &_1011101;
    let i5134 = square_n(&(&(square_n(&(&square_n(&i5109, 9) * &_10101011), 8)) * &_10010111), 6);
    let i5161 = &(square_n(&(&(square_n(&(&_100101 * &i5134), 12)) * &_11001101), 12)) * &_10000011;
    let i5192 = square_n(&(&(square_n(&(&square_n(&i5161, 7) * &_1101011), 10)) * &_10110011), 12);
    let i5209 = &(square_n(&(&(square_n(&(&_1100001 * &i5192), 9)) * &_1001001), 5)) * &_1011;
    let i5243 = square_n(&(&(square_n(&(&square_n(&i5209, 12) * &_11100101), 8)) * &_110111), 12);
    let i5264 = &(square_n(&(&(square_n(&(&_11111111 * &i5243), 9)) * &_11110001), 9)) * &_11101101;
    let i5291 = square_n(&(&(square_n(&(&square_n(&i5264, 9) * &_11100111), 7)) * &_1100101), 9);
    let i5314 = &(square_n(&(&(square_n(&(&_1101011 * &i5291), 4)) * &_11), 16)) * &_11001011;
    let i5341 = square_n(&(&(square_n(&(&square_n(&i5314, 7) * &_1010101), 10)) * &_10100111), 8);
    let i5359 = &(square_n(&(&(square_n(&(&_10100001 * &i5341), 4)) * &_1111), 11)) * &_1011101;
    let i5388 = square_n(&(&(square_n(&(&square_n(&i5359, 10) * &_10111101), 10)) * &_11111101), 7);
    let i5406 = &(square_n(&(&(square_n(&(&_1011011 * &i5388), 8)) * &_1011111), 7)) * &_110101;
    let i5435 = square_n(&(&(square_n(&(&square_n(&i5406, 10) * &_10110001), 8)) * &_11010011), 9);
    let i5457 = &(square_n(&(&(square_n(&(&_11011011 * &i5435), 10)) * &_11101101), 9)) * &_1010011;
    let i5485 = square_n(&(&(square_n(&(&square_n(&i5457, 3) * &_11), 13)) * &_1001111), 10);
    let i5506 = &(square_n(&(&(square_n(&(&_1010101 * &i5485), 9)) * &_10100011), 9)) * &_11110111;
    let i5530 = square_n(&(&(square_n(&(&square_n(&i5506, 8) * &_11110011), 7)) * &_1011011), 7);
    let i5547 = &(square_n(&(&(square_n(&(&_111011 * &i5530), 10)) * &_11010111), 4)) * &_1011;
    let i5576 = square_n(&(&(square_n(&(&square_n(&i5547, 12) * &_1000101), 11)) * &_11110111), 4);
    let i5600 = &(square_n(&(&(square_n(&(&_1001 * &i5576), 13)) * &_11001111), 8)) * &_11001011;
    let i5631 = square_n(&(&(square_n(&(&square_n(&i5600, 9) * &_10010111), 9)) * &_10101), 11);
    let i5650 = &(square_n(&(&(square_n(&(&_10011111 * &i5631), 9)) * &_11011101), 7)) * &_1101011;
    let i5676 = square_n(&(&(square_n(&(&square_n(&i5650, 7) * &_100011), 10)) * &_10111001), 7);
    let i5697 = &(square_n(&(&(square_n(&(&_1001011 * &i5676), 8)) * &_110011), 10)) * &_11100011;
    let i5725 = square_n(&(&(square_n(&(&square_n(&i5697, 8) * &_11001001), 9)) * &_10011011), 9);
    let i5744 = &(square_n(&(&(square_n(&(&_10100111 * &i5725), 8)) * &_11001011), 8)) * &_10011001;
    let i5773 = square_n(&(&(square_n(&(&square_n(&i5744, 7) * &_11111), 11)) * &_11110111), 9);
    let i5793 = &(square_n(&(&(square_n(&(&_11100101 * &i5773), 9)) * &_11010111), 8)) * &_10011001;
    let i5821 = square_n(&(&(square_n(&(&square_n(&i5793, 6) * &_11101), 12)) * &_11101011), 8);
    let i5844 = &(square_n(&(&(square_n(&(&_1111001 * &i5821), 9)) * &_10110111), 11)) * &_10100001;
    let i5867 = square_n(&(&(square_n(&(&square_n(&i5844, 9) * &_10111001), 8)) * &_11001001), 4);
    let i5890 = &(square_n(&(&(square_n(&(&_1011 * &i5867), 13)) * &_11110101), 7)) * &_1001001;
    let i5917 = square_n(&(&(square_n(&(&square_n(&i5890, 8) * &_1011101), 6)) * &_10111), 11);
    let i5939 = &(square_n(&(&(square_n(&(&_10010101 * &i5917), 9)) * &_1011101), 10)) * &_11110101;
    let i5969 = square_n(&(&(square_n(&(&square_n(&i5939, 5) * &_1001), 11)) * &_1110111), 12);
    let i5985 = &(square_n(&(&(square_n(&(&_10110011 * &i5969), 8)) * &_10110101), 5)) * &_10111;
    let i6017 = square_n(&(&(square_n(&(&square_n(&i5985, 12) * &_11011111), 10)) * &_11111011), 8);
    let i6037 = &(square_n(&(&(square_n(&(&_10101011 * &i6017), 8)) * &_11010001), 9)) * &_10000011;
    let i6066 = square_n(&(&(square_n(&(&square_n(&i6037, 9) * &_11011111), 11)) * &_1010111), 7);
    let i6088 = &(square_n(&(&(square_n(&(&_110001 * &i6066), 5)) * &_111), 14)) * &_11011111;
    let i6112 = square_n(&(&(square_n(&(&square_n(&i6088, 6) * &_101101), 9)) * &_1101101), 7);
    let i6137 = &(square_n(&(&(square_n(&(&_110111 * &i6112), 9)) * &_10001), 13)) * &_11100011;
    let i6161 = square_n(&(&(square_n(&(&square_n(&i6137, 8) * &_10010001), 5)) * &_11001), 9);
    let i6182 = &(square_n(&(&(square_n(&(&_101101 * &i6161), 10)) * &_1011101), 8)) * &_1110101;
    let i6208 = square_n(&(&(square_n(&(&square_n(&i6182, 10) * &_10101001), 11)) * &_10000101), 3);
    let i6235 = &(square_n(&(&(square_n(&(&_111 * &i6208), 10)) * &_10101), 14)) * &_101001;
    let i6263 = square_n(&(&(square_n(&(&square_n(&i6235, 10) * &_1100001), 9)) * &_10010011), 7);
    let i6283 = &(square_n(&(&(square_n(&(&_100111 * &i6263), 10)) * &_10111111), 7)) * &_1111101;
    let i6314 = square_n(&(&(square_n(&(&square_n(&i6283, 12) * &_11101111), 9)) * &_1111101), 8);
    &_10111 * &i6314
}

/// Algorithm for computing  residues over BN254 curve
/// Input: Output of a Miller loop f
/// Output: (c, wi) such that c **  = f * wi
pub fn get_final_exp_witness(
    f: FieldElement<Degree12ExtensionField>,
) -> (
    FieldElement<Degree12ExtensionField>,
    FieldElement<Degree12ExtensionField>,
) {
    let w = get_27th_root();
    let mut c = f.clone();
    let mut ws = FieldElement::<Degree12ExtensionField>::one();

    if pow_exp(&c) != FieldElement::<Degree12ExtensionField>::one() {
        c = &c * &w;
        ws = &ws * &w;
        if pow_exp(&c) != FieldElement::<Degree12ExtensionField>::one() {
            c = &c * &w;
            ws = &ws * &w;
        }
    }

    c = pow_r_m_d_inv(&c);
    (find_cube_root(c, w), ws)
}

fn get_27th_root() -> FieldElement<Degree12ExtensionField> {
    FieldElement::<Degree12ExtensionField>::new([
        FieldElement::<Degree6ExtensionField>::new([
            FieldElement::<Degree2ExtensionField>::zero(),
            FieldElement::<Degree2ExtensionField>::zero(),
            FieldElement::<Degree2ExtensionField>::new([
                FieldElement::<BN254PrimeField>::from_hex_unchecked(
                    "1223c9e5932f55ff4c5bb93e3ae400abc8ff620b6cd0ba64515fe1909e9f8e51",
                ),
                FieldElement::<BN254PrimeField>::from_hex_unchecked(
                    "279a0a9dbd98089c184dac0e71909eb223ea52bfc24790f6d545aed52a2fbdb8",
                ),
            ]),
        ]),
        FieldElement::<Degree6ExtensionField>::zero(),
    ])
}

fn find_cube_root(
    a: FieldElement<Degree12ExtensionField>,
    w: FieldElement<Degree12ExtensionField>,
) -> FieldElement<Degree12ExtensionField> {
    let a_inv = a.inv().unwrap();
    let we = pow_exp0(&w);
    let mut x = pow_exp0(&a);
    let mut t = pow_3_ord(&(&x.pow(3u64) * &a_inv));
    while t != 0 {
        x = &x * &we;
        t = pow_3_ord(&(&x.pow(3u64) * &a_inv));
    }
    x
}

fn pow_3_ord(a: &FieldElement<Degree12ExtensionField>) -> usize {
    let mut a = a.clone();
    let mut t = 0;
    while a != FieldElement::<Degree12ExtensionField>::one() {
        a = a.pow(3u64);
        t += 1;
    }
    t
}
