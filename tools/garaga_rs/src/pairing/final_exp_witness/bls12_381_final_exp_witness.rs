use lambdaworks_math::elliptic_curve::short_weierstrass::curves::bls12_381::field_extension::Degree12ExtensionField;
use lambdaworks_math::field::element::FieldElement;

// Helper function to square a value n times
#[inline]
fn square_n(
    base: &FieldElement<Degree12ExtensionField>,
    n: usize,
) -> FieldElement<Degree12ExtensionField> {
    let mut result = base.clone();
    for _ in 0..n {
        result = result.square();
    }
    result
}

/// Optimized exponentiation using addition chain (generated by addchain)
fn pow_h3_s(base: &FieldElement<Degree12ExtensionField>) -> FieldElement<Degree12ExtensionField> {
    let _10 = base.square();
    let _11 = base * &_10;
    let _101 = &_10 * &_11;
    let _111 = &_10 * &_101;
    let _1001 = &_10 * &_111;
    let _1011 = &_10 * &_1001;
    let _1101 = &_10 * &_1011;
    let _1111 = &_10 * &_1101;
    let _10001 = &_10 * &_1111;
    let _10011 = &_10 * &_10001;
    let _10101 = &_10 * &_10011;
    let _10111 = &_10 * &_10101;
    let _11001 = &_10 * &_10111;
    let _11011 = &_10 * &_11001;
    let _11101 = &_10 * &_11011;
    let _11111 = &_10 * &_11101;
    let _100001 = &_10 * &_11111;
    let _100011 = &_10 * &_100001;
    let _100101 = &_10 * &_100011;
    let _100110 = base * &_100101;
    let _100111 = base * &_100110;
    let _101001 = &_10 * &_100111;
    let _101011 = &_10 * &_101001;
    let _101101 = &_10 * &_101011;
    let _110001 = &_1011 * &_100110;
    let _110011 = &_10 * &_110001;
    let _110101 = &_10 * &_110011;
    let _110111 = &_10 * &_110101;
    let _111001 = &_10 * &_110111;
    let _111011 = &_10 * &_111001;
    let _111101 = &_10 * &_111011;
    let _111111 = &_10 * &_111101;
    let _1000001 = &_10 * &_111111;
    let _1000011 = &_10 * &_1000001;
    let _1000101 = &_10 * &_1000011;
    let _1000111 = &_10 * &_1000101;
    let _1001001 = &_10 * &_1000111;
    let _1001011 = &_10 * &_1001001;
    let _1001101 = &_10 * &_1001011;
    let _1001111 = &_10 * &_1001101;
    let _1010001 = &_10 * &_1001111;
    let _1010011 = &_10 * &_1010001;
    let _1010101 = &_10 * &_1010011;
    let _1010111 = &_10 * &_1010101;
    let _1011001 = &_10 * &_1010111;
    let _1011011 = &_10 * &_1011001;
    let _1011101 = &_10 * &_1011011;
    let _1011111 = &_10 * &_1011101;
    let _1100001 = &_10 * &_1011111;
    let _1100011 = &_10 * &_1100001;
    let _1100101 = &_10 * &_1100011;
    let _1100111 = &_10 * &_1100101;
    let _1101001 = &_10 * &_1100111;
    let _1101011 = &_10 * &_1101001;
    let _1101101 = &_10 * &_1101011;
    let _1101111 = &_10 * &_1101101;
    let _1110001 = &_10 * &_1101111;
    let _1110011 = &_10 * &_1110001;
    let _1110101 = &_10 * &_1110011;
    let _1110111 = &_10 * &_1110101;
    let _1111001 = &_10 * &_1110111;
    let _1111011 = &_10 * &_1111001;
    let _1111101 = &_10 * &_1111011;
    let _1111111 = &_10 * &_1111101;
    let _10000001 = &_10 * &_1111111;
    let _10000011 = &_10 * &_10000001;
    let _10000101 = &_10 * &_10000011;
    let _10000111 = &_10 * &_10000101;
    let _10001001 = &_10 * &_10000111;
    let _10001011 = &_10 * &_10001001;
    let _10001101 = &_10 * &_10001011;
    let _10001111 = &_10 * &_10001101;
    let _10010001 = &_10 * &_10001111;
    let _10010011 = &_10 * &_10010001;
    let _10010101 = &_10 * &_10010011;
    let _10010111 = &_10 * &_10010101;
    let _10011001 = &_10 * &_10010111;
    let _10011011 = &_10 * &_10011001;
    let _10011101 = &_10 * &_10011011;
    let _10011111 = &_10 * &_10011101;
    let _10100001 = &_10 * &_10011111;
    let _10100011 = &_10 * &_10100001;
    let _10100101 = &_10 * &_10100011;
    let _10100111 = &_10 * &_10100101;
    let _10101001 = &_10 * &_10100111;
    let _10101011 = &_10 * &_10101001;
    let _10101101 = &_10 * &_10101011;
    let _10101111 = &_10 * &_10101101;
    let _10110001 = &_10 * &_10101111;
    let _10110011 = &_10 * &_10110001;
    let _10110101 = &_10 * &_10110011;
    let _10110111 = &_10 * &_10110101;
    let _10111001 = &_10 * &_10110111;
    let _10111011 = &_10 * &_10111001;
    let _10111101 = &_10 * &_10111011;
    let _10111111 = &_10 * &_10111101;
    let _11000001 = &_10 * &_10111111;
    let _11000011 = &_10 * &_11000001;
    let _11000101 = &_10 * &_11000011;
    let _11000111 = &_10 * &_11000101;
    let _11001001 = &_10 * &_11000111;
    let _11001011 = &_10 * &_11001001;
    let _11001101 = &_10 * &_11001011;
    let _11001111 = &_10 * &_11001101;
    let _11010001 = &_10 * &_11001111;
    let _11010011 = &_10 * &_11010001;
    let _11010101 = &_10 * &_11010011;
    let _11010111 = &_10 * &_11010101;
    let _11011001 = &_10 * &_11010111;
    let _11011011 = &_10 * &_11011001;
    let _11011101 = &_10 * &_11011011;
    let _11011111 = &_10 * &_11011101;
    let _11100001 = &_10 * &_11011111;
    let _11100011 = &_10 * &_11100001;
    let _11100101 = &_10 * &_11100011;
    let _11100111 = &_10 * &_11100101;
    let _11101001 = &_10 * &_11100111;
    let _11101011 = &_10 * &_11101001;
    let _11101101 = &_10 * &_11101011;
    let _11101111 = &_10 * &_11101101;
    let _11110101 = &_100110 * &_11001111;
    let _11110111 = &_10 * &_11110101;
    let _11111001 = &_10 * &_11110111;
    let _11111101 = &_100110 * &_11010111;
    let _11111111 = &_10 * &_11111101;
    let i145 = &(square_n(&(&(square_n(&(&_110001 * &_11111111), 7)) * &_11001101), 10)) * &_10100111;
    let i172 = square_n(&(&(square_n(&(&square_n(&i145, 9) * &_1001011), 8)) * &_1011001), 8);
    let i199 = &(square_n(&(&(square_n(&(&_100001 * &i172), 10)) * &_10111), 14)) * &_1111101;
    let i228 = square_n(&(&(square_n(&(&square_n(&i199, 11) * &_1000111), 9)) * &_11111101), 7);
    let i248 = &(square_n(&(&(square_n(&(&_1101011 * &i228), 10)) * &_11011001), 7)) * &_1011111;
    let i274 = square_n(&(&(square_n(&(&square_n(&i248, 8) * &_1101011), 9)) * &_1001111), 7);
    let i295 = &(square_n(&(&(square_n(&(&_101001 * &i274), 10)) * &_10100011), 8)) * &_11101011;
    let i321 = square_n(&(&(square_n(&(&square_n(&i295, 9) * &_11011011), 6)) * &_111111), 9);
    let i342 = &(square_n(&(&(square_n(&(&_100111 * &i321), 9)) * &_1011001), 9)) * &_11000101;
    let i368 = square_n(&(&(square_n(&(&square_n(&i342, 7) * &_1101111), 9)) * &_10010011), 8);
    let i388 = &(square_n(&(&(square_n(&(&_10001001 * &i368), 9)) * &_11101001), 8)) * &_1010011;
    let i417 = square_n(&(&(square_n(&(&square_n(&i388, 3) * &_11), 15)) * &_1110101), 9);
    let i437 = &(square_n(&(&(square_n(&(&_10110111 * &i417), 5)) * &_10001), 12)) * &_10010111;
    let i463 = square_n(&(&(square_n(&(&square_n(&i437, 9) * &_10101001), 9)) * &_10100111), 6);
    let i486 = &(square_n(&(&(square_n(&(&_10101 * &i463), 9)) * &_10101), 11)) * &_10101011;
    let i513 = square_n(&(&(square_n(&(&square_n(&i486, 4) * &_101), 13)) * &_10001101), 8);
    let i530 = &(square_n(&(&(square_n(&(&_10100011 * &i513), 8)) * &_11011101), 6)) * &_10011;
    let i560 = square_n(&(&(square_n(&(&square_n(&i530, 11) * &_1101111), 8)) * &_101001), 9);
    let i582 = &(square_n(&(&(square_n(&(&_1001101 * &i560), 11)) * &_10111001), 8)) * &_11000011;
    let i606 = square_n(&(&(square_n(&(&square_n(&i582, 9) * &_11100111), 10)) * &_11010011), 3);
    let i630 = &(square_n(&(&(square_n(&(&_101 * &i606), 13)) * &_10110011), 8)) * &_11011101;
    let i661 = square_n(&(&(square_n(&(&square_n(&i630, 8) * &_1000011), 12)) * &_10101111), 9);
    let i679 = &(square_n(&(&(square_n(&(&_10010001 * &i661), 9)) * &_10000001), 6)) * &_100101;
    let i708 = square_n(&(&(square_n(&(&square_n(&i679, 8) * &_100101), 10)) * &_1100111), 9);
    let i727 = &(square_n(&(&(square_n(&(&_1100001 * &i708), 9)) * &_10110101), 7)) * &_110011;
    let i755 = square_n(&(&(square_n(&(&square_n(&i727, 8) * &_101101), 10)) * &_1101101), 8);
    let i776 = &(square_n(&(&(square_n(&(&_1110111 * &i755), 9)) * &_1101011), 9)) * &_11001011;
    let i806 = square_n(&(&(square_n(&(&square_n(&i776, 4) * &_1001), 9)) * &_10011), 15);
    let i826 = &(square_n(&(&(square_n(&(&_11000011 * &i806), 10)) * &_10001001), 7)) * &_1011101;
    let i855 = square_n(&(&(square_n(&(&square_n(&i826, 9) * &_10011111), 8)) * &_1100111), 10);
    let i876 = &(square_n(&(&(square_n(&(&_11100101 * &i855), 9)) * &_10101111), 9)) * &_10001111;
    let i904 = square_n(&(&(square_n(&(&square_n(&i876, 7) * &_110001), 9)) * &_1110111), 10);
    let i925 = &(square_n(&(&(square_n(&(&_1100011 * &i904), 9)) * &_1010101), 9)) * &_11110111;
    let i955 = square_n(&(&(square_n(&(&square_n(&i925, 10) * &_10100011), 10)) * &_11110101), 8);
    let i978 = &(square_n(&(&(square_n(&(&_11101111 * &i955), 12)) * &_11100001), 8)) * &_10000001;
    let i1010 = square_n(&(&(square_n(&(&square_n(&i978, 5) * &_10101), 11)) * &_1111101), 14);
    let i1029 = &(square_n(&(&(square_n(&(&_11101001 * &i1010), 7)) * &_1110011), 9)) * &_11000101;
    let i1057 = square_n(&(&(square_n(&(&square_n(&i1029, 11) * &_1001011), 9)) * &_10101011), 6);
    let i1081 = &(square_n(&(&(square_n(&(&_111011 * &i1057), 11)) * &_111101), 10)) * &_10011101;
    let i1108 = square_n(&(&(square_n(&(&square_n(&i1081, 8) * &_10000011), 8)) * &_11010111), 9);
    let i1129 = &(square_n(&(&(square_n(&(&_11010001 * &i1108), 8)) * &_11011001), 10)) * &_10101001;
    let i1157 = square_n(&(&(square_n(&(&square_n(&i1129, 5) * &_10011), 12)) * &_11010011), 9);
    let i1176 = &(square_n(&(&(square_n(&(&_10101101 * &i1157), 8)) * &_11110101), 8)) * &_10000101;
    let i1201 = square_n(&(&(square_n(&(&square_n(&i1176, 7) * &_1111011), 8)) * &_1110001), 8);
    let i1222 = &(square_n(&(&(square_n(&(&_1111011 * &i1201), 9)) * &_11010001), 9)) * &_11111101;
    let i1250 = square_n(&(&(square_n(&(&square_n(&i1222, 7) * &_1101101), 8)) * &_1111011), 11);
    let i1270 = &(square_n(&(&(square_n(&(&_11101111 * &i1250), 8)) * &_11101101), 9)) * &_11111001;
    let i1299 = square_n(&(&(square_n(&(&square_n(&i1270, 10) * &_10000011), 8)) * &_11110111), 9);
    let i1322 = &(square_n(&(&(square_n(&(&_101101 * &i1299), 8)) * &_100101), 12)) * &_1111101;
    let i1354 = square_n(&(&(square_n(&(&square_n(&i1322, 10) * &_1001011), 11)) * &_11011001), 9);
    let i1376 = &(square_n(&(&(square_n(&(&_100101 * &i1354), 10)) * &_10001011), 9)) * &_11101111;
    let i1399 = square_n(&(&(square_n(&(&square_n(&i1376, 8) * &_1010111), 8)) * &_1010111), 5);
    let i1423 = &(square_n(&(&(square_n(&(&_111 * &i1399), 12)) * &_1001001), 9)) * &_10000111;
    let i1449 = square_n(&(&(square_n(&(&square_n(&i1423, 7) * &_1111111), 7)) * &_11011), 10);
    let i1470 = &(square_n(&(&(square_n(&(&_1111011 * &i1449), 10)) * &_10011101), 8)) * &_11011001;
    let i1499 = square_n(&(&(square_n(&(&square_n(&i1470, 6) * &_11001), 11)) * &_10111101), 10);
    let i1522 = &(square_n(&(&(square_n(&(&_1111101 * &i1499), 12)) * &_11010001), 8)) * &_11010011;
    let i1548 = square_n(&(&(square_n(&(&square_n(&i1522, 8) * &_11000011), 8)) * &_10010011), 8);
    let i1563 = &(square_n(&(&(square_n(&(&_10011001 * &i1548), 7)) * &_1110111), 5)) * &_1011;
    let i1599 = square_n(&(&(square_n(&(&square_n(&i1563, 18) * &_10001101), 9)) * &_10101101), 7);
    let i1618 = &(square_n(&(&(square_n(&(&_1100101 * &i1599), 8)) * &_1001001), 8)) * &_1111111;
    let i1651 = square_n(&(&(square_n(&(&square_n(&i1618, 10) * &_10010101), 10)) * &_100011), 11);
    let i1672 = &(square_n(&(&(square_n(&(&_11100111 * &i1651), 7)) * &_1101111), 11)) * &_1000001;
    let i1701 = square_n(&(&(square_n(&(&square_n(&i1672, 9) * &_10100011), 10)) * &_10010111), 8);
    let i1720 = &(square_n(&(&(square_n(&(&_11101001 * &i1701), 9)) * &_1111101), 7)) * &_110011;
    let i1752 = square_n(&(&(square_n(&(&square_n(&i1720, 8) * &_110101), 12)) * &_1010011), 10);
    let i1775 = &(square_n(&(&(square_n(&(&_1101001 * &i1752), 9)) * &_1000001), 11)) * &_11001111;
    let i1801 = square_n(&(&(square_n(&(&square_n(&i1775, 6) * &_110001), 10)) * &_11010011), 8);
    let i1825 = &(square_n(&(&(square_n(&(&_11001011 * &i1801), 13)) * &_11101001), 8)) * &_10010111;
    let i1852 = square_n(&(&(square_n(&(&square_n(&i1825, 7) * &_1111011), 10)) * &_11001001), 8);
    let i1874 = &(square_n(&(&(square_n(&(&_11111101 * &i1852), 7)) * &_1011011), 12)) * &_1010111;
    let i1906 = square_n(&(&(square_n(&(&square_n(&i1874, 11) * &_11101), 9)) * &_110001), 10);
    let i1925 = &(square_n(&(&(square_n(&(&_10111001 * &i1906), 8)) * &_10011001), 8)) * &_10110101;
    let i1954 = square_n(&(&(square_n(&(&square_n(&i1925, 11) * &_10100011), 7)) * &_1010101), 9);
    let i1971 = &(square_n(&(&(square_n(&(&_11001011 * &i1954), 9)) * &_10110111), 5)) * &_10001;
    let i2003 = square_n(&(&(square_n(&(&square_n(&i1971, 11) * &_1101011), 9)) * &_100011), 10);
    let i2023 = &(square_n(&(&(square_n(&(&_11110111 * &i2003), 10)) * &_1011101), 7)) * &_11011;
    let i2052 = square_n(&(&(square_n(&(&square_n(&i2023, 10) * &_1001001), 6)) * &_11001), 11);
    let i2076 = &(square_n(&(&(square_n(&(&_10011011 * &i2052), 8)) * &_1100111), 13)) * &_11001001;
    let i2102 = square_n(&(&(square_n(&(&square_n(&i2076, 8) * &_11110111), 8)) * &_11100101), 8);
    let i2127 = &(square_n(&(&(square_n(&(&_10111011 * &i2102), 7)) * &_111001), 15)) * &_11101011;
    let i2153 = square_n(&(&(square_n(&(&square_n(&i2127, 9) * &_11010011), 6)) * &_10001), 9);
    let i2178 = &(square_n(&(&(square_n(&(&_110111 * &i2153), 10)) * &_11101001), 12)) * &_11100011;
    let i2205 = square_n(&(&(square_n(&(&square_n(&i2178, 7) * &_1010011), 9)) * &_10101111), 9);
    let i2237 = &(square_n(&(&(square_n(&(&_10001 * &i2205), 20)) * &_11111111), 9)) * &_11111001;
    let i2267 = square_n(&(&(square_n(&(&square_n(&i2237, 8) * &_10011111), 8)) * &_101001), 12);
    let i2287 = &(square_n(&(&(square_n(&(&_10110011 * &i2267), 7)) * &_1011101), 10)) * &_10111111;
    let i2312 = square_n(&(&(square_n(&(&square_n(&i2287, 8) * &_11111101), 8)) * &_11011001), 7);
    let i2333 = &(square_n(&(&(square_n(&(&_1011111 * &i2312), 8)) * &_100011), 10)) * &_10011101;
    let i2357 = square_n(&(&(square_n(&(&square_n(&i2333, 8) * &_11101001), 10)) * &_10101001), 4);
    let i2381 = &(square_n(&(&(square_n(&(&_111 * &i2357), 14)) * &_10010101), 7)) * &_101011;
    let i2407 = square_n(&(&(square_n(&(&square_n(&i2381, 9) * &_1111111), 5)) * &_1011), 10);
    let i2428 = &(square_n(&(&(square_n(&(&_101101 * &i2407), 11)) * &_1000101), 7)) * &_11101;
    let i2458 = square_n(&(&(square_n(&(&square_n(&i2428, 11) * &_10101111), 4)) * &_11), 13);
    let i2482 = &(square_n(&(&(square_n(&(&_110111 * &i2458), 10)) * &_10110011), 11)) * &_1100111;
    let i2514 = square_n(&(&(square_n(&(&square_n(&i2482, 10) * &_1101001), 9)) * &_101011), 11);
    let i2536 = &(square_n(&(&(square_n(&(&_1101001 * &i2514), 8)) * &_1100011), 11)) * &_10011001;
    let i2564 = square_n(&(&(square_n(&(&square_n(&i2536, 4) * &_1101), 15)) * &_1111011), 7);
    let i2586 = &(square_n(&(&(square_n(&(&_11011 * &i2564), 8)) * &_10101), 11)) * &_10111101;
    let i2612 = square_n(&(&(square_n(&(&square_n(&i2586, 6) * &_110011), 7)) * &_11111), 11);
    let i2633 = &(square_n(&(&(square_n(&(&_11100101 * &i2612), 8)) * &_111001), 10)) * &_10101111;
    let i2661 = square_n(&(&(square_n(&(&square_n(&i2633, 8) * &_10000111), 7)) * &_110011), 11);
    let i2685 = &(square_n(&(&(square_n(&(&_11100101 * &i2661), 10)) * &_11010111), 11)) * &_10000001;
    let i2715 = square_n(&(&(square_n(&(&square_n(&i2685, 6) * &_110001), 12)) * &_11100001), 10);
    let i2737 = &(square_n(&(&(square_n(&(&_1011111 * &i2715), 9)) * &_11001101), 10)) * &_1111011;
    let i2767 = square_n(&(&(square_n(&(&square_n(&i2737, 8) * &_1100011), 8)) * &_110101), 12);
    let i2789 = &(square_n(&(&(square_n(&(&_10101111 * &i2767), 8)) * &_10010011), 11)) * &_11011001;
    let i2815 = square_n(&(&(square_n(&(&square_n(&i2789, 9) * &_1100111), 10)) * &_10101101), 5);
    let i2839 = &(square_n(&(&(square_n(&(&_11011 * &i2815), 11)) * &_101101), 10)) * &_1001111;
    let i2866 = square_n(&(&(square_n(&(&square_n(&i2839, 9) * &_11110101), 7)) * &_1111001), 9);
    let i2888 = &(square_n(&(&(square_n(&(&_10110001 * &i2866), 3)) * &_101), 16)) * &_10011111;
    let i2912 = square_n(&(&(square_n(&(&square_n(&i2888, 7) * &_1011101), 6)) * &_11001), 9);
    let i2934 = &(square_n(&(&(square_n(&(&_100011 * &i2912), 10)) * &_10111101), 9)) * &_1001011;
    let i2960 = square_n(&(&(square_n(&(&square_n(&i2934, 6) * &_10011), 12)) * &_11111001), 6);
    let i2982 = &(square_n(&(&(square_n(&(&_101001 * &i2960), 13)) * &_10001101), 6)) * &_111011;
    let i3017 = square_n(&(&(square_n(&(&square_n(&i2982, 11) * &_10001001), 15)) * &_11111001), 7);
    let i3042 = &(square_n(&(&(square_n(&(&_111011 * &i3017), 9)) * &_10101), 13)) * &_10111011;
    let i3071 = square_n(&(&(square_n(&(&square_n(&i3042, 9) * &_11001011), 4)) * &_1111), 14);
    let i3096 = &(square_n(&(&(square_n(&(&_10001001 * &i3071), 13)) * &_10011011), 9)) * &_100111;
    let i3123 = square_n(&(&(square_n(&(&square_n(&i3096, 10) * &_11110101), 7)) * &_1110111), 8);
    let i3146 = &(square_n(&(&(square_n(&(&_1100001 * &i3123), 10)) * &_11111111), 10)) * &_1011001;
    let i3174 = square_n(&(&(square_n(&(&square_n(&i3146, 9) * &_11001101), 7)) * &_1000011), 10);
    let i3193 = &(square_n(&(&(square_n(&(&_11000111 * &i3174), 8)) * &_10110001), 8)) * &_11001011;
    let i3221 = square_n(&(&(square_n(&(&square_n(&i3193, 5) * &_10001), 8)) * &_11001), 13);
    let i3241 = &(square_n(&(&(square_n(&(&_1101101 * &i3221), 9)) * &_10000011), 8)) * &_11000011;
    let i3269 = square_n(&(&(square_n(&(&square_n(&i3241, 9) * &_11101001), 9)) * &_10011111), 8);
    let i3288 = &(square_n(&(&(square_n(&(&_10110011 * &i3269), 3)) * &_11), 13)) * &_1000001;
    let i3317 = square_n(&(&(square_n(&(&square_n(&i3288, 10) * &_1010011), 8)) * &_1010111), 9);
    let i3340 = &(square_n(&(&(square_n(&(&_1000101 * &i3317), 11)) * &_11001001), 9)) * &_1000101;
    let i3366 = square_n(&(&(square_n(&(&square_n(&i3340, 8) * &_1010001), 3)) * &_11), 13);
    let i3386 = &(square_n(&(&(square_n(&(&_1001011 * &i3366), 9)) * &_1000101), 8)) * &_1110011;
    let i3414 = square_n(&(&(square_n(&(&square_n(&i3386, 10) * &_10110101), 9)) * &_10101101), 7);
    let i3433 = &(square_n(&(&(square_n(&(&_1010001 * &i3414), 12)) * &_10001111), 4)) * &_1101;
    let i3463 = square_n(&(&(square_n(&(&square_n(&i3433, 12) * &_10000111), 7)) * &_100111), 9);
    let i3485 = &(square_n(&(&(square_n(&(&_1110101 * &i3463), 9)) * &_1000001), 10)) * &_11111101;
    let i3514 = square_n(&(&(square_n(&(&square_n(&i3485, 9) * &_11000001), 8)) * &_1011011), 10);
    let i3534 = &(square_n(&(&(square_n(&(&_1101001 * &i3514), 9)) * &_10000001), 8)) * &_11000111;
    let i3564 = square_n(&(&(square_n(&(&square_n(&i3534, 8) * &_10000011), 8)) * &_10110011), 12);
    let i3580 = &(square_n(&(&(square_n(&(&_10011111 * &i3564), 8)) * &_1000101), 5)) * &_1011;
    let i3611 = square_n(&(&(square_n(&(&square_n(&i3580, 11) * &_1111001), 10)) * &_11000011), 8);
    let i3633 = &(square_n(&(&(square_n(&(&_10011111 * &i3611), 11)) * &_10001), 8)) * &_101;
    let i3663 = square_n(&(&(square_n(&(&square_n(&i3633, 13) * &_1100001), 7)) * &_100001), 8);
    let i3684 = &(square_n(&(&(square_n(&(&_100011 * &i3663), 10)) * &_10011111), 8)) * &_1101001;
    let i3712 = square_n(&(&(square_n(&(&square_n(&i3684, 7) * &_100101), 10)) * &_11110111), 9);
    let i3733 = &(square_n(&(&(square_n(&(&_1110001 * &i3712), 9)) * &_101001), 9)) * &_11001;
    let i3766 = square_n(&(&(square_n(&(&square_n(&i3733, 14) * &_11011001), 10)) * &_10101101), 7);
    let i3789 = &(square_n(&(&(square_n(&(&_100111 * &i3766), 9)) * &_11101), 11)) * &_11101111;
    let i3814 = square_n(&(&(square_n(&(&square_n(&i3789, 9) * &_11100001), 8)) * &_11010001), 6);
    let i3838 = &(square_n(&(&(square_n(&(&_100101 * &i3814), 11)) * &_11011001), 10)) * &_11101001;
    let i3864 = square_n(&(&(square_n(&(&square_n(&i3838, 8) * &_11111111), 8)) * &_11110111), 8);
    let i3884 = &(square_n(&(&(square_n(&(&_10101111 * &i3864), 5)) * &_10101), 12)) * &_10100001;
    let i3910 = square_n(&(&(square_n(&(&square_n(&i3884, 8) * &_11010101), 9)) * &_10000001), 7);
    let i3932 = &(square_n(&(&(square_n(&(&_1010001 * &i3910), 9)) * &_1101101), 10)) * &_1000011;
    let i3958 = square_n(&(&(square_n(&(&square_n(&i3932, 8) * &_1010011), 8)) * &_1001101), 8);
    let i3980 = &(square_n(&(&(square_n(&(&_1100011 * &i3958), 11)) * &_11111101), 8)) * &_11100001;
    let i4013 = square_n(&(&(square_n(&(&square_n(&i3980, 12) * &_11001111), 5)) * &_1101), 14);
    let i4033 = &(square_n(&(&(square_n(&(&_10100101 * &i4013), 7)) * &_1001111), 10)) * &_10110111;
    let i4065 = square_n(&(&(square_n(&(&square_n(&i4033, 12) * &_11100111), 11)) * &_11100001), 7);
    let i4087 = &(square_n(&(&(square_n(&(&_1010101 * &i4065), 8)) * &_11011), 11)) * &_11101011;
    let i4116 = square_n(&(&(square_n(&(&square_n(&i4087, 8) * &_10110101), 8)) * &_100111), 11);
    let i4136 = &(square_n(&(&(square_n(&(&_11001011 * &i4116), 9)) * &_10110001), 8)) * &_10001011;
    let i4162 = square_n(&(&(square_n(&(&square_n(&i4136, 4) * &_1111), 7)) * &_101), 13);
    let i4181 = &(square_n(&(&(square_n(&(&_10111001 * &i4162), 8)) * &_10101101), 8)) * &_10100111;
    let i4208 = square_n(&(&(square_n(&(&square_n(&i4181, 8) * &_10010101), 9)) * &_11110101), 8);
    let i4227 = &(square_n(&(&(square_n(&(&_11001001 * &i4208), 8)) * &_10101101), 8)) * &_1101001;
    let i4263 = square_n(&(&(square_n(&(&square_n(&i4227, 17) * &_1100001), 8)) * &_1001011), 9);
    let i4284 = &(square_n(&(&(square_n(&(&_10001 * &i4263), 11)) * &_11001001), 7)) * &_111111;
    let i4316 = square_n(&(&(square_n(&(&square_n(&i4284, 14) * &_11111001), 8)) * &_11101011), 8);
    let i4344 = &(square_n(&(&(square_n(&(&_1101011 * &i4316), 12)) * &_10001111), 13)) * &_1000011;
    let i4375 = square_n(&(&(square_n(&(&square_n(&i4344, 8) * &_1011001), 10)) * &_1101011), 11);
    let i4389 = &(square_n(&(&(square_n(&(&_11110111 * &i4375), 7)) * &_1111001), 4)) * &_101;
    let i4421 = square_n(&(&(square_n(&(&square_n(&i4389, 12) * &_100001), 7)) * &_10101), 11);
    let i4440 = &(square_n(&(&(square_n(&(&_10001001 * &i4421), 8)) * &_10111011), 8)) * &_1000101;
    let i4475 = square_n(&(&(square_n(&(&square_n(&i4440, 11) * &_110101), 12)) * &_11001), 10);
    let i4493 = &(square_n(&(&(square_n(&(&_1011111 * &i4475), 8)) * &_1111101), 7)) * &_100001;
    let i4523 = square_n(&(&(square_n(&(&square_n(&i4493, 11) * &_11101011), 6)) * &_111111), 11);
    let i4545 = &(square_n(&(&(square_n(&(&_10010111 * &i4523), 10)) * &_1010001), 9)) * &_11110101;
    let i4565 = square_n(&(&(square_n(&(&square_n(&i4545, 6) * &_110011), 10)) * &_10101001), 2);
    let i4590 = &(square_n(&(&(square_n(&(base * &i4565), 16)) * &_10100011), 6)) * &_111111;
    let i4620 = square_n(&(&(square_n(&(&square_n(&i4590, 7) * &_10001), 10)) * &_1100011), 11);
    let i4638 = &(square_n(&(&(square_n(&(&_1101111 * &i4620), 9)) * &_10000101), 6)) * &_100111;
    let i4665 = square_n(&(&(square_n(&(&square_n(&i4638, 13) * &_111111), 10)) * &_11011101), 2);
    let i4687 = &(square_n(&(&(square_n(&(base * &i4665), 14)) * &_1000101), 5)) * &_1111;
    let i4719 = square_n(&(&(square_n(&(&square_n(&i4687, 14) * &_10000111), 8)) * &_11110101), 8);
    let i4741 = &(square_n(&(&(square_n(&(&_11011001 * &i4719), 8)) * &_11011111), 11)) * &_11000011;
    let i4767 = square_n(&(&(square_n(&(&square_n(&i4741, 7) * &_1111101), 9)) * &_10001011), 8);
    let i4787 = &(square_n(&(&(square_n(&(&_1010011 * &i4767), 9)) * &_1000001), 8)) * &_110011;
    let i4814 = square_n(&(&(square_n(&(&square_n(&i4787, 11) * &_1111001), 9)) * &_11100001), 5);
    let i4836 = &(square_n(&(&(square_n(&(&_11101 * &i4814), 12)) * &_10000101), 7)) * &_1010111;
    let i4867 = square_n(&(&(square_n(&(&square_n(&i4836, 10) * &_11010101), 11)) * &_11011001), 8);
    let i4886 = &(square_n(&(&(square_n(&(&_11011111 * &i4867), 4)) * &_111), 12)) * &_10001;
    square_n(&(&(square_n(&(&square_n(&i4886, 7) * &_1001), 8)) * &_1111), 4)
}

/// Optimized exponentiation using addition chain (generated by addchain)
fn pow_e(base: &FieldElement<Degree12ExtensionField>) -> FieldElement<Degree12ExtensionField> {
    let _10 = base.square();
    let _11 = base * &_10;
    let _101 = &_10 * &_11;
    let _111 = &_10 * &_101;
    let _1001 = &_10 * &_111;
    let _1011 = &_10 * &_1001;
    let _1101 = &_10 * &_1011;
    let _1111 = &_10 * &_1101;
    let _10001 = &_10 * &_1111;
    let _10011 = &_10 * &_10001;
    let _10101 = &_10 * &_10011;
    let _10111 = &_10 * &_10101;
    let _11001 = &_10 * &_10111;
    let _11011 = &_10 * &_11001;
    let _11101 = &_10 * &_11011;
    let _11111 = &_10 * &_11101;
    let _100001 = &_10 * &_11111;
    let _100011 = &_10 * &_100001;
    let _100101 = &_10 * &_100011;
    let _100111 = &_10 * &_100101;
    let _101001 = &_10 * &_100111;
    let _101011 = &_10 * &_101001;
    let _101101 = &_10 * &_101011;
    let _101111 = &_10 * &_101101;
    let _110001 = &_10 * &_101111;
    let _110011 = &_10 * &_110001;
    let _110101 = &_10 * &_110011;
    let _110111 = &_10 * &_110101;
    let _111001 = &_10 * &_110111;
    let _111011 = &_10 * &_111001;
    let _111101 = &_10 * &_111011;
    let _111111 = &_10 * &_111101;
    let _1000001 = &_10 * &_111111;
    let _1000011 = &_10 * &_1000001;
    let _1000101 = &_10 * &_1000011;
    let _1000111 = &_10 * &_1000101;
    let _1001001 = &_10 * &_1000111;
    let _1001011 = &_10 * &_1001001;
    let _1001101 = &_10 * &_1001011;
    let _1001111 = &_10 * &_1001101;
    let _1010001 = &_10 * &_1001111;
    let _1010011 = &_10 * &_1010001;
    let _1010101 = &_10 * &_1010011;
    let _1010111 = &_10 * &_1010101;
    let _1011001 = &_10 * &_1010111;
    let _1011011 = &_10 * &_1011001;
    let _1011101 = &_10 * &_1011011;
    let _1011111 = &_10 * &_1011101;
    let _1100001 = &_10 * &_1011111;
    let _1100011 = &_10 * &_1100001;
    let _1100101 = &_10 * &_1100011;
    let _1100111 = &_10 * &_1100101;
    let _1101001 = &_10 * &_1100111;
    let _1101011 = &_10 * &_1101001;
    let _1101101 = &_10 * &_1101011;
    let _1101111 = &_10 * &_1101101;
    let _1110001 = &_10 * &_1101111;
    let _1110011 = &_10 * &_1110001;
    let _1110101 = &_10 * &_1110011;
    let _1110111 = &_10 * &_1110101;
    let _1111001 = &_10 * &_1110111;
    let _1111011 = &_10 * &_1111001;
    let _1111101 = &_10 * &_1111011;
    let _1111111 = &_10 * &_1111101;
    let _11111110 = _1111111.square();
    let _11111111 = base * &_11111110;
    let i69 = &_1110001 * &_1001;
    let i72 = i69.square();
    let i95 = square_n(&(&(square_n(&(&square_n(&i72, 2) * &_101001), 8)) * &_100011), 9);
    let i118 = &(square_n(&(&(square_n(&(&_1100101 * &i95), 7)) * &_1100101), 13)) * &_1101011;
    let i140 = square_n(&(&(square_n(&(&square_n(&i118, 7) * &_1010111), 4)) * &_101), 9);
    let i163 = &(square_n(&(&(square_n(&(&_101 * &i140), 13)) * &_1110111), 7)) * &_10001;
    let i188 = square_n(&(&(square_n(&(&square_n(&i163, 9) * &_100001), 7)) * &_100001), 7);
    let i214 = &(square_n(&(&(square_n(&(&_101011 * &i188), 7)) * &_11), 16)) * &_111001;
    let i242 = square_n(&(&(square_n(&(&square_n(&i214, 8) * &_101001), 8)) * &_111011), 10);
    let i258 = &(square_n(&(&(square_n(&(&_1010011 * &i242), 7)) * &_1001001), 6)) * &_101001;
    let i286 = square_n(&(&(square_n(&(&square_n(&i258, 9) * &_1010111), 7)) * &_1101), 10);
    let i306 = &(square_n(&(&(square_n(&(&_1100011 * &i286), 7)) * &_101011), 10)) * &_1110111;
    let i331 = square_n(&(&(square_n(&(&square_n(&i306, 7) * &_1110001), 7)) * &_11101), 9);
    let i349 = &(square_n(&(&(square_n(&(&_1000111 * &i331), 8)) * &_1011101), 7)) * &_1101;
    let i380 = square_n(&(&(square_n(&(&square_n(&i349, 9) * &_110101), 10)) * &_1111001), 10);
    let i400 = &(square_n(&(&(square_n(&(&_110101 * &i380), 10)) * &_1101111), 7)) * &_1101101;
    let i428 = square_n(&(&(square_n(&(&square_n(&i400, 8) * &_1111), 11)) * &_1011011), 7);
    let i449 = &(square_n(&(&(square_n(&(&_1110111 * &i428), 8)) * &_101011), 10)) * &_1000011;
    let i473 = square_n(&(&(square_n(&(&square_n(&i449, 7) * &_1010111), 6)) * &_100101), 9);
    let i489 = &(square_n(&(&(square_n(&(&_1010001 * &i473), 5)) * &_1011), 8)) * &_1001;
    let i518 = square_n(&(&(square_n(&(&square_n(&i489, 12) * &_1001011), 8)) * &_1010001), 7);
    let i537 = &(square_n(&(&(square_n(&(&_1101111 * &i518), 8)) * &_1010001), 8)) * &_1110111;
    let i562 = square_n(&(&(square_n(&(&square_n(&i537, 8) * &_1001001), 5)) * &_11101), 10);
    let i578 = &(square_n(&(&(square_n(&(&_101111 * &i562), 8)) * &_1001101), 5)) * &_10001;
    let i609 = square_n(&(&(square_n(&(&square_n(&i578, 9) * &_1011101), 13)) * &_110011), 7);
    let i627 = &(square_n(&(&(square_n(&(&_110001 * &i609), 6)) * &_11011), 9)) * &_1100111;
    let i651 = square_n(&(&(square_n(&(&square_n(&i627, 7) * &_1101), 10)) * &_1000111), 5);
    let i672 = &(square_n(&(&(square_n(&(&_10001 * &i651), 10)) * &_1000001), 8)) * &_1100011;
    let i699 = square_n(&(&(square_n(&(&square_n(&i672, 10) * &_1111011), 8)) * &_1001101), 7);
    let i715 = &(square_n(&(&(square_n(&(&_1110101 * &i699), 9)) * &_1000011), 4)) * &_1101;
    let i742 = square_n(&(&(square_n(&(&square_n(&i715, 14) * &_1010101), 6)) * &_111101), 5);
    let i764 = &(square_n(&(&(square_n(&(&_111 * &i742), 10)) * &_110111), 9)) * &_1101001;
    let i789 = square_n(&(&(square_n(&(&square_n(&i764, 7) * &_1100101), 3)) * &_11), 13);
    let i807 = &(square_n(&(&(square_n(&(&_1010011 * &i789), 4)) * &_11), 11)) * &_11001;
    let i833 = square_n(&(&(square_n(&(&square_n(&i807, 9) * &_100111), 8)) * &_1111011), 7);
    let i855 = &(square_n(&(&(square_n(&(&_1100111 * &i833), 2)) * &_11), 17)) * &_1011;
    let i882 = square_n(&(&(square_n(&(&square_n(&i855, 7) * &_101111), 10)) * &_1101011), 8);
    let i902 = &(square_n(&(&(square_n(&(&_1001111 * &i882), 7)) * &_111001), 10)) * &_11111111;
    let i928 = square_n(&(&(square_n(&(&square_n(&i902, 8) * &_100111), 8)) * &_110011), 8);
    let i946 = &(square_n(&(&(square_n(&(&_10111 * &i928), 6)) * &_1101), 9)) * &_11011;
    let i971 = square_n(&(&(square_n(&(&square_n(&i946, 9) * &_110101), 6)) * &_11101), 8);
    let i992 = &(square_n(&(&(square_n(&(&_100011 * &i971), 10)) * &_110001), 8)) * &_10101;
    let i1018 = square_n(&(&(square_n(&(&square_n(&i992, 10) * &_1010001), 7)) * &_111111), 7);
    let i1039 = &(square_n(&(&(square_n(&(&_101101 * &i1018), 9)) * &_11011), 9)) * &_101111;
    let i1063 = square_n(&(&(square_n(&(&square_n(&i1039, 8) * &_1001001), 6)) * &_111001), 8);
    let i1081 = &(square_n(&(&(square_n(&(&_110111 * &i1063), 8)) * &_1010101), 7)) * &_1111001;
    let i1101 = square_n(&(&(square_n(&(&square_n(&i1081, 6) * &_111011), 8)) * &_1100011), 4);
    let i1123 = &(square_n(&(&(square_n(&(&_1101 * &i1101), 13)) * &_1111011), 6)) * &_110001;
    let i1147 = square_n(&(&(square_n(&(&square_n(&i1123, 8) * &_1101101), 7)) * &_1000001), 7);
    let i1163 = &(square_n(&(&(square_n(&(&_1100001 * &i1147), 6)) * &_111011), 7)) * &_100111;
    let i1193 = square_n(&(&(square_n(&(&square_n(&i1163, 8) * &_10011), 11)) * &_1111111), 9);
    let i1210 = &(square_n(&(&(square_n(&(&_1001101 * &i1193), 6)) * &_101011), 8)) * &_1011011;
    let i1233 = square_n(&(&(square_n(&(&square_n(&i1210, 7) * &_1110111), 7)) * &_1001011), 7);
    let i1254 = &(square_n(&(&(square_n(&(&_110101 * &i1233), 8)) * &_1011111), 10)) * &_1101111;
    let i1283 = square_n(&(&(square_n(&(&square_n(&i1254, 7) * &_101101), 5)) * &_111), 15);
    let i1297 = &(square_n(&(&(square_n(&(&_1000001 * &i1283), 8)) * &_1110001), 3)) * base;
    let i1331 = square_n(&(&(square_n(&(&square_n(&i1297, 15) * &_110001), 8)) * &_1100001), 9);
    let i1351 = &(square_n(&(&(square_n(&(&_1111011 * &i1331), 7)) * &_10011), 10)) * &_1011101;
    let i1372 = square_n(&(&(square_n(&(&square_n(&i1351, 8) * &_1110111), 5)) * &_10111), 6);
    let i1395 = &(square_n(&(&(square_n(&(&_1011 * &i1372), 6)) * &_11), 14)) * &_1011;
    let i1415 = square_n(&(&(square_n(&(&i1395.square() * base), 8)) * &_1011001), 9);
    let i1437 = &(square_n(&(&(square_n(&(&_1110101 * &i1415), 9)) * &_1111011), 10)) * &_1101011;
    let i1459 = square_n(&(&(square_n(&(&square_n(&i1437, 8) * &_100101), 3)) * base), 9);
    let i1480 = &(square_n(&(&(square_n(&(&_11111111 * &i1459), 11)) * &_101011), 7)) * &_110011;
    let i1503 = square_n(&(&(square_n(&(&square_n(&i1480, 7) * &_111111), 7)) * &_101011), 7);
    let i1529 = &(square_n(&(&(square_n(&(&_100101 * &i1503), 13)) * &_1000001), 10)) * &_1001101;
    let i1553 = square_n(&(&(square_n(&(&square_n(&i1529, 8) * &_1100101), 8)) * &_1010101), 6);
    let i1573 = &(square_n(&(&(square_n(&(&_100101 * &i1553), 9)) * &_1010001), 8)) * &_1011101;
    let i1599 = square_n(&(&(square_n(&(&square_n(&i1573, 6) * &_111011), 8)) * &_1011111), 10);
    let i1617 = &(square_n(&(&(square_n(&(&_1011101 * &i1599), 7)) * &_1001111), 8)) * &_1111001;
    let i1642 = square_n(&(&(square_n(&(&square_n(&i1617, 8) * &_1100001), 7)) * &_1010111), 8);
    let i1662 = &(square_n(&(&(square_n(&(&_1001001 * &i1642), 7)) * &_1000111), 10)) * &_1001001;
    let i1695 = square_n(&(&(square_n(&(&square_n(&i1662, 12) * &_1011101), 9)) * &_1110101), 10);
    let i1713 = &(square_n(&(&(square_n(&(&_111101 * &i1695), 8)) * &_111011), 7)) * &_111101;
    let i1735 = square_n(&(&(square_n(&(&square_n(&i1713, 6) * &_11011), 9)) * &_1101011), 5);
    let i1758 = &(square_n(&(&(square_n(&(&_11011 * &i1735), 10)) * &_1001011), 10)) * &_1001001;
    let i1782 = square_n(&(&(square_n(&(&square_n(&i1758, 4) * &_1111), 11)) * &_1000011), 7);
    let i1803 = &(square_n(&(&(square_n(&(&_10101 * &i1782), 9)) * &_111001), 9)) * &_1000011;
    let i1829 = square_n(&(&(square_n(&(&square_n(&i1803, 5) * &_10011), 10)) * &_1011001), 9);
    let i1846 = &(square_n(&(&(square_n(&(&_1110011 * &i1829), 8)) * &_1100001), 6)) * &_110011;
    let i1875 = square_n(&(&(square_n(&(&square_n(&i1846, 9) * &_110001), 7)) * &_101101), 11);
    let i1898 = &(square_n(&(&(square_n(&(&_1100111 * &i1875), 8)) * &_1011011), 12)) * &_1101101;
    let i1927 = square_n(&(&(square_n(&(&square_n(&i1898, 11) * &_1000011), 7)) * &_1110111), 9);
    let i1945 = &(square_n(&(&(square_n(&(&_1101001 * &i1927), 4)) * &_1011), 11)) * &_1100011;
    let i1967 = square_n(&(&(square_n(&(&square_n(&i1945, 4) * &_1001), 11)) * &_1001111), 5);
    let i1986 = &(square_n(&(&(square_n(&(&_10111 * &i1967), 6)) * &_1001), 10)) * &_1001011;
    let i2009 = square_n(&(&(square_n(&(&square_n(&i1986, 8) * &_1011011), 4)) * &_1001), 9);
    let i2029 = &(square_n(&(&(square_n(&(&_100101 * &i2009), 10)) * &_11111111), 7)) * &_101011;
    let i2057 = square_n(&(&(square_n(&(&square_n(&i2029, 10) * &_1111), 10)) * &_1011011), 6);
    let i2075 = &(square_n(&(&(square_n(&(&_111001 * &i2057), 9)) * &_1101001), 6)) * &_101111;
    let i2100 = square_n(&(&(square_n(&(&square_n(&i2075, 7) * &_10011), 9)) * &_1110011), 7);
    let i2125 = &(square_n(&(&(square_n(&(&_1110011 * &i2100), 10)) * &_101101), 12)) * &_1110001;
    let i2153 = square_n(&(&(square_n(&(&square_n(&i2125, 6) * &_11), 12)) * &_1101101), 8);
    let i2171 = &(square_n(&(&(square_n(&(&_110011 * &i2153), 6)) * &_10111), 9)) * &_1011011;
    let i2199 = square_n(&(&(square_n(&(&square_n(&i2171, 10) * &_1000111), 7)) * &_1111011), 9);
    let i2220 = &(square_n(&(&(square_n(&(&_1111111 * &i2199), 11)) * &_1110001), 7)) * &_1101111;
    let i2244 = square_n(&(&(square_n(&(&square_n(&i2220, 9) * &_1001101), 7)) * &_1000111), 6);
    let i2264 = &(square_n(&(&(square_n(&(&_1011 * &i2244), 11)) * &_1010001), 6)) * &_11001;
    let i2289 = square_n(&(&(square_n(&(&square_n(&i2264, 10) * &_1101001), 8)) * &_1010111), 5);
    let i2309 = &(square_n(&(&(square_n(&(&_10111 * &i2289), 6)) * &_101), 11)) * &_1010011;
    let i2333 = square_n(&(&(square_n(&(&square_n(&i2309, 6) * &_110101), 5)) * &_1101), 11);
    let i2354 = &(square_n(&(&(square_n(&(&_110101 * &i2333), 8)) * &_11001), 10)) * &_1111011;
    let i2378 = square_n(&(&(square_n(&(&square_n(&i2354, 8) * &_1110111), 6)) * &_1011), 8);
    let i2398 = &(square_n(&(&(square_n(&(&_11001 * &i2378), 9)) * &_11111111), 8)) * &_1011111;
    let i2427 = square_n(&(&(square_n(&(&square_n(&i2398, 6) * &_1111), 13)) * &_1100001), 8);
    let i2444 = &(square_n(&(&(square_n(&(&_1100001 * &i2427), 5)) * &_11001), 9)) * &_1101001;
    let i2470 = square_n(&(&(square_n(&(&square_n(&i2444, 9) * &_1010111), 3)) * &_111), 12);
    let i2487 = &(square_n(&(&(square_n(&(&_1000011 * &i2470), 6)) * &_100011), 8)) * &_1011111;
    let i2519 = square_n(&(&(square_n(&(&square_n(&i2487, 10) * &_111011), 10)) * &_101011), 10);
    let i2538 = &(square_n(&(&(square_n(&(&_11111111 * &i2519), 9)) * &_111101), 7)) * &_11111;
    let i2566 = square_n(&(&(square_n(&(&square_n(&i2538, 7) * &_11001), 9)) * &_10101), 10);
    let i2586 = &(square_n(&(&(square_n(&(&_1111001 * &i2566), 9)) * &_1010101), 8)) * &_10101;
    let i2609 = square_n(&(&(square_n(&(&square_n(&i2586, 9) * &_1110001), 5)) * &_1001), 7);
    let i2631 = &(square_n(&(&(square_n(&(&_1011 * &i2609), 12)) * &_1011101), 7)) * &_1000011;
    let i2658 = square_n(&(&(square_n(&(&square_n(&i2631, 9) * &_1011001), 9)) * &_1100101), 7);
    let i2679 = &(square_n(&(&(square_n(&(&_1010111 * &i2658), 10)) * &_11111), 8)) * &_11111;
    let i2703 = square_n(&(&(square_n(&(&square_n(&i2679, 7) * &_10111), 10)) * &_1110011), 5);
    let i2725 = &(square_n(&(&(square_n(&(&_10111 * &i2703), 9)) * &_100101), 10)) * &_1011101;
    let i2749 = square_n(&(&(square_n(&(&square_n(&i2725, 4) * &_1111), 11)) * &_1010011), 7);
    let i2771 = &(square_n(&(&(square_n(&(&_1000001 * &i2749), 9)) * &_1111001), 10)) * &_1100101;
    let i2799 = square_n(&(&(square_n(&(&i2771.square() * base), 17)) * &_1000001), 8);
    let i2815 = &(square_n(&(&(square_n(&(&_1011101 * &i2799), 7)) * &_1010101), 6)) * &_111011;
    let i2842 = square_n(&(&(square_n(&(&square_n(&i2815, 8) * &_1100011), 5)) * &_11011), 12);
    let i2861 = &(square_n(&(&(square_n(&(&_1101011 * &i2842), 8)) * &_1101111), 8)) * &_1000111;
    let i2882 = square_n(&(&(square_n(&(&square_n(&i2861, 2) * base), 10)) * &_1001), 7);
    let i2900 = &(square_n(&(&(square_n(&(&_101101 * &i2882), 3)) * &_11), 12)) * &_1110111;
    let i2929 = square_n(&(&(square_n(&(&square_n(&i2900, 6) * base), 12)) * &_100111), 9);
    let i2949 = &(square_n(&(&(square_n(&(&_1010001 * &i2929), 6)) * &_110011), 11)) * &_1100011;
    let i2971 = square_n(&(&(square_n(&(&square_n(&i2949, 6) * &_101111), 11)) * &_1110011), 3);
    let i2990 = &(square_n(&(&(square_n(&(&_111 * &i2971), 11)) * &_1010111), 5)) * &_11101;
    let i3017 = square_n(&(&(square_n(&(&square_n(&i2990, 9) * &_1110011), 5)) * &_1101), 11);
    let i3037 = &(square_n(&(&(square_n(&(&_1001 * &i3017), 6)) * &_10011), 11)) * &_1101011;
    let i3061 = square_n(&(&(square_n(&(&square_n(&i3037, 7) * &_1110111), 6)) * &_10011), 9);
    let i3081 = &(square_n(&(&(square_n(&(&_1101111 * &i3061), 10)) * &_1100011), 7)) * &_1000111;
    let i3099 = (&(square_n(&(&square_n(&i3081, 3) * &_111), 12)) * &_1111001).square();
    let i3125 = &(square_n(&(&(square_n(&(base * &i3099), 15)) * &_111101), 8)) * &_1101111;
    let i3152 = square_n(&(&(square_n(&(&square_n(&i3125, 5) * &_1101), 10)) * &_1011001), 10);
    let i3172 = &(square_n(&(&(square_n(&(&_1101011 * &i3152), 6)) * &_110111), 11)) * &_10011;
    let i3200 = square_n(&(&(square_n(&(&square_n(&i3172, 12) * &_1111011), 8)) * &_1100001), 6);
    let i3220 = &(square_n(&(&(square_n(&(&_10101 * &i3200), 9)) * &_1011011), 8)) * &_1010111;
    let i3243 = square_n(&(&(square_n(&(&square_n(&i3220, 5) * &_11101), 8)) * &_100001), 8);
    let i3262 = &(square_n(&(&(square_n(&(&_1101101 * &i3243), 8)) * &_1001101), 8)) * &_100101;
    let i3286 = (&(square_n(&(&square_n(&i3262, 12) * &_1111101), 9)) * &_1000011).square();
    let _1010 = _101.square();
    let i3309 = &(square_n(&(&(square_n(&(base * &i3286), 11)) * &_1010), 9)) * &_1110111;
    let i3330 = square_n(&(&(square_n(&(&square_n(&i3309, 7) * &_101011), 8)) * &_1110101), 4);
    let i3350 = &(square_n(&(&(square_n(&(&_1111 * &i3330), 10)) * &_1000101), 7)) * &_111101;
    let i3373 = square_n(&(&(square_n(&(&square_n(&i3350, 9) * &_1101101), 6)) * &_110101), 6);
    let i3395 = &(square_n(&(&(square_n(&(&_11101 * &i3373), 8)) * &_101), 11)) * &_1001101;
    let i3420 = square_n(&(&(square_n(&(&square_n(&i3395, 9) * &_1000111), 2)) * &_11), 12);
    let i3435 = &(square_n(&(&(square_n(&(&_1110111 * &i3420), 6)) * &_111011), 6)) * &_10101;
    let i3462 = square_n(&(&(square_n(&(&square_n(&i3435, 9) * &_100001), 7)) * &_101101), 9);
    let i3480 = &(square_n(&(&(square_n(&(&_1101001 * &i3462), 7)) * &_101001), 8)) * &_101101;
    let i3505 = square_n(&(&(square_n(&(&square_n(&i3480, 8) * &_1000101), 4)) * &_1001), 11);
    let i3522 = &(square_n(&(&(square_n(&(&_1111001 * &i3505), 7)) * &_110001), 7)) * &_100011;
    let i3551 = square_n(&(&(square_n(&(&square_n(&i3522, 12) * &_1011001), 4)) * &_1101), 11);
    let i3568 = &(square_n(&(&(square_n(&(&_1100011 * &i3551), 5)) * &_11111), 9)) * &_111001;
    let i3592 = square_n(&(&(square_n(&(&square_n(&i3568, 8) * &_1010011), 7)) * &_1100011), 7);
    let i3609 = &(square_n(&(&(square_n(&(&_101101 * &i3592), 8)) * &_1101111), 6)) * &_100111;
    let i3637 = square_n(&(&(square_n(&(&square_n(&i3609, 8) * &_1000101), 9)) * &_100001), 9);
    let i3657 = &(square_n(&(&(square_n(&(&_1010111 * &i3637), 7)) * &_1101101), 10)) * &_1100001;
    let i3682 = square_n(&(&(square_n(&(&square_n(&i3657, 10) * &_100101), 7)) * &_101111), 6);
    let i3704 = &(square_n(&(&(square_n(&(&_11111 * &i3682), 9)) * &_101101), 10)) * &_1101001;
    let i3728 = square_n(&(&(square_n(&(&square_n(&i3704, 7) * &_101101), 8)) * &_1110111), 7);
    let i3746 = &(square_n(&(&(square_n(&(&_100011 * &i3728), 8)) * &_1000111), 7)) * &_110101;
    let i3769 = square_n(&(&(square_n(&(&square_n(&i3746, 8) * &_1110101), 7)) * &_1010001), 6);
    let i3785 = &(square_n(&(&(square_n(&(&_101001 * &i3769), 6)) * &_10001), 7)) * &_10111;
    let i3811 = square_n(&(&(square_n(&(&square_n(&i3785, 9) * &_1110011), 8)) * &_110001), 7);
    let i3831 = &(square_n(&(&(square_n(&(&_100101 * &i3811), 8)) * &_1010011), 9)) * &_1100111;
    let i3857 = square_n(&(&(square_n(&(&square_n(&i3831, 7) * &_1000011), 10)) * &_1111011), 7);
    let i3879 = &(square_n(&(&(square_n(&(&_101 * &i3857), 12)) * &_1111001), 7)) * &_1101011;
    let i3902 = square_n(&(&(square_n(&(&square_n(&i3879, 6) * &_110011), 9)) * &_10101), 6);
    let i3928 = &(square_n(&(&(square_n(&(&_101 * &i3902), 13)) * &_10111), 10)) * &_1011101;
    let i3953 = square_n(&(&(square_n(&(&square_n(&i3928, 5) * &_1001), 12)) * &_100001), 6);
    let i3977 = &(square_n(&(&(square_n(&(&_1001 * &i3953), 9)) * &_11111), 12)) * &_1111101;
    let i4010 = square_n(&(&(square_n(&(&square_n(&i3977, 10) * &_1011101), 12)) * &_1111101), 9);
    let i4029 = &(square_n(&(&(square_n(&(&_1001001 * &i4010), 7)) * &_101011), 9)) * &_100111;
    let i4058 = square_n(&(&(square_n(&(&square_n(&i4029, 9) * &_11011), 9)) * &_1100011), 9);
    let i4075 = &(square_n(&(&(square_n(&(&_1010101 * &i4058), 6)) * &_110001), 8)) * &_1101101;
    let i4098 = square_n(&(&(square_n(&(&square_n(&i4075, 7) * &_110101), 8)) * &_1000111), 6);
    let i4120 = &(square_n(&(&(square_n(&(&_101011 * &i4098), 10)) * &_11011), 9)) * &_101011;
    let i4145 = square_n(&(&(square_n(&(&square_n(&i4120, 5) * &_101), 8)) * &_111), 10);
    let i4169 = &(square_n(&(&(square_n(&(&_11101 * &i4145), 10)) * &_1110011), 11)) * &_101001;
    let i4194 = square_n(&(&(square_n(&(&square_n(&i4169, 7) * &_111011), 14)) * &_101111), 2);
    let i4218 = &(square_n(&(&(square_n(&(base * &i4194), 14)) * &_1011111), 7)) * &_1101101;
    let i4243 = square_n(&(&(square_n(&(&square_n(&i4218, 7) * &_1110101), 4)) * &_101), 12);
    let i4262 = &(square_n(&(&(square_n(&(&_110001 * &i4243), 5)) * &_1101), 11)) * &_1011001;
    let i4286 = square_n(&(&(square_n(&(&square_n(&i4262, 7) * &_1011011), 6)) * &_110011), 9);
    let i4311 = &(square_n(&(&(square_n(&(&_110101 * &i4286), 15)) * &_1100001), 7)) * &_101001;
    let i4336 = square_n(&(&(square_n(&(&square_n(&i4311, 9) * &_1001011), 7)) * &_110011), 7);
    let i4354 = &(square_n(&(&(square_n(&(&_10101 * &i4336), 6)) * &_1101), 9)) * &_101001;
    let i4382 = square_n(&(&(square_n(&(&square_n(&i4354, 9) * &_1010011), 9)) * &_1111111), 8);
    let i4400 = &(square_n(&(&(square_n(&(&_1010101 * &i4382), 5)) * &_10101), 10)) * &_1000111;
    let i4424 = square_n(&(&(square_n(&(&square_n(&i4400, 8) * &_110101), 4)) * &_101), 10);
    let i4444 = &(square_n(&(&(square_n(&(&_111001 * &i4424), 8)) * &_11001), 9)) * &_1011101;
    let i4471 = square_n(&(&(square_n(&(&square_n(&i4444, 7) * &_1101101), 11)) * &_1110001), 7);
    let i4491 = &(square_n(&(&(square_n(&(&_1100001 * &i4471), 2)) * &_11), 15)) * &_1010001;
    let i4515 = square_n(&(&(square_n(&(&square_n(&i4491, 5) * &_1101), 8)) * &_10011), 9);
    let i4532 = &(square_n(&(&(square_n(&(&_1010011 * &i4515), 7)) * &_1110101), 7)) * &_1010111;
    let i4561 = square_n(&(&(square_n(&(&square_n(&i4532, 8) * &_1010001), 8)) * &_101101), 11);
    let i4580 = &(square_n(&(&(square_n(&(&_1100101 * &i4561), 7)) * &_101111), 9)) * &_111011;
    let i4605 = square_n(&(&(square_n(&(&square_n(&i4580, 6) * &_11111), 6)) * &_1011), 11);
    let i4619 = &(square_n(&(&(square_n(&(&_1000001 * &i4605), 7)) * &_1101001), 4)) * &_1011;
    let i4646 = square_n(&(&(square_n(&(&square_n(&i4619, 10) * &_1111101), 3)) * base), 12);
    let i4665 = &(square_n(&(&(square_n(&(&_111001 * &i4646), 9)) * &_1000101), 7)) * &_1111011;
    let i4688 = square_n(&(&(square_n(&(&square_n(&i4665, 7) * &_1110011), 6)) * &_100011), 8);
    let i4704 = &(square_n(&(&(square_n(&(&_1001001 * &i4688), 8)) * &_1011101), 5)) * &_101;
    let i4731 = square_n(&(&(square_n(&(&square_n(&i4704, 11) * &_1111011), 5)) * &_10101), 9);
    let i4747 = &(square_n(&(&(square_n(&(&_1000011 * &i4731), 5)) * &_10101), 8)) * &_100101;
    let i4778 = square_n(&(&(square_n(&(&square_n(&i4747, 6) * &_10011), 8)) * &_110111), 15);
    let i4797 = &(square_n(&(&(square_n(&(&_1011011 * &i4778), 4)) * &_111), 12)) * &_1001;
    let i4822 = square_n(&(&(square_n(&(&square_n(&i4797, 8) * &_1111101), 8)) * &_1010111), 7);
    &(square_n(&(&_1011011 * &i4822), 10)) * &_100011
}

/// Takes a miller loop output and returns root, shift such that
/// root ** lam = shift * mlo, if and only if mlo ** h == 1.
pub fn get_final_exp_witness(
    mlo: FieldElement<Degree12ExtensionField>,
) -> (
    FieldElement<Degree12ExtensionField>,
    FieldElement<Degree12ExtensionField>,
) {
    // Calculate shift and root
    let shift = pow_h3_s(&mlo);
    let root = pow_e(&(&shift * &mlo));

    (root, shift)
}
