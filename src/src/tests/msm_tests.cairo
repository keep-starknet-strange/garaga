#[cfg(test)]
mod msm_tests {
    use garaga::ec_ops::{G1Point, FunctionFelt, u384, msm_g1, MSMHint, DerivePointFromXHint};


    #[test]
    fn test_msm_BN254_1P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high_shifted: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0xc7c2c14510d62220cdc7b3c7,
                limb1: 0x5a684b4bc2b37a7ee0634d2c,
                limb2: 0x17eef8e7e4dd2e33,
                limb3: 0x0
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![u256 { low: 0x0, high: 0x0 },].span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 0
        );
        assert!(
            res == G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            }
        );
    }


    #[test]
    fn test_msm_BN254_2P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high_shifted: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x60c349ba17c1d4434209b924,
                limb1: 0xb4b96efd8be92cde9de1280e,
                limb2: 0x6e55e1a8666f8e3,
                limb3: 0x0
            },
            g_rhs_sqrt: array![
                u384 {
                    limb0: 0xd35ab3554d3a17e69bc90c5e,
                    limb1: 0xffde96e368c26798d24bad63,
                    limb2: 0x1147ab0976577bd3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x48f5fc1455c8dd38358b75b1,
                    limb1: 0x806fc9ed4ccac3f93bbf2adf,
                    limb2: 0xa77478d31681d27,
                    limb3: 0x0
                }
            ]
                .span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x5c724369afbc772d02aed58e,
                    limb1: 0x2cd3bc838c66439a3d6160b,
                    limb2: 0x72f26b55fb56be1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x772ca79c580e121ca148fe75,
                    limb1: 0xce2f55e418ca01b3d6d1014b,
                    limb2: 0x2884b1dc4e84e30f,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0xb4862b21fb97d43588561712e8e5216a, high: 0x967d0cae6f4590b9a164106cf6a659e
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 0
        );
        assert!(
            res == G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            }
        );
    }


    #[test]
    fn test_msm_BN254_3P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0x5b9b511a35490c4f05d6e4e7,
                    limb1: 0xf11ec8642a0df9cb0b8f2cdd,
                    limb2: 0x2b568cd4a3e221ca,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb45c3680d8359a0fdb47de6f,
                    limb1: 0x4c17fe1c96f237095df8c737,
                    limb2: 0x118fc0474955ac2b,
                    limb3: 0x0
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0x47bec5e5e1f295cdcd7689e9,
                    limb1: 0xcb171283d651071401630545,
                    limb2: 0xa401c0298cd5f83,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xe5d2831c05e61956d8725b57,
                    limb1: 0x6bb84991518471727263fde0,
                    limb2: 0x15e82f62ee3caf32,
                    limb3: 0x0
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0xd15f8e23aaf3af13ab5ba169,
                    limb1: 0xb0ff9631870f189040aec289,
                    limb2: 0x1c77509b88d3bab7,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb620e3716b30b1003beab421,
                    limb1: 0x1d6aad1137155249c5d4f785,
                    limb2: 0xbf95d2db0be45f9,
                    limb3: 0x0
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x405f71fc00076527e6fc4c78,
                        limb1: 0x8f18daa35c7ff6a960bb5b70,
                        limb2: 0x1acf52b3d2e4d78c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x55e1ce0e388c458a64de1245,
                        limb1: 0xb85045b68181585d899bbe7f,
                        limb2: 0x30644e72e131a029,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x5216182e9954282e5165d882,
                        limb1: 0xee6d9c3bb968e7795eb593da,
                        limb2: 0x177a7ed9a366cff7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x21dbaba28fbba1e6e8e0352d,
                        limb1: 0x832ea73bd944e7d1c99a888c,
                        limb2: 0xfec2b187b6ab9bc,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x7f5148b9d01ce644c0551d1d,
                        limb1: 0xea7e65b88ff441961f0e382c,
                        limb2: 0x77540b6fa020ca1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9d966e013d09193481e80906,
                        limb1: 0x34a3efbaf588ae0deca14017,
                        limb2: 0xd794d7aa57b6d27,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x389f846ccb041083a10cb9ff,
                        limb1: 0x6a448b23b92648c8a242bcc3,
                        limb2: 0x228a9ea16b505f32,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x8dd07dfe8fdbec741bb48c3f,
                        limb1: 0x12f88efcaab95e0e849f50fd,
                        limb2: 0x160b2e1a0902cfbe,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x659302e7af32e5b4baa09f87,
                        limb1: 0x898bf5b38bceb7755ccf99a4,
                        limb2: 0x2fc4814972402d35,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 {
                        limb0: 0x5216182e9954282e5165d882,
                        limb1: 0xee6d9c3bb968e7795eb593da,
                        limb2: 0x177a7ed9a366cff7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x21dbaba28fbba1e6e8e0352d,
                        limb1: 0x832ea73bd944e7d1c99a888c,
                        limb2: 0xfec2b187b6ab9bc,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x27f4d0d676cdd860c4d1fa6f,
                        limb1: 0xe65386ac1951a13cd4f02a75,
                        limb2: 0xd2f1b8c9dfc2c96,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5be57268705f4a795a64db97,
                        limb1: 0xdc2822db40c0ac2ebd2b6c30,
                        limb2: 0x183227397098d014,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x56063c8c991bc325c89db352,
                        limb1: 0x714aae2911782fd7314a08b5,
                        limb2: 0x757a6155c5ca7ad,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xcd466c49a6f18c5148c392e4,
                        limb1: 0xf0e61765ab80822b3c454592,
                        limb2: 0x9e4d77a54ddbd9,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xf0c06ca91ca69b071361bb3b,
                        limb1: 0x14a5ec278cd5ce650ed8a951,
                        limb2: 0x1fe39905c3c30e6f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6273f5753079b21e51dc95d0,
                        limb1: 0xa13b582e80dd3ed1bd56b763,
                        limb2: 0x175816dcf2342dc4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8d515b1af421f13038e172f0,
                        limb1: 0xae4b61cb0c64b0a2f27bc490,
                        limb2: 0xdebd80bd3a7da0a,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x212b5a5cb53497159d919f6,
                        limb1: 0x53e00a7b34688f8593de1a20,
                        limb2: 0x1606f2401515f708,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x67d344dcf4d4a4f3da4ab8ac,
                        limb1: 0xd2b2463102818681b4cfd0b8,
                        limb2: 0x1dae866efe9938d,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 {
                        limb0: 0x56063c8c991bc325c89db352,
                        limb1: 0x714aae2911782fd7314a08b5,
                        limb2: 0x757a6155c5ca7ad,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xcd466c49a6f18c5148c392e4,
                        limb1: 0xf0e61765ab80822b3c454592,
                        limb2: 0x9e4d77a54ddbd9,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xf31bdf775ed460cbb09a77a4,
                        limb1: 0xbbc894efc25ad7150f2b950a,
                        limb2: 0x29528e7e585ce271,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8bbd8e60fc1a1859e888a509,
                        limb1: 0xdc2822db40c0ac2e47c7fadc,
                        limb2: 0x183227397098d014,
                        limb3: 0x0
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xf3f8288b819d04552d495ec1,
                        limb1: 0x5637b5a04eaec6328f049790,
                        limb2: 0x196a7a54ca00e273,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4f537683af3a47355faad1f5,
                        limb1: 0x3c399d01242138b9556fa2c2,
                        limb2: 0x9ace1d4bf9085ee,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xe42601d9feb3ab9f2b5ae3c1,
                        limb1: 0x45b721c6cecc99dcd79013a2,
                        limb2: 0x1d1a0e768059ba78,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf080a40759b90d6a683d3e76,
                        limb1: 0xe23206d3cafbfeab3d6884f,
                        limb2: 0x1cebdd881068dc2f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7a61a762fe584ff4f91e5ac,
                        limb1: 0xfab1f33e1518d8901d1cc2c0,
                        limb2: 0x173b3f764519e6cd,
                        limb3: 0x0
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x7376af1548b680e8af5f1efc,
                        limb1: 0x4a56db2a6a8afa3a158c5c21,
                        limb2: 0x1bdb208b7cd10730,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xedfa638b0daed5a01f0075df,
                        limb1: 0xb4acd7036c63aa2c004ee846,
                        limb2: 0x1d06a57e3eb191ca,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 {
                        limb0: 0xf3f8288b819d04552d495ec1,
                        limb1: 0x5637b5a04eaec6328f049790,
                        limb2: 0x196a7a54ca00e273,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4f537683af3a47355faad1f5,
                        limb1: 0x3c399d01242138b9556fa2c2,
                        limb2: 0x9ace1d4bf9085ee,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x91b2f2a1b63488947587b29f,
                limb1: 0x272207211ee84c7a00242db6,
                limb2: 0x111e3c81a23fb2b4,
                limb3: 0x0
            },
            g_rhs_sqrt: array![
                u384 {
                    limb0: 0x258b01b2858d51de8acd178c,
                    limb1: 0x6a34cc2dcf1f37f6ab367139,
                    limb2: 0x28d10e632d4cdfe,
                    limb3: 0x0
                }
            ]
                .span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x5c724369afbc772d02aed58e,
                    limb1: 0x2cd3bc838c66439a3d6160b,
                    limb2: 0x72f26b55fb56be1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x772ca79c580e121ca148fe75,
                    limb1: 0xce2f55e418ca01b3d6d1014b,
                    limb2: 0x2884b1dc4e84e30f,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x536c985db33c69f7c242e07a,
                    limb1: 0xfc531bccffafcf1e59d91fb9,
                    limb2: 0x2585e4f8a31664cb,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x57fa42444057cf0c1d62ae3c,
                    limb1: 0x4f48d341183118d68ea41313,
                    limb2: 0x1d2d2799db056ed1,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0x12e0c8b2bad640fb19488dec4f65d4d9, high: 0x1521f387af19922ad9b8a714e61a441c
            },
            u256 {
                low: 0x5a92118719c78df48f4ff31e78de5857, high: 0x28fcb26f9c6316b950f244556f25e2a2
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 0
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x21725fdb9f487676e547051,
                    limb1: 0xc23930e4f96498a77a316418,
                    limb2: 0x1244cb13309195ed,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x6251c487cf0f5a44ac24a45b,
                    limb1: 0xf1db336c10ce7fae206dd8dd,
                    limb2: 0x1da9c56792006d76,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_BN254_4P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0x86e063fb7ec25be43b131a81,
                    limb1: 0x93e844015403a8f7dfeb5c28,
                    limb2: 0x174a5493e74a2d09,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x91ca263218101c0d60b53319,
                    limb1: 0x581ed6a4a31cb7fd061d99c,
                    limb2: 0x183999b303e135fd,
                    limb3: 0x0
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0x5fb5769b3e3c1bee7a6b6b29,
                    limb1: 0x280d5e368d6965bfb181f8,
                    limb2: 0x2bc047bf3c906ee2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x9f898b2cb0c81f1d4a2a4c9a,
                    limb1: 0xb0c4c460d5242da7f633b58e,
                    limb2: 0x2549f8d91404e768,
                    limb3: 0x0
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0x8b78590174dbcc2cf125bf4b,
                    limb1: 0xa8cd83cf722816e54bfa0fbb,
                    limb2: 0x27b3d85c8cce1408,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xfefa5a6be30e6517c9b94ab2,
                    limb1: 0xfeb01666b69919f6d14354de,
                    limb2: 0x272bba280082a072,
                    limb3: 0x0
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xb70f199e6db17b4daca5168a,
                        limb1: 0xd647a41bed4ad5acf6336ce,
                        limb2: 0x25bcfeed0cd8c1cd,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7a44e8d72ae204c6848aa7f2,
                        limb1: 0x4acd91449c941c617b47d535,
                        limb2: 0x14702c61503f432e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x60416bb07aa26060d453430d, limb1: 0x5302fc4c, limb2: 0x0, limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x9d5972a9ca343dcfe69701da,
                        limb1: 0x615d6620cd81416d8915042d,
                        limb2: 0x25e4c512f1b58338,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x77572bdefad6dc9d57ac1583,
                        limb1: 0x1c7491261a1eb794a59c2561,
                        limb2: 0xd4bbc639e75f253,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd329ef9018951bf01024d224,
                        limb1: 0x4822df9ce4a1c312c3e7436f,
                        limb2: 0x1c62a95ba3e78ab9,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x81820ec055ec93ed65f0e4cf,
                        limb1: 0xcb6967722c85ac2455176903,
                        limb2: 0x229af1606d8f08ee,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x97902256d32e115c8a4b60f0,
                        limb1: 0x7b705140145f6891c7287623,
                        limb2: 0x2adf7ec16ea21854,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe9254a704a9b981ccf5dae9f,
                        limb1: 0x95211c5e52612078087b8b75,
                        limb2: 0x1cade05f89c951f5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x107cf888dd1644db11094f9d,
                        limb1: 0xca886d96c2c70583d16019ec,
                        limb2: 0x4432bcaae8577a4,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x728c2e2e65ba14202cb0b00,
                        limb1: 0xb377a6f56581138d6c3c3766,
                        limb2: 0x10e5b25312bd4955,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6605839cf08495d807044089,
                        limb1: 0x555db3724e5c26bdf0d47024,
                        limb2: 0x27e3352adb61d6f9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x110c04230d9ec7b957f17925,
                        limb1: 0x201859202c63f0dab4345fbe,
                        limb2: 0x24c3ada00a850002,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9d5972a9ca343dcfe69701dd,
                        limb1: 0x615d6620cd81416d8915042d,
                        limb2: 0x25e4c512f1b58338,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x77572bdefad6dc9d57ac1583,
                        limb1: 0x1c7491261a1eb794a59c2561,
                        limb2: 0xd4bbc639e75f253,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd329ef9018951bf01024d224,
                        limb1: 0x4822df9ce4a1c312c3e7436f,
                        limb2: 0x1c62a95ba3e78ab9,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x469283c53db13d34dca606a4,
                        limb1: 0x9b2d15aba87587fa14cc1d1e,
                        limb2: 0xc3db1dbb4aa745c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb06a8cae9959e6dbfb06c34f,
                        limb1: 0x25417030f68b6e6d28830b64,
                        limb2: 0x242d047d1fe9fd36,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4b8298a2fcaf236fe983882a,
                        limb1: 0xdc2822db40c0ac2ea25df7f9,
                        limb2: 0x183227397098d014,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x2849ccd0d78dd7f7b92d92f2,
                        limb1: 0x2f6b6f6b53e9898b5a0a8cfa,
                        limb2: 0x1dc306314b8985d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdaa4ba4f0f06e1b0002ade5e,
                        limb1: 0x4e72dc022cd89d26d2b86d1f,
                        limb2: 0x2ddcf329140f07d2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfa54dcf0591b5be5d0cc817c,
                        limb1: 0xdbe31640021802a4e4211d9f,
                        limb2: 0x7ecb6304ea148e0,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x3fcdeaeaee2d82ca345b0480,
                        limb1: 0xc5ea14f63c62ba9d54b66bd8,
                        limb2: 0x29e24a83ebafed2d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb4bd4c75586d3beed97ea3ac,
                        limb1: 0xff5c223b91ff13772d68a4f2,
                        limb2: 0x1ed6cc020bac5e21,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9ef9889c4b1fd9cd6368404f,
                        limb1: 0x8a8b7e89d73b3d52c7207984,
                        limb2: 0x19ae837c31b60353,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x23db0e2d8558bef3c7bf905c,
                        limb1: 0xb4acca1cb5073fee85961f4,
                        limb2: 0x1ec4de2186abd294,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x78dd667286a987e72b88b8d6,
                        limb1: 0x8e424e41fbbc9ca20e1fa6ee,
                        limb2: 0x59491293e29c917,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbf0a99d2b4d38ce24f86a08c,
                        limb1: 0x7ab80899838726b94926723c,
                        limb2: 0x28ce3c9579c9d723,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xeefe96d10b5213b172658474,
                        limb1: 0x93a942c0064807eeac6358df,
                        limb2: 0x17c62290ebe3daa2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2849ccd0d78dd7f7b92d92f5,
                        limb1: 0x2f6b6f6b53e9898b5a0a8cfa,
                        limb2: 0x1dc306314b8985d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdaa4ba4f0f06e1b0002ade5e,
                        limb1: 0x4e72dc022cd89d26d2b86d1f,
                        limb2: 0x2ddcf329140f07d2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfa54dcf0591b5be5d0cc817c,
                        limb1: 0xdbe31640021802a4e4211d9f,
                        limb2: 0x7ecb6304ea148e0,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x93583bbbe8a948adbf6268f3,
                        limb1: 0xcb58c7af7caae75722098676,
                        limb2: 0x413302d6aeeb1c0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8bbd8e60fc1a1859e888a509,
                        limb1: 0xdc2822db40c0ac2e47c7fadc,
                        limb2: 0x183227397098d014,
                        limb3: 0x0
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x8a68ca3bf542a054d18eaff8,
                        limb1: 0x9962ab8236eb001f59a60b8b,
                        limb2: 0xe673ae30dd0ce68,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe5b5c57dc52930124568d01a,
                        limb1: 0xc7aafa3f5a4d30702357436e,
                        limb2: 0xd547cc9f904bd68,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xdfd9fe960922bcabd7b05712,
                        limb1: 0x6825e46149a8286e80e88de0,
                        limb2: 0x17492ea545985760,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb6950c1d1d10dfd86602c498,
                        limb1: 0xae1fd1f3d1b6ce8c96a7e301,
                        limb2: 0x2e1397a81067bac2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x577caf137386f4ecc72f40e9,
                        limb1: 0xfb79bf4906378da03cad3f3f,
                        limb2: 0x3012f892a3dadeaa,
                        limb3: 0x0
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x9f3a5eb3dfc7e0fe74ac0fe8,
                        limb1: 0xcc280286a4c1005e0cf222a2,
                        limb2: 0x2b35b0a929726b39,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb12150794f7b9036d03a704e,
                        limb1: 0x5700eebe0ee791506a05ca4c,
                        limb2: 0x27fd765deb0e383a,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 {
                        limb0: 0x8a68ca3bf542a054d18eaff8,
                        limb1: 0x9962ab8236eb001f59a60b8b,
                        limb2: 0xe673ae30dd0ce68,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe5b5c57dc52930124568d01a,
                        limb1: 0xc7aafa3f5a4d30702357436e,
                        limb2: 0xd547cc9f904bd68,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0xbb72327ea501636a9ace5b39,
                limb1: 0x936325c58447efb149f492c1,
                limb2: 0x10fa4a6dca3f246c,
                limb3: 0x0
            },
            g_rhs_sqrt: array![
                u384 {
                    limb0: 0xb6a84f61aed7a7265f7c215d,
                    limb1: 0xc4b7c1e37084476336d4444c,
                    limb2: 0x170ad69e25dd0067,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc13124085d1cf347c5dcea01,
                    limb1: 0xb84de4ac9ac12bf51eee850,
                    limb2: 0x389aece1d572174,
                    limb3: 0x0
                }
            ]
                .span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x5c724369afbc772d02aed58e,
                    limb1: 0x2cd3bc838c66439a3d6160b,
                    limb2: 0x72f26b55fb56be1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x772ca79c580e121ca148fe75,
                    limb1: 0xce2f55e418ca01b3d6d1014b,
                    limb2: 0x2884b1dc4e84e30f,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x536c985db33c69f7c242e07a,
                    limb1: 0xfc531bccffafcf1e59d91fb9,
                    limb2: 0x2585e4f8a31664cb,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x57fa42444057cf0c1d62ae3c,
                    limb1: 0x4f48d341183118d68ea41313,
                    limb2: 0x1d2d2799db056ed1,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x236ca9312dad3661a37f2d6f,
                    limb1: 0x98424c01caad7592315715d1,
                    limb2: 0x795b9fd941b23c4,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc7ab5834609a54b8993ffd79,
                    limb1: 0xe81cd490528b814ca632aace,
                    limb2: 0x2d9ff53d3009e6f7,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0x5a92118719c78df48f4ff31e78de5857, high: 0x28fcb26f9c6316b950f244556f25e2a2
            },
            u256 {
                low: 0x8d723104f77383c13458a748e9bb17bc, high: 0x215ddba6dd84f39e71545a137a1d5006
            },
            u256 {
                low: 0xeb2083e6ce164dba0ff18e0242af9fc3, high: 0x5f82a8f03983ca8ea7e9d498c778ea6
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 0
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x788e687dfb0b523192cc5507,
                    limb1: 0x6f7b3482a11f4cce1bffaf09,
                    limb2: 0x225f8689ecb156c4,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x2ccf8a4cb742cbcef2f9ac6a,
                    limb1: 0x518ede2a1e12372316e8442b,
                    limb2: 0x4ad79f70e4de756,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_BN254_10P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0x68bfb16794e5817b6b448ffe,
                    limb1: 0x111b7282dbeffcce7b3f715,
                    limb2: 0x246bed5ddc3c74a9,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc91f291a147b3b57a00196a7,
                    limb1: 0x8839341dbd54ad6d21e0e0ef,
                    limb2: 0x18889d68d755b621,
                    limb3: 0x0
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0x635439e16fcbfe5eeba3ecf3,
                    limb1: 0x45b96bc19418f65e9d7aa491,
                    limb2: 0x305fbc2daa6baee9,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x4368a16fa3c73077c4f3cd6,
                    limb1: 0xd363f026c2e38686d22c3585,
                    limb2: 0x291cf0bebd9202c1,
                    limb3: 0x0
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0xb3b7d4349ed18bd82925ef84,
                    limb1: 0x3cd4cdba2a8676b60e52962c,
                    limb2: 0x2bc5ba2338a53b6c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x866ec014b98838760c368ee6,
                    limb1: 0xfdaac7c202634518f73544ed,
                    limb2: 0x2206a4deafdc7284,
                    limb3: 0x0
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x5f51c3e08c86d6a1faf60021,
                        limb1: 0xec3328ece4d8d9f6a4fd1007,
                        limb2: 0x3c3656b75c2d055,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x532f041f81e46a75cb96822c,
                        limb1: 0xa3b136eeb38a3bb149a8138f,
                        limb2: 0x19444dae5c5aba3c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x57862af362236a2b05d4085b,
                        limb1: 0x8d9ac676d7e691bc19803648,
                        limb2: 0x1a4b845f395ed8a8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfb37bd7ca6415036c56b04de,
                        limb1: 0x21ca58dcfd6b3330e082cbcd,
                        limb2: 0x2c69c2d5b1df1dd3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x316965f5009950b2bd787ab3,
                        limb1: 0x6893263e758516198e654ac6,
                        limb2: 0x2d8b6d116fa86df9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xda4a4d6c00964fb73b80ff6,
                        limb1: 0x9b88e93fd6523241ef65a200,
                        limb2: 0x177c9307d71987d5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd3225eb142bc1b70a39430fb,
                        limb1: 0x3bf8576417fa9a31c58828a2,
                        limb2: 0xecfcc97b49ccf82,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2965c32ecb416377abd7c816,
                        limb1: 0xef3d4dddb92c8277a1c238fb,
                        limb2: 0x129ca3741564251f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7fa2ea835023e38f2fef98a3,
                        limb1: 0xdc2822db40c0ac2e5f34ed91,
                        limb2: 0x183227397098d014,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x87df4abf0c6a304446ff70f2,
                        limb1: 0x19ab7a4a79c8a0f2cc004772,
                        limb2: 0x1ca1c49b765a352b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4a9cc8f02f942d3ff0569357,
                        limb1: 0x605ef7d70b3d19527f879662,
                        limb2: 0xb0d044afb65c3ae,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbff06cc6fc012e46ce8597dd,
                        limb1: 0xaf3ac9bb77e932807591f137,
                        limb2: 0x22cdd1723ce304a1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbd409afca8c4ce6e34a4a87,
                        limb1: 0x17f0367cae0c7fa77fa52c18,
                        limb2: 0xfbb0fb5a47d2dfb,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc7402436f68ed91e39a77ef7,
                        limb1: 0xf2048c8d7968634f4bdedd90,
                        limb2: 0x858f9edf9d7ea32,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5ffbc57fc7f820b7c2ced43e,
                        limb1: 0x50575672ff31216459e02bd7,
                        limb2: 0x292bc4914eebc9b4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xef58a0c2eafe9fe12110ec94,
                        limb1: 0xddb9585a19359d3ab6cbc64,
                        limb2: 0x97f388c56c281c8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8e1973ef3122ace515e34f6b,
                        limb1: 0x994b52d9b2dbb34d4cb7c492,
                        limb2: 0xc5ad2704e5707,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa8f73b2325e3cff8873a6d39,
                        limb1: 0x52f22d598cbb78020150dff2,
                        limb2: 0x3fd228b13d83a52,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x27df8e0f1dad2973e0987145,
                        limb1: 0x208f96f80e7377c6959806c5,
                        limb2: 0x2615dfd18640ee3b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x56079308f3d1cb020ca59bf1,
                        limb1: 0x286317da6ffef6d84a5e3635,
                        limb2: 0xa708bba86f67a7c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3fac13fc2f86c0976363af82,
                        limb1: 0x48b0cb2af2514eaf2aaeb5f6,
                        limb2: 0x185ec8e6bb269ff0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf692680248fcc136f874f8ef,
                        limb1: 0xb4b31e61d5f1c1024e2083f5,
                        limb2: 0x1e7442ecbad78446,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3f06ea1c19f493987e6356aa,
                        limb1: 0x1f5907f0fffb1295b06956e2,
                        limb2: 0x1d81ae206eb241dc,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6877e35bcea7598cfa3eca3e,
                        limb1: 0x2da72f4503366903c72f43a7,
                        limb2: 0x1233b0140a105ca1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3a59a6057a8729c3bc9c0b80,
                        limb1: 0x41a3f25de942ad2437ee969c,
                        limb2: 0xab9b18db773a85d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x401c7b41c4187a20d6b9d227,
                        limb1: 0x46c5a9240eb1141013a3d4ca,
                        limb2: 0x13451b969693ed65,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2637c9ebef96769eb43184e1,
                        limb1: 0x90ba6a130e4b54a5f1aedf8,
                        limb2: 0x773f7d9c6ed941e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x233541df4df575eecf0fa338,
                        limb1: 0xcf5ae7153af53a78161e095,
                        limb2: 0x20cb70a1bcd66f93,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x2f2c15afe91e04b5fc81558f,
                        limb1: 0x94b22928ebd88a7acc7f6bc6,
                        limb2: 0x2580ff5f81dcff57,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdfd65ad08ebc87bfd103ba05,
                        limb1: 0x211ce78521b74bf77e96c326,
                        limb2: 0x21270ce0f2314b0b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6eedb13a7bc272a6ba96cd09,
                        limb1: 0x9d0fd1c564b8e6c631b2fe84,
                        limb2: 0x7a0d770f445cd91,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x42e99d412fee8ae218615340,
                        limb1: 0xa92bd80a026cc78bb36e6129,
                        limb2: 0x1b6ea54982a01ef2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa05d35951340b89a9d4d103c,
                        limb1: 0x366c9d7f7776434063242f14,
                        limb2: 0x2417f214e8ed8247,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa68e5d9e9f87ec298d7b1cc2,
                        limb1: 0x774ffbf0f0f88d94bcae3509,
                        limb2: 0xd2433cd86118141,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd9ddebf88b882c8a467d1043,
                        limb1: 0x4182f70d92c68d2281eb6146,
                        limb2: 0x2c38b95aa8c4b353,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x718c800489f6dfcd7b516d38,
                        limb1: 0xbde6851a91fb7d3732062b48,
                        limb2: 0x87e0a654ac2ef49,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf26fac5bfd83048a80011ea2,
                        limb1: 0x90dd98c923e2310cc651611d,
                        limb2: 0x4beddbfa942d881,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xef58a0c2eafe9fe12110ec97,
                        limb1: 0xddb9585a19359d3ab6cbc64,
                        limb2: 0x97f388c56c281c8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8e1973ef3122ace515e34f6b,
                        limb1: 0x994b52d9b2dbb34d4cb7c492,
                        limb2: 0xc5ad2704e5707,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa8f73b2325e3cff8873a6d39,
                        limb1: 0x52f22d598cbb78020150dff2,
                        limb2: 0x3fd228b13d83a52,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x81f495f64e702f5554804917,
                        limb1: 0xf82ed80f85ee57f8b0e0f048,
                        limb2: 0x2edbd3fa55a1361,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x36b72f82156e457d7dda8351,
                        limb1: 0x5cdfba2bf14e6b6923ed664e,
                        limb2: 0x1eeff52a9304b222,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1dfaed23b53e95da747748ff,
                        limb1: 0x28c377573f63ec892e97d89a,
                        limb2: 0x59225e9731fd43b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe0271fb9aaca3ac28976d5e2,
                        limb1: 0xff3ca3689fb3a21a94f7314b,
                        limb2: 0x311aa96b94d65d7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfadb2ce0b72f8448ded6d1a0,
                        limb1: 0xb61b71bb83da566ea84bc096,
                        limb2: 0x1633598a6f14fdbf,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe2df61d62fcfeba61b3a102c,
                        limb1: 0x256835cbcc978e782564a76d,
                        limb2: 0x28a7052e3cac91b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x542c932740f2577cff5930c8,
                        limb1: 0x6fb292c87dc760b4f3c3d525,
                        limb2: 0x1fa75b3071c3a155,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbcf739782299015939a675ed,
                        limb1: 0x3479cb8ebd269f3187c194ad,
                        limb2: 0x2b9ce00d21713aad,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5c16e1db53349c0b56cb3b15,
                        limb1: 0xb85045b68181585d42558246,
                        limb2: 0x30644e72e131a029,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xe34561de3ebf36c298cea030,
                        limb1: 0x27005bb4091762d858356ad7,
                        limb2: 0x180f2349e3ade9cf,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x584be1d26ab0e33221e79a23,
                        limb1: 0x91eaee8a90e327918cfdc5ce,
                        limb2: 0xc600571db5763d4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd42d9c157f2513468c393fba,
                        limb1: 0xc106a5113610549a0738f8fc,
                        limb2: 0x84c1ea1f56c584,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x312b9600c7fb13edfa42f854,
                        limb1: 0x648e327565e6b6722164e945,
                        limb2: 0x316e9d9514acbf6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xacb769d7eae5f59bedf5c680,
                        limb1: 0x49df84bb2e78a51fa632bd08,
                        limb2: 0x301cd14cd4bca84d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa5265fc824148d315506860a,
                        limb1: 0x2686217c69b2b41b4b13e8,
                        limb2: 0x1d18726ec5794324,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x70a36afac65e30dafc7df63e,
                        limb1: 0xee3fe864d0d593c9aa35375e,
                        limb2: 0x2b498cc8951581e6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6e7adfb9dbd46ad8a7ecc50c,
                        limb1: 0xe31373013af91a94369e84db,
                        limb2: 0x1876eff45644b83d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x16d47d36871ddf2bdf580d8b,
                        limb1: 0xc69abe76a7e2d9cde30b9d08,
                        limb2: 0x286da22e26daa03b,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xfb90ee7bdee5f39cd08c2cd5,
                        limb1: 0x5135573657a099a69ba82853,
                        limb2: 0x63a29b4d4d7c064,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2196c0128d6a587aed0355c0,
                        limb1: 0xf8c11f32a383e642d1c6a1a9,
                        limb2: 0x2bb300c5fad1f8bd,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x18c346dd3d82e3a1f40ce89a,
                        limb1: 0xc7dcf74662168ac69cf35e80,
                        limb2: 0x18908960de3e438c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x728b4097c268d9eba9170968,
                        limb1: 0x33a9de25e8dfd2c598243467,
                        limb2: 0x22e03ff5649ccc25,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6b311e5159740266d087830e,
                        limb1: 0x544ea0f2bd8a23655569ae91,
                        limb2: 0x1bff413197289f61,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf70b40acfe3df31d06a9fb98,
                        limb1: 0xd73987de867b3ec16fe45cd4,
                        limb2: 0xbb9c6d18f0d28f6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdf5fdd321ffa4399d0742ddc,
                        limb1: 0xce1d4f65fc6388bd897d25d6,
                        limb2: 0x3ff829a416fee05,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xffa087dfb9c5676e66987e83,
                        limb1: 0x415633dcfe8cdbdfc6b88d86,
                        limb2: 0x2ab238cd61699ad1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5e8ee702b3913c848402aacd,
                        limb1: 0xa4b280122782eb42a9ca643a,
                        limb2: 0x10be919857e4bcd,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4e38574c0e1d3f27dad80e8e,
                        limb1: 0x13491266711b64b82b205215,
                        limb2: 0x2dd8d5c14cd95733,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x415e5b0d801d1830f1eee349,
                        limb1: 0xbcb0cd6599c4d02b711ed5f6,
                        limb2: 0x17c91b6ac9d81d43,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8e3a5774012a99665b6ce69,
                        limb1: 0xb5c0cb9fb2a976b4a6f9516b,
                        limb2: 0x2520105592062b7d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7c88d4407d6f39d3a4abbf2e,
                        limb1: 0x4313ef33a230fdce15aaeaf6,
                        limb2: 0x18e45be5e04508e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x76c823e096b0728c8797892c,
                        limb1: 0x54aaf3143acb862ebc6426a7,
                        limb2: 0x2153e0d5d78e4db2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x251cbfb277011fc16251f5ce,
                        limb1: 0x4698ab9897c90dd7b911bd34,
                        limb2: 0xb898dffb5f87c3f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5b2ef0e0af422ec3b2cfd491,
                        limb1: 0x929f1bf29cc1458c198ca25,
                        limb2: 0x2769cac38e90eec7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb23241d6a2d48e513ec2e080,
                        limb1: 0xbead6036d564c113f101ba3d,
                        limb2: 0x242af34d4e281157,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x274473eb06221df834c21b16,
                        limb1: 0x82795251dc6144211b0b7678,
                        limb2: 0x18b90444152790b3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb04e77c4050c86706997b6d6,
                        limb1: 0x2b05f061ef8e3704fde9ab4c,
                        limb2: 0x5346da09674435a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x70a36afac65e30dafc7df641,
                        limb1: 0xee3fe864d0d593c9aa35375e,
                        limb2: 0x2b498cc8951581e6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6e7adfb9dbd46ad8a7ecc50c,
                        limb1: 0xe31373013af91a94369e84db,
                        limb2: 0x1876eff45644b83d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x16d47d36871ddf2bdf580d8b,
                        limb1: 0xc69abe76a7e2d9cde30b9d08,
                        limb2: 0x286da22e26daa03b,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xc31df45182f5cecdb94603b3,
                        limb1: 0x6dc3d8ae5baf1fa9ba9b1f97,
                        limb2: 0x1b0b1abce36ce9fc,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8bbd8e60fc1a1859e888a509,
                        limb1: 0xdc2822db40c0ac2e47c7fadc,
                        limb2: 0x183227397098d014,
                        limb3: 0x0
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x651161258487ddb3be23a80e,
                        limb1: 0xb4de25cd3b8e534fda5a8fc,
                        limb2: 0x11fccd5743d87daa,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb9d7870469a38df69c301e17,
                        limb1: 0xee1251f1446343a683359a64,
                        limb2: 0x4a32694df5255fd,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xd5ac57f4f347f88c426f5536,
                        limb1: 0xcc6e895d127411d36f40829c,
                        limb2: 0x1675066c22755474,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xba243da9a9afe3c980815a6a,
                        limb1: 0x3c1f8e2f3cbdcc87f6d6a281,
                        limb2: 0x116810b58ffaa6e9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf965823d8032a2bdfcb66efc,
                        limb1: 0x66aa66c9cbcb963d7080870f,
                        limb2: 0x15010de5ebac89ae,
                        limb3: 0x0
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xc6c258e351770d0461edfae3,
                        limb1: 0x6999615ff9a95741616f9063,
                        limb2: 0x5921992ea57d8d4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2d86950d3ceaa9e3d4905a45,
                        limb1: 0xca36f5d3cd29caf389a0cf2e,
                        limb2: 0xde973be9df701f9,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 {
                        limb0: 0x651161258487ddb3be23a80e,
                        limb1: 0xb4de25cd3b8e534fda5a8fc,
                        limb2: 0x11fccd5743d87daa,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb9d7870469a38df69c301e17,
                        limb1: 0xee1251f1446343a683359a64,
                        limb2: 0x4a32694df5255fd,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x792ef5ee2bca1f87630a7651,
                limb1: 0x7629a25e0950c39ee0f6bfcd,
                limb2: 0x118fb77384c18c3d,
                limb3: 0x0
            },
            g_rhs_sqrt: array![
                u384 {
                    limb0: 0x2bb89ea5b236f9cc2b8ba784,
                    limb1: 0x4ae53de8f9f077ee43278c73,
                    limb2: 0x36e979a3ceed10c,
                    limb3: 0x0
                }
            ]
                .span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x5c724369afbc772d02aed58e,
                    limb1: 0x2cd3bc838c66439a3d6160b,
                    limb2: 0x72f26b55fb56be1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x772ca79c580e121ca148fe75,
                    limb1: 0xce2f55e418ca01b3d6d1014b,
                    limb2: 0x2884b1dc4e84e30f,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x536c985db33c69f7c242e07a,
                    limb1: 0xfc531bccffafcf1e59d91fb9,
                    limb2: 0x2585e4f8a31664cb,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x57fa42444057cf0c1d62ae3c,
                    limb1: 0x4f48d341183118d68ea41313,
                    limb2: 0x1d2d2799db056ed1,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x236ca9312dad3661a37f2d6f,
                    limb1: 0x98424c01caad7592315715d1,
                    limb2: 0x795b9fd941b23c4,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc7ab5834609a54b8993ffd79,
                    limb1: 0xe81cd490528b814ca632aace,
                    limb2: 0x2d9ff53d3009e6f7,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x163df40cafbf585ca5b2ab44,
                    limb1: 0xb4752e4666c88dbbe23783a0,
                    limb2: 0x1a801462ac9cb657,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xac9b557d7ca8625d957263c6,
                    limb1: 0xdc6f75fa8339a78b998ae54a,
                    limb2: 0x28683293b6494d9f,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x5c4f5dca0c973b7f70bfff9,
                    limb1: 0x188c2afab11eef5d48ecda3c,
                    limb2: 0xc2fed35d36c49f1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x9d7244ea10697ca42e2e066b,
                    limb1: 0xfe18a519c7d68770dc48dbf9,
                    limb2: 0x149bb528db998529,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xffc057151b06c496e6fdd440,
                    limb1: 0x5a01bae0c7441f08c7af1cf9,
                    limb2: 0x274e0e02529e6d26,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x65ceb8977413bc9798681ecb,
                    limb1: 0x19ffb287b45234f0c28fd1a7,
                    limb2: 0x28dbbd2f9267be76,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xcfcdbfdb2056ff1a64bf1d47,
                    limb1: 0xf26fe2dae9f693d9b4aab2e6,
                    limb2: 0x12d66ad4802d841e,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xe6e34ebfa2e18dce86cadbdc,
                    limb1: 0x7ce096238b3d4b1b8fba6a55,
                    limb2: 0x2e0a660b1549800c,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xd2dd03b29d58d045656ecf33,
                    limb1: 0xeddac3cf7a123aae2180739b,
                    limb2: 0x215bec6e0a03c924,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xe5201e51828eb11589d8619f,
                    limb1: 0xa6563c760aa3a2c9d15af235,
                    limb2: 0x7ed0c9b2e7811fb,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xc33ac21c67b06a9994457b4c,
                    limb1: 0xa9aa5573bf7a92aab85366eb,
                    limb2: 0x1a407281e1d92e91,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x5a306649d971b115d71a78b1,
                    limb1: 0xa70687a9b5132e26b2cfbb37,
                    limb2: 0x2031920af5d6c9db,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0x247a8333f7b0b7d2cda8056c3d15eef7, high: 0x5d67b7072ae22448b0163c1cd9d2b7d
            },
            u256 {
                low: 0xe005b86051ef1922fe43c49e149818d1, high: 0x1f507980eece328bff7b118e820865d6
            },
            u256 {
                low: 0x4a84eb038d1fd9b74d2b9deb1beb3711, high: 0x154bc8ce8c25166a1ff39849b4e1357d
            },
            u256 {
                low: 0x3405095c8a5006c1ec188efbd080e66e, high: 0x2305d1699a6a5f92cca74147f6be1f72
            },
            u256 {
                low: 0x1775336d71eacd0549a3e80e966e1277, high: 0x144a7edf6288e1a5cc45782198a6416d
            },
            u256 {
                low: 0x2f1205544a5308cc3dfabc08935ddd72, high: 0x21c38572fcd81b5d24bace4307bf326
            },
            u256 {
                low: 0x42930b33a81ad477fb3675b89cdeb3e6, high: 0x2b70369e16febaa011af923d79fdef7c
            },
            u256 {
                low: 0x2648ee38e07405eb215663abc1f254b8, high: 0x522c9d6d7ab792809e469e6ec62b2c8
            },
            u256 {
                low: 0x85940927468ff53d864a7a50b48d73f1, high: 0xdc5dba1d977e9933c49d76fcfc6e625
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 0
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x308fd6b45a63e49bf708e96,
                    limb1: 0x9b97a3363c95c209e8fab620,
                    limb2: 0x1ae699a4de6d9998,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x6966fe3425872dc23fd55404,
                    limb1: 0xa8be5375eb482c4e7d2ad043,
                    limb2: 0x12572137d2078244,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_BN254_11P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0x90b45d7a39843ae2cf8649e4,
                    limb1: 0x4f3f05fe6a82257db5ef4638,
                    limb2: 0x2e5317b879b4f67d,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb5aec8ffa005f236cb86d08f,
                    limb1: 0x7c11b27ce9c06cee3fa3793,
                    limb2: 0x13abbc2cb5a70d04,
                    limb3: 0x0
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0x6c7780a212a34f79a5a4984,
                    limb1: 0xd2b9f43370853e82b6e280f3,
                    limb2: 0x49098e1fef9ff1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf16e5ea4fa4507af42f9148f,
                    limb1: 0x67e653350524a43c52475d47,
                    limb2: 0x1ff99fb3e2fe4ead,
                    limb3: 0x0
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0xc18d4af2d637781faf364b80,
                    limb1: 0x43beee7449f92708853e95de,
                    limb2: 0x3072f460ce59704,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x1dddbd01de2320fae30a9244,
                    limb1: 0xf6111cd106dc6a17348c4d58,
                    limb2: 0xc922fcf80c6b390,
                    limb3: 0x0
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xf184c3cae225009b56f88267,
                        limb1: 0x57bc64e905798e76fefa631a,
                        limb2: 0xe8d725a8e9a8fb1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xabf9b0472844b35780291374,
                        limb1: 0xbaa158cf765c39a72d4fe42b,
                        limb2: 0x1bca43911c49d510,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6ea563415bac85b622cd8819,
                        limb1: 0xe3f4412714b49eb591d013de,
                        limb2: 0x1c47fa71a5208f2e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x54561408f69dd18704ad79f9,
                        limb1: 0x76261218353d5f1727c61123,
                        limb2: 0xb13c4f87ba870b0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd960440c30fdca4000e73a63,
                        limb1: 0x1f5dc87056812ccc9134e83a,
                        limb2: 0x26aae97e130dec15,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xafe47f9e31f27206d3d4fe17,
                        limb1: 0xcfa168a90c6460f4984de44d,
                        limb2: 0x1bc4af113d97a3f5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x64aeec8b2f7623f593dd9849,
                        limb1: 0x325719fbf4d0d25723d18ac0,
                        limb2: 0x201e51889f89886f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x30e91d1d27c0f302d1d7e0fc,
                        limb1: 0x5e0b4e18c6c58db82bc9ff0e,
                        limb2: 0x2c6f187b8ccff56f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xba957299d39e954103d13e4c,
                        limb1: 0x8ebbea74319995c7c8992190,
                        limb2: 0x298be6eea497ffb0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb94ba12b839aff95a528735c,
                        limb1: 0xdc2822db40c0ac2e333dbc74,
                        limb2: 0x183227397098d014,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xbd9870f8e85b457393a738ad,
                        limb1: 0x4d3926c1da30b6059578dbfc,
                        limb2: 0x26660d36e457e539,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9f4e310412a202b931511252,
                        limb1: 0x92233776d1baa777bc7495b7,
                        limb2: 0x1ad4d51a48e94dc1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf94985c5c4b66a21386b3763,
                        limb1: 0xd45bb5239b60a6d93598bef5,
                        limb2: 0x1d1917b7585f3155,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xce7c1ae478eca46e413a08eb,
                        limb1: 0x3eee992084e62dbee2657a63,
                        limb2: 0x257e3699b875b343,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x70bf5a5b636ff5ad639f0a12,
                        limb1: 0xd216ec1945f3c73c11b0250a,
                        limb2: 0x1f4d525347071d00,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd60698937f4628a315543ae0,
                        limb1: 0x3275d97c37a3d3e6eed171f,
                        limb2: 0x1e65e27e5eadc4c9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x96ce17dae3776051fc167350,
                        limb1: 0xefcdfd89d0e04e38b9413496,
                        limb2: 0x1f5f4c48a8778a54,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x11e146c84057354f6a587bbc,
                        limb1: 0x9f9d963b9da1fa4c551b924f,
                        limb2: 0x168ef2841df87da2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xabdf15a9f5a04bf7b76d229b,
                        limb1: 0xb8e879641e1ceeb68ba1e63c,
                        limb2: 0x2651b0b8e40222f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x90d08afcad268c67ccbe6492,
                        limb1: 0xdd2556a7f24a6818de751b26,
                        limb2: 0x192989e2bccd589f,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xd08d6e0b94dabafa035d8b62,
                        limb1: 0x5b973c1952ad18d086e60d0f,
                        limb2: 0x20b102655f46b00f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1f45fea0fa87a39c99479158,
                        limb1: 0x51a39fb99afa4aa798e864c,
                        limb2: 0x1792a46e7e4cd2c0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8aa8108610ef28283eac7340,
                        limb1: 0x4900ca6484aa03ec742e9341,
                        limb2: 0x2634d18ed475bf7f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe02ce17ca45fa9a2ed16c9c2,
                        limb1: 0x7d5a23dd9fd881bc5d67d347,
                        limb2: 0x250d4d477d4a9fcc,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x144922c9e34b857f5b45671d,
                        limb1: 0x1ec28e26e9c2fd1a3e7bce0d,
                        limb2: 0x21c860c2975d994,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4624f2d4bb43360ad9a8fc8d,
                        limb1: 0x135664ee80f6f245fef54d0e,
                        limb2: 0x1d1a374c33e1de32,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfcec606139102286a9a6ea9,
                        limb1: 0xf0934e5e2c2e7b5294a58325,
                        limb2: 0x1929876f93a1588d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9141e0ba4c6c38378bbd40ab,
                        limb1: 0x88d796d9a72239fb4b1663d8,
                        limb2: 0x2249ccfaa68086bf,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9a1823ddd784db6bce7854db,
                        limb1: 0x7b3cba16a6d7d61449496d48,
                        limb2: 0x762cd5268df606,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb8a841c039f8b1dfb3ed8cc8,
                        limb1: 0x4159c91ae4f56a7be77f85f3,
                        limb2: 0xfe59ed8bc782bc,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xde904ee74948582ac4cc7074,
                        limb1: 0x7cd4e7e4f198e3376379270a,
                        limb2: 0x95f7700cfec330d,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x67e5bdd040d0b82d09fbaf79,
                        limb1: 0x770ae8d88b8f71559167bed3,
                        limb2: 0x12698abeeaa46f58,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7578c87efbc57c14bb7639af,
                        limb1: 0xfe1960adf3ae9e099ddc5695,
                        limb2: 0x201a30dbf98a491a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x836ac6c41202b24cd0c4a8e2,
                        limb1: 0xc4c2d9b450a09c2e0948d250,
                        limb2: 0x26e6f8b327ebf3d7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xefb761fe9ebf8e79cdde5b99,
                        limb1: 0xe11420ffe45f362976250b73,
                        limb2: 0x5b3c5ab6a241e85,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x20a8aafbc4b0cb93ab3435fa,
                        limb1: 0x97c77055a0934c70c2822fb4,
                        limb2: 0x17f42f2e5b9b6470,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xaa79ba65ca47cbdcc76ded75,
                        limb1: 0x6d31427de2ccadd9535d2f32,
                        limb2: 0x1782224cb2053f5d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc202cd5aab11ad368483684d,
                        limb1: 0x9db80650f48467addf264304,
                        limb2: 0x22d37e8def7911ee,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd57f9999ac347d6df1ae82b8,
                        limb1: 0x404f235f1bd70565e20006d4,
                        limb2: 0x2318cf9de8d5595,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd9a3d99160270c8a3b9ba2b1,
                        limb1: 0x2de0c9c41dd1096211d2c9d5,
                        limb2: 0x259533a1096e2b58,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x785c23b672a9ed5bb157a678,
                        limb1: 0x169d7614a4bcd5c8259db0e7,
                        limb2: 0xa134d0b1c7c53e1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x11e146c84057354f6a587bbf,
                        limb1: 0x9f9d963b9da1fa4c551b924f,
                        limb2: 0x168ef2841df87da2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xabdf15a9f5a04bf7b76d229b,
                        limb1: 0xb8e879641e1ceeb68ba1e63c,
                        limb2: 0x2651b0b8e40222f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x90d08afcad268c67ccbe6492,
                        limb1: 0xdd2556a7f24a6818de751b26,
                        limb2: 0x192989e2bccd589f,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x9b5f0d529bab3035470deb3c,
                        limb1: 0xdbf2ec2908f2fdcf5fef4ddf,
                        limb2: 0x2b542f8c9e784eb,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3ef088e0968f3ffbc50573ac,
                        limb1: 0x271c265b1012e44bc370ceb8,
                        limb2: 0x1be24156f5bb8d0c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb3b4535c8cc420508ace4a9d,
                        limb1: 0x6d8956c6cbe90653cd22eec3,
                        limb2: 0x2212f7c3fda9b60e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x229624ec4206cff7820a3801,
                        limb1: 0x76c369d3392cc53715dc872,
                        limb2: 0x1b346cd12b188c5b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x222166c426b3128b19f4ae64,
                        limb1: 0x28689c265668cac7f18317b4,
                        limb2: 0x178abfbe55562fd8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3c28c590140226afdb553511,
                        limb1: 0x61ffca6cfd4baac539e9f134,
                        limb2: 0x1f5e73573193920a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9c7bd8ccf433ee27762e9fc6,
                        limb1: 0x2293f741fd2df1b29213feea,
                        limb2: 0x8972b1c02e3d4e7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfc2187db4d61bc20e53e74eb,
                        limb1: 0xcd1632e9988f7d3f5142aec3,
                        limb2: 0x236917f784951cfd,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3dccc81abb5ac9d0fa9f378,
                        limb1: 0x93d250bcefc684faf76333ee,
                        limb2: 0xa2ee16e8f6d780,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3b3ce8970652b390855ecf33,
                        limb1: 0xb85045b68181585d4f58ed5c,
                        limb2: 0x30644e72e131a029,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x1dbc85fcba563127b61c9188,
                        limb1: 0x1b75dbb5da304c4f8ed9e8fb,
                        limb2: 0x28369d5e720e69f6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x34a4ffd530bb61e012f12f69,
                        limb1: 0x5378d5ed5b44b757a649086e,
                        limb2: 0x7be4a37fd17361b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdab17bddbe8ed97ad73eda43,
                        limb1: 0x5b2ca4342ddb94cb2be73ec3,
                        limb2: 0x1621aa6ff944503c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x83ffbefbd7dc3db191d5db0d,
                        limb1: 0x53056b0ca109249fa55e3e25,
                        limb2: 0x950c41dba762c38,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc50296883b79ab1c7e65c293,
                        limb1: 0x416bd40ed9350c97b42e18bc,
                        limb2: 0x29fa6dc31a58723a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5df32cd1c613aa30c2d213c4,
                        limb1: 0x2444bfce313e86abe64ce0eb,
                        limb2: 0x9ff894975440b26,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe26e3dac114d6d35f9547621,
                        limb1: 0xb8d7cb27498e26a9c4a1270c,
                        limb2: 0xfb14abebcf1d355,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc814fbeb584059447074bed8,
                        limb1: 0x854c3ee4a4b2fe114018d3e9,
                        limb2: 0x9c51835869b9ed0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5aa096652cc158f8da768865,
                        limb1: 0x621e4976ff3dd6a845c5bbe,
                        limb2: 0x1405f46c063beb3d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb24ba5df8960063c296d67ab,
                        limb1: 0xa15a22bc6ac5f6b6460075da,
                        limb2: 0x16cf499a35610f01,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x68313b7f683911720c05ba73,
                        limb1: 0x9e15eb91eb5f60f07fbfa816,
                        limb2: 0x17bb6628e1a2ef8d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4c6031efd17a88be71b4897f,
                        limb1: 0xe3be4c014b26d914b376450c,
                        limb2: 0x34b3deaea6539f6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x68dccd85ebe875c8e94dedf1,
                        limb1: 0x831bef76422664130fc5f2fa,
                        limb2: 0x1724e4bd1a6e3ea9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc8e0e05ed88ba565937c3a23,
                        limb1: 0xffb0feb52038fb3a50cf3851,
                        limb2: 0x25c2529d3204170,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xad02ea2f92f0d0f8fb406738,
                        limb1: 0x26693f4f98fe1d6601382f8f,
                        limb2: 0x2f9b90d19b2b974a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd256581034d99b7f8f3feaf7,
                        limb1: 0xaaa978aaf9c81400021e40c,
                        limb2: 0xd62f89c9d625e69,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4df01d83caba17de6fc02af5,
                        limb1: 0x9978e68c4b4a79e375af1136,
                        limb2: 0x190f38300537092f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2ca7cba5cd5c2cac73920912,
                        limb1: 0x59870607909e97e336b1e823,
                        limb2: 0x270ee03be812e4fd,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdfa33377f82b563414f49111,
                        limb1: 0x2ff09d2849dedc2eb467e24b,
                        limb2: 0x18482cd656f8d42c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3750889583fa84548224180,
                        limb1: 0xd17f50edff6163fc4037b20e,
                        limb2: 0x1006b037f49b453a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd41e0203e881bffc2018e83e,
                        limb1: 0x9ea2081b844acbc7ca73bff8,
                        limb2: 0x2caf300f97e7df9f,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x8851fcdbb6c17b49715bba0a,
                        limb1: 0xe1c107b48b8e34337d8ae5ce,
                        limb2: 0x17db3b3593c7fd8e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9deeff7f923225a038d38e3b,
                        limb1: 0xfa6a81c811ce2606f2db194a,
                        limb2: 0x173adea7f745a251,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x27a2a90bff8c0059ad3f9182,
                        limb1: 0x5935a6e608116603ec3451ba,
                        limb2: 0x1200b0dd0a9b508b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4149f86305ca5e2593212568,
                        limb1: 0x5c35d7253bca61d0e77338da,
                        limb2: 0x13c49b44c03f4e75,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb2c92e536ae74b07dd287c94,
                        limb1: 0xa71bc6ace3e12c6393d07d81,
                        limb2: 0x24e4f69b89bd4c76,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8c1937c5d4a94bf647381848,
                        limb1: 0xfaa9de84015d071474c76f4,
                        limb2: 0x3bbf7d977ded185,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc2d8ad72cfa3f93ca5564029,
                        limb1: 0xc53c86cbfc32403f5bc048ba,
                        limb2: 0x80055e7101a060f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb4cfbfbd081a2ad2f74701d4,
                        limb1: 0x19004b0645ccae6ddcf729e8,
                        limb2: 0x16e567f0ccf9ae82,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x56325741037290479b8afac,
                        limb1: 0x7e5a27ddff98c68ddbe08995,
                        limb2: 0x15ad181aa6c62cb3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x90df64bd714cf3d39d1fafdb,
                        limb1: 0xe495eda6085eb26eff211e0b,
                        limb2: 0x23bad91a7be36030,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc814fbeb584059447074bedb,
                        limb1: 0x854c3ee4a4b2fe114018d3e9,
                        limb2: 0x9c51835869b9ed0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5aa096652cc158f8da768865,
                        limb1: 0x621e4976ff3dd6a845c5bbe,
                        limb2: 0x1405f46c063beb3d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb24ba5df8960063c296d67ab,
                        limb1: 0xa15a22bc6ac5f6b6460075da,
                        limb2: 0x16cf499a35610f01,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xaef15bfafb2d5c5ee59c7b5b,
                        limb1: 0x4c95ff239061cce29ca35822,
                        limb2: 0x2b4256fabb45a381,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8bbd8e60fc1a1859e888a509,
                        limb1: 0xdc2822db40c0ac2e47c7fadc,
                        limb2: 0x183227397098d014,
                        limb3: 0x0
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x1cd3109b05dba0790ef535c8,
                        limb1: 0xc93334ededa249e877d7cb93,
                        limb2: 0x1b6d5c3af843ee8a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa01d079044bedeff8eec6843,
                        limb1: 0xa1d7630ec702f2d25b6053bf,
                        limb2: 0x2d14159eb45c6933,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x23a7bc1712d5fb43839baa92,
                        limb1: 0x47983d8c72a3589624a67628,
                        limb2: 0xfbd42f56b084c1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xba9c81e25821891fc3bf0a01,
                        limb1: 0xe3248331ddfa7cee7cb9e58b,
                        limb2: 0x26106aff71c7c427,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xed7cd75f9c669c25b1f8ccf9,
                        limb1: 0x96eecf54c834db8ecd4fa613,
                        limb2: 0x215fb6340533c94b,
                        limb3: 0x0
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xee076743d57255545462a411,
                        limb1: 0xa34959134765855bd005f827,
                        limb2: 0x21e3c63e079a2b76,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf73819655fb84d0fbcb3e3b,
                        limb1: 0x74e59dbf520627bbe31e261c,
                        limb2: 0x2673a3f65ab1fb47,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 {
                        limb0: 0x1cd3109b05dba0790ef535c8,
                        limb1: 0xc93334ededa249e877d7cb93,
                        limb2: 0x1b6d5c3af843ee8a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa01d079044bedeff8eec6843,
                        limb1: 0xa1d7630ec702f2d25b6053bf,
                        limb2: 0x2d14159eb45c6933,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0xbc53ffba4b377c88fcbeb24,
                limb1: 0x1db22efa0f7c923d7aa0d016,
                limb2: 0x13209b4f6a3b53df,
                limb3: 0x0
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x5c724369afbc772d02aed58e,
                    limb1: 0x2cd3bc838c66439a3d6160b,
                    limb2: 0x72f26b55fb56be1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x772ca79c580e121ca148fe75,
                    limb1: 0xce2f55e418ca01b3d6d1014b,
                    limb2: 0x2884b1dc4e84e30f,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x536c985db33c69f7c242e07a,
                    limb1: 0xfc531bccffafcf1e59d91fb9,
                    limb2: 0x2585e4f8a31664cb,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x57fa42444057cf0c1d62ae3c,
                    limb1: 0x4f48d341183118d68ea41313,
                    limb2: 0x1d2d2799db056ed1,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x236ca9312dad3661a37f2d6f,
                    limb1: 0x98424c01caad7592315715d1,
                    limb2: 0x795b9fd941b23c4,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc7ab5834609a54b8993ffd79,
                    limb1: 0xe81cd490528b814ca632aace,
                    limb2: 0x2d9ff53d3009e6f7,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x163df40cafbf585ca5b2ab44,
                    limb1: 0xb4752e4666c88dbbe23783a0,
                    limb2: 0x1a801462ac9cb657,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xac9b557d7ca8625d957263c6,
                    limb1: 0xdc6f75fa8339a78b998ae54a,
                    limb2: 0x28683293b6494d9f,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x5c4f5dca0c973b7f70bfff9,
                    limb1: 0x188c2afab11eef5d48ecda3c,
                    limb2: 0xc2fed35d36c49f1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x9d7244ea10697ca42e2e066b,
                    limb1: 0xfe18a519c7d68770dc48dbf9,
                    limb2: 0x149bb528db998529,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xffc057151b06c496e6fdd440,
                    limb1: 0x5a01bae0c7441f08c7af1cf9,
                    limb2: 0x274e0e02529e6d26,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x65ceb8977413bc9798681ecb,
                    limb1: 0x19ffb287b45234f0c28fd1a7,
                    limb2: 0x28dbbd2f9267be76,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xcfcdbfdb2056ff1a64bf1d47,
                    limb1: 0xf26fe2dae9f693d9b4aab2e6,
                    limb2: 0x12d66ad4802d841e,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xe6e34ebfa2e18dce86cadbdc,
                    limb1: 0x7ce096238b3d4b1b8fba6a55,
                    limb2: 0x2e0a660b1549800c,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xd2dd03b29d58d045656ecf33,
                    limb1: 0xeddac3cf7a123aae2180739b,
                    limb2: 0x215bec6e0a03c924,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xe5201e51828eb11589d8619f,
                    limb1: 0xa6563c760aa3a2c9d15af235,
                    limb2: 0x7ed0c9b2e7811fb,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xc33ac21c67b06a9994457b4c,
                    limb1: 0xa9aa5573bf7a92aab85366eb,
                    limb2: 0x1a407281e1d92e91,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x5a306649d971b115d71a78b1,
                    limb1: 0xa70687a9b5132e26b2cfbb37,
                    limb2: 0x2031920af5d6c9db,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x58a3cea1103f16402eb74c08,
                    limb1: 0xdfefcd91df2f4295ec21e03a,
                    limb2: 0x1150bcc09ac40007,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x57ed7d356f91abcef751889f,
                    limb1: 0x5c668cded3599c9af5a7e5fa,
                    limb2: 0x2ccf74197cb9bc13,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0xe005b86051ef1922fe43c49e149818d1, high: 0x1f507980eece328bff7b118e820865d6
            },
            u256 {
                low: 0x4a84eb038d1fd9b74d2b9deb1beb3711, high: 0x154bc8ce8c25166a1ff39849b4e1357d
            },
            u256 {
                low: 0x3405095c8a5006c1ec188efbd080e66e, high: 0x2305d1699a6a5f92cca74147f6be1f72
            },
            u256 {
                low: 0x1775336d71eacd0549a3e80e966e1277, high: 0x144a7edf6288e1a5cc45782198a6416d
            },
            u256 {
                low: 0x2f1205544a5308cc3dfabc08935ddd72, high: 0x21c38572fcd81b5d24bace4307bf326
            },
            u256 {
                low: 0x42930b33a81ad477fb3675b89cdeb3e6, high: 0x2b70369e16febaa011af923d79fdef7c
            },
            u256 {
                low: 0x2648ee38e07405eb215663abc1f254b8, high: 0x522c9d6d7ab792809e469e6ec62b2c8
            },
            u256 {
                low: 0x85940927468ff53d864a7a50b48d73f1, high: 0xdc5dba1d977e9933c49d76fcfc6e625
            },
            u256 {
                low: 0xd344749096fd35d0adf20806e5214606, high: 0x119d0dd09466e4726b5f5241f323ca74
            },
            u256 {
                low: 0x5306f3f5151665705b7c709acb175a5a, high: 0x2592a1c37c879b741d878f9f9cdf5a86
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 0
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x2f70823545198bb774dfb985,
                    limb1: 0x363546466fd4c023b72f21aa,
                    limb2: 0x2c5558596fa0905f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x50096f8b9d63643890d31c51,
                    limb1: 0x9e514bcb711d8e6edd2033e2,
                    limb2: 0x1436325ffa32a10,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_BN254_12P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0xc3a31070a7d9ebd554d3a065,
                    limb1: 0xb9109b898885a0dc6fad5069,
                    limb2: 0x1078e59157543192,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x2f84df2e544b7106b7650ad5,
                    limb1: 0xfbe6bc68eb7b3ce9d0921d3a,
                    limb2: 0x1b6201f18ce1978b,
                    limb3: 0x0
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0x69e5b9c91819ad621d92f585,
                    limb1: 0x1f4dce0d4ef79a593fca55f5,
                    limb2: 0x2ab6b6fdf389efe1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc5045bbf844632ca4df04976,
                    limb1: 0xbffb033e8ec5f6c914bf9cee,
                    limb2: 0x2bde1f40aae349c3,
                    limb3: 0x0
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0x160c2a4f26366c842c4fbc30,
                    limb1: 0x721ae82df8c46c7080ac4d92,
                    limb2: 0x21f7cd237e1c9b32,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x2fd1353df407c3cde1804d5b,
                    limb1: 0x1e4a97ad0ea11589cde85f6a,
                    limb2: 0xf143fae3f3561cd,
                    limb3: 0x0
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xb95f81f4e13405aa0571165,
                        limb1: 0x1c81d932d87c4e115a735fd8,
                        limb2: 0x1b74ca8306d5ac38,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x885b335eefdfc50eff7a195a,
                        limb1: 0x94265e433fc80493bba4214c,
                        limb2: 0x259952bb1ed721d8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x94e779d1a8e2423f608195f4,
                        limb1: 0x787515462f8ded557849191f,
                        limb2: 0x7da00b65e6e0300,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8fd9ee4eb57aef0e4f9625da,
                        limb1: 0x3de2bec7a320dccdbf54d5a1,
                        limb2: 0xedd69611675c0bd,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9d031ca3534b93437a3c001f,
                        limb1: 0xaa86c926f181e06971bde1e0,
                        limb2: 0xfa19bb593d31c37,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9b1a41665289d3da43673d46,
                        limb1: 0xb727e06ef34b4ba755d5e856,
                        limb2: 0x1ad721dd8f989986,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe16246e9652a3fbdb936f13e,
                        limb1: 0x4cde790b119a16ee13474969,
                        limb2: 0x23aae238bb30e240,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6da302d0c9043bb09ea9ef46,
                        limb1: 0x6872d4bc6bca1efd692971eb,
                        limb2: 0x21b6d4f6bd1dea79,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x37132d952a38939079c6938,
                        limb1: 0x46bc5b1fbc2cefa19bd75250,
                        limb2: 0x1f801bf2e05a7ff8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc12d55291fdf047b17eaeddf,
                        limb1: 0xb2525196fed81c2cea30a097,
                        limb2: 0x23720d6ba46915a0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd1516296c90aa394fae0a1ea,
                        limb1: 0xdc2822db40c0ac2ebe68ac4c,
                        limb2: 0x183227397098d014,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xfa3182ab129f6ec186fcd0f8,
                        limb1: 0x8666ee20857b440a69588a14,
                        limb2: 0x1c79fba0b768754e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8288d64e6265a2453e2a9f4f,
                        limb1: 0xd7f82c4c33f4641b4c71c2be,
                        limb2: 0x1e6936fd8a820254,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6d0000d951f0bbe3b1ade5f,
                        limb1: 0x18dd4d613b031e1523c2999f,
                        limb2: 0x2777a6c9eaa00af1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x89c3d3b49ea2e1440a57b089,
                        limb1: 0xb28cad30945b1fc19b7f5d86,
                        limb2: 0x58fe0cc1caf2797,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x21dae3ad3576eaaa655f15e6,
                        limb1: 0x8dda04ba3c3c7888797bd0bb,
                        limb2: 0xf979952888dfc1b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3fe945bef33e805cc800384,
                        limb1: 0xf48b10fde34ebaf3c6142bcf,
                        limb2: 0x1273493c2d17cf5f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9209e186c2e7486a7b4409,
                        limb1: 0x159e9b18e97ec18d2b805829,
                        limb2: 0x25f602a9d2ae89cb,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x15e14e2f438c9eb4180df481,
                        limb1: 0xda90261ab83388277d1a9f30,
                        limb2: 0x1e9fb164b1ca248f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc4e40eed9b71dcd6fa36657d,
                        limb1: 0x1607152f8768cde90cb1af77,
                        limb2: 0x19b333d580ff8379,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x847f2fc0496fe95160ce87ee,
                        limb1: 0x3219cb29b77df66c8eedd1bb,
                        limb2: 0x2f528617b9b1aab7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb50bf23ad3e665e67b453e4,
                        limb1: 0x2f48c7c38d1a8ad08a0a977e,
                        limb2: 0x1577ff908e92c3bc,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x7a6ff21d649c612b5caa9162,
                        limb1: 0x8208cac352a15d74e531d6ee,
                        limb2: 0x1fb11cd679fb5a7c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc21424865a665f4af292b9e7,
                        limb1: 0xb3fcaf43689de111e9dad5ef,
                        limb2: 0x1877f5217fb24cf8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf369487e6af636ae3217886,
                        limb1: 0x88d9107cb8520037b9060cad,
                        limb2: 0x1ed887e070ff81ab,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5a22b2d11f730eb410d07710,
                        limb1: 0x8910f4c40cbfc67634b31637,
                        limb2: 0xbe0d711fdac2124,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x35733f6ff4b2bb775ae8449c,
                        limb1: 0xecace5479e58e64a95289d5a,
                        limb2: 0x1c12af3e5a428106,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x50e4df72500b8a6994300b9,
                        limb1: 0xbeae4d1ee6034e8968154149,
                        limb2: 0xe5209ba548c476c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x77b636ccf2c889dfd0c4ed8f,
                        limb1: 0xb5af465a2791a64d01daba33,
                        limb2: 0x1cc5c480476fae19,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x76a10979887d8ce6d3b12a55,
                        limb1: 0x578f4340965b518d44b0f7f5,
                        limb2: 0x579d31c477f5ed0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7be5d18d08aafbcf57abf255,
                        limb1: 0x84e46bc3f95ba3dcd0905e5b,
                        limb2: 0xefc3612e9310f0e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x64514336e3131f9b757fafe7,
                        limb1: 0x4fdf545953c9c050282983d3,
                        limb2: 0x241f97c60a0e3303,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x76bd68065df92bae9f994cac,
                        limb1: 0xa5de01573f6387d7ef92b45f,
                        limb2: 0x1bd1a29a82218eba,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdd10713dea26661d1299904e,
                        limb1: 0xae8df69a8b5aac0fc77b8b1d,
                        limb2: 0x3a5804b32eb140b,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x8622bd73fbbdc02dbc7975a1,
                        limb1: 0xdae484ab0ef073c1a48833ad,
                        limb2: 0x2509a46f4507bfc1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1f28b85deb105ab8e202e0a6,
                        limb1: 0xcf983f2e1a5bd3f44dd3ddaa,
                        limb2: 0x2ad75685be5466d4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x438c6b0e471c0b0d0056a08f,
                        limb1: 0xd9f75cb6ae06a9843c44f7ba,
                        limb2: 0x159e5777fd7ce07f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x977cfdc8ee88128da603e293,
                        limb1: 0x9e0cf5b2428ca34f3bd6a2a8,
                        limb2: 0x2d299e050d75ec15,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7fa7b6c8c6a9d62d95cae3ba,
                        limb1: 0xc935f4c4672875572163ca5e,
                        limb2: 0x1ccbb48242fa567d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xaa59f294269a37b8c81deba4,
                        limb1: 0x3e2e3aa4636df692de7db27a,
                        limb2: 0x2e6d340b90b5d8e7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xba965c3ebaaa7eef98cf8216,
                        limb1: 0x82c7f30e4dd4b3adeefd90de,
                        limb2: 0x16a94be3d25784a5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x929b392087dbae98fc8ef8db,
                        limb1: 0xace9eb9d61d46043c1c8d928,
                        limb2: 0xaae109adb892977,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xea38f6978568f273e2a636b4,
                        limb1: 0x7e500ad5f807cc5154a7cfa4,
                        limb2: 0x2f289649cee4b9a1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x54ba397aaeb0fef8036fe3fe,
                        limb1: 0x82fb2b728b749bba11c58da7,
                        limb2: 0x22c0a9985c2ea973,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xcf61c10d0f2745b876adf2e6,
                        limb1: 0xb01a37aede01d03b83b8fb18,
                        limb2: 0x2ea361a37c50cf9a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc4e40eed9b71dcd6fa366580,
                        limb1: 0x1607152f8768cde90cb1af77,
                        limb2: 0x19b333d580ff8379,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x847f2fc0496fe95160ce87ee,
                        limb1: 0x3219cb29b77df66c8eedd1bb,
                        limb2: 0x2f528617b9b1aab7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb50bf23ad3e665e67b453e4,
                        limb1: 0x2f48c7c38d1a8ad08a0a977e,
                        limb2: 0x1577ff908e92c3bc,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x7897cc0392ecb950a7715a16,
                        limb1: 0xd73e274b8be8fa9510703f2e,
                        limb2: 0x13eafd9ae8969d07,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x438217de774981e52a6e8a95,
                        limb1: 0x6a1f31a6f157a781db3292a0,
                        limb2: 0x283bf68297ea344f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3b567da8c0d99e534bf80faa,
                        limb1: 0x2d35f323a3635dc07c9a8562,
                        limb2: 0x22ce30bf4374ac3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe952e2ae4287ca0c42c3004b,
                        limb1: 0xb7635876f1b03acd2bb49540,
                        limb2: 0x285c6d1e086d03d8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb3d172bef8c90e022f336d4a,
                        limb1: 0x7993fdbac2068a9004f65f26,
                        limb2: 0x181d28c9f78e5dfe,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe324fa7b50baacb832c04b81,
                        limb1: 0x67c5a5f01ae47ea471ea54c2,
                        limb2: 0x187495c2b3184384,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa8ab905c4b380119b7d589e,
                        limb1: 0x854bd920dbc0f7bb257e92ed,
                        limb2: 0x19441a144d1d3ae4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x474fdccaeb14f4ea88a2ab08,
                        limb1: 0xb06cccf589e4ee4c66e0b16d,
                        limb2: 0x1d39099f307ee61,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdf0973416012add80a9ae435,
                        limb1: 0x3b2d5e21de200d877ce16608,
                        limb2: 0xd1338fc7db34063,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1b762cfb9d0f3b994d829fc7,
                        limb1: 0x5308f84b2ce24be08cb4683b,
                        limb2: 0x2fed65f62cda7e65,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x55c9306a8ec3b769804e83f1,
                        limb1: 0xdc2822db40c0ac2e897197c3,
                        limb2: 0x183227397098d014,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xdb73ae4a60e1a6a4074531a9,
                        limb1: 0xeefc8c313b234f312001ba74,
                        limb2: 0x1a142219c78d92d0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x74a35598c8b994cea69f10e6,
                        limb1: 0x7e6856449829c49768aabdf6,
                        limb2: 0xba7e07a301fb282,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1b9a4a6ee3aab30f7264022e,
                        limb1: 0x7a764d753a99bfe18e6fb51d,
                        limb2: 0x1ead550c372faa27,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2f1c2d9bc5e2e012699f7046,
                        limb1: 0xe33732d80d87251a5cb5bc90,
                        limb2: 0x28ff13818abe15fb,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb068e98b6ee9d99bf6da81f8,
                        limb1: 0x24ae2f875cff92beb014eb0b,
                        limb2: 0x1c885bf2c81abcdc,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x80ce8786db89b0cdf5955bf9,
                        limb1: 0x7bfe651e9564b4369f542167,
                        limb2: 0x2f314fe4d688082d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x617053085bad11a83b9c72d2,
                        limb1: 0xdb4fe1c44233084ac0295003,
                        limb2: 0x1daff55b1d6964ab,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x33d29744d0bd359247a62949,
                        limb1: 0x9a776ab516549b2a8caef47c,
                        limb2: 0x153dc7d699a74cc6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x497921b6baf2babcfb53b0cb,
                        limb1: 0x3882933844ef1f2ccaaa6053,
                        limb2: 0x29a283b646b47124,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8f835ff6daa8ffb5373d57c6,
                        limb1: 0xd26d9a1ea07eb6dd6019d31c,
                        limb2: 0x85b797781fa9673,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xcd7fe058791f30e87771fc0b,
                        limb1: 0x815bdaf64829e9b1516efc83,
                        limb2: 0x2b9e7c96d38ea597,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x5c95f2af627e2a7982173540,
                        limb1: 0x8bf0d0da3c1df8afbe5ef847,
                        limb2: 0x1275b01eb092b92c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8d616f473704e4526821fb5a,
                        limb1: 0xde7f025f1b994cce5f11d359,
                        limb2: 0x612a452c99cd177,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb81216aa78d2b1c13512333e,
                        limb1: 0x40b7743aec32f1e0fb10dc5c,
                        limb2: 0x2ad62f4c83b20321,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf54101662133b7252b7f7b5d,
                        limb1: 0xb6fe6ef00d01dcba829bbd47,
                        limb2: 0x111973ec4b54ae76,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x766fdbe996015136457cf1eb,
                        limb1: 0x3a05cae75f9b296b3a6cb2,
                        limb2: 0x18e542a536a9d2bb,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8614291722cd156484189686,
                        limb1: 0x42813dc57ed0b21e0b191357,
                        limb2: 0x12991cc350b7717c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x135ef8f3685d6bd6d0e9fadb,
                        limb1: 0xbe1266ef39ece19e473337cb,
                        limb2: 0xb87be877f643a23,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9ec7b8f586e9b26542762aea,
                        limb1: 0x283e17684b959743424b7d6b,
                        limb2: 0x28e6b96360b4db24,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xcb6cc301745cc33c9d874b4d,
                        limb1: 0x1362173234480a5efdfe9283,
                        limb2: 0x199ec7c310204a50,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb4195117ca769e064668ac37,
                        limb1: 0xdba59c21fbb92c136609ced3,
                        limb2: 0x26ee5eac5cbf7d9a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1892a064f412affcf385aafa,
                        limb1: 0x95adb767c37b6a5eadfd4370,
                        limb2: 0x2d637d14799eb58b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x42677ad310398901ab5d95f2,
                        limb1: 0xf23dcfdc03090f5bcb552ffb,
                        limb2: 0x1a5efbbfed0fd089,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x29e94051e68467d53d5297b4,
                        limb1: 0x14a55edd2fe89535c883c4cd,
                        limb2: 0x1dd817da75771849,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5dea00ca5a2cbe6bf3dd32b2,
                        limb1: 0x7b3902cdc87d4dc63a0039e3,
                        limb2: 0x22f7a16e905f1787,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xea5d14bf6edf8d177eaf0943,
                        limb1: 0xb712a2a92e4be74713cdb4c5,
                        limb2: 0x2ba3b0b1c45d5e4c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2f72d775fe28a296baac8aa6,
                        limb1: 0x6fb15395df34b5676f9eb071,
                        limb2: 0x3e47145c432f447,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb4fa7d209d360974da349c40,
                        limb1: 0x7bd2596dac25cc1849e6a9f6,
                        limb2: 0x78576cc60ca8c3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x64b0815bc1e62134c9ad1e44,
                        limb1: 0xc580abad7643d36ca5e7d99f,
                        limb2: 0x1b1459621732e232,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8289919a60a8fcdd6b7ace2e,
                        limb1: 0x4864cb7d11d8d3f6e2ed777,
                        limb2: 0x214656ad209703ac,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe36ee4cca500ee3bf550008c,
                        limb1: 0x3bc429f01e7c0be0bea05dee,
                        limb2: 0x2bdd6503b3df0306,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x23e48d0358003cc05e197685,
                        limb1: 0xfc954da3dfae08a438cf02ad,
                        limb2: 0x1aebefaf07107b1c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa788a85faf8784b108d77cdd,
                        limb1: 0x9a486a69a22dd48548f55ec7,
                        limb2: 0x65e134ec22787dd,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x62fcd8a687b9240724852595,
                        limb1: 0xf59a2a746a4e4f25ba77aa53,
                        limb2: 0x6ec524270be5d0f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x497921b6baf2babcfb53b0ce,
                        limb1: 0x3882933844ef1f2ccaaa6053,
                        limb2: 0x29a283b646b47124,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8f835ff6daa8ffb5373d57c6,
                        limb1: 0xd26d9a1ea07eb6dd6019d31c,
                        limb2: 0x85b797781fa9673,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xcd7fe058791f30e87771fc0b,
                        limb1: 0x815bdaf64829e9b1516efc83,
                        limb2: 0x2b9e7c96d38ea597,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x34960deb50c0fa37053c16e5,
                        limb1: 0x53d79c5320363dad57726b03,
                        limb2: 0x1793e1d42c073be,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8bbd8e60fc1a1859e888a509,
                        limb1: 0xdc2822db40c0ac2e47c7fadc,
                        limb2: 0x183227397098d014,
                        limb3: 0x0
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x9b6370bd9d3637f4ec5f88e6,
                        limb1: 0x20f2ea49b8e005cc4dc13e85,
                        limb2: 0x192fd65befe51499,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x50f1b10239f0fe47671748d9,
                        limb1: 0xdf37d531bb46a9f16e8c319b,
                        limb2: 0x141a18c450bcb53f,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x1c0c62232c450cceb70e9210,
                        limb1: 0x862a3a2be0c83b96aed2de18,
                        limb2: 0x26bc33083894982,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x111bdbebbe963bd7c14fe224,
                        limb1: 0x18a1c5b4146d5a17a24245d7,
                        limb2: 0xc564d6129880355,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x98e1badacf322b09be985336,
                        limb1: 0x867b924cf6c9c3124e805e00,
                        limb2: 0x183dcd843ebca7d3,
                        limb3: 0x0
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x69b887ab9b821bc7eca19d6b,
                        limb1: 0xaa887926a91eb90751c250ff,
                        limb2: 0x1b2b34a0ee7d9da1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8a63487971b26ebf5cc8dd44,
                        limb1: 0xe55739deb052a576b4232a40,
                        limb2: 0xbe9fbda11047f95,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 {
                        limb0: 0x9b6370bd9d3637f4ec5f88e6,
                        limb1: 0x20f2ea49b8e005cc4dc13e85,
                        limb2: 0x192fd65befe51499,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x50f1b10239f0fe47671748d9,
                        limb1: 0xdf37d531bb46a9f16e8c319b,
                        limb2: 0x141a18c450bcb53f,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x9915c58aa0fb5257eb3afb54,
                limb1: 0x6ccdbc91d623d69be392ba2f,
                limb2: 0x1106e955f0f1d926,
                limb3: 0x0
            },
            g_rhs_sqrt: array![
                u384 {
                    limb0: 0x86185523edb93e00ac576cbf,
                    limb1: 0x408efb5b0f67c1a95023b14a,
                    limb2: 0x68068eaaf3e51cc,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x824603b580029c393c9986c7,
                    limb1: 0x318d6be459e117ebf2a78e6,
                    limb2: 0x2d9f28946605cf4,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9f962603c670b2be55b42855,
                    limb1: 0xe2b90d5a935157a2801679c,
                    limb2: 0x65348ee600307bb,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf0b34d2a68ed4fc3e4174657,
                    limb1: 0x2a976f51fd4bf27c82e60bcc,
                    limb2: 0x17da0d2c1a6cce02,
                    limb3: 0x0
                }
            ]
                .span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x5c724369afbc772d02aed58e,
                    limb1: 0x2cd3bc838c66439a3d6160b,
                    limb2: 0x72f26b55fb56be1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x772ca79c580e121ca148fe75,
                    limb1: 0xce2f55e418ca01b3d6d1014b,
                    limb2: 0x2884b1dc4e84e30f,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x536c985db33c69f7c242e07a,
                    limb1: 0xfc531bccffafcf1e59d91fb9,
                    limb2: 0x2585e4f8a31664cb,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x57fa42444057cf0c1d62ae3c,
                    limb1: 0x4f48d341183118d68ea41313,
                    limb2: 0x1d2d2799db056ed1,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x236ca9312dad3661a37f2d6f,
                    limb1: 0x98424c01caad7592315715d1,
                    limb2: 0x795b9fd941b23c4,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc7ab5834609a54b8993ffd79,
                    limb1: 0xe81cd490528b814ca632aace,
                    limb2: 0x2d9ff53d3009e6f7,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x163df40cafbf585ca5b2ab44,
                    limb1: 0xb4752e4666c88dbbe23783a0,
                    limb2: 0x1a801462ac9cb657,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xac9b557d7ca8625d957263c6,
                    limb1: 0xdc6f75fa8339a78b998ae54a,
                    limb2: 0x28683293b6494d9f,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x5c4f5dca0c973b7f70bfff9,
                    limb1: 0x188c2afab11eef5d48ecda3c,
                    limb2: 0xc2fed35d36c49f1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x9d7244ea10697ca42e2e066b,
                    limb1: 0xfe18a519c7d68770dc48dbf9,
                    limb2: 0x149bb528db998529,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xffc057151b06c496e6fdd440,
                    limb1: 0x5a01bae0c7441f08c7af1cf9,
                    limb2: 0x274e0e02529e6d26,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x65ceb8977413bc9798681ecb,
                    limb1: 0x19ffb287b45234f0c28fd1a7,
                    limb2: 0x28dbbd2f9267be76,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xcfcdbfdb2056ff1a64bf1d47,
                    limb1: 0xf26fe2dae9f693d9b4aab2e6,
                    limb2: 0x12d66ad4802d841e,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xe6e34ebfa2e18dce86cadbdc,
                    limb1: 0x7ce096238b3d4b1b8fba6a55,
                    limb2: 0x2e0a660b1549800c,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xd2dd03b29d58d045656ecf33,
                    limb1: 0xeddac3cf7a123aae2180739b,
                    limb2: 0x215bec6e0a03c924,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xe5201e51828eb11589d8619f,
                    limb1: 0xa6563c760aa3a2c9d15af235,
                    limb2: 0x7ed0c9b2e7811fb,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xc33ac21c67b06a9994457b4c,
                    limb1: 0xa9aa5573bf7a92aab85366eb,
                    limb2: 0x1a407281e1d92e91,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x5a306649d971b115d71a78b1,
                    limb1: 0xa70687a9b5132e26b2cfbb37,
                    limb2: 0x2031920af5d6c9db,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x58a3cea1103f16402eb74c08,
                    limb1: 0xdfefcd91df2f4295ec21e03a,
                    limb2: 0x1150bcc09ac40007,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x57ed7d356f91abcef751889f,
                    limb1: 0x5c668cded3599c9af5a7e5fa,
                    limb2: 0x2ccf74197cb9bc13,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x529118e291927516dfbcba2d,
                    limb1: 0x440af959472c61e99aac7977,
                    limb2: 0x218bbc79509b59ce,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x226044f7331ccf82af7afb39,
                    limb1: 0xc1953da25a89d084dcfaea76,
                    limb2: 0x1042fdc36b43dac3,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0x4a84eb038d1fd9b74d2b9deb1beb3711, high: 0x154bc8ce8c25166a1ff39849b4e1357d
            },
            u256 {
                low: 0x3405095c8a5006c1ec188efbd080e66e, high: 0x2305d1699a6a5f92cca74147f6be1f72
            },
            u256 {
                low: 0x1775336d71eacd0549a3e80e966e1277, high: 0x144a7edf6288e1a5cc45782198a6416d
            },
            u256 {
                low: 0x2f1205544a5308cc3dfabc08935ddd72, high: 0x21c38572fcd81b5d24bace4307bf326
            },
            u256 {
                low: 0x42930b33a81ad477fb3675b89cdeb3e6, high: 0x2b70369e16febaa011af923d79fdef7c
            },
            u256 {
                low: 0x2648ee38e07405eb215663abc1f254b8, high: 0x522c9d6d7ab792809e469e6ec62b2c8
            },
            u256 {
                low: 0x85940927468ff53d864a7a50b48d73f1, high: 0xdc5dba1d977e9933c49d76fcfc6e625
            },
            u256 {
                low: 0xd344749096fd35d0adf20806e5214606, high: 0x119d0dd09466e4726b5f5241f323ca74
            },
            u256 {
                low: 0x5306f3f5151665705b7c709acb175a5a, high: 0x2592a1c37c879b741d878f9f9cdf5a86
            },
            u256 {
                low: 0x30bcab0ed857010255d44936a1515607, high: 0x1158af9fbb42e0b20426465e3e37952d
            },
            u256 {
                low: 0x5f3f563838701a14b490b6081dfc8352, high: 0x1b45bb86552116dd2ba4b180cb69ca38
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 0
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x5c3a06447a0996b0a92f9931,
                    limb1: 0xbe6a2eedc8ef87e71e9ec66f,
                    limb2: 0x226eea38486e086b,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc880fabdc7f0d4cc409b1a40,
                    limb1: 0x14008cf49435dbd34779e8,
                    limb2: 0x2fd9b0fb62c9320e,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_BLS12_381_1P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high_shifted: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x933cf0c20f38001183ed9df6,
                limb1: 0xcb294eff7864b62ddb3adf3d,
                limb2: 0xe7801e5dd2b70de9e4b1af57,
                limb3: 0x4b3b4eaca402c3b711f869b
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![u256 { low: 0x0, high: 0x0 },].span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 1
        );
        assert!(
            res == G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            }
        );
    }


    #[test]
    fn test_msm_BLS12_381_2P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high_shifted: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0xbd7c0a86fc43972d8b51dd60,
                limb1: 0xcfceb99ca4a950898233fc8c,
                limb2: 0x830b2ea5189bbb6905ef8511,
                limb3: 0x1a2bb55cd901d35f38f4ff5
            },
            g_rhs_sqrt: array![
                u384 {
                    limb0: 0x4f4fd082399091404d2f02a7,
                    limb1: 0x81d93e4dc28e48b38d24fa0a,
                    limb2: 0xcc9039d4ba7ae8849e2f2064,
                    limb3: 0x680f0068cb18a987654e66b
                }
            ]
                .span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xe4f817e54aede0613c17035c,
                    limb1: 0xdff1f15010392a6da1f95a6,
                    limb2: 0xbed78d3d341e911d49f15454,
                    limb3: 0x18154782ce0913b21588066d
                },
                y: u384 {
                    limb0: 0x3d77d61326ef5a9a5a681757,
                    limb1: 0xd3070afd4f0e121de7fcee60,
                    limb2: 0xdf9ef4088763fe611fb85858,
                    limb3: 0x11a612bdd0bc09562856a70
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0xb4862b21fb97d43588561712e8e5216a, high: 0x12cfa194e6f4590b9a164106cf6a659e
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 1
        );
        assert!(
            res == G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            }
        );
    }


    #[test]
    fn test_msm_BLS12_381_3P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0xf6a31a9a41fd0378150dc360,
                    limb1: 0x7a355df87079a4cf4c78fd36,
                    limb2: 0xbd92b81f9f87a14ded17256e,
                    limb3: 0x1259b26908470ad4f6be037c
                },
                y: u384 {
                    limb0: 0xfbe2abbd7e05b561703438fe,
                    limb1: 0x892d1cc404bcc0c000d206cf,
                    limb2: 0x962b60138682dd48428b2a8d,
                    limb3: 0xa68b20ba71d8fde199d485b
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0x7c866be61fbaed5ef7d1122e,
                    limb1: 0x7fed89acb87ce49d38175a6f,
                    limb2: 0x30dbb6ee5876fa6873045668,
                    limb3: 0x60c4285948cc11859881060
                },
                y: u384 {
                    limb0: 0x5a931aaa036da6ee08c49738,
                    limb1: 0x1c92b3a560ce474174cfa275,
                    limb2: 0xa4f783dad6c9da34040c6553,
                    limb3: 0x8d9752128e5b2be6254e2b
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0x663acbe46ab1edf9e0302ddb,
                    limb1: 0x133eafb6b82660d39354a91b,
                    limb2: 0xec9146f8b18f4ccfa8f938e,
                    limb3: 0x1127139158d2558af3ede6c1
                },
                y: u384 {
                    limb0: 0x2e2dc7b89be127d3eee7e15f,
                    limb1: 0xb9b688b1096640c721587415,
                    limb2: 0xd09f1d870e1c2d4e08674d2b,
                    limb3: 0x12308a0685f2c08876496459
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x7bc762e158a515b52d821792,
                        limb1: 0x6ecca75faa6f0257a0026f0,
                        limb2: 0x54035e714db9d186af76bd14,
                        limb3: 0x6741a842e9567e705af8ef4
                    },
                    u384 {
                        limb0: 0x9ec40380b66ab9738c60bfa9,
                        limb1: 0x6730d2a0f6b0f62410c653ec,
                        limb2: 0x434bacd764774b84f38512bf,
                        limb3: 0x1a0111ea397fe69a4b1ba7b6
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x72e3a1aba373f660d9374982,
                        limb1: 0x7f6c533e38820545e6743293,
                        limb2: 0x4a14d7b2c73830dd1036e44b,
                        limb3: 0x163220ef11c45701b870d3ce
                    },
                    u384 {
                        limb0: 0x5e1fef3acc783347caf29623,
                        limb1: 0xb8764fb1d07b13e339cae211,
                        limb2: 0xeccab81b7e73d7d6d7d92107,
                        limb3: 0x114aa51d9c7f621b2257782d
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xc777357daa6aa6c4ebef18c7,
                        limb1: 0x80736b12a17997bf6e675de5,
                        limb2: 0x7695e787d8535cdeb6df21c3,
                        limb3: 0x45a863fbf06f8c4f9075629
                    },
                    u384 {
                        limb0: 0x9d9a9c620cf8011b609cd9bf,
                        limb1: 0x5e601cc474976cd361c63721,
                        limb2: 0xdc45e17f1a6a0e748a8474a5,
                        limb3: 0x70bdc9e64717c3a0bd18e8b
                    },
                    u384 {
                        limb0: 0xe99ceeb08e413423167a42d6,
                        limb1: 0xbbb460d6a22df80bf24d7d86,
                        limb2: 0xe8dbed95ff300f747a6b6edb,
                        limb3: 0xc798d1b717ca47003bdda9e
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xb79286af5fd2d98364de2607,
                        limb1: 0xc81ed515fdf532ab3dccca51,
                        limb2: 0x5e705844ef7ae0e5664c58ef,
                        limb3: 0xac54dfd9a91a83800705816
                    },
                    u384 {
                        limb0: 0x15d7bcebbde2cd1f2bcb0336,
                        limb1: 0x13779985548a6344a9d38848,
                        limb2: 0x2c9386bf30e0c851785a5ea0,
                        limb3: 0x112870a1fefdbb37f326914b
                    },
                    u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 {
                        limb0: 0x72e3a1aba373f660d9374982,
                        limb1: 0x7f6c533e38820545e6743293,
                        limb2: 0x4a14d7b2c73830dd1036e44b,
                        limb3: 0x163220ef11c45701b870d3ce
                    },
                    u384 {
                        limb0: 0x5e1fef3acc783347caf29623,
                        limb1: 0xb8764fb1d07b13e339cae211,
                        limb2: 0xeccab81b7e73d7d6d7d92107,
                        limb3: 0x114aa51d9c7f621b2257782d
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x5019495f08aacfea0142907a,
                        limb1: 0x5c6c84c98c4bdbff212b9f6f,
                        limb2: 0x74629b821dc449cf706989ca,
                        limb3: 0xd852403077491f348815589
                    },
                    u384 {
                        limb0: 0x515834b7b494091d02ac60ea,
                        limb1: 0xb39869507b587b11fb48a4ec,
                        limb2: 0x21a5d66bb23ba5c279c2895f,
                        limb3: 0xd0088f51cbff34d258dd3db
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x212dea0ff4fe177f1e0b0298,
                        limb1: 0x9f459b636eadb91eead4e97a,
                        limb2: 0x75eb15d611e1fb6bff9b473f,
                        limb3: 0x531c91c12c79d937ef79a92
                    },
                    u384 {
                        limb0: 0x26e89def34bb4960e82f9caa,
                        limb1: 0x4b8d515c91c6ddf12f8084da,
                        limb2: 0x36360c75610d33375e66dd4e,
                        limb3: 0x3970316d6b9c53d7471c394
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xce3933f42d6e07280a6555fd,
                        limb1: 0xcf6637cf3132966601952da7,
                        limb2: 0x1ba13bcd292f9580d238e4d5,
                        limb3: 0x55cb80b014630f65d21697c
                    },
                    u384 {
                        limb0: 0xec23d12308aea492320ab446,
                        limb1: 0xc547fbcf9c08f7a7b20a2f31,
                        limb2: 0x56f288207b6283a0c20629d3,
                        limb3: 0xb6493b88317b20ee1743bea
                    },
                    u384 {
                        limb0: 0x668633e5546177aa7d419d1a,
                        limb1: 0x6c68d1c1d2a25741cfd4c2df,
                        limb2: 0x1d5ec99fa64509524c49a8da,
                        limb3: 0xc601a6fda782877abd32782
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x84b7a83fd3f85dfc782c0a60,
                        limb1: 0x7d166d8dbab6e47bab53a5e8,
                        limb2: 0xd7ac57584787edaffe6d1cfe,
                        limb3: 0x14c724704b1e764dfbde6a49
                    },
                    u384 {
                        limb0: 0x9ba277bcd2ed2583a0be72a8,
                        limb1: 0x2e354572471b77c4be021368,
                        limb2: 0xd8d831d58434ccdd799b7539,
                        limb3: 0xe5c0c5b5ae714f5d1c70e50
                    },
                    u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 {
                        limb0: 0x212dea0ff4fe177f1e0b0298,
                        limb1: 0x9f459b636eadb91eead4e97a,
                        limb2: 0x75eb15d611e1fb6bff9b473f,
                        limb3: 0x531c91c12c79d937ef79a92
                    },
                    u384 {
                        limb0: 0x26e89def34bb4960e82f9caa,
                        limb1: 0x4b8d515c91c6ddf12f8084da,
                        limb2: 0x36360c75610d33375e66dd4e,
                        limb3: 0x3970316d6b9c53d7471c394
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x6768b46c349823ba55a416a1,
                        limb1: 0xce708c87c4ab529d7c4d4b51,
                        limb2: 0xc5de7d14d5274f9a7ec5131f,
                        limb3: 0x168d4b5ae1a7125dead907dc
                    },
                    u384 {
                        limb0: 0x302ea91a3b09524e7c49fbbb,
                        limb1: 0xb39869507b587b118b5d4593,
                        limb2: 0x21a5d66bb23ba5c279c2895f,
                        limb3: 0xd0088f51cbff34d258dd3db
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xbf233d2aee64158f2f91c838,
                        limb1: 0x3e0a4923172718281a48731d,
                        limb2: 0xbc29b375d5e4cf55bd898b0d,
                        limb3: 0xb2f255db19d2e8ee63ed7d
                    },
                    u384 {
                        limb0: 0xce92c8352f9224a727fe6aa2,
                        limb1: 0xd404993d860db0b3533ffc73,
                        limb2: 0x3a6e17980e75c4f85f128c8,
                        limb3: 0x2cdbbd34c20cff6fda5b095
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x5ed0334bc9993edb772b4442,
                        limb1: 0xd1c7bd63bc34515b01d4caae,
                        limb2: 0xb0d2ecc1d9a3f1d218d774ce,
                        limb3: 0xd5fb4713c434613fb837abd
                    },
                    u384 {
                        limb0: 0xf4156ff70f76f3b687c6eaf2,
                        limb1: 0x32d6c654ecc59021cc0fef3,
                        limb2: 0x45a693b73a054e74944cce5f,
                        limb3: 0xd189e878386807a0d2a27c7
                    },
                    u384 {
                        limb0: 0xc43d5cbf1370cafe7a75939d,
                        limb1: 0x9836263aaf4f3f064d1a1e83,
                        limb2: 0x9eaa6b8c07a5bbf633e387f7,
                        limb3: 0x5c57abc959b5cbb96eb1ecb
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xfc8cf4abb990563cbe4720e0,
                        limb1: 0xf829248c5c9c60a06921cc76,
                        limb2: 0xf0a6cdd757933d56f6262c34,
                        limb3: 0x2cbc9576c674ba3b98fb5f6
                    },
                    u384 {
                        limb0: 0x3a4b20d4be48929c9ff9aa88,
                        limb1: 0x501264f61836c2cd4cfff1cf,
                        limb2: 0xe9b85e6039d713e17c4a323,
                        limb3: 0xb36ef4d30833fdbf696c254
                    },
                    u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 {
                        limb0: 0xbf233d2aee64158f2f91c838,
                        limb1: 0x3e0a4923172718281a48731d,
                        limb2: 0xbc29b375d5e4cf55bd898b0d,
                        limb3: 0xb2f255db19d2e8ee63ed7d
                    },
                    u384 {
                        limb0: 0xce92c8352f9224a727fe6aa2,
                        limb1: 0xd404993d860db0b3533ffc73,
                        limb2: 0x3a6e17980e75c4f85f128c8,
                        limb3: 0x2cdbbd34c20cff6fda5b095
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x7de11bb33af7b669d3eea385,
                limb1: 0xf050e2b3645c76f4021a9145,
                limb2: 0xbb5dafe124843cb2bf90ab58,
                limb3: 0x83df3d15b1ef9fb0abffd31
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xe4f817e54aede0613c17035c,
                    limb1: 0xdff1f15010392a6da1f95a6,
                    limb2: 0xbed78d3d341e911d49f15454,
                    limb3: 0x18154782ce0913b21588066d
                },
                y: u384 {
                    limb0: 0x3d77d61326ef5a9a5a681757,
                    limb1: 0xd3070afd4f0e121de7fcee60,
                    limb2: 0xdf9ef4088763fe611fb85858,
                    limb3: 0x11a612bdd0bc09562856a70
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xde4f62a6588c9401ffefbd3,
                    limb1: 0x9bb5f797ac6d3395b71420b5,
                    limb2: 0xdc39e973aaf31de52219df08,
                    limb3: 0x105dcc4dce3960447d21d3c1
                },
                y: u384 {
                    limb0: 0xaefd0d854043fd325dd3c34f,
                    limb1: 0x9b63c98d9a7845c52e1e2b0f,
                    limb2: 0x9db0be660d847ccc58358f3f,
                    limb3: 0x17cb6c41f0c4e1a7394ab62a
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0x12e0c8b2bad640fb19488dec4f65d4d9, high: 0x2a43e70faf19922ad9b8a714e61a441c
            },
            u256 {
                low: 0x5a92118719c78df48f4ff31e78de5857, high: 0x51f964df9c6316b950f244556f25e2a2
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 1
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x2b828af1f5fe30bbe7a1074a,
                    limb1: 0x5669beaa69827b52dc874c9f,
                    limb2: 0x648af2c24d82a5a758c96b8e,
                    limb3: 0x188bc245620ae6b6afec9dc3
                },
                y: u384 {
                    limb0: 0xdc96192f803ef92f56d59758,
                    limb1: 0xfc6139925c05a030065d564,
                    limb2: 0xb24447300bec56efec94dcf4,
                    limb3: 0x156f97e5d31055c0a5fe154d
                }
            }
        );
    }


    #[test]
    fn test_msm_BLS12_381_4P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0xcf5bc4cf513273a64b43540a,
                    limb1: 0x6613974b3587de6a0421a52b,
                    limb2: 0x9f11261324f0125289a51c4,
                    limb3: 0x90308470b416ca1aff0c5e3
                },
                y: u384 {
                    limb0: 0x3102ea48c94f20f4ccebc9c3,
                    limb1: 0x4d6ae4a26c0e0350d12814d5,
                    limb2: 0x2dc8ffb6c7db29c2dacd756a,
                    limb3: 0x9cf7dc9d86166897fb4c3ce
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0x36952716073ad3a0784c804b,
                    limb1: 0x925ddef3c85fe6d3a513b55f,
                    limb2: 0xd670ae77446cb42ba15c358,
                    limb3: 0x1164ae8fe1dc44c74a1279b
                },
                y: u384 {
                    limb0: 0x83e4d47d929ded88adf56ff5,
                    limb1: 0x45a6caccd5bc61c52fd977a9,
                    limb2: 0xf2c35142e28cb439cb9f42e8,
                    limb3: 0x6cdaf0c31bac5372c41228e
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0x36feccbcf8718c917cc04cd3,
                    limb1: 0x4f3ced9cd8d2f9e58751adaa,
                    limb2: 0xcf671555118dadc2f708f1ca,
                    limb3: 0x8619de3ffa219bbdfc07acc
                },
                y: u384 {
                    limb0: 0xfd78095a60ed4f6c2023e653,
                    limb1: 0x88a7c4412c34745f062cb8f1,
                    limb2: 0xdb50e0b5ab8899e15fcc908b,
                    limb3: 0x1419343e534a2c7643769e8
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x45b98cdd7ba62359feaa9a6e,
                        limb1: 0xc24aefac23a9faf002a724f1,
                        limb2: 0x55b785038331c5793e47ed32,
                        limb3: 0x7bf1b171c9abcc90c38fffd
                    },
                    u384 {
                        limb0: 0x33cec0bc6ee35213214e4609,
                        limb1: 0x81317eafb6b08750488be866,
                        limb2: 0x7edf4ad39875b59fb4accb75,
                        limb3: 0x9de0a94f406873c76bf7b41
                    },
                    u384 {
                        limb0: 0x60416bb07aa26060d453430d, limb1: 0x5302fc4c, limb2: 0x0, limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x3227c96ba469bf879b5871bb,
                        limb1: 0x1c3e60618214cb0ea9c2234f,
                        limb2: 0x23914f4977a4a34b2a16c107,
                        limb3: 0x1328417d029a5a71b288521a
                    },
                    u384 {
                        limb0: 0xd134d2d91d0a63d314877bc8,
                        limb1: 0x721dbe609fc7994b71a78baa,
                        limb2: 0xb29f44924459d9343c7ba5e8,
                        limb3: 0x1379f214ed93a33a27306c7d
                    },
                    u384 {
                        limb0: 0xb5e12f7b06b0afe1064ae9c2,
                        limb1: 0x6d2004386df3d2b0b7489006,
                        limb2: 0xeea8fbafea3577e1fd7d1252,
                        limb3: 0x9445b15a52b7806e35dfb80
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xdf34167093291aab063f9501,
                        limb1: 0x59c1ae271eac29b03d67fea0,
                        limb2: 0xcef6d2db0dfb0f275d24dcaf,
                        limb3: 0x70d686be1b51d317489e73e
                    },
                    u384 {
                        limb0: 0xfcfc007decd49dc2fb532ac4,
                        limb1: 0x36c3b610c81b133dad6b0c5c,
                        limb2: 0x76fb4c28acf9795dcc430ee3,
                        limb3: 0x6b2dac5e56e1f3e0b8c2cc1
                    },
                    u384 {
                        limb0: 0x57471f3fbdc331b1a7e9b8be,
                        limb1: 0x26850e4b97aca2cb6873bee7,
                        limb2: 0x6ed0d3dc0f306e9d8626fdac,
                        limb3: 0xb50da43c97733f161b7213c
                    },
                    u384 {
                        limb0: 0xdd5ba2d207af3eec498950c3,
                        limb1: 0x2b249f961be9a25514d2535d,
                        limb2: 0xf1552c988db8a645d8c2283d,
                        limb3: 0x508a5b51044ddfa52465dc5
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x65f725af1da8fe1e6d627196,
                        limb1: 0xa297dc441af13ff269b08d3f,
                        limb2: 0x7ade37715a3f622c150de9d,
                        limb3: 0x189ee21f97699c9233e9f8fc
                    },
                    u384 {
                        limb0: 0xe22b4b65002b8f4c521e99ca,
                        limb1: 0xfa15544091bc78e589462ead,
                        limb2: 0x43e5b89a4878cdc70ae47222,
                        limb3: 0x19e5a47f434ebfb4068a628a
                    },
                    u384 {
                        limb0: 0x2630bdec60c3bf84192bfc5d,
                        limb1: 0x4d4f3e40c11e549ebe76401c,
                        limb2: 0x775841e8445e9403026f368a,
                        limb3: 0xb105a6c5b2df981425c464d
                    },
                    u384 {
                        limb0: 0x3227c96ba469bf879b5871bf,
                        limb1: 0x1c3e60618214cb0ea9c2234f,
                        limb2: 0x23914f4977a4a34b2a16c107,
                        limb3: 0x1328417d029a5a71b288521a
                    },
                    u384 {
                        limb0: 0xd134d2d91d0a63d314877bc8,
                        limb1: 0x721dbe609fc7994b71a78baa,
                        limb2: 0xb29f44924459d9343c7ba5e8,
                        limb3: 0x1379f214ed93a33a27306c7d
                    },
                    u384 {
                        limb0: 0xb5e12f7b06b0afe1064ae9c2,
                        limb1: 0x6d2004386df3d2b0b7489006,
                        limb2: 0xeea8fbafea3577e1fd7d1252,
                        limb3: 0x9445b15a52b7806e35dfb80
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x4fdb7ea59c4b471160c8c50d,
                        limb1: 0x4b85ae0b0d5b49f76da2842b,
                        limb2: 0xc86025e96bbd751181f1983b,
                        limb3: 0x71fd1306ff4f3cb164c90b8
                    },
                    u384 {
                        limb0: 0xe44b9f16cb8a3fe997819a87,
                        limb1: 0x260952491d5b39a0d99d8c00,
                        limb2: 0xb696f723c62a6ade943f653a,
                        limb3: 0x52d53776b2cd0e52aec0cb4
                    },
                    u384 {
                        limb0: 0xc43f3b466f92c145a1ceac5d,
                        limb1: 0xb39869507b587b1261f8cad3,
                        limb2: 0x21a5d66bb23ba5c279c2895f,
                        limb3: 0xd0088f51cbff34d258dd3db
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xc399ea617993f4cafc42e4fa,
                        limb1: 0x5644e7262a5545d64787ed1c,
                        limb2: 0x5d115c7e4c4381b98abfb1ec,
                        limb3: 0x7bd41d32f3ff91a287a60e7
                    },
                    u384 {
                        limb0: 0x8f6d21aba032b60b549687a4,
                        limb1: 0xd1ead638677550cdb69f2c70,
                        limb2: 0xd4dcb745cb15ced6933071f5,
                        limb3: 0x156e8b94d0c435054616abaa
                    },
                    u384 {
                        limb0: 0x4ea7cd3450a84fe6d941bd81,
                        limb1: 0x40d5bc8fdb1bca4716567fd3,
                        limb2: 0xeb330329a83dadc46c01a0be,
                        limb3: 0x11311873b24f205c1ead99c8
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xf97802bf4065dceeb2309f86,
                        limb1: 0x16ce0e90f3e14ace88acf4d7,
                        limb2: 0x30da0de8377c8cd6c3559e81,
                        limb3: 0x86feb976d70b25674e36ef4
                    },
                    u384 {
                        limb0: 0xbd4255e141804a797fddaac0,
                        limb1: 0x999588dcef296780a5ea21f8,
                        limb2: 0xcad694975360de1f0e761834,
                        limb3: 0x6cb92857362b88060847cb3
                    },
                    u384 {
                        limb0: 0xb3ab6a1f8fed24c52e10a667,
                        limb1: 0x5ca515ee07e7035b4ef715d9,
                        limb2: 0xc78e4a0355d9a5a03d69c961,
                        limb3: 0x133a02539b2573657e8711c8
                    },
                    u384 {
                        limb0: 0x90b94d516254f95706647d55,
                        limb1: 0x798e1c6561759f8eceec747e,
                        limb2: 0xe3548568f1db4b7d84ffa740,
                        limb3: 0x15efd7e0c35ed001c7be76d5
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x5d13a9862c50d32bf10be93d,
                        limb1: 0xf1e2c9f7b2a42134ff73b474,
                        limb2: 0x30f9c521cc96bb613779b4f1,
                        limb3: 0x4f3f562837ffdce56cddbe7
                    },
                    u384 {
                        limb0: 0x29b886af52cdd82d525b1e8f,
                        limb1: 0x1218e0feb9c260ca7e78b1c6,
                        limb2: 0x898fd690fef158cb72328f99,
                        limb3: 0x7b6f894969120463707b788
                    },
                    u384 {
                        limb0: 0xd7f734d1cea33f9b6507a0ae,
                        limb1: 0x34f54cfd7f0d3cd41c01ff4f,
                        limb2: 0x2634b2f7d8082007c8fc5d7a,
                        limb3: 0x10c23dfa563cb43be47f17b7
                    },
                    u384 {
                        limb0: 0xc399ea617993f4cafc42e4fe,
                        limb1: 0x5644e7262a5545d64787ed1c,
                        limb2: 0x5d115c7e4c4381b98abfb1ec,
                        limb3: 0x7bd41d32f3ff91a287a60e7
                    },
                    u384 {
                        limb0: 0x8f6d21aba032b60b549687a4,
                        limb1: 0xd1ead638677550cdb69f2c70,
                        limb2: 0xd4dcb745cb15ced6933071f5,
                        limb3: 0x156e8b94d0c435054616abaa
                    },
                    u384 {
                        limb0: 0x4ea7cd3450a84fe6d941bd81,
                        limb1: 0x40d5bc8fdb1bca4716567fd3,
                        limb2: 0xeb330329a83dadc46c01a0be,
                        limb3: 0x11311873b24f205c1ead99c8
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x2e148677584394e905f4cedf,
                        limb1: 0x88d1548e4b7fd1f62222df68,
                        limb2: 0x2c31f16d8374d5ea530e5346,
                        limb3: 0x14ea6a97d6687a2bdc6722f
                    },
                    u384 {
                        limb0: 0x302ea91a3b09524e7c49fbbb,
                        limb1: 0xb39869507b587b118b5d4593,
                        limb2: 0x21a5d66bb23ba5c279c2895f,
                        limb3: 0xd0088f51cbff34d258dd3db
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xb5186478343fe7a850fc5f0e,
                        limb1: 0xf905683a0e05bef4de0b8d6c,
                        limb2: 0x32572e7a8296fd05d03deb4a,
                        limb3: 0x123fa6c250e4c33f98b2bfee
                    },
                    u384 {
                        limb0: 0x43c00c2cba529fce0af2dd8d,
                        limb1: 0x85960610557e156af2469cf5,
                        limb2: 0x667d8c9adea2d27f42665d9c,
                        limb3: 0x1089291d3bc00891f6ba054e
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xa34d2e36fa57d78149d2c139,
                        limb1: 0x28a171b4168a41f3c5a85704,
                        limb2: 0xc08636027a9794898f99ca1f,
                        limb3: 0x6c2d603b40207a03504da12
                    },
                    u384 {
                        limb0: 0x360c03c601bb2beb93223a15,
                        limb1: 0x4f9bcbfa9d88ef397c1ff7c9,
                        limb2: 0xa27c906c83ab6cd83e1dee2d,
                        limb3: 0x90515fb6944da14a96ca0cd
                    },
                    u384 {
                        limb0: 0x6a4be843be3fae169b9efd1,
                        limb1: 0x9cfc1655281b7fd1ee970b9e,
                        limb2: 0xb0f42e6a174e449b222d97bb,
                        limb3: 0x8bdcef4485a4f316cab2207
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x71b991e15d019ea143f226e2,
                        limb1: 0x15b3fba64ab50f8b3ad635b5,
                        limb2: 0x42c5603b416d5d0d59ed87ad,
                        limb3: 0x14fc7734d0933fc9cc93b04c
                    },
                    u384 {
                        limb0: 0xac5830b3754c7f382bcc20de,
                        limb1: 0x47f672ff689669638bc273d7,
                        limb2: 0x135ed8bcb19cb2f3228f50f3,
                        limb3: 0xe2280a07c00551344b0c5cd
                    },
                    u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 {
                        limb0: 0xb5186478343fe7a850fc5f0e,
                        limb1: 0xf905683a0e05bef4de0b8d6c,
                        limb2: 0x32572e7a8296fd05d03deb4a,
                        limb3: 0x123fa6c250e4c33f98b2bfee
                    },
                    u384 {
                        limb0: 0x43c00c2cba529fce0af2dd8d,
                        limb1: 0x85960610557e156af2469cf5,
                        limb2: 0x667d8c9adea2d27f42665d9c,
                        limb3: 0x1089291d3bc00891f6ba054e
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0xa2a78a076bfa92eeb3471559,
                limb1: 0xefead878f8b359c96d13762c,
                limb2: 0x5aa7c8939dc4c5def02b2150,
                limb3: 0xaa4c34974276c39918a6164
            },
            g_rhs_sqrt: array![
                u384 {
                    limb0: 0xc59f08099be7220f2ccc7622,
                    limb1: 0xe498d2d5c8b6f2373e0636b5,
                    limb2: 0x7b3e4fb649773a3521f9b6c,
                    limb3: 0x3b968b3cf7f24db94d7b969
                },
                u384 {
                    limb0: 0x7e26dc27d2c965b85c9055d8,
                    limb1: 0x10df5f7570f04c82287cdbed,
                    limb2: 0xb0b842334cbf5da22303c7a8,
                    limb3: 0x4b5164e3cf33838c501c0e2
                }
            ]
                .span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xe4f817e54aede0613c17035c,
                    limb1: 0xdff1f15010392a6da1f95a6,
                    limb2: 0xbed78d3d341e911d49f15454,
                    limb3: 0x18154782ce0913b21588066d
                },
                y: u384 {
                    limb0: 0x3d77d61326ef5a9a5a681757,
                    limb1: 0xd3070afd4f0e121de7fcee60,
                    limb2: 0xdf9ef4088763fe611fb85858,
                    limb3: 0x11a612bdd0bc09562856a70
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xde4f62a6588c9401ffefbd3,
                    limb1: 0x9bb5f797ac6d3395b71420b5,
                    limb2: 0xdc39e973aaf31de52219df08,
                    limb3: 0x105dcc4dce3960447d21d3c1
                },
                y: u384 {
                    limb0: 0xaefd0d854043fd325dd3c34f,
                    limb1: 0x9b63c98d9a7845c52e1e2b0f,
                    limb2: 0x9db0be660d847ccc58358f3f,
                    limb3: 0x17cb6c41f0c4e1a7394ab62a
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xcf86158ab69213388e721bb7,
                    limb1: 0x5f7812269d790797cad9aa15,
                    limb2: 0xb1c3622a0177001d9ed8e25f,
                    limb3: 0x115cf429f459884785c6ba46
                },
                y: u384 {
                    limb0: 0x1e81341e2f3f988ff115dda3,
                    limb1: 0xad22946489db6ee4954fa5e1,
                    limb2: 0x83bed94412e19d92b73cc763,
                    limb3: 0x2074c7bceff87d0d41edba1
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0x5a92118719c78df48f4ff31e78de5857, high: 0x51f964df9c6316b950f244556f25e2a2
            },
            u256 {
                low: 0x8d723104f77383c13458a748e9bb17bc, high: 0x42bbb74ddd84f39e71545a137a1d5006
            },
            u256 {
                low: 0xeb2083e6ce164dba0ff18e0242af9fc3, high: 0xbf0551e03983ca8ea7e9d498c778ea6
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 1
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x565ae56adf7b971b0ce04f43,
                    limb1: 0x7605de48d1513332bde03447,
                    limb2: 0x47735c7081fba830eb5d056,
                    limb3: 0x99dd8907656b77fed7fdbb9
                },
                y: u384 {
                    limb0: 0x7e2426bdb634f1fc715d795c,
                    limb1: 0x3780edcc7f3bf5dbf54b578,
                    limb2: 0x973c69d9a9020e1f731e4837,
                    limb3: 0x114a8f415fb1d913dce9456a
                }
            }
        );
    }


    #[test]
    fn test_msm_BLS12_381_10P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0x625c53bcdd3dedd0838beff1,
                    limb1: 0xcb07e15a10d4575bc015205c,
                    limb2: 0x2d427eeeb94d8dc9f8735c62,
                    limb3: 0x172bcbe199c9d8a12b9389c7
                },
                y: u384 {
                    limb0: 0xeafcb601f648817e1959e01c,
                    limb1: 0x6bd0b06d7fd2c766caf6ec5b,
                    limb2: 0xe1bfd50ac038928b2571d10e,
                    limb3: 0x11d9e1ad8577f4db1ef6b668
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0xedb9846df215a6a54b23692b,
                    limb1: 0x5f8b753d0b0f6a923b86bd3,
                    limb2: 0xf6b0c0878664ed75179fa99c,
                    limb3: 0x1172f8ba63ad84e04422505a
                },
                y: u384 {
                    limb0: 0x79199cd6ac1258b0434b39ec,
                    limb1: 0x8d390ace52602684311b314,
                    limb2: 0x4e38c74bd0ff18deeac5f3b0,
                    limb3: 0xa3e7183ee7f841987aebb01
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0x761b1eefd28e95ed15b39509,
                    limb1: 0xcb46c3daf5eb3a2666d9c59e,
                    limb2: 0xd5af01e7fbf829a132533307,
                    limb3: 0x1928ae276500d4c516350a1d
                },
                y: u384 {
                    limb0: 0xa5a5bb48ca9892a49b6ac9fa,
                    limb1: 0x846dfec893cc4c8bdb0e834b,
                    limb2: 0x3bd7ed60d4c4f329754c8a4e,
                    limb3: 0x802baf75f1ba64c907b58be
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x6b25491c3e836c5bfd18ee7d,
                        limb1: 0x2d0537da66723ad7ad071c19,
                        limb2: 0x9a53eaaec238eb1c2e0af6ab,
                        limb3: 0x1438a666e1f9f3ec89ca01e4
                    },
                    u384 {
                        limb0: 0xfd85173965aa27750b5b31a7,
                        limb1: 0xd36852c053330a5e276ae99b,
                        limb2: 0xa1fd8a7055d7a4af693ecc87,
                        limb3: 0x44cc84529d9a9cf9e5c61a2
                    },
                    u384 {
                        limb0: 0x8fb193d99958dd3aea26a2a,
                        limb1: 0x402708faf37889d5bab4967c,
                        limb2: 0xf363b852bfdb044ae23f7dea,
                        limb3: 0x3546d5db7f39f5729a4e765
                    },
                    u384 {
                        limb0: 0x157747ee872c1b174a2c8cf7,
                        limb1: 0x7bdc027779255897045587e7,
                        limb2: 0x5bbe4ad4c795028e4ebca2bf,
                        limb3: 0x6f819c8e1769b92b7bc6f72
                    },
                    u384 {
                        limb0: 0xa4630f936b86028a4dda333f,
                        limb1: 0x6fd1bed2e57bbf9c9fce9175,
                        limb2: 0x4f0a9d8779177f39806d1851,
                        limb3: 0x98a60949ba97008a1e2507b
                    },
                    u384 {
                        limb0: 0x55ff7fa091952efc1a208ba4,
                        limb1: 0xb7e0012a61b335caaf04530f,
                        limb2: 0x22b622f1d7ecef669a8d9b0f,
                        limb3: 0xafd4e165bbf250156b84e52
                    },
                    u384 {
                        limb0: 0x27bfb6cbc72da5a81132dde5,
                        limb1: 0x92e325fa66a2ed6022173d55,
                        limb2: 0x8b627e00e8454ff1da4620f7,
                        limb3: 0x100934c912a2bb30a03978cd
                    },
                    u384 {
                        limb0: 0xa16d4383b5ade5fcbe00954,
                        limb1: 0xab962dd26b6f228b90cf44cd,
                        limb2: 0x55e66b6c16dfd69264ff804b,
                        limb3: 0x16cc1ef0a525ff4de1ad78e0
                    },
                    u384 {
                        limb0: 0x2414053c8f131d83c3b0ef55,
                        limb1: 0xb39869507b587b11a2ca3848,
                        limb2: 0x21a5d66bb23ba5c279c2895f,
                        limb3: 0xd0088f51cbff34d258dd3db
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xe6f1c6e0cf92dec8ba8c9598,
                        limb1: 0x2d3d9dda55ad904201745ff3,
                        limb2: 0x9131f90dbf913a7b551dfdb7,
                        limb3: 0x258cc727e847462ed2a72d2
                    },
                    u384 {
                        limb0: 0x67f454937880567680764cb7,
                        limb1: 0x55b236d5f8c473b1ea3b9722,
                        limb2: 0xd70fdd630b6257630e241ba,
                        limb3: 0x1153fb06dd0cb5c176378976
                    },
                    u384 {
                        limb0: 0x4774f7fffd56b681051bee6f,
                        limb1: 0x1605048e2a7259f315ecc635,
                        limb2: 0x3013e53b209dc19c0a835bb9,
                        limb3: 0xcca787a9fe6ba6a19d0c57c
                    },
                    u384 {
                        limb0: 0x2b34bf41d58641c9909d50d1,
                        limb1: 0x4430777d9cc6775f2748153,
                        limb2: 0x8c0a8b30fbafe632df3878be,
                        limb3: 0x54bd95614296e89aead6d82
                    },
                    u384 {
                        limb0: 0x7161b23c8ed5962de376efed,
                        limb1: 0x9be3ec48774b22759a6b8803,
                        limb2: 0xbebea1b822bc6dfa03bfb3eb,
                        limb3: 0x189207fcee24b44154074ff4
                    },
                    u384 {
                        limb0: 0x13c96c120132b7b6803a54fe,
                        limb1: 0xb70dd4a665298b5c3fa5da51,
                        limb2: 0xc6a2b831d16ff2a3282fb2fe,
                        limb3: 0x1466f6ba4c29edef6b10426f
                    },
                    u384 {
                        limb0: 0x10b6e35e9c873101ecf457c1,
                        limb1: 0xaefbe094b9a012ce342bed66,
                        limb2: 0xd60534beb63c793cc5533b5d,
                        limb3: 0x19810e7f05ed66170944ca5b
                    },
                    u384 {
                        limb0: 0xb47493951ef0b456333667bf,
                        limb1: 0x2424fcbd761ca60ac8fd3a63,
                        limb2: 0xf28f642d728b82ce87b0448d,
                        limb3: 0x79a2ed8cf6350af42f59545
                    },
                    u384 {
                        limb0: 0x3c207e79747415599a99ef0,
                        limb1: 0x480ac0cebca84a9bcc5c26c6,
                        limb2: 0x4e1e6d56bbf24f1ee9bd8033,
                        limb3: 0xc5ceac6235eaee5a3bb2eb0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xa28e49f58a2bb34472b3324,
                        limb1: 0x9d0cddba73db6a077d78f945,
                        limb2: 0x766a48d6c54414b8784861f,
                        limb3: 0x39929d023f62587fa93a30e
                    },
                    u384 {
                        limb0: 0x884cc800b1deac8e94fba442,
                        limb1: 0xbf5cfdc8df2b319bf9fce41b,
                        limb2: 0xf2c38d18a47704e9ea1047ee,
                        limb3: 0xebd221f1850bf765687b114
                    },
                    u384 {
                        limb0: 0xf9db13a7701af688382f82d8,
                        limb1: 0x4d48000aacaf209a65f29c06,
                        limb2: 0xf15d440f2728257b96d6e14,
                        limb3: 0x20417ffda20fe614db36308
                    },
                    u384 {
                        limb0: 0x808124dbd1ae7bb3c3d01538,
                        limb1: 0x96c222db2b53c97b54218bce,
                        limb2: 0xe4a794746eca7861e92fd6c2,
                        limb3: 0x3f78a1f1330493ba49952b
                    },
                    u384 {
                        limb0: 0x1fbd4f587ad0cbd6e6df2a45,
                        limb1: 0xb061ced3af6e7e6dae4ae4ce,
                        limb2: 0xef5441630c4b2cd243c5dc51,
                        limb3: 0x12db38302ffc254ad2a1eb0e
                    },
                    u384 {
                        limb0: 0xdc448d4fc21451835fcd5cad,
                        limb1: 0xa4fe59bad9730a5ea4288d09,
                        limb2: 0xab6847cc4f0768e21dfcd1e9,
                        limb3: 0x17c42aa0f691d0730a141633
                    },
                    u384 {
                        limb0: 0xaef6e12650eabb49ac49a223,
                        limb1: 0x83af856e529b85b412ce6090,
                        limb2: 0x8784f6cc39b958dbb3449d3e,
                        limb3: 0x800be802125010958b85adf
                    },
                    u384 {
                        limb0: 0xae49852a9348b268406870e7,
                        limb1: 0xe196070b05613f9b1d3a08bb,
                        limb2: 0xd2c9bc2d71ec2ec709eaba79,
                        limb3: 0x6af1782e97e746e03ca2869
                    },
                    u384 {
                        limb0: 0xdee9b0b67ff7f9aa1829f040,
                        limb1: 0xb5922d8b57fee2efffa1b1fc,
                        limb2: 0x6788ba8217db1ebf1d66ca51,
                        limb3: 0x125197ad605e6d977c487b59
                    },
                    u384 {
                        limb0: 0xc9eace376ef1c93ba82190fb,
                        limb1: 0x94d0ff4c403968723f9cddbb,
                        limb2: 0x4c546eecf16c3abf85eb394d,
                        limb3: 0x757dda024385ae560bd5d30
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x9bc71b833e4b7b22ea325660,
                        limb1: 0xb4f6776956b6410805d17fcf,
                        limb2: 0x44c7e436fe44e9ed5477f6dc,
                        limb3: 0x96331c9fa11d18bb4a9cb4a
                    },
                    u384 {
                        limb0: 0x3d29524e6e0359da01d9dd86,
                        limb1: 0x88673615f5afe27f6b965c8c,
                        limb2: 0xaf2c9da9f9e9fecedc7ee16a,
                        limb3: 0x114dc847013309d142a6d66b
                    },
                    u384 {
                        limb0: 0x6c7fe0003b5bda0414700f11,
                        limb1: 0xf0e33f97b31871a8390718d6,
                        limb2: 0x7d03e8151dffbaeb36885c24,
                        limb3: 0x1928d000461b030e1c276e3a
                    },
                    u384 {
                        limb0: 0x93c4c3e825abe5eefd01d8dc,
                        limb1: 0x3e49bbb9bcdf2e19cb466540,
                        limb2: 0xc15c25d1ae50d346d1ffe0af,
                        limb3: 0x178831cacf2a2e89a7e028dc
                    },
                    u384 {
                        limb0: 0x682b1d86cbdaaf2e0e5361bf,
                        limb1: 0x287e9d73fb2d24f7d939b735,
                        limb2: 0xfb3cd15929caaf4a71ccc66b,
                        limb3: 0xb97d351af9fec5d99e62a6f
                    },
                    u384 {
                        limb0: 0x829ea848d424955b06064266,
                        limb1: 0xbca9df44db05a4f7b8802f7d,
                        limb2: 0x80bbbf7c38f7a999d0b2ef75,
                        limb3: 0x10631da5240ebe58e4bed818
                    },
                    u384 {
                        limb0: 0xa8c04cbd5fa705d144700529,
                        limb1: 0x236f3f46e588da1e487436f0,
                        limb2: 0xd6f0aace42c49d1226711b37,
                        limb3: 0x34bcba945df6c7ca751f818
                    },
                    u384 {
                        limb0: 0xe08c0091969a6786b0513993,
                        limb1: 0x5e1639fc625bce5881087194,
                        limb2: 0x264d8bf23fbe22a3b76a0a1,
                        limb3: 0x2f89f8bb8b229c9c9a655a0
                    },
                    u384 {
                        limb0: 0xc0298bb0ea51bd0ce6e17b68,
                        limb1: 0x8d7329f6a68c98333be756b,
                        limb2: 0x788513ddf84a9814e81b8e4d,
                        limb3: 0x11d87dfe66a4dc5163c5adc4
                    },
                    u384 {
                        limb0: 0x10b6e35e9c873101ecf457c5,
                        limb1: 0xaefbe094b9a012ce342bed66,
                        limb2: 0xd60534beb63c793cc5533b5d,
                        limb3: 0x19810e7f05ed66170944ca5b
                    },
                    u384 {
                        limb0: 0xb47493951ef0b456333667bf,
                        limb1: 0x2424fcbd761ca60ac8fd3a63,
                        limb2: 0xf28f642d728b82ce87b0448d,
                        limb3: 0x79a2ed8cf6350af42f59545
                    },
                    u384 {
                        limb0: 0x3c207e79747415599a99ef0,
                        limb1: 0x480ac0cebca84a9bcc5c26c6,
                        limb2: 0x4e1e6d56bbf24f1ee9bd8033,
                        limb3: 0xc5ceac6235eaee5a3bb2eb0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x54d59a9c6fc092d9915082b2,
                        limb1: 0xfab18b008dcbf75b2ede81bb,
                        limb2: 0xfd960d4e515851eb2f0a277f,
                        limb3: 0x6be33a753f70c807bf714b7
                    },
                    u384 {
                        limb0: 0x862520a40e18e772a6b4d737,
                        limb1: 0x323c6da74add6ac3c076c631,
                        limb2: 0x95babdf5a5844a79f306dc04,
                        limb3: 0x735d1db36b1693015e3fb63
                    },
                    u384 {
                        limb0: 0x7da447818696df77e92ecf24,
                        limb1: 0x26ebf1800f6f8f784fd45e15,
                        limb2: 0x46e39d7424433ee2eab9d33,
                        limb3: 0x16852a247b0c3b0bad078484
                    },
                    u384 {
                        limb0: 0xab362246d5b3cedac74f581f,
                        limb1: 0xa7a4915c6aceea845d8c342,
                        limb2: 0x8efe76a16a24f8e62c0b9b82,
                        limb3: 0x69779612c0917401715cca5
                    },
                    u384 {
                        limb0: 0x23127c166dd2edc57d532693,
                        limb1: 0x8c79e9e35050de214a74473f,
                        limb2: 0x6896b4079e1eaba2c7c657e4,
                        limb3: 0x396fbb1a709b2bf4018f19
                    },
                    u384 {
                        limb0: 0x8fcc5c67f0950e96588faa42,
                        limb1: 0x79f59f54bd947e13968d4179,
                        limb2: 0xb598d99d530aa85bb77a5365,
                        limb3: 0xf3b511a948fc7029014e7c1
                    },
                    u384 {
                        limb0: 0x229afaa5a70a0a2ec07c4092,
                        limb1: 0x757e13d86c830f9b878ab8e1,
                        limb2: 0xd65a749710833f15e6a0fe7,
                        limb3: 0x636085bc53cf2cec115c4e5
                    },
                    u384 {
                        limb0: 0xdb960aadec46f460401cc472,
                        limb1: 0xe5a884b1b8ce0cf624d42a65,
                        limb2: 0xb1d03d48bc2b4014cec8fd21,
                        limb3: 0x11b82afb254c0dd0ccc5a1e2
                    },
                    u384 {
                        limb0: 0xc0987cc2fb46bf3c5e5d5fa1, limb1: 0x59a196e0, limb2: 0x0, limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x8a2b42f89e6f89af71097330,
                        limb1: 0x168a2fa9ae6b77f5cdf81701,
                        limb2: 0x7dba9894e07e81d5f71c20c1,
                        limb3: 0x14e32f6757ecfca91a63f155
                    },
                    u384 {
                        limb0: 0x33d77dfd665a89bb0fc431d2,
                        limb1: 0xcb75428b35fd87d36cd2b6d,
                        limb2: 0xaeb03865022803f636767059,
                        limb3: 0x84856e96dee484a8650fa23
                    },
                    u384 {
                        limb0: 0xb3b44dbefb000f57b381f1a2,
                        limb1: 0x2f6821c1fa52236a117d7a13,
                        limb2: 0x80c9afdfa9c34b6d85c01529,
                        limb3: 0x3b77a0991eb970694a9a1fa
                    },
                    u384 {
                        limb0: 0x2f815107f8ded68f2e24f15e,
                        limb1: 0x7c15b4683c162bc21c466d9a,
                        limb2: 0xfafa99d8f517644e2c742151,
                        limb3: 0x101a26dfa4b17749698bc180
                    },
                    u384 {
                        limb0: 0x49b2d22a610d3af49bca5435,
                        limb1: 0x51aaa3802e40c777f87e4f2e,
                        limb2: 0x3d0717b1bc4fa02aad1b91,
                        limb3: 0x6e0a66e468bc4cb8bda85dd
                    },
                    u384 {
                        limb0: 0x1e9c7c5a9df1203f9204aa13,
                        limb1: 0xc1116de67e0ff86b103f7799,
                        limb2: 0x12f83dccef7133519fa52af0,
                        limb3: 0x19a3662cedc185fd0a83e7e6
                    },
                    u384 {
                        limb0: 0x78dc3837483cf9d540d776e3,
                        limb1: 0xa49c0ec82b2010d373e30477,
                        limb2: 0x8ae8f68997e5995b3079f63d,
                        limb3: 0x63dbd2f5233e735f44a7b4d
                    },
                    u384 {
                        limb0: 0xf5f448c921bb27f1935c8147,
                        limb1: 0x9b04bd8c36156758c4e91802,
                        limb2: 0x4f4cc814da11405a9046336d,
                        limb3: 0xb31c04ac74bbc14af9f3d07
                    },
                    u384 {
                        limb0: 0x7864d736826f8880d21225b6,
                        limb1: 0xd19ead4fccbab4e68b8db4e,
                        limb2: 0x84b02bbdeedaef73ca9132fa,
                        limb3: 0x1215bded597b02a68b2c681c
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x3bb5b7287519130ba88557de,
                        limb1: 0x216415bc8a2efb3d3df6d4ec,
                        limb2: 0x1acf541e9f360f5fe3e4b262,
                        limb3: 0xc21e216cf1c77ab1c48ab33
                    },
                    u384 {
                        limb0: 0xe76dbb86ab1efbf822ba5f2e,
                        limb1: 0x91dfe0709f6f821d9d8c8365,
                        limb2: 0xe538e2626194647f8d46f5be,
                        limb3: 0xd0512fe4ca61ab329badfe3
                    },
                    u384 {
                        limb0: 0xe99a0bffb387d6b20178564,
                        limb1: 0xb82615a27c78e9994c7ebb28,
                        limb2: 0x77ca7d52ad136d7d167d3fbe,
                        limb3: 0x15d1d1a5f046c85cf038228
                    },
                    u384 {
                        limb0: 0xa975da4b7d48064ddcb8af3f,
                        limb1: 0xdfd037fa0ce1ef7beff0d848,
                        limb2: 0xb7aff4a79408d5eb09e2ef14,
                        limb3: 0x14aedb28dbb75fa26b3f8b74
                    },
                    u384 {
                        limb0: 0xe38e7e9f4ccb4bf03a4fb05a,
                        limb1: 0x5914c2929079ab865447b734,
                        limb2: 0xe8f40fc175a8d54b958faadf,
                        limb3: 0xadd2a9bd533d152d4523959
                    },
                    u384 {
                        limb0: 0x9c80b5a76dcd871f6aae6726,
                        limb1: 0xe0e52df134282611f4a34d5a,
                        limb2: 0x1246a37107a2fbc7d0429a2,
                        limb3: 0xeb43e98b1abb2a688cb52d8
                    },
                    u384 {
                        limb0: 0x1865e9e79bd35cbd34915c8c,
                        limb1: 0x43f11d0293e838e6ac58beeb,
                        limb2: 0x3eac4f4e5bd1255da17107c,
                        limb3: 0xbe590ecdc7c44f37e3b1359
                    },
                    u384 {
                        limb0: 0x4e0b352532c6f91ea0245c50,
                        limb1: 0x6cda4fc539a7f5bfed368891,
                        limb2: 0x280ccb657e9592fb82c03189,
                        limb3: 0x40fc233a66f52a9d5088efe
                    },
                    u384 {
                        limb0: 0xb3d5c2e98f7c625516e11bb7,
                        limb1: 0x8144fcbde776909802e49f80,
                        limb2: 0x4e290a74035d4163aecec8bb,
                        limb3: 0x2884ed0bd2c2c5f54579009
                    },
                    u384 {
                        limb0: 0x994cbc9883c390390d23a132,
                        limb1: 0xff32481198fbad0130c69,
                        limb2: 0xa7f3beaa6ac3073921805999,
                        limb3: 0xf551ec0ec68de951a712d08
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x14b10be34bc126bdc426ccbf,
                        limb1: 0x249646c3d59afd6adbdc5c0a,
                        limb2: 0x2d075bcd549424c901e14ac6,
                        limb3: 0x58987deb3343ed5883cce33
                    },
                    u384 {
                        limb0: 0x1e09f7f5df6b26ec3f111c9d,
                        limb1: 0xcbac7e01d6ce6bd0bc88adb6,
                        limb2: 0x777534bca428c453e654aea4,
                        limb3: 0x72049bb7e393a8fce2840d8
                    },
                    u384 {
                        limb0: 0xced136fbec003d5ece07c688,
                        limb1: 0xbda08707e9488da845f5e84e,
                        limb2: 0x326bf7ea70d2db6170054a4,
                        limb3: 0xedde82647ae5c1a52a687ea
                    },
                    u384 {
                        limb0: 0x3434871953ede3ec299e38a7,
                        limb1: 0xd14e8967bab14491e30dcd6e,
                        limb2: 0x9fc1f9728776307fce5d6dc8,
                        limb3: 0x74895273e3325ffdf400036
                    },
                    u384 {
                        limb0: 0xa94ec6a73090758d7eedd7fb,
                        limb1: 0xec310f8875b20038fa1a6827,
                        limb2: 0x6c58a7ec64a1f6f1eda5cbde,
                        limb3: 0x9c9deb84e9d74de6a9f69e1
                    },
                    u384 {
                        limb0: 0x68d63f2a8ac89055fb95ef42,
                        limb1: 0x96ea8ed817ce2c85d7cb587d,
                        limb2: 0xbf7bf3b5d5aaeaa0364075ee,
                        limb3: 0x240cb1462f21491924aa2b9
                    },
                    u384 {
                        limb0: 0x619e31e55fd3bde43183223f,
                        limb1: 0xa7551ce7f1e578ebcd267f79,
                        limb2: 0xe352c727f0367e35fad6e788,
                        limb3: 0xf1009b2b4012d86ef9a0700
                    },
                    u384 {
                        limb0: 0x702ff54f2dfadabae93caea6,
                        limb1: 0x568cc7100fe56eb6ed76af3b,
                        limb2: 0xfa247a93b58a05857840d688,
                        limb3: 0x19a695af2a3ace83ff3bd243
                    },
                    u384 {
                        limb0: 0xec33d93579b24242da4e40ea,
                        limb1: 0xbfe6a1578d2bc338571ee4d6,
                        limb2: 0x5bd5e63e7d770e91ef5abe9a,
                        limb3: 0x13f72823a72ddcc855e29135
                    },
                    u384 {
                        limb0: 0x78dc3837483cf9d540d776e7,
                        limb1: 0xa49c0ec82b2010d373e30477,
                        limb2: 0x8ae8f68997e5995b3079f63d,
                        limb3: 0x63dbd2f5233e735f44a7b4d
                    },
                    u384 {
                        limb0: 0xf5f448c921bb27f1935c8147,
                        limb1: 0x9b04bd8c36156758c4e91802,
                        limb2: 0x4f4cc814da11405a9046336d,
                        limb3: 0xb31c04ac74bbc14af9f3d07
                    },
                    u384 {
                        limb0: 0x7864d736826f8880d21225b6,
                        limb1: 0xd19ead4fccbab4e68b8db4e,
                        limb2: 0x84b02bbdeedaef73ca9132fa,
                        limb3: 0x1215bded597b02a68b2c681c
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x2cde7d36da5a585c7d3be1c,
                        limb1: 0x73d0597fe710990efaa9432d,
                        limb2: 0x48eae0805bef7af54a2b40b7,
                        limb3: 0x22451c3237c0cc4429b9db1
                    },
                    u384 {
                        limb0: 0x302ea91a3b09524e7c49fbbb,
                        limb1: 0xb39869507b587b118b5d4593,
                        limb2: 0x21a5d66bb23ba5c279c2895f,
                        limb3: 0xd0088f51cbff34d258dd3db
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x59017e662273fb1a0de0afed,
                        limb1: 0x4b09ce5bf3b8756ed1eb5e9f,
                        limb2: 0x72d14a209295ebb24a45fe73,
                        limb3: 0x5fe6a6e1625e1ff9768945
                    },
                    u384 {
                        limb0: 0xfed35ca1af59c36d9f285722,
                        limb1: 0xfd222a1326c5bb78b2c5ce8a,
                        limb2: 0xba37973f46917ff39d1748da,
                        limb3: 0x9667cf2aa51738f3bdff4f3
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x674edd855993f60586b614e0,
                        limb1: 0x74bdc5cb2caecb2e2205f797,
                        limb2: 0xa69852a27019b1eacc3724f,
                        limb3: 0x61f97270c77f921278dda35
                    },
                    u384 {
                        limb0: 0x8dacc380f9e46590d3aafc6e,
                        limb1: 0xe05f6b9a495d897292f21454,
                        limb2: 0xc4f3c2d5957f5cb24e54437,
                        limb3: 0xa68173ce15315f4c99c502d
                    },
                    u384 {
                        limb0: 0xa94372f0abde1590d32d6c41,
                        limb1: 0xe700bcf3cd2b8db1c2a01650,
                        limb2: 0x24a67b3cc56b327f4d770907,
                        limb3: 0x107b8e1800f3f5409c1b5b96
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x6405f99889cfec683782bfb4,
                        limb1: 0x2c27396fcee1d5bb47ad7a7d,
                        limb2: 0xcb4528824a57aec92917f9cd,
                        limb3: 0x17f9a9b8589787fe5da2515
                    },
                    u384 {
                        limb0: 0x49f9728703680db67ca1b1dd,
                        limb1: 0x8d57d5aba465f7beac6b3a2d,
                        limb2: 0xa592b025b5ceb44980d810ac,
                        limb3: 0xb98e1e06fc5e7a2a4642c18
                    },
                    u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 {
                        limb0: 0x59017e662273fb1a0de0afed,
                        limb1: 0x4b09ce5bf3b8756ed1eb5e9f,
                        limb2: 0x72d14a209295ebb24a45fe73,
                        limb3: 0x5fe6a6e1625e1ff9768945
                    },
                    u384 {
                        limb0: 0xfed35ca1af59c36d9f285722,
                        limb1: 0xfd222a1326c5bb78b2c5ce8a,
                        limb2: 0xba37973f46917ff39d1748da,
                        limb3: 0x9667cf2aa51738f3bdff4f3
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x2d5d8b6c75c43a533d9cde4a,
                limb1: 0xb658f28e13f15571e7797b82,
                limb2: 0xb2a72b540969e37ceb956dc2,
                limb3: 0x96afc5be6b18fcbb65e5a39
            },
            g_rhs_sqrt: array![
                u384 {
                    limb0: 0xdc508bc9bb1eda8e768c3f9a,
                    limb1: 0xc5de9b31a826e7f51019dc72,
                    limb2: 0x80bdc6a367271e5941835e3e,
                    limb3: 0x5a967044175bf27e03552b4
                }
            ]
                .span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xe4f817e54aede0613c17035c,
                    limb1: 0xdff1f15010392a6da1f95a6,
                    limb2: 0xbed78d3d341e911d49f15454,
                    limb3: 0x18154782ce0913b21588066d
                },
                y: u384 {
                    limb0: 0x3d77d61326ef5a9a5a681757,
                    limb1: 0xd3070afd4f0e121de7fcee60,
                    limb2: 0xdf9ef4088763fe611fb85858,
                    limb3: 0x11a612bdd0bc09562856a70
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xde4f62a6588c9401ffefbd3,
                    limb1: 0x9bb5f797ac6d3395b71420b5,
                    limb2: 0xdc39e973aaf31de52219df08,
                    limb3: 0x105dcc4dce3960447d21d3c1
                },
                y: u384 {
                    limb0: 0xaefd0d854043fd325dd3c34f,
                    limb1: 0x9b63c98d9a7845c52e1e2b0f,
                    limb2: 0x9db0be660d847ccc58358f3f,
                    limb3: 0x17cb6c41f0c4e1a7394ab62a
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xcf86158ab69213388e721bb7,
                    limb1: 0x5f7812269d790797cad9aa15,
                    limb2: 0xb1c3622a0177001d9ed8e25f,
                    limb3: 0x115cf429f459884785c6ba46
                },
                y: u384 {
                    limb0: 0x1e81341e2f3f988ff115dda3,
                    limb1: 0xad22946489db6ee4954fa5e1,
                    limb2: 0x83bed94412e19d92b73cc763,
                    limb3: 0x2074c7bceff87d0d41edba1
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xe2955c55da59eba4b7b57d3d,
                    limb1: 0x1e6629b0431bce67cf28c22,
                    limb2: 0x1c35b7efd5b67f87221b8bfc,
                    limb3: 0x3e53df9e3488a9e42acd87e
                },
                y: u384 {
                    limb0: 0x2e089afa726154d40dd12102,
                    limb1: 0x5391613ecf49db2bcf1cad86,
                    limb2: 0x84a2abb2de6b3a6e09026a50,
                    limb3: 0x19557a3a3c1d62a205d5dc87
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x490bf40774926e8b279947c,
                    limb1: 0xeabab6aef9e9d2a4f64f4e7d,
                    limb2: 0x3e309fe1b1c8247abab20d7e,
                    limb3: 0x79c527862917f69ac58fcc4
                },
                y: u384 {
                    limb0: 0xacb18f2da2b425c2ff50dafd,
                    limb1: 0x7623850d87e279a8a30f31ff,
                    limb2: 0x777564c7291d95fa80203ade,
                    limb3: 0x1764ce0e7fb626109b63789b
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x42f2f3f4f6b9d2c2b73a361f,
                    limb1: 0xcd78c070c184c38b1e5716aa,
                    limb2: 0x72cbc24cd90da89e0e3cefe4,
                    limb3: 0x19485e1c46d0dce75f8b192b
                },
                y: u384 {
                    limb0: 0xb56b3539074b3c47b3f504d9,
                    limb1: 0x2c229530bddedd8851b03dcc,
                    limb2: 0xc93eef8474c4e18d6378e7f0,
                    limb3: 0x173d36f17a3c9ae77a2acc25
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x5fbf29cf20556a11621a6639,
                    limb1: 0xdfda5b7dbf0b226822094787,
                    limb2: 0x4a3b059e521b4b0445df96d5,
                    limb3: 0x333988c2c09f5af061cdfb
                },
                y: u384 {
                    limb0: 0x13d3570be6d27d1d588b22fc,
                    limb1: 0x20c763e58d4df3e4990cdae9,
                    limb2: 0x2c3301367f400c31f4bded26,
                    limb3: 0x16a6c25d133fba74b4c55972
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xcb24d12438557639f52df5fd,
                    limb1: 0x4a6a46feebe8a88a8062bd0e,
                    limb2: 0x65f04211af4b168b1e25787d,
                    limb3: 0x17935d6f4fa575744ca46f75
                },
                y: u384 {
                    limb0: 0x644f324be8a5c152625a5b8a,
                    limb1: 0x501e52e8c5707d7a3a77ee18,
                    limb2: 0x9636c463c14c5b85c2e6d3b1,
                    limb3: 0x1939b6f297f7b5b7fd0ac458
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xde1d8e2670532ec5bba60ade,
                    limb1: 0x1154f5064f7dd38656f7f82b,
                    limb2: 0xc9bec68372b7d07dcf66270c,
                    limb3: 0x315ced00b3153219bbd430
                },
                y: u384 {
                    limb0: 0xc48b3bc110e208d827b13f4d,
                    limb1: 0x87d82592699bca3dbf847c2b,
                    limb2: 0xff04f0f2c8be12365aa73443,
                    limb3: 0x1739c8c450ac994a5326c809
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0x247a8333f7b0b7d2cda8056c3d15eef7, high: 0xbacf6e172ae22448b0163c1cd9d2b7d
            },
            u256 {
                low: 0xe005b86051ef1922fe43c49e149818d1, high: 0x3ea0f301eece328bff7b118e820865d6
            },
            u256 {
                low: 0x4a84eb038d1fd9b74d2b9deb1beb3711, high: 0x2a97919d8c25166a1ff39849b4e1357d
            },
            u256 {
                low: 0x3405095c8a5006c1ec188efbd080e66e, high: 0x460ba2d39a6a5f92cca74147f6be1f72
            },
            u256 {
                low: 0x1775336d71eacd0549a3e80e966e1277, high: 0x2894fdbe6288e1a5cc45782198a6416d
            },
            u256 {
                low: 0x2f1205544a5308cc3dfabc08935ddd72, high: 0x43870ae2fcd81b5d24bace4307bf326
            },
            u256 {
                low: 0x42930b33a81ad477fb3675b89cdeb3e6, high: 0x56e06d3d16febaa011af923d79fdef7c
            },
            u256 {
                low: 0x2648ee38e07405eb215663abc1f254b8, high: 0xa4593acd7ab792809e469e6ec62b2c8
            },
            u256 {
                low: 0xd450fe4aec4f217bb306d1a8e5eeac76, high: 0x6b3f2afe642bfa42aef9c00b8a64c1b9
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 1
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x75b33668139cf598c76976ae,
                    limb1: 0xb57555c5f811f5932d2d664f,
                    limb2: 0x3dc0a463f21f628f6dd61035,
                    limb3: 0x13a7f85cd448414d544b7ba9
                },
                y: u384 {
                    limb0: 0xedc098375876a9807b6eda05,
                    limb1: 0x650b70683fc239e28e6697c5,
                    limb2: 0x368e2ab0d50c091cf0be6938,
                    limb3: 0xcd0881f2458dd277af780b3
                }
            }
        );
    }


    #[test]
    fn test_msm_BLS12_381_11P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0xda9cdde4e5c188233d85ff60,
                    limb1: 0x94bff3ad03f3cd34b48043c2,
                    limb2: 0x25a858c0f2c2ce6d9c1bcf02,
                    limb3: 0x1832d91c2c3f9a6f969b267e
                },
                y: u384 {
                    limb0: 0x96f189a68bc1acf589e8ee8,
                    limb1: 0x4a1949d57a1cd60710138159,
                    limb2: 0x10f87bc3adcbbcafeb091948,
                    limb3: 0x1519173fd0ddb592b2a9438f
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0xe28783905041626972027b5d,
                    limb1: 0x209a7185e3d7dcf824cd318,
                    limb2: 0xedea887527ba8825337cc658,
                    limb3: 0xa097cd7b1cf6b4244b0d234
                },
                y: u384 {
                    limb0: 0x8a8dfb95bbd5a3372759b0de,
                    limb1: 0x59df5374722393631e53b53,
                    limb2: 0x96fc6de10523745e115d47e4,
                    limb3: 0x399551a8a5d335850b49e6a
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0x28f1d7db996ba62dbf84ef85,
                    limb1: 0xdd4f6c28e044fec88359238c,
                    limb2: 0x3dc00b6d0c79ca704e025684,
                    limb3: 0x18cd5498819252b01053293c
                },
                y: u384 {
                    limb0: 0x78e32d74881ba0a29e12561,
                    limb1: 0x6587f89c3b6e577301996b36,
                    limb2: 0x84c0912c12022d68336ec3d5,
                    limb3: 0x18587691602430b0d4f1defe
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x642a5de4cc9d228acb9b95e6,
                        limb1: 0xfdf8243d628e7ea56ae10a26,
                        limb2: 0xec86a11299d815d3c5fbd8f3,
                        limb3: 0x2540f57d9622fa2eff74697
                    },
                    u384 {
                        limb0: 0xffbb38d796ee4dc9398b47e3,
                        limb1: 0x6307464320db393359fa7399,
                        limb2: 0x851f4e28c301e3fc123183ab,
                        limb3: 0x14919921a6e6d8f2c3d7e304
                    },
                    u384 {
                        limb0: 0x75374725ea12c8d1f402a064,
                        limb1: 0xf6506d972321921d692b3dbd,
                        limb2: 0x1228cbf52efb7c70718467e4,
                        limb3: 0x68e57c300550968094d7a42
                    },
                    u384 {
                        limb0: 0x10b198440e638aaf2cb75306,
                        limb1: 0x511e9d40b16acf9676417614,
                        limb2: 0x9eb70f14413b40c250d44bba,
                        limb3: 0x13237e78bb190e4fed0640eb
                    },
                    u384 {
                        limb0: 0xeecbfe719f29851ec663668e,
                        limb1: 0x798d237c2492431f4c152b3a,
                        limb2: 0x91b2163c4acbbf78e2a4ed6c,
                        limb3: 0x15381194efc4053de7e5ba1b
                    },
                    u384 {
                        limb0: 0x5737ba590a1d84c2b6201628,
                        limb1: 0xdea93070bbe0cebe6ff9372c,
                        limb2: 0xc650064498af1f2402111896,
                        limb3: 0xfa83579478f31e68374def5
                    },
                    u384 {
                        limb0: 0x5dbf10c7c45a468fca2cd39b,
                        limb1: 0xc70900d880b0cd14791079e5,
                        limb2: 0x87b4b45a3d2cbab22071bb10,
                        limb3: 0xcd9e037dc58b28811e70289
                    },
                    u384 {
                        limb0: 0x4790caf2ce6693df0c739a5d,
                        limb1: 0x30808d1a760ccfcb7a4f0bf2,
                        limb2: 0x9cfcb127881477763193e9ec,
                        limb3: 0x1316cba66c76d274abd6a6e
                    },
                    u384 {
                        limb0: 0xe63809d43e648b72d0915a95,
                        limb1: 0x353c96320fcade280594d4eb,
                        limb2: 0x36717708eca08d9d03aca496,
                        limb3: 0x13af6eec2d4c53e970cc08b6
                    },
                    u384 {
                        limb0: 0xe4651617d1ff18679923df3f,
                        limb1: 0xb39869507b587b117478a9c8,
                        limb2: 0x21a5d66bb23ba5c279c2895f,
                        limb3: 0xd0088f51cbff34d258dd3db
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x7de4757b74a123e7c9a488ab,
                        limb1: 0x495a2b15155fde0280b4aa51,
                        limb2: 0xb09d2657a32b6a30b792618a,
                        limb3: 0x13af1bfee4537680a54bba46
                    },
                    u384 {
                        limb0: 0x393ce29c66ba94631056dd37,
                        limb1: 0x7fa491409fc349a012be8909,
                        limb2: 0x19a50f5d48fa2b20af2a77f9,
                        limb3: 0x8430d257b350cee6f877cb4
                    },
                    u384 {
                        limb0: 0x2c6a672a644e884d595e5388,
                        limb1: 0xd544e10b9359eee69a6b37a5,
                        limb2: 0xabcf97edbaa49893827c4518,
                        limb3: 0xd55062af62546e53e75f244
                    },
                    u384 {
                        limb0: 0x1401ec20ae75a1481ceb5dcd,
                        limb1: 0x1b5c98a64657aefd93befc59,
                        limb2: 0x236590943a02b038f797a9bf,
                        limb3: 0x7b830cde857a4f597ff45de
                    },
                    u384 {
                        limb0: 0xf93ded463b439db65843a82d,
                        limb1: 0x961028543a645e7d93aa378,
                        limb2: 0x670df315e72e687ad7c4e473,
                        limb3: 0x10ac337d19a22e1287d099f9
                    },
                    u384 {
                        limb0: 0xf077c05ac82967d64817f984,
                        limb1: 0x5532978e199df1b5df9c0604,
                        limb2: 0xbd080194c9948d2429563ca3,
                        limb3: 0x2d1861580595bccf54e6d1d
                    },
                    u384 {
                        limb0: 0x9bb3d9d7cfc884cbf3a20c57,
                        limb1: 0x5ffff8337c57ad7232b533b0,
                        limb2: 0x59c72f83e3227bd09a7bda9a,
                        limb3: 0x121abee3fe9c5af1c34267dc
                    },
                    u384 {
                        limb0: 0xbb2d3607187788682b765256,
                        limb1: 0xdb35f47f6025dd1ae3b19b9e,
                        limb2: 0x8b346e8405fcd155816cbf5d,
                        limb3: 0x3ad14f214f4939b2ed0e061
                    },
                    u384 {
                        limb0: 0x97e833c76087e9d7a94c7005,
                        limb1: 0x31b390565a8c941aed64a166,
                        limb2: 0x1caa28b584c650e4d0058b60,
                        limb3: 0x172e4a480acf589d1f93b00f
                    },
                    u384 {
                        limb0: 0xb3d0c671ebb15baec8d02b56,
                        limb1: 0x9de49fde766bea7f8270dd08,
                        limb2: 0x534b0abfecc0cc2c06cf8061,
                        limb3: 0x12978b14e2c4aa6ec563230f
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x5e2ff2f735fdea20f9642040,
                        limb1: 0x8130ecae7cf1c671ae94e680,
                        limb2: 0x17e220e748f123b6d74e9239,
                        limb3: 0x15a25ce8b5eaa54cccae228e
                    },
                    u384 {
                        limb0: 0xf2bb2651f6dd5ae3f3528ff1,
                        limb1: 0xdcbc6b0c90ced110bc63fd4d,
                        limb2: 0x93847d87fa62aac37900c09a,
                        limb3: 0x183ea35837f597a60a438239
                    },
                    u384 {
                        limb0: 0x7426d20f1cf86936542f0dbe,
                        limb1: 0x18ca0cde9c42b1a9a1e8c050,
                        limb2: 0x3298f95bbae1beb785e40f33,
                        limb3: 0x11510d11616b95be3dffa89f
                    },
                    u384 {
                        limb0: 0x5253ac0c1548f7883e915f20,
                        limb1: 0xc0256ad12ea366b91f06200a,
                        limb2: 0x64e1db4eeaa1e7f197c2f25b,
                        limb3: 0xd7d75d8b80005987bf44885
                    },
                    u384 {
                        limb0: 0xe93de929cf671ff9df37f113,
                        limb1: 0x19392034e356c1a101027445,
                        limb2: 0xd17638f25c2af12dc3fce3e3,
                        limb3: 0x155b094bfbb2eec58d412df1
                    },
                    u384 {
                        limb0: 0x1052a3c49b2692aba47f4cdc,
                        limb1: 0xd7d9d827103dda4683c08090,
                        limb2: 0x9e1da9af46aa163d7a7c2b78,
                        limb3: 0x1702cc9570c6ad7a50caa126
                    },
                    u384 {
                        limb0: 0xeddbaac2ebe41e0a0674c570,
                        limb1: 0x14ccab1d97761a31054f40f4,
                        limb2: 0xf5bee47e1528bdf78733ccc5,
                        limb3: 0x80777db83f8a73a0adcf5f4
                    },
                    u384 {
                        limb0: 0x682e6f9e1f0ab75c4e903322,
                        limb1: 0x600b48194f2059dace46a5e1,
                        limb2: 0x99f6d5c03485e0afaedae68f,
                        limb3: 0x18fae5782614e12db1329b38
                    },
                    u384 {
                        limb0: 0x4f98e9c11ffd38f6b850a3b,
                        limb1: 0x335ffc534c8b65c2388c1eea,
                        limb2: 0xd851e1238b5779dfa93c9947,
                        limb3: 0x89fb0fad8f842f352dd1de5
                    },
                    u384 {
                        limb0: 0x99ee707d49dbe946f703a0cb,
                        limb1: 0xb0371dcf99c8ca4bbfd44426,
                        limb2: 0x549e902ed9406723de063cb8,
                        limb3: 0x4e2469fb46a5ad80c3443b3
                    },
                    u384 {
                        limb0: 0x776fc470b3c077c33c9f22c,
                        limb1: 0x1f1377b228f4251b9bf41ba4,
                        limb2: 0x66c7498809cdfbdbbdeef8a9,
                        limb3: 0x13aa25bb53eb2680815de73e
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xe395d5eea4878f9f269322ab,
                        limb1: 0xefd63471716c959da6cea949,
                        limb2: 0xf89192d85f47c63403ba4dea,
                        limb3: 0xb93a3ce4ce2633b3dbf1f7
                    },
                    u384 {
                        limb0: 0x339f8a71e0eb518c415bca31,
                        limb1: 0x97617261885c305c2c4e2426,
                        limb2: 0x2348909dbf7160fdc924cd26,
                        limb3: 0x70b22abb3544d1f73024b1a
                    },
                    u384 {
                        limb0: 0x4f019caa1d3c21356579f8ca,
                        limb1: 0x86b1deec6005cf522c54de97,
                        limb2: 0x28a7060821a3cb4422e6eee4,
                        limb3: 0x151f4d765954e6063a079a6
                    },
                    u384 {
                        limb0: 0x1c9825fe7478a9083d525534,
                        limb1: 0x4f9bbb0d380da3d4b1049bb7,
                        limb2: 0xfae7bbd126bedf8fa26bf5c7,
                        limb3: 0x188ecd4c4c3223bcba2d2a08
                    },
                    u384 {
                        limb0: 0xbb8c97b5dfcb0b3c71662895,
                        limb1: 0xd6c6f613c0fa74f73a5116ef,
                        limb2: 0x2f4582061cc536022733e446,
                        limb3: 0x16f1b7456ebdf803f892952d
                    },
                    u384 {
                        limb0: 0xee49689584f427a679be3998,
                        limb1: 0x2a0f3f43f9d1b5be18db4fb8,
                        limb2: 0x9fef9e40e0f6cd2427d537a6,
                        limb3: 0x189b1e80f78ab61913afa6bb
                    },
                    u384 {
                        limb0: 0x6ed55380bf9ab477eb748f28,
                        limb1: 0x65ca019153a3825a028fcb1f,
                        limb2: 0xc09f481d9926bcec86f7dbea,
                        limb3: 0x21ff69f36495cedc3b5ee2c
                    },
                    u384 {
                        limb0: 0x349ec562e322bf57061d46da,
                        limb1: 0xf0801e1cd8cc42f495511f5,
                        limb2: 0x5094004e9aaa624be9f2cf2b,
                        limb3: 0x55f755b33f495e4f7f873c9
                    },
                    u384 {
                        limb0: 0x3c1c8f791c4c0f34ed4ab997,
                        limb1: 0xe66e61049fbd5fb5392a8ba3,
                        limb2: 0x65cd9de4af47ee288edd31e5,
                        limb3: 0x11877976ff170a72924a3637
                    },
                    u384 {
                        limb0: 0x56faf3a05090f38716e3b9ae,
                        limb1: 0xa1ffffca71f47503e074a7d7,
                        limb2: 0xdd1053fd68bfc9f1db2aa3e2,
                        limb3: 0xe75b578dd2f50ddf77bfcf6
                    },
                    u384 {
                        limb0: 0xbb2d3607187788682b76525a,
                        limb1: 0xdb35f47f6025dd1ae3b19b9e,
                        limb2: 0x8b346e8405fcd155816cbf5d,
                        limb3: 0x3ad14f214f4939b2ed0e061
                    },
                    u384 {
                        limb0: 0x97e833c76087e9d7a94c7005,
                        limb1: 0x31b390565a8c941aed64a166,
                        limb2: 0x1caa28b584c650e4d0058b60,
                        limb3: 0x172e4a480acf589d1f93b00f
                    },
                    u384 {
                        limb0: 0xb3d0c671ebb15baec8d02b56,
                        limb1: 0x9de49fde766bea7f8270dd08,
                        limb2: 0x534b0abfecc0cc2c06cf8061,
                        limb3: 0x12978b14e2c4aa6ec563230f
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x36cc383865ff6a355dc498ce,
                        limb1: 0x6ef6bfc72b662c0b801d0b5b,
                        limb2: 0xa9ef9a1061b69a8233b0aa0,
                        limb3: 0x29184f6eb612e98d97301af
                    },
                    u384 {
                        limb0: 0xf53933a2c6bb6470d66dda31,
                        limb1: 0x4bf43e14fcde299437d2ea7b,
                        limb2: 0xb96ad2c46b9aada66c85325f,
                        limb3: 0xf24d1101e7904f68e3b3a36
                    },
                    u384 {
                        limb0: 0x533d7ea2ada3c408eb494147,
                        limb1: 0x3485f55e2f2c93b1ca803cab,
                        limb2: 0x59686c1102cdd8e3e51ca57,
                        limb3: 0xca9a485bda0079119bdc44c
                    },
                    u384 {
                        limb0: 0x533529b133d38aa4035300e8,
                        limb1: 0x68cf0832c4847fe628e59ccc,
                        limb2: 0xbc12a167ddd7e61ddbbf8b7b,
                        limb3: 0x1ce668636f46f1792f5c793
                    },
                    u384 {
                        limb0: 0x3cdf34f90cc44ce6226710c4,
                        limb1: 0x1515e61fb254a2b1869b20e6,
                        limb2: 0xb233e2c26c0b7cf02452b158,
                        limb3: 0x1c8dac8f35578af812de21e
                    },
                    u384 {
                        limb0: 0x9b57e7442aaf280afc6ae402,
                        limb1: 0x32d06aced302d7653ea698a3,
                        limb2: 0x4af5f0b70928cc6328e640b7,
                        limb3: 0x6537b5a0d83304844a6030b
                    },
                    u384 {
                        limb0: 0xe46718b620bca9db127385dc,
                        limb1: 0xe93a6b599df4bbc0d1c0979a,
                        limb2: 0xa46d15f0870648a07e64c475,
                        limb3: 0xc632dc73298e9328b53f356
                    },
                    u384 {
                        limb0: 0xf7cf7f75dd72027976215293,
                        limb1: 0x4d2872338ba4a7a1113b397b,
                        limb2: 0xf01aaad0ed096f6ae9f87702,
                        limb3: 0x194977b6313d4f0f22a06af6
                    },
                    u384 {
                        limb0: 0x1e126bc9075e8c4ce5c62c93,
                        limb1: 0x9077713526fd5edcf48e7cf7,
                        limb2: 0xd5b62091f9e7beac1b21d20b,
                        limb3: 0x610c0235f22f32337478f8f
                    },
                    u384 {
                        limb0: 0x96b9c872e31cadde3ec88089,
                        limb1: 0xb39869507b587b128ae8dfe8,
                        limb2: 0x21a5d66bb23ba5c279c2895f,
                        limb3: 0xd0088f51cbff34d258dd3db
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x13d8f09c1567463508d6697c,
                        limb1: 0x8fce07bc2c66685adf789940,
                        limb2: 0x1879e456c05c2ca621d43e5b,
                        limb3: 0x188de337cec2544e670011de
                    },
                    u384 {
                        limb0: 0x9efb913ecb87459ae7e183d9,
                        limb1: 0x824fdcd37bbe933f2b84aef4,
                        limb2: 0xfe24d41df1857efb55a35c00,
                        limb3: 0xe7465a089e0ca8da163d3e8
                    },
                    u384 {
                        limb0: 0x2f49a75b067fd0efde48db8c,
                        limb1: 0x2d12ce2fdf2ca21283740885,
                        limb2: 0x28a98352ffcddbc2706255a5,
                        limb3: 0x149edc7654209ee1eb6ed101
                    },
                    u384 {
                        limb0: 0x1c02759541ff31765dd1d8fc,
                        limb1: 0x3d4337b33d9eeb33b7d1cda2,
                        limb2: 0xbb86f53547b04269165c2911,
                        limb3: 0x143162da9d8fef4965c9c063
                    },
                    u384 {
                        limb0: 0x5c23f9c324d08a8d4df44a20,
                        limb1: 0x2d24a185565678bb578d46d5,
                        limb2: 0xa507ee1bfeded73ee77ae0ca,
                        limb3: 0x325d89610a0e40a4c2b89c7
                    },
                    u384 {
                        limb0: 0x3abbe291bceb5ddabe5e76cc,
                        limb1: 0xb10211470226bed03e16dd76,
                        limb2: 0xe1601ef6326c600f783fd818,
                        limb3: 0x7ca6b57bb5f2f3d73381117
                    },
                    u384 {
                        limb0: 0x8d0ad07136c4a2c746b68e92,
                        limb1: 0x26440f95390b032674b1e148,
                        limb2: 0x4b43d9bae3af31bad3193e08,
                        limb3: 0x14631ba4d2d3283bca99b07e
                    },
                    u384 {
                        limb0: 0xb017e5c13e6c1976f37ca96a,
                        limb1: 0xd2999c41fa2fbcda5ce2ac3e,
                        limb2: 0x4c8ace29fc7d21bc6027c324,
                        limb3: 0xfec464cf0b6fa7fb44d9b8c
                    },
                    u384 {
                        limb0: 0x1981baacaf63e4bec92c1979,
                        limb1: 0x83713a6e5e7b408fe996034f,
                        limb2: 0xab4460b9d4ff3b05e0d3b87c,
                        limb3: 0x17ef01809e31cfb1f81a23e9
                    },
                    u384 {
                        limb0: 0xfa9220c6c7328168945404ae,
                        limb1: 0xc96a19d2257143c095f84db3,
                        limb2: 0x47bd2e345351c6ef7be9764c,
                        limb3: 0x6bfd56f23b4f301cc31cfa2
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x3efb4404f562f986eadca4a7,
                        limb1: 0xe14da27c79b7c7c5909a8623,
                        limb2: 0x58e76ae1129ad4acfdb06a1a,
                        limb3: 0xbacefaa20b777f5ec0263c
                    },
                    u384 {
                        limb0: 0x9c82a5a15eb55f9128ae256b,
                        limb1: 0xd44a288aefffe362d223d18a,
                        limb2: 0x930f149630f9c0cea2665f28,
                        limb3: 0x19476ce33c2da503935cf70e
                    },
                    u384 {
                        limb0: 0x8e3eb8c676fab22885a1ab9d,
                        limb1: 0x3f2c198f9944315691374825,
                        limb2: 0xe17d5c587936652f0fe2d05e,
                        limb3: 0x672d9b6842033744aed70c8
                    },
                    u384 {
                        limb0: 0x19eeaf75381759b1c01288b2,
                        limb1: 0x33ed49bfe7f8ed7da08dafb4,
                        limb2: 0xeae6bcb1d6eb6d37c89a46ec,
                        limb3: 0x1641b38a2b963f980ece61b9
                    },
                    u384 {
                        limb0: 0x9008f269003ad6429935e06a,
                        limb1: 0x179b55e60d8cadebc67dc8ea,
                        limb2: 0x2e2978c997740c22147745a7,
                        limb3: 0xbf482907443cec60f68f4fe
                    },
                    u384 {
                        limb0: 0x21d7b8a3fa2d77dccce482,
                        limb1: 0xa0015ca8eb82ff840d667beb,
                        limb2: 0x3a9d7b6bf149c26710ed9867,
                        limb3: 0xd174946128e86987aedeed2
                    },
                    u384 {
                        limb0: 0xac524dafa476e840657286c7,
                        limb1: 0x8fd6b675333af4dfd25a698,
                        limb2: 0x3f11a28bf80a826b85cad87b,
                        limb3: 0x158e60004624cc19c6f65e8a
                    },
                    u384 {
                        limb0: 0x4560050559c677b993200669,
                        limb1: 0x5c4aa71a25b6d859896255b4,
                        limb2: 0xa53c7f08a11cc016c7474c9d,
                        limb3: 0x11f54536b71afe323663541d
                    },
                    u384 {
                        limb0: 0x724c6bec1c3716259e941cc6,
                        limb1: 0x5af44557dbba571f56098cc4,
                        limb2: 0xcff6c4e4183c672a1b84e14b,
                        limb3: 0xbdd71e9e471af90b805b5a9
                    },
                    u384 {
                        limb0: 0x227d7c445dfcf0fb5a850a37,
                        limb1: 0x2a705286f6fbf2ac5d78f076,
                        limb2: 0xabd0d736ed47b00e3617ab2d,
                        limb3: 0x1856a05e247d28902615eff3
                    },
                    u384 {
                        limb0: 0x912a408ae50c041a640c14a,
                        limb1: 0x7c3fd132c5051e7af29c7b66,
                        limb2: 0xd3634c92f7a7de39fe9d2946,
                        limb3: 0xa0ac5e2bf2b54a60a2f2d1f
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x3b67c27127a018d4235aa5ef,
                        limb1: 0x9a5a70dcd86beff21de6504,
                        limb2: 0x98048ad4d40ad009acc1c130,
                        limb3: 0x143457208e899d6abaad5055
                    },
                    u384 {
                        limb0: 0x194644fbba1f166b9f86ba0e,
                        limb1: 0x3addce0c019860b470babbd5,
                        limb2: 0x71fbf6c8fd2764e36f834a83,
                        limb3: 0x5cf72adb4835d01ef580037
                    },
                    u384 {
                        limb0: 0xa92a9d6cec0243bf79246e2f,
                        limb1: 0x7eb8c0dc989fa5ddb1cc2218,
                        limb2: 0xd8c306c5d1d18c7ae6fa1e56,
                        limb3: 0x4783c1aa402c7b8cc684ce1
                    },
                    u384 {
                        limb0: 0xbe92c6f235680c0e801f22c0,
                        limb1: 0xe8179c05481e3c99440fcfcd,
                        limb2: 0xf96705ce4d400836ad3097a2,
                        limb3: 0x14f26f95f02770ad1b87493
                    },
                    u384 {
                        limb0: 0x5e37784ba4ca6fd01fb301ae,
                        limb1: 0xcfb19047de6780086b0dca4b,
                        limb2: 0x4ef8dfb6888990720009cc69,
                        limb3: 0x10ab60e92e4741c86f65351
                    },
                    u384 {
                        limb0: 0x68e531a2402e485ad7c30c11,
                        limb1: 0x89ea40aaf116a72f5d237e5f,
                        limb2: 0x6ade52546508107b5ddca348,
                        limb3: 0x19c777eb081d753d6d336daa
                    },
                    u384 {
                        limb0: 0x3c31b75aef14bc9378ad1343,
                        limb1: 0xa0c0fe253db815612e9552c8,
                        limb2: 0x1eb3559aa90726c58831e8f3,
                        limb3: 0x17ba9baf3c5cdc69aedd8b3a
                    },
                    u384 {
                        limb0: 0xb9db90c8aa82f0691be79a72,
                        limb1: 0xa9296d4b51b37fdc8dbff7d2,
                        limb2: 0x509bcd1527e4c726810fc7de,
                        limb3: 0xed4cdf5607d00d4872aa88c
                    },
                    u384 {
                        limb0: 0x8cc6cd454c7df0d5e30fdcaf,
                        limb1: 0x8934831d9800dea3886aeab6,
                        limb2: 0xc48e9b575903699820ff81cc,
                        limb3: 0x19833b9b87a6ba36724da99b
                    },
                    u384 {
                        limb0: 0xc5ff538c998fa8699806f69f,
                        limb1: 0xe4bba43cd81f1c04ade71819,
                        limb2: 0x26ece5b4cc7f01f3cf3a047b,
                        limb3: 0x15615f7728270da8b0454751
                    },
                    u384 {
                        limb0: 0xb017e5c13e6c1976f37ca96e,
                        limb1: 0xd2999c41fa2fbcda5ce2ac3e,
                        limb2: 0x4c8ace29fc7d21bc6027c324,
                        limb3: 0xfec464cf0b6fa7fb44d9b8c
                    },
                    u384 {
                        limb0: 0x1981baacaf63e4bec92c1979,
                        limb1: 0x83713a6e5e7b408fe996034f,
                        limb2: 0xab4460b9d4ff3b05e0d3b87c,
                        limb3: 0x17ef01809e31cfb1f81a23e9
                    },
                    u384 {
                        limb0: 0xfa9220c6c7328168945404ae,
                        limb1: 0xc96a19d2257143c095f84db3,
                        limb2: 0x47bd2e345351c6ef7be9764c,
                        limb3: 0x6bfd56f23b4f301cc31cfa2
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xf70358b98d49df74ec48b065,
                        limb1: 0xa2583487fd3f20c6f2463eec,
                        limb2: 0x1c4f1820b2bab7c72a659ea1,
                        limb3: 0xc297c59cb8411260408838d
                    },
                    u384 {
                        limb0: 0x302ea91a3b09524e7c49fbbb,
                        limb1: 0xb39869507b587b118b5d4593,
                        limb2: 0x21a5d66bb23ba5c279c2895f,
                        limb3: 0xd0088f51cbff34d258dd3db
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x3d3fd061cd69195e7766d1ba,
                        limb1: 0x201980d5547f71805a82e3be,
                        limb2: 0xdaede9d98938a960829db284,
                        limb3: 0x5b9b389a0d7a3a6742e1ca3
                    },
                    u384 {
                        limb0: 0x572ea4938a50f768ce77ea74,
                        limb1: 0xef089200aedf6fb037b20958,
                        limb2: 0x5aecc5cc94ba4474658b08a1,
                        limb3: 0x112b52643f9e0f42413353fb
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xfa999fcf7a2a14efd03a12a6,
                        limb1: 0x4df130da8c0e2f335ca4a401,
                        limb2: 0xa174bfbecbc5ff717b407309,
                        limb3: 0x456f9f7e9e794e02ef21797
                    },
                    u384 {
                        limb0: 0x11043fa246d6ac3b546d013f,
                        limb1: 0x9bdb37ea1f4ad823b4477878,
                        limb2: 0xc7f9df12a20b1af79d0ff133,
                        limb3: 0x85a908a91c1fd502f06da3a
                    },
                    u384 {
                        limb0: 0xceecca123603262697f62ce,
                        limb1: 0x3ac4b491250655db2f5cba47,
                        limb2: 0x4489495204bf8acfc6d1be06,
                        limb3: 0x13a3331f1c1c8ef15df2a286
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xf4ff418735a46579dd9b46e8,
                        limb1: 0x8066035551fdc6016a0b8ef8,
                        limb2: 0x6bb7a76624e2a5820a76ca10,
                        limb3: 0x16e6ce26835e8e99d0b8728f
                    },
                    u384 {
                        limb0: 0xfa12924eb545dda339e0547a,
                        limb1: 0xedc0a2c0ce1bd278a1702563,
                        limb2: 0xe51bbd8389fa7ac7af21fd08,
                        limb3: 0x10ab25bc8b786fd46e960080
                    },
                    u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 {
                        limb0: 0x3d3fd061cd69195e7766d1ba,
                        limb1: 0x201980d5547f71805a82e3be,
                        limb2: 0xdaede9d98938a960829db284,
                        limb3: 0x5b9b389a0d7a3a6742e1ca3
                    },
                    u384 {
                        limb0: 0x572ea4938a50f768ce77ea74,
                        limb1: 0xef089200aedf6fb037b20958,
                        limb2: 0x5aecc5cc94ba4474658b08a1,
                        limb3: 0x112b52643f9e0f42413353fb
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0xb78d4af733678afa84ec8550,
                limb1: 0x19d3529fff4d16f6eb6016f2,
                limb2: 0xfcc814488055416bbb34ab2c,
                limb3: 0x943ae55ca406339af29defa
            },
            g_rhs_sqrt: array![
                u384 {
                    limb0: 0x10310c86324cf26472be67db,
                    limb1: 0x6166b347fc6c6996f12ae4fa,
                    limb2: 0xea20f9e610f3b3637910944d,
                    limb3: 0x36db310938ac317f21e5206
                },
                u384 {
                    limb0: 0x3b312711a19592a24e284b5b,
                    limb1: 0xee4b794b3219edcb28719080,
                    limb2: 0xb3fee67cb7d20ad1caa393cd,
                    limb3: 0x2b78180e1348e774aea87a6
                }
            ]
                .span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xe4f817e54aede0613c17035c,
                    limb1: 0xdff1f15010392a6da1f95a6,
                    limb2: 0xbed78d3d341e911d49f15454,
                    limb3: 0x18154782ce0913b21588066d
                },
                y: u384 {
                    limb0: 0x3d77d61326ef5a9a5a681757,
                    limb1: 0xd3070afd4f0e121de7fcee60,
                    limb2: 0xdf9ef4088763fe611fb85858,
                    limb3: 0x11a612bdd0bc09562856a70
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xde4f62a6588c9401ffefbd3,
                    limb1: 0x9bb5f797ac6d3395b71420b5,
                    limb2: 0xdc39e973aaf31de52219df08,
                    limb3: 0x105dcc4dce3960447d21d3c1
                },
                y: u384 {
                    limb0: 0xaefd0d854043fd325dd3c34f,
                    limb1: 0x9b63c98d9a7845c52e1e2b0f,
                    limb2: 0x9db0be660d847ccc58358f3f,
                    limb3: 0x17cb6c41f0c4e1a7394ab62a
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xcf86158ab69213388e721bb7,
                    limb1: 0x5f7812269d790797cad9aa15,
                    limb2: 0xb1c3622a0177001d9ed8e25f,
                    limb3: 0x115cf429f459884785c6ba46
                },
                y: u384 {
                    limb0: 0x1e81341e2f3f988ff115dda3,
                    limb1: 0xad22946489db6ee4954fa5e1,
                    limb2: 0x83bed94412e19d92b73cc763,
                    limb3: 0x2074c7bceff87d0d41edba1
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xe2955c55da59eba4b7b57d3d,
                    limb1: 0x1e6629b0431bce67cf28c22,
                    limb2: 0x1c35b7efd5b67f87221b8bfc,
                    limb3: 0x3e53df9e3488a9e42acd87e
                },
                y: u384 {
                    limb0: 0x2e089afa726154d40dd12102,
                    limb1: 0x5391613ecf49db2bcf1cad86,
                    limb2: 0x84a2abb2de6b3a6e09026a50,
                    limb3: 0x19557a3a3c1d62a205d5dc87
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x490bf40774926e8b279947c,
                    limb1: 0xeabab6aef9e9d2a4f64f4e7d,
                    limb2: 0x3e309fe1b1c8247abab20d7e,
                    limb3: 0x79c527862917f69ac58fcc4
                },
                y: u384 {
                    limb0: 0xacb18f2da2b425c2ff50dafd,
                    limb1: 0x7623850d87e279a8a30f31ff,
                    limb2: 0x777564c7291d95fa80203ade,
                    limb3: 0x1764ce0e7fb626109b63789b
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x42f2f3f4f6b9d2c2b73a361f,
                    limb1: 0xcd78c070c184c38b1e5716aa,
                    limb2: 0x72cbc24cd90da89e0e3cefe4,
                    limb3: 0x19485e1c46d0dce75f8b192b
                },
                y: u384 {
                    limb0: 0xb56b3539074b3c47b3f504d9,
                    limb1: 0x2c229530bddedd8851b03dcc,
                    limb2: 0xc93eef8474c4e18d6378e7f0,
                    limb3: 0x173d36f17a3c9ae77a2acc25
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x5fbf29cf20556a11621a6639,
                    limb1: 0xdfda5b7dbf0b226822094787,
                    limb2: 0x4a3b059e521b4b0445df96d5,
                    limb3: 0x333988c2c09f5af061cdfb
                },
                y: u384 {
                    limb0: 0x13d3570be6d27d1d588b22fc,
                    limb1: 0x20c763e58d4df3e4990cdae9,
                    limb2: 0x2c3301367f400c31f4bded26,
                    limb3: 0x16a6c25d133fba74b4c55972
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xcb24d12438557639f52df5fd,
                    limb1: 0x4a6a46feebe8a88a8062bd0e,
                    limb2: 0x65f04211af4b168b1e25787d,
                    limb3: 0x17935d6f4fa575744ca46f75
                },
                y: u384 {
                    limb0: 0x644f324be8a5c152625a5b8a,
                    limb1: 0x501e52e8c5707d7a3a77ee18,
                    limb2: 0x9636c463c14c5b85c2e6d3b1,
                    limb3: 0x1939b6f297f7b5b7fd0ac458
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xde1d8e2670532ec5bba60ade,
                    limb1: 0x1154f5064f7dd38656f7f82b,
                    limb2: 0xc9bec68372b7d07dcf66270c,
                    limb3: 0x315ced00b3153219bbd430
                },
                y: u384 {
                    limb0: 0xc48b3bc110e208d827b13f4d,
                    limb1: 0x87d82592699bca3dbf847c2b,
                    limb2: 0xff04f0f2c8be12365aa73443,
                    limb3: 0x1739c8c450ac994a5326c809
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x8904b74d5d114b5416df0ed6,
                    limb1: 0x479ee13e49cde067742c2655,
                    limb2: 0x45b9359bfa338dd432ca9ff1,
                    limb3: 0x12bf6460e7a42942be6c16a0
                },
                y: u384 {
                    limb0: 0x3a8b37aacb2f620bc41c6109,
                    limb1: 0x91f68edf90b5947273b0aadf,
                    limb2: 0x265d48695a73800b7404124c,
                    limb3: 0x141e3d99b3ab683bdb0ce70f
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0xe005b86051ef1922fe43c49e149818d1, high: 0x3ea0f301eece328bff7b118e820865d6
            },
            u256 {
                low: 0x4a84eb038d1fd9b74d2b9deb1beb3711, high: 0x2a97919d8c25166a1ff39849b4e1357d
            },
            u256 {
                low: 0x3405095c8a5006c1ec188efbd080e66e, high: 0x460ba2d39a6a5f92cca74147f6be1f72
            },
            u256 {
                low: 0x1775336d71eacd0549a3e80e966e1277, high: 0x2894fdbe6288e1a5cc45782198a6416d
            },
            u256 {
                low: 0x2f1205544a5308cc3dfabc08935ddd72, high: 0x43870ae2fcd81b5d24bace4307bf326
            },
            u256 {
                low: 0x42930b33a81ad477fb3675b89cdeb3e6, high: 0x56e06d3d16febaa011af923d79fdef7c
            },
            u256 {
                low: 0x2648ee38e07405eb215663abc1f254b8, high: 0xa4593acd7ab792809e469e6ec62b2c8
            },
            u256 {
                low: 0xd450fe4aec4f217bb306d1a8e5eeac76, high: 0x6b3f2afe642bfa42aef9c00b8a64c1b9
            },
            u256 {
                low: 0x85940927468ff53d864a7a50b48d73f1, high: 0x1b8bb742d977e9933c49d76fcfc6e625
            },
            u256 {
                low: 0xd344749096fd35d0adf20806e5214606, high: 0x233a1ba09466e4726b5f5241f323ca74
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 1
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x9ec142be39a5f52851d40011,
                    limb1: 0xa2c6a9a59c2e5cc721418300,
                    limb2: 0xf1b002b6ff0a802aa11d79f1,
                    limb3: 0x4ef0f37cba80a70d0645e6d
                },
                y: u384 {
                    limb0: 0xb7eadd19764cdf407fce674a,
                    limb1: 0xcd0f0fe2c23c44035093a0e2,
                    limb2: 0xb99254d6476ffdbaf7f749d0,
                    limb3: 0xd20d67685607fa1d8542a6
                }
            }
        );
    }


    #[test]
    fn test_msm_BLS12_381_12P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0x3e97d2180b8d9becdeecbc4,
                    limb1: 0x22464786b5e8678d30ea566d,
                    limb2: 0x460842529ef02457631e7075,
                    limb3: 0x9d08075235f7e786a2c8610
                },
                y: u384 {
                    limb0: 0xad8b261cae9ca9c1ce60a5ad,
                    limb1: 0x49ed6d249b5433c2925f4a11,
                    limb2: 0xd21d53fd1765d52afd70bf35,
                    limb3: 0x19de584d836f54db00d356c4
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0xdaebc752ad2b8ffff7549f07,
                    limb1: 0xd413863791b7a8f0c34eb3c6,
                    limb2: 0x9c92f45c88f9f47f20f4f8fc,
                    limb3: 0x145230516d9fe61cff157933
                },
                y: u384 {
                    limb0: 0xe31cca49cb02ec5099286e72,
                    limb1: 0x299af97f18ac81739c305e01,
                    limb2: 0xc5d74563760466c83734d9d6,
                    limb3: 0xd65e4b6d9b871273837279d
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0xf247311021189eaad71dc07a,
                    limb1: 0x95ea7c5761ce3305b72b3d27,
                    limb2: 0x4ed7e368cc21a3e659c373bb,
                    limb3: 0xa8a70d7ede8f711ca032c1a
                },
                y: u384 {
                    limb0: 0x45f584bb123ee417f69a22ba,
                    limb1: 0xdf04ffc9dc515c574699e709,
                    limb2: 0x619bd5d8e446e7653d287f52,
                    limb3: 0xebda39b41cb789b69e9d1c1
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x8c57db9060209c0b37fc7d09,
                        limb1: 0xf84edaea29c30790408f815a,
                        limb2: 0xcc36907573d0a50a5ab2de05,
                        limb3: 0x5c8873b8fa59e75695e6e68
                    },
                    u384 {
                        limb0: 0x74797acf5e88173453ae9801,
                        limb1: 0x771b8cd9505be9d4ed809298,
                        limb2: 0x58b3710510d8e512685395b2,
                        limb3: 0x26902ebd18d83be26c4f110
                    },
                    u384 {
                        limb0: 0x5759cd8660cd7b3615b0fa75,
                        limb1: 0x27cd155d9f03222b96f2a950,
                        limb2: 0x39dd8fb25179ed3171607eec,
                        limb3: 0x1215cf60ad654e95112185f7
                    },
                    u384 {
                        limb0: 0xa5d95f778b2b6e832ee03043,
                        limb1: 0xa1458bedcdbbdc1f3a90a417,
                        limb2: 0x3337f2ead92396068e4446d4,
                        limb3: 0x5468b86c1222dd1751f66c8
                    },
                    u384 {
                        limb0: 0x6a9666fefd3d9b13ee847f55,
                        limb1: 0xde3944edfd2eca125aae9907,
                        limb2: 0xad44df48d1efa1859c17d1a1,
                        limb3: 0xaf3c8e12a16202f5695a6fd
                    },
                    u384 {
                        limb0: 0x69e18bd5323a42e21d927dba,
                        limb1: 0x470384c1b82355d739e6809,
                        limb2: 0x51fc8e26cd3adf43df7c0f4e,
                        limb3: 0xa2d218726b1462c6034bc7
                    },
                    u384 {
                        limb0: 0x42cb6bd8cbc555486f807845,
                        limb1: 0x3363a11b977fcf1049ff634e,
                        limb2: 0x4c51c3b1fcb19b423a7226c4,
                        limb3: 0x165c8378f77a14afe849ad01
                    },
                    u384 {
                        limb0: 0xc808090d740ada56bafce20,
                        limb1: 0xbf5a6e77e923bb666e4233ad,
                        limb2: 0x7d7f5398111e0ecc738e698b,
                        limb3: 0xec729b9c40f41cce35e0288
                    },
                    u384 {
                        limb0: 0x8d4bcd5b7fb384e9e569c347,
                        limb1: 0xa762eaa41680142ff510b199,
                        limb2: 0xfda2f77be7758f4fcb7a7e43,
                        limb3: 0x12781a78a97081fb0b23dc14
                    },
                    u384 {
                        limb0: 0x900a83e26a008cf0ffbcb62f,
                        limb1: 0x6023e47230f6ccd732542f32,
                        limb2: 0xea346c6a9b400e03453fc83b,
                        limb3: 0xd1255464c99b44f313c452c
                    },
                    u384 {
                        limb0: 0xb11dc76145b6fa2db119473b,
                        limb1: 0x6730d2a0f6b0f623b33dce5f,
                        limb2: 0x434bacd764774b84f38512bf,
                        limb3: 0x1a0111ea397fe69a4b1ba7b6
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x394ca5df941ef96ba376f70e,
                        limb1: 0xc7d92aba4a2aa18701246902,
                        limb2: 0xd59a8029e750171a9f78fe08,
                        limb3: 0xa16a37a149f1ff64c8b7fad
                    },
                    u384 {
                        limb0: 0xc387e5a382c5c90e8d9c037b,
                        limb1: 0xbb50c6c63a9a1c04932951ca,
                        limb2: 0x6975be66c8eead6bff7c8dc4,
                        limb3: 0x64df532d56d43bf48ba5b53
                    },
                    u384 {
                        limb0: 0xb14870dc86ab11a55ea4c782,
                        limb1: 0x2bee240fd06bfccfbc7b777a,
                        limb2: 0x5b2006814a638f32e7dbd44b,
                        limb3: 0x151c4ccc4417033c1c165173
                    },
                    u384 {
                        limb0: 0xbf71c79ed815fe303ef62d28,
                        limb1: 0xca701061ffc4d675148be361,
                        limb2: 0x191560da60f93a98f737cf10,
                        limb3: 0xccafffddb49328410bca068
                    },
                    u384 {
                        limb0: 0xdbb2889be1deebc99dc00ffb,
                        limb1: 0xc9765bcb2901a9af32d6195e,
                        limb2: 0x9783b90a9f639023f2e5649f,
                        limb3: 0x1987e63dd9e7bdcdfd6ae16
                    },
                    u384 {
                        limb0: 0x884d850a4e6dfd8a0f249f77,
                        limb1: 0xe29b719304f7e0a37e070848,
                        limb2: 0xfef717520b3ab9148f91bedc,
                        limb3: 0xd7f08cd89f0066f62b81f86
                    },
                    u384 {
                        limb0: 0xea0b4b6b325cdcde6a72fd7a,
                        limb1: 0xc0901b33b2c7d6b20a2beacf,
                        limb2: 0x84aa3aa19442c6f17ff965ce,
                        limb3: 0x17e3bcba37a79fdbf9c752b8
                    },
                    u384 {
                        limb0: 0xc8f128c78152c69a11efc551,
                        limb1: 0xc8f8915aae070ddc2cddd134,
                        limb2: 0xda738b8ea136f8eed7fe308d,
                        limb3: 0x9694196f5c44cdeed328652
                    },
                    u384 {
                        limb0: 0xf805121e5b22b3b9b18e62dd,
                        limb1: 0x232ca35ac4309a820853775c,
                        limb2: 0xf053b9e9efd692e800e10210,
                        limb3: 0x5c1c26aaf117f278fc3a360
                    },
                    u384 {
                        limb0: 0xf1450654edec3ab0968ef6b,
                        limb1: 0x18c485f1d7e7b508fd7c8683,
                        limb2: 0xeafb8b4b03baf970f245e817,
                        limb3: 0x3dbc7f13e6688fafc83482e
                    },
                    u384 {
                        limb0: 0x1d167712a8656b2ad4f2a858,
                        limb1: 0xd1c554df4306dcf1fe2e59c3,
                        limb2: 0x2236edb3e9bea92a949cfd19,
                        limb3: 0xfc3794bfef3a1f0815acec7
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xa202091ba44aecfa248c6f3e,
                        limb1: 0x75413c1bb3b8c3666b15b01c,
                        limb2: 0xccac0cd74a788ec67d3dc940,
                        limb3: 0x13439c00fa351ef7532126c2
                    },
                    u384 {
                        limb0: 0x3015579bf6dcddb618f9ac7c,
                        limb1: 0xd104d39fa242b410524e6740,
                        limb2: 0x2b26cf9bd335048d63267a4,
                        limb3: 0x5a7c87953a2c44b94effdce
                    },
                    u384 {
                        limb0: 0x1b7f6528d55b2ea84fe82d07,
                        limb1: 0x87bee73d9b87a3bf055f6a9d,
                        limb2: 0x8fca8c88f1e7d3716215ff1e,
                        limb3: 0x13ea27c9bf59362d915c3408
                    },
                    u384 {
                        limb0: 0x69d91d3e39ceac418f7df446,
                        limb1: 0xec655a535ee5055e300ebb7d,
                        limb2: 0x648d478b040f3b9e66edbff7,
                        limb3: 0xd75e459ab5668e9a4fb6efe
                    },
                    u384 {
                        limb0: 0x19650f683a932a5f77aa5d1c,
                        limb1: 0x2a5ba492a31aa5a04a3f7ef7,
                        limb2: 0xe5796b6849fee3766fceae27,
                        limb3: 0xc22449c53b688c4912733da
                    },
                    u384 {
                        limb0: 0xd459cc954748899d1cb69c7e,
                        limb1: 0xa9347fde14531723abe8ab97,
                        limb2: 0x11be1310d423ecac824e49a9,
                        limb3: 0xa7b235343e73a56a1ec3a65
                    },
                    u384 {
                        limb0: 0x3b643d76457ab54727feca50,
                        limb1: 0xb334c275106a0267a78f331d,
                        limb2: 0xd90c726c9904f3073590bcb9,
                        limb3: 0xb79288931e314a636bf9c06
                    },
                    u384 {
                        limb0: 0x764cf1fb3ffe54b78b6634ee,
                        limb1: 0x3af13ad911473e34ea107008,
                        limb2: 0x79b812aae3f034a9f7fff1d,
                        limb3: 0x2e95abbf1188037126eb601
                    },
                    u384 {
                        limb0: 0x7d561f7eacbcc3339d6ff06e,
                        limb1: 0x3f98ae97bbc5922f46626ef6,
                        limb2: 0x81e2c797f9b8483403e9f593,
                        limb3: 0x133579216a52ac950009461f
                    },
                    u384 {
                        limb0: 0xc5d43e5c27a7e444f7b1eefd,
                        limb1: 0xb968b631d518c797aece659e,
                        limb2: 0xb8348611f29c0cfaba4ef447,
                        limb3: 0xd47a6a1bcafb955bb88d7c8
                    },
                    u384 {
                        limb0: 0xc43034c834d833bdaeed1b51,
                        limb1: 0x73e225d519c73e685b4fded7,
                        limb2: 0xc8c637ce038654f930013eed,
                        limb3: 0x4c1b45ef0989337eb0df07a
                    },
                    u384 {
                        limb0: 0x4dd6890dd91c9292b08b6b57,
                        limb1: 0xfe7c723b503298998cf71680,
                        limb2: 0xc1083c0322894aea9168b47b,
                        limb3: 0x82a4390a2106246ffd7f831
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x33de977e967ce5ae8ddc318d,
                        limb1: 0xb833d84831f98ff7e5e5a40a,
                        limb2: 0x131e53d038c910e58a5ee563,
                        limb3: 0xe597bfe18fc993ee7125701
                    },
                    u384 {
                        limb0: 0xe1f968e0b17243a36700dec,
                        limb1: 0xed431b18ea6870124ca5472b,
                        limb2: 0xa5d6f99b23bab5affdf23712,
                        limb3: 0x1937d4cb55b50efd22e96d4d
                    },
                    u384 {
                        limb0: 0xb125c372ecaf46957a941e07,
                        limb1: 0x7a26185c5d9d10d295e9ddee,
                        limb2: 0xa29d137efc285a3cc4e018ee,
                        limb3: 0x66dfd7263dc59218f064eaa
                    },
                    u384 {
                        limb0: 0xd46bc45b8078f22c9f505658,
                        limb1: 0x2337c7005bdc0f1315fbf68b,
                        limb2: 0xb358a9e4a2466a74954e14cd,
                        limb3: 0x9407f9d0ec41cd1f946b1e1
                    },
                    u384 {
                        limb0: 0x325208130a417835049c4367,
                        limb1: 0xe12a35f2dea0c2c15e81b746,
                        limb2: 0xc784a291467cedfbcb122043,
                        limb3: 0xcafeec24be73332c81513ad
                    },
                    u384 {
                        limb0: 0x6fd685064c6507cd9b37f008,
                        limb1: 0xe7fa4519f6e99315773f989f,
                        limb2: 0xd0650a1aae5fdc7b3f18aa3f,
                        limb3: 0x17164c2df8d74fc510bf8022
                    },
                    u384 {
                        limb0: 0xa24ef54cb98d71a9e8c37864,
                        limb1: 0x2fed32acf02058acc28b8ea6,
                        limb2: 0x1e8f98032027284b29091b4e,
                        limb3: 0x455ab3dd3e8178acb6b4c71
                    },
                    u384 {
                        limb0: 0x4e232bba2d2b0631e57f7a94,
                        limb1: 0x8627ce94ea6ceafbc7a15e33,
                        limb2: 0xbe063a6dbfc8285a5f591417,
                        limb3: 0xd3c72d57b2fc8be49851fab
                    },
                    u384 {
                        limb0: 0xb70dcd8400f9cc70d55e8040,
                        limb1: 0x81d2c5d1f09548780a8e5bd,
                        limb2: 0x7cfa5222661db92f9f90b45e,
                        limb3: 0xa85008e0cb61c7356ab0554
                    },
                    u384 {
                        limb0: 0x75088d00b3d8eb8a9017107b,
                        limb1: 0xbc71605a1bb5b4b1e17204dd,
                        limb2: 0xed4cbaf63eb76130558bf36b,
                        limb3: 0xd51ca94f7c1dd2da0b8cbbd
                    },
                    u384 {
                        limb0: 0xdaa30512aeea734565bb115b,
                        limb1: 0x41ac3f95ccc0955be83f3843,
                        limb2: 0xdcb7e8af7f43068f4367ff76,
                        limb3: 0x147502f27e93076c5c667202
                    },
                    u384 {
                        limb0: 0xf805121e5b22b3b9b18e62e1,
                        limb1: 0x232ca35ac4309a820853775c,
                        limb2: 0xf053b9e9efd692e800e10210,
                        limb3: 0x5c1c26aaf117f278fc3a360
                    },
                    u384 {
                        limb0: 0xf1450654edec3ab0968ef6b,
                        limb1: 0x18c485f1d7e7b508fd7c8683,
                        limb2: 0xeafb8b4b03baf970f245e817,
                        limb3: 0x3dbc7f13e6688fafc83482e
                    },
                    u384 {
                        limb0: 0x1d167712a8656b2ad4f2a858,
                        limb1: 0xd1c554df4306dcf1fe2e59c3,
                        limb2: 0x2236edb3e9bea92a949cfd19,
                        limb3: 0xfc3794bfef3a1f0815acec7
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x57a1bedaed307dfc807a6097,
                        limb1: 0xf0576fdb0977ccaacf2543cc,
                        limb2: 0x9a1a3f605b84c06e9b7599ba,
                        limb3: 0x9e4eb4fdc2f844ef18e475e
                    },
                    u384 {
                        limb0: 0x2d65f9410bd65b0329929049,
                        limb1: 0x52710301436f5dbe18dc07ac,
                        limb2: 0x5caa213b1ffefc049f143893,
                        limb3: 0xc7b6aa5ab7dc019ae1c26b4
                    },
                    u384 {
                        limb0: 0xbdfa5450308917dce7561bd4,
                        limb1: 0x462ba3498fd650c25f641d91,
                        limb2: 0x278eb1aa9c842f723c9d8913,
                        limb3: 0x7e9c7115f305529ed785346
                    },
                    u384 {
                        limb0: 0x4ed2488bb45ac8cf92ad7667,
                        limb1: 0x84760b92981fa474d59746d6,
                        limb2: 0x4c85c420094ef2ab1c303baf,
                        limb3: 0x173e21c1f95d4d29003e1d2b
                    },
                    u384 {
                        limb0: 0x9bb0bee935ad63cfd17a4337,
                        limb1: 0xa0254c33124be868490afd0c,
                        limb2: 0xfe28a3b557124cb7602779e1,
                        limb3: 0x225870c8dd2096d6c362259
                    },
                    u384 {
                        limb0: 0x811fa25cf6df9f09dc07c5b5,
                        limb1: 0x97d62f71d019ee669dbeec65,
                        limb2: 0xdd4ed3ac8ef05435180c79ea,
                        limb3: 0x709af74f7cba5b68d72e206
                    },
                    u384 {
                        limb0: 0xb1890a529e04611f6ab6ff1a,
                        limb1: 0x7cc023ec9c9a001fc9c42556,
                        limb2: 0x1318bbaadab7e3bf04df7221,
                        limb3: 0x1038475993e4e1a3dfb5b1b8
                    },
                    u384 {
                        limb0: 0x905742765c8688c05aa7b9d,
                        limb1: 0x60a3a9bbc0acc36b2d02ee69,
                        limb2: 0xbd8d7fb09d49a3ae289b92f6,
                        limb3: 0x1597a30f7eee8d52f398b599
                    },
                    u384 {
                        limb0: 0xf584f911f44c5c56567e0f58,
                        limb1: 0x6e7653796c6f13ed8497461f,
                        limb2: 0x4e6fea913af81f6e1a370973,
                        limb3: 0x1864aa3078e61a7187ae6af4
                    },
                    u384 {
                        limb0: 0xe5f66986ea013031f7678400,
                        limb1: 0x87e4e87992f958a32e8ed570,
                        limb2: 0x9c7353d97e842b6abd13328f,
                        limb3: 0x1031f6799af53ae6940c3b81
                    },
                    u384 {
                        limb0: 0x959659e1cd5105cacd04b9a,
                        limb1: 0xb39869507b587b1272bb046d,
                        limb2: 0x21a5d66bb23ba5c279c2895f,
                        limb3: 0xd0088f51cbff34d258dd3db
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x7b7fa2ffc473ed10e5d76d7a,
                        limb1: 0x6a00205795fb45223c10304d,
                        limb2: 0x669a88ea3bb76f87a4ae5d6d,
                        limb3: 0x13103af9e2816698196bba17
                    },
                    u384 {
                        limb0: 0x52f4cf35a1f2163e1bfaf5ea,
                        limb1: 0x6f201be478e40fd30fef1e1d,
                        limb2: 0x941a0e0aefe33047d2b26a89,
                        limb3: 0x38b83ad8282569768f47725
                    },
                    u384 {
                        limb0: 0x9891ad40da4d6ef8928f6cc4,
                        limb1: 0x2a8070b5984d1938df81be6a,
                        limb2: 0xb85eaacf327d173a9dfec601,
                        limb3: 0x178312a33dbb581f17f4414c
                    },
                    u384 {
                        limb0: 0x2eef2228e46e13ca46530d54,
                        limb1: 0x7137e25e6a65d3196bef6879,
                        limb2: 0x160d1cec38b0582c6ad58e5d,
                        limb3: 0x75c03b09cf3200587e43949
                    },
                    u384 {
                        limb0: 0xd521c60103ebe779a9f1f1,
                        limb1: 0x8c9ce6d677349a53a9d694b4,
                        limb2: 0x975f5a768622c2bc7ef76c23,
                        limb3: 0xa14b1729b0945c468f079e9
                    },
                    u384 {
                        limb0: 0xd87145c6f6047de38c1870bf,
                        limb1: 0x725adce253cc0cbb8ca39200,
                        limb2: 0x5b4983d878473602ccea4220,
                        limb3: 0x13dae5e86c4abe526e2db101
                    },
                    u384 {
                        limb0: 0xc4385eedc4af072fefc321e4,
                        limb1: 0x3636ae3b2557ef299f035e45,
                        limb2: 0x45bffe49c01663dcdb889cc5,
                        limb3: 0x961c674545a5e1097fd597b
                    },
                    u384 {
                        limb0: 0xa0dce417b47afb80d5361355,
                        limb1: 0xde7a2cb1833b199b089a6d46,
                        limb2: 0x50c2d54cf67e6239fce01573,
                        limb3: 0x7d934b39d08aacc7329dfff
                    },
                    u384 {
                        limb0: 0xcfc571cba82d9c6c8a142f2f,
                        limb1: 0xc1dee38699a8f4b9214d71d2,
                        limb2: 0x3c9e60b271df42ed2a774270,
                        limb3: 0x811f816d5464cb4ded9fdd2
                    },
                    u384 {
                        limb0: 0xad29dd0d27745feded7ef6ff,
                        limb1: 0xfdeb3cc4e7d1b65288f60c19,
                        limb2: 0xf9833f6339b3d33f63bbb5e2,
                        limb3: 0x113f8d05d5665b539eb2c168
                    },
                    u384 {
                        limb0: 0x46142ce17bf2b4e9ab8cd515,
                        limb1: 0x1ff8162e67379b8e6bc9fc69,
                        limb2: 0xcbac3ba9ffb4d902d6c67492,
                        limb3: 0x541c96fb4b33a4bec71dba3
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xd4f4bf6dd4b009d898a2fa6c,
                        limb1: 0x38d6a4560682b0ff0fcb5dec,
                        limb2: 0x7c8ce41b447c92837ee03421,
                        limb3: 0x110e83b4fa1933e3b8ac879a
                    },
                    u384 {
                        limb0: 0x5e0f8625307dc2742d4ed785,
                        limb1: 0xc7c755c9785ecd8ca91cefa5,
                        limb2: 0x5bfd311117ec2d8161f0c770,
                        limb3: 0xa64c27df6827360023d6d9c
                    },
                    u384 {
                        limb0: 0x62c92e8f42479808388c1466,
                        limb1: 0x8500cc7545642a34692de8,
                        limb2: 0x97a3f1dc2ba342a9973efac2,
                        limb3: 0xdd1a0c45a350401beba8531
                    },
                    u384 {
                        limb0: 0xa3a960a1734bae2c857c1196,
                        limb1: 0x8feebdf958ad84fa2ee6ed37,
                        limb2: 0xe7fc8ea809dc5cdbfc45ecd7,
                        limb3: 0xa6ee3c9f209e58595fa0bdb
                    },
                    u384 {
                        limb0: 0xd40a5c705a98d4cc5c52aad0,
                        limb1: 0x91a216ef9200ae90bbbdb792,
                        limb2: 0x2ed5995380421b12cd5fbd9d,
                        limb3: 0xd8ba876156bf90fb50450e9
                    },
                    u384 {
                        limb0: 0x8b281bfb19a809c0df1c9bbd,
                        limb1: 0x8e69500d97d15ce50ae8d461,
                        limb2: 0x22f5278a5c9c10f2d61f4361,
                        limb3: 0x4401e59a1bc3256fdccaf7c
                    },
                    u384 {
                        limb0: 0xd811ac59b824a6bd31906e54,
                        limb1: 0xaf203880558c2dddeabefdf4,
                        limb2: 0x6759bd9aa4807979aedc92ed,
                        limb3: 0x73153a879f949e892e73fa7
                    },
                    u384 {
                        limb0: 0x9ca9eb6ec758ecd9d6762bd1,
                        limb1: 0x87fd167599f2e234131d6571,
                        limb2: 0xde68a5e0040b767e90c2f347,
                        limb3: 0x187e3b31ad215dc3a7b5e79d
                    },
                    u384 {
                        limb0: 0x188f6aa2ebb8ccd81bd5410,
                        limb1: 0x1fdb2314ffe0fb5857826f3b,
                        limb2: 0xce6c22720c5a22322fe65fa1,
                        limb3: 0x8b85773fc5211245fc8c636
                    },
                    u384 {
                        limb0: 0xbedd3f97e0898119923a758d,
                        limb1: 0xf97001126d24e34ecfa8b005,
                        limb2: 0xd5cef5953fab0b31e3f7d79a,
                        limb3: 0x147b323cfae81571edfd13ce
                    },
                    u384 {
                        limb0: 0x45dafe827880f3620703b27c,
                        limb1: 0xd32319e20d4f2dccf6cc0871,
                        limb2: 0x9ed6722630aee2d4645b1e33,
                        limb3: 0x14f58137e27c21acfa3ddcb2
                    },
                    u384 {
                        limb0: 0x8327e8b1ad4d2b64fddd8d99,
                        limb1: 0x6ecc073ab5785950858a015f,
                        limb2: 0x584fb63812ca7ace6ba595e9,
                        limb3: 0x15571b43eff060127e710150
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x8b568bff9dd1b443975e6092,
                        limb1: 0xd99edc1c6a8b2840b2e8c138,
                        limb2: 0x13d2c9fa25ef2714abaf5036,
                        limb3: 0x183ec8131705cd2bcf7798f1
                    },
                    u384 {
                        limb0: 0x4bd33cd687c858f86febd7a8,
                        limb1: 0xbc806f91e3903f4c3fbc7875,
                        limb2: 0x5068382bbf8cc11f4ac9aa25,
                        limb3: 0xe2e0eb60a095a5da3d1dc96
                    },
                    u384 {
                        limb0: 0x4e4ab5043b38bbe24a3eb30f,
                        limb1: 0x746f4af37d2182772202f9ae,
                        limb2: 0x1797a4b69c8e7a5b9d6bdfc6,
                        limb3: 0x100914ce4a6dacad7e7e0e10
                    },
                    u384 {
                        limb0: 0x85e82ba39c2d3c39ff23f81f,
                        limb1: 0xc7aed73048e19b63cd21d233,
                        limb2: 0x7b834fc3ba0184b45c7f8423,
                        limb3: 0x167f37d21cce0013ede0f785
                    },
                    u384 {
                        limb0: 0xa4f5564dec02c5dc02a31303,
                        limb1: 0x3a62e49d5f0582fd989d70ee,
                        limb2: 0xae4bcb0da3f6efb4db0b0858,
                        limb3: 0x11dd378db527870ec19ab715
                    },
                    u384 {
                        limb0: 0xe65ac45d84626686c2f22fbf,
                        limb1: 0xbe596c5c036a69bab60c0671,
                        limb2: 0x5ba1b3aae6340cb6f7189644,
                        limb3: 0x18eb748642669d99ef580e2f
                    },
                    u384 {
                        limb0: 0x8e7c9de03d2b308a055fea39,
                        limb1: 0xe2e1c8aa0914999bc950e191,
                        limb2: 0xe9c1693bd4929c1ae572eeb2,
                        limb3: 0x12e20b97b4dcb1ad9cbdf77f
                    },
                    u384 {
                        limb0: 0xd2f4b22518f0d9eace82949a,
                        limb1: 0x9f54c6fb8d700a9bad9449cf,
                        limb2: 0x971f02d2fba5001f7ef2af33,
                        limb3: 0xf787256d5ac0a5bea7c5230
                    },
                    u384 {
                        limb0: 0xb4df0cf622bcef95b469d825,
                        limb1: 0xab74c5bacd0df357d481594e,
                        limb2: 0xc72bacf376d5aaad8fbd2664,
                        limb3: 0x20a26f4e6423f1535e58dd
                    },
                    u384 {
                        limb0: 0x64e3d323348386e7a5bffddf,
                        limb1: 0xf851296be08be60766d78eb0,
                        limb2: 0x61e9f550797fce4b8fe83c12,
                        limb3: 0x5cc4ccfd741790317567fc
                    },
                    u384 {
                        limb0: 0x7d9979dea46cf278369bcfe,
                        limb1: 0xf729b2ca296891b099165eed,
                        limb2: 0x3c28171d90da7ac06474d4fc,
                        limb3: 0x2df48883655ad61d9d5a6d8
                    },
                    u384 {
                        limb0: 0xcfc571cba82d9c6c8a142f33,
                        limb1: 0xc1dee38699a8f4b9214d71d2,
                        limb2: 0x3c9e60b271df42ed2a774270,
                        limb3: 0x811f816d5464cb4ded9fdd2
                    },
                    u384 {
                        limb0: 0xad29dd0d27745feded7ef6ff,
                        limb1: 0xfdeb3cc4e7d1b65288f60c19,
                        limb2: 0xf9833f6339b3d33f63bbb5e2,
                        limb3: 0x113f8d05d5665b539eb2c168
                    },
                    u384 {
                        limb0: 0x46142ce17bf2b4e9ab8cd515,
                        limb1: 0x1ff8162e67379b8e6bc9fc69,
                        limb2: 0xcbac3ba9ffb4d902d6c67492,
                        limb3: 0x541c96fb4b33a4bec71dba3
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x3f06676a4ca165bd943482b1,
                        limb1: 0x7b8942bed3acbedbfbfcf9ca,
                        limb2: 0x80ff9248f19727f3ef4bbf43,
                        limb3: 0x323623273fe937f82c1f19d
                    },
                    u384 {
                        limb0: 0x302ea91a3b09524e7c49fbbb,
                        limb1: 0xb39869507b587b118b5d4593,
                        limb2: 0x21a5d66bb23ba5c279c2895f,
                        limb3: 0xd0088f51cbff34d258dd3db
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xfd25ccd567319347684f7e8a,
                        limb1: 0xed5aac27c72fdd8abf4ae507,
                        limb2: 0xcc18446e7028de7e7fbd98c2,
                        limb3: 0x17f5a4a58d99e761758b2c84
                    },
                    u384 {
                        limb0: 0x9575079ca5b9d155318cf5d5,
                        limb1: 0x6463a2b2f9dc1051c2de0f0e,
                        limb2: 0x9b2c81e973d2fea46c51b8c6,
                        limb3: 0x152582ab1776f005cd1eaa1e
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x96b654e8990024b1dad5faa7,
                        limb1: 0x16f6fe4ccfcba6ac2597e7b7,
                        limb2: 0x9e426581e55e97d34ea9339,
                        limb3: 0x9de35790d1820950f292429
                    },
                    u384 {
                        limb0: 0x50cd837744dce1fa5f6e7d91,
                        limb1: 0xa2a410e6ff23c005e2492eb,
                        limb2: 0xa3f1650466c73dd460c24def,
                        limb3: 0x16e66afbc29f76423c4eaec0
                    },
                    u384 {
                        limb0: 0x11e0ab6b6a648317ad3b771,
                        limb1: 0x579ad748d4455dc595797118,
                        limb2: 0xf826b92a9e587eabf24e6fd6,
                        limb3: 0x16c4aa5662c14c1d7c5b85
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xe09b33566ec94d1da13efa27,
                        limb1: 0x7fd838bc38ac93bea1279423,
                        limb2: 0x667e0b33933d976b24672acd,
                        limb3: 0x11d35cd789e7e9b6f4d9baf0
                    },
                    u384 {
                        limb0: 0x41d81e7368ea4554c634d753,
                        limb1: 0x5bfc12e9035d5edaaf743c3e,
                        limb2: 0xa2cf011fa1e61802d6b7aadb,
                        limb3: 0x692d4edb15c0c485327b157
                    },
                    u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 {
                        limb0: 0xfd25ccd567319347684f7e8a,
                        limb1: 0xed5aac27c72fdd8abf4ae507,
                        limb2: 0xcc18446e7028de7e7fbd98c2,
                        limb3: 0x17f5a4a58d99e761758b2c84
                    },
                    u384 {
                        limb0: 0x9575079ca5b9d155318cf5d5,
                        limb1: 0x6463a2b2f9dc1051c2de0f0e,
                        limb2: 0x9b2c81e973d2fea46c51b8c6,
                        limb3: 0x152582ab1776f005cd1eaa1e
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x99fae3e65271b45f5539badf,
                limb1: 0x3025a049152b4c59c56e2ec4,
                limb2: 0xb47d8b97def7714621056367,
                limb3: 0xbffcee71f25077a76d7fa2e
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xe4f817e54aede0613c17035c,
                    limb1: 0xdff1f15010392a6da1f95a6,
                    limb2: 0xbed78d3d341e911d49f15454,
                    limb3: 0x18154782ce0913b21588066d
                },
                y: u384 {
                    limb0: 0x3d77d61326ef5a9a5a681757,
                    limb1: 0xd3070afd4f0e121de7fcee60,
                    limb2: 0xdf9ef4088763fe611fb85858,
                    limb3: 0x11a612bdd0bc09562856a70
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xde4f62a6588c9401ffefbd3,
                    limb1: 0x9bb5f797ac6d3395b71420b5,
                    limb2: 0xdc39e973aaf31de52219df08,
                    limb3: 0x105dcc4dce3960447d21d3c1
                },
                y: u384 {
                    limb0: 0xaefd0d854043fd325dd3c34f,
                    limb1: 0x9b63c98d9a7845c52e1e2b0f,
                    limb2: 0x9db0be660d847ccc58358f3f,
                    limb3: 0x17cb6c41f0c4e1a7394ab62a
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xcf86158ab69213388e721bb7,
                    limb1: 0x5f7812269d790797cad9aa15,
                    limb2: 0xb1c3622a0177001d9ed8e25f,
                    limb3: 0x115cf429f459884785c6ba46
                },
                y: u384 {
                    limb0: 0x1e81341e2f3f988ff115dda3,
                    limb1: 0xad22946489db6ee4954fa5e1,
                    limb2: 0x83bed94412e19d92b73cc763,
                    limb3: 0x2074c7bceff87d0d41edba1
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xe2955c55da59eba4b7b57d3d,
                    limb1: 0x1e6629b0431bce67cf28c22,
                    limb2: 0x1c35b7efd5b67f87221b8bfc,
                    limb3: 0x3e53df9e3488a9e42acd87e
                },
                y: u384 {
                    limb0: 0x2e089afa726154d40dd12102,
                    limb1: 0x5391613ecf49db2bcf1cad86,
                    limb2: 0x84a2abb2de6b3a6e09026a50,
                    limb3: 0x19557a3a3c1d62a205d5dc87
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x490bf40774926e8b279947c,
                    limb1: 0xeabab6aef9e9d2a4f64f4e7d,
                    limb2: 0x3e309fe1b1c8247abab20d7e,
                    limb3: 0x79c527862917f69ac58fcc4
                },
                y: u384 {
                    limb0: 0xacb18f2da2b425c2ff50dafd,
                    limb1: 0x7623850d87e279a8a30f31ff,
                    limb2: 0x777564c7291d95fa80203ade,
                    limb3: 0x1764ce0e7fb626109b63789b
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x42f2f3f4f6b9d2c2b73a361f,
                    limb1: 0xcd78c070c184c38b1e5716aa,
                    limb2: 0x72cbc24cd90da89e0e3cefe4,
                    limb3: 0x19485e1c46d0dce75f8b192b
                },
                y: u384 {
                    limb0: 0xb56b3539074b3c47b3f504d9,
                    limb1: 0x2c229530bddedd8851b03dcc,
                    limb2: 0xc93eef8474c4e18d6378e7f0,
                    limb3: 0x173d36f17a3c9ae77a2acc25
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x5fbf29cf20556a11621a6639,
                    limb1: 0xdfda5b7dbf0b226822094787,
                    limb2: 0x4a3b059e521b4b0445df96d5,
                    limb3: 0x333988c2c09f5af061cdfb
                },
                y: u384 {
                    limb0: 0x13d3570be6d27d1d588b22fc,
                    limb1: 0x20c763e58d4df3e4990cdae9,
                    limb2: 0x2c3301367f400c31f4bded26,
                    limb3: 0x16a6c25d133fba74b4c55972
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xcb24d12438557639f52df5fd,
                    limb1: 0x4a6a46feebe8a88a8062bd0e,
                    limb2: 0x65f04211af4b168b1e25787d,
                    limb3: 0x17935d6f4fa575744ca46f75
                },
                y: u384 {
                    limb0: 0x644f324be8a5c152625a5b8a,
                    limb1: 0x501e52e8c5707d7a3a77ee18,
                    limb2: 0x9636c463c14c5b85c2e6d3b1,
                    limb3: 0x1939b6f297f7b5b7fd0ac458
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xde1d8e2670532ec5bba60ade,
                    limb1: 0x1154f5064f7dd38656f7f82b,
                    limb2: 0xc9bec68372b7d07dcf66270c,
                    limb3: 0x315ced00b3153219bbd430
                },
                y: u384 {
                    limb0: 0xc48b3bc110e208d827b13f4d,
                    limb1: 0x87d82592699bca3dbf847c2b,
                    limb2: 0xff04f0f2c8be12365aa73443,
                    limb3: 0x1739c8c450ac994a5326c809
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x8904b74d5d114b5416df0ed6,
                    limb1: 0x479ee13e49cde067742c2655,
                    limb2: 0x45b9359bfa338dd432ca9ff1,
                    limb3: 0x12bf6460e7a42942be6c16a0
                },
                y: u384 {
                    limb0: 0x3a8b37aacb2f620bc41c6109,
                    limb1: 0x91f68edf90b5947273b0aadf,
                    limb2: 0x265d48695a73800b7404124c,
                    limb3: 0x141e3d99b3ab683bdb0ce70f
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x6d6db022a8549ee86374b69a,
                    limb1: 0x3e98f7258170733507d8709b,
                    limb2: 0x10b4337a56d4cd17ab2fe1d5,
                    limb3: 0x11366a6fecb124757076f4b6
                },
                y: u384 {
                    limb0: 0x77b25b600d3baa1a2f54f826,
                    limb1: 0x924c3c1a699e9b27b3612246,
                    limb2: 0x6a253cae0097b1955d4f0cfd,
                    limb3: 0xd2bd6591140d2faabafefac
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0x4a84eb038d1fd9b74d2b9deb1beb3711, high: 0x2a97919d8c25166a1ff39849b4e1357d
            },
            u256 {
                low: 0x3405095c8a5006c1ec188efbd080e66e, high: 0x460ba2d39a6a5f92cca74147f6be1f72
            },
            u256 {
                low: 0x1775336d71eacd0549a3e80e966e1277, high: 0x2894fdbe6288e1a5cc45782198a6416d
            },
            u256 {
                low: 0x2f1205544a5308cc3dfabc08935ddd72, high: 0x43870ae2fcd81b5d24bace4307bf326
            },
            u256 {
                low: 0x42930b33a81ad477fb3675b89cdeb3e6, high: 0x56e06d3d16febaa011af923d79fdef7c
            },
            u256 {
                low: 0x2648ee38e07405eb215663abc1f254b8, high: 0xa4593acd7ab792809e469e6ec62b2c8
            },
            u256 {
                low: 0xd450fe4aec4f217bb306d1a8e5eeac76, high: 0x6b3f2afe642bfa42aef9c00b8a64c1b9
            },
            u256 {
                low: 0x85940927468ff53d864a7a50b48d73f1, high: 0x1b8bb742d977e9933c49d76fcfc6e625
            },
            u256 {
                low: 0xd344749096fd35d0adf20806e5214606, high: 0x233a1ba09466e4726b5f5241f323ca74
            },
            u256 {
                low: 0x5306f3f5151665705b7c709acb175a5a, high: 0x4b2543867c879b741d878f9f9cdf5a86
            },
            u256 {
                low: 0x30bcab0ed857010255d44936a1515607, high: 0x22b15f3fbb42e0b20426465e3e37952d
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 1
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xc0fae85730816663a083b3ff,
                    limb1: 0x8eeeb4d636a81006cac603ad,
                    limb2: 0xf0f40dc24542dd2f9caf4878,
                    limb3: 0x124bec083e5a23bb11859569
                },
                y: u384 {
                    limb0: 0x8666d8ee624f5a3d425b3bae,
                    limb1: 0x2299908d21f6475fc69fed83,
                    limb2: 0x78f769e47d3af619393f077e,
                    limb3: 0x11cd8088ab13c9943e7ddf7
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256R1_1P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high_shifted: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x939295458800009ac8be94f9,
                limb1: 0x57a120ac49dc3782bcf1b6e1,
                limb2: 0x31036fb2f551a296,
                limb3: 0x0
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![u256 { low: 0x0, high: 0x0 },].span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 3
        );
        assert!(
            res == G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            }
        );
    }


    #[test]
    fn test_msm_SECP256R1_2P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high_shifted: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x47336a2358d87987148bcb8d,
                limb1: 0xead7957765acf9a1bbea50d9,
                limb2: 0x1f68715a44c3ef82,
                limb3: 0x0
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x113c8d620e3745e45e4389b8,
                    limb1: 0x85b8ff52d905fd02fe191c3f,
                    limb2: 0xf5d132d685201517,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x60c0ba1b358f375b2362662e,
                    limb1: 0x6abfc829d93e09aa5174ec04,
                    limb2: 0x7bc4637aca93cb5a,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0xeb1167b367a9c3787c65c1e582e2e662, high: 0xf7c1bd874da5e709d4713d60c8a70639
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 3
        );
        assert!(
            res == G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            }
        );
    }


    #[test]
    fn test_msm_SECP256R1_3P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0xf831856624736393b3b76d11,
                    limb1: 0xc165a27df5b76589fe2ce1e2,
                    limb2: 0x2a23444ace6bef77,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xa6bbeec6fb0369c3de339579,
                    limb1: 0xd394f6a5704d1de2da06048,
                    limb2: 0xe8057073c0fde87b,
                    limb3: 0x0
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0x3b1d72dc227f75f02874e08b,
                    limb1: 0xd395fa7c14d6ff33d03e1baf,
                    limb2: 0xbf16fcc65f95b486,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xe2461ebbe7a5b4d76dbef92b,
                    limb1: 0x3eecb75c5315cd3d2d0b9456,
                    limb2: 0x8192517353bc6523,
                    limb3: 0x0
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0xcff970bda4db69dac06ebad8,
                    limb1: 0xdee4204cca252abd67132509,
                    limb2: 0xa79c0006b6ca7fab,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x759642b853dd01b9d2d7bb18,
                    limb1: 0xe1e1d2f8bf0f2f5b463bfae0,
                    limb2: 0xbc3c71be130f204d,
                    limb3: 0x0
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xec4b7a43e1054882a2b8787f,
                        limb1: 0xfb71f01aab18dd64bf0290ef,
                        limb2: 0x739387fdd621db47,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb9104445c9ee329ddab79885,
                        limb1: 0x7fffffffffffffff8f41b07b,
                        limb2: 0x7fffffff80000000,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x8b184b2d84dda8fb47336e4a,
                        limb1: 0x7cc34072cf43d5f8c50e123,
                        limb2: 0x2ac6de072c8291de,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x33cf6619ea9e5a5857292b71,
                        limb1: 0xfb86f6da971e2c2b963efbc8,
                        limb2: 0x35f57801d45a6af7,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x7a1c2b0493c892201f4ed6b0,
                        limb1: 0xdfc0b649a4c1ffe41434c3e4,
                        limb2: 0x6b9772a42ab95dd0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x845a4b3e553c8b8b94d04830,
                        limb1: 0x2c2f8ddc08e40a6d5bd715f0,
                        limb2: 0xe64e5d836de3bc0d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8dae72c8fcd89cd4476749f2,
                        limb1: 0x7e3b93070af8aad22c1313f4,
                        limb2: 0xc65b8685c01c77dd,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x8658cb14baa19703d5c193c4,
                        limb1: 0x7a859f1d78a8d102d490ffb9,
                        limb2: 0x8810871891fb97f5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb79f901e1c9df0b7a2aebda6,
                        limb1: 0x9aa214fa44a1511b0d6c8dcf,
                        limb2: 0x5a97091e3eb20750,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x30e57ea87bf32d352256ddf7,
                        limb1: 0xc156d8c5b13e0239a2601359,
                        limb2: 0xb8e5cdd22d2b5300,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8b184b2d84dda8fb47336e47,
                        limb1: 0x7cc34072cf43d5f8c50e123,
                        limb2: 0x2ac6de072c8291de,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x33cf6619ea9e5a5857292b71,
                        limb1: 0xfb86f6da971e2c2b963efbc8,
                        limb2: 0x35f57801d45a6af7,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x1eba51d293cb74b25730952a,
                        limb1: 0x906541fa014f7054082fbe21,
                        limb2: 0x2e106fda62d7fa85,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x18d0afe0edb98066b4e326fd,
                        limb1: 0xffffffffffffffffee22305f,
                        limb2: 0xffffffff00000000,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x79a28720b6f6c2901c1b6b21,
                        limb1: 0x704ddc3781df41868fe9f55e,
                        limb2: 0x518625728416a2bf,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf0e378a3ec9247fbe26bb7f6,
                        limb1: 0xe9569edc77fe9281c42dc1fc,
                        limb2: 0xa101bf854330a5e9,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x6d8fca3224e3136dcba20051,
                        limb1: 0x531ef14ca1e30be2b0bceb4c,
                        limb2: 0xb666fb69f3c379d6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x97cac4a4fdff83f6161c6056,
                        limb1: 0xa0d567b311571677c37ca52e,
                        limb2: 0x6fc445a46fd466fd,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2d46378df71f30211f291fbd,
                        limb1: 0x6817355d6ca9352b06f4696f,
                        limb2: 0x975515b1e97470a4,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xdfb71a46102ad9dee734687e,
                        limb1: 0xd04da4108863a8238e9ea8b7,
                        limb2: 0xefe716b56f4b6c3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x84885b5b88da356c87aef9b5,
                        limb1: 0xac4230444d712eb17d097f09,
                        limb2: 0x169f510fa322d815,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf9a9470a7617644a808f3867,
                        limb1: 0xf7e7e0c00e9ccf371893c0bb,
                        limb2: 0x77c0f746e0a8a22b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x79a28720b6f6c2901c1b6b1e,
                        limb1: 0x704ddc3781df41868fe9f55e,
                        limb2: 0x518625728416a2bf,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf0e378a3ec9247fbe26bb7f6,
                        limb1: 0xe9569edc77fe9281c42dc1fc,
                        limb2: 0xa101bf854330a5e9,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xa9676ad3b9efcf4e461f93a4,
                        limb1: 0x45b3ccf12c2e3c619157a6de,
                        limb2: 0x3c0fc5c272f3b212,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5784a91a5e09d24e7c4a2665,
                        limb1: 0x7fffffffffffffff7c074594,
                        limb2: 0x7fffffff80000000,
                        limb3: 0x0
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xef83b988624532b4d50958cc,
                        limb1: 0x7c751ca858569d5f9d6672ec,
                        limb2: 0x76a51d1761fa980c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf4e91c6638a52035171c649b,
                        limb1: 0x4d85e5372103d60ec8aebf48,
                        limb2: 0x994d0330e99fcbcf,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x95a032c38809b3674a705f22,
                        limb1: 0x5354b2074b618c858b289c7f,
                        limb2: 0x7665a34a8549ce9f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2e1e7ce6eeff836215e86895,
                        limb1: 0x83ec0565ce91000c75ae3f79,
                        limb2: 0x88a12adc65e89b5f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc45977bd10156f2598c0d18c,
                        limb1: 0x9c0bc3988d833b0010a9e6bf,
                        limb2: 0x33a7d18b3006b094,
                        limb3: 0x0
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x8d66e8b7b483d3265ac1edeb,
                        limb1: 0x560d3627f7cdcf9c54522ca,
                        limb2: 0xc5d0f963ce8e175,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x382e9e19dfde37e65c9f124c,
                        limb1: 0xa722e47de4449f771e39dbd7,
                        limb2: 0x8579057707069afb,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xed985bc391dedb9ee27d3278,
                        limb1: 0xcb5a0db0138d04900b10c8d7,
                        limb2: 0x8edf2c43ed5b307b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xef83b988624532b4d50958c9,
                        limb1: 0x7c751ca858569d5f9d6672ec,
                        limb2: 0x76a51d1761fa980c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf4e91c6638a52035171c649b,
                        limb1: 0x4d85e5372103d60ec8aebf48,
                        limb2: 0x994d0330e99fcbcf,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0xb8ef2dfd1444c4e0efe00148,
                limb1: 0x967459cf9f622705ee83c962,
                limb2: 0x3a669994cff338be,
                limb3: 0x0
            },
            g_rhs_sqrt: array![
                u384 {
                    limb0: 0xf57dfd2e75b1ce26390a7a1a,
                    limb1: 0x609597792b488ee2b8b2a3f2,
                    limb2: 0x605b9279af8c238f,
                    limb3: 0x0
                }
            ]
                .span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x113c8d620e3745e45e4389b8,
                    limb1: 0x85b8ff52d905fd02fe191c3f,
                    limb2: 0xf5d132d685201517,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x60c0ba1b358f375b2362662e,
                    limb1: 0x6abfc829d93e09aa5174ec04,
                    limb2: 0x7bc4637aca93cb5a,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xd3ff147ff0ee4213f51f677d,
                    limb1: 0x431366a7732a6e4a6b942255,
                    limb2: 0x9fe743b25d39a591,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x7f8bb562ff60a902ef14bcb0,
                    limb1: 0xeb9420089fa531db62e806a6,
                    limb2: 0xfd028df433dfd5cc,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0xe443df789558867f5ba91faf7a024204, high: 0x23a7711a8133287637ebdcd9e87a1613
            },
            u256 {
                low: 0x1846d424c17c627923c6612f48268673, high: 0xfcbd04c340212ef7cca5a5a19e4d6e3c
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 3
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x33ee7695471a03192ef22266,
                    limb1: 0xb449dd8cfd0c3438e14a718c,
                    limb2: 0x1fbb33f079b828e2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb411f97aeec2eae6044122ec,
                    limb1: 0xcdce180b60667260d7ce284e,
                    limb2: 0xa73a7381dd3b07c,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256R1_4P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0xddb5a889b8b2286c5d1124ca,
                    limb1: 0xe3db8af7035bf63b788d1b86,
                    limb2: 0x2e193b7cafebcfe6,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x519a5d47cdb177063c1665a5,
                    limb1: 0x4f72ccaf2e61bf1ca5909e56,
                    limb2: 0x5a4c815353430f54,
                    limb3: 0x0
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0x7471395483d3edfae9b6f108,
                    limb1: 0xdc3612b8c1cff114d0097f61,
                    limb2: 0xf3cd0f7bac63576e,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x7546388b69b878a6a1808495,
                    limb1: 0xc57e063ce6a1619ab7f4a8c9,
                    limb2: 0x876dcde507c5b206,
                    limb3: 0x0
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0x7be10be31458fbb2b84ad1cf,
                    limb1: 0xc6c7c5315901dfe6df3b4e86,
                    limb2: 0x245ced58428a76b2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x59d7d6bf1a2a69e2c0c680f9,
                    limb1: 0x35c6a2e80821772c88ce7405,
                    limb2: 0x4859fbcef0a50f54,
                    limb3: 0x0
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xffb6485b7c4566a12ccfcd11,
                        limb1: 0xa67ee86cc834e674d041231e,
                        limb2: 0x28c5224ab16b57a4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd9c383c68cb492ec67b2395d,
                        limb1: 0x71d790d80ab9f5d0fb151fc3,
                        limb2: 0x41571d3e0e10ebe4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd2eb4c69b0a6de0146012128,
                        limb1: 0xffffffffffffffff7024d874,
                        limb2: 0xffffffff00000000,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x5476f94da448d8a0b5a7fa17,
                        limb1: 0x2a75a94dfc04b5d38b5376be,
                        limb2: 0xe43d427c163f1e69,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2bfc44077e07eede31ee0071,
                        limb1: 0x3b1fd21baf4610b3b6b30bf2,
                        limb2: 0x34bea281e5e77f17,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x79d10ff5a364aaf2c8a2102,
                        limb1: 0xabbc41e06a7ea1f12c2ae401,
                        limb2: 0x7d2c0a463ce48e9,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xa271389f3cf354e14933999,
                        limb1: 0x6be238049b022ad7b00556b5,
                        limb2: 0x6227007b71ec4eab,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x81a98038f340f2d0c79f31fe,
                        limb1: 0x5274f97681207a2827bc6ccf,
                        limb2: 0xf2e9272318f42cea,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x409f864997e75300aeac837,
                        limb1: 0xacc1a8e74849a5aa25812760,
                        limb2: 0xb521716b25b4d497,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x86b25fdc4107da96a39b316d,
                        limb1: 0xeeb7ea0e4debbc1513785825,
                        limb2: 0xe9754fd5e5871805,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x1fef3193aef53d8f4caff4e9,
                        limb1: 0xda3666b348a12207c8fa7091,
                        limb2: 0x982eaac7d63601d3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x44bae73bb48330c5d1e600b6,
                        limb1: 0xf04f6d1fd9fbdc76705a8cd0,
                        limb2: 0xf1cf8cb2ee54ff50,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7171a0e61d8792e69df715ca,
                        limb1: 0xd2de7aa3f9881f7e76c2f070,
                        limb2: 0xca6c6af18baeea7e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9f37745d17434d157dbf75d,
                        limb1: 0xdb2ca102332156bc6befd16b,
                        limb2: 0x278b3668950ed792,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2bfc44077e07eede31ee006e,
                        limb1: 0x3b1fd21baf4610b3b6b30bf2,
                        limb2: 0x34bea281e5e77f17,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x79d10ff5a364aaf2c8a2102,
                        limb1: 0xabbc41e06a7ea1f12c2ae401,
                        limb2: 0x7d2c0a463ce48e9,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x265c69a8e3e7c06adaae96d5,
                        limb1: 0xf2c24562857ce6c73b616712,
                        limb2: 0x1d631e42290f63d8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4df5736f2c3d354532cdd9a4,
                        limb1: 0xca375e54e818fed09da008d2,
                        limb2: 0x6690a8268bbbc915,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8fbc03718caec8c8d5896705,
                        limb1: 0x7fffffffffffffff7071f4bf,
                        limb2: 0x7fffffff80000000,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xa98b6697792c7ca6153315cb,
                        limb1: 0xe506ae2992b850ce808a62be,
                        limb2: 0x1810213c71d467e5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5aef2a607802894543454fd4,
                        limb1: 0xc37e2df93f078e1430c9adcd,
                        limb2: 0x9858cbb796d570f8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x70e180348f1485209fe454c3,
                        limb1: 0xb361ba1eac0aa717d4ae8027,
                        limb2: 0x421eeca46756c162,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xfb6e6cfff43a10797c5f947c,
                        limb1: 0x85027a230fb9dca5788fa6bc,
                        limb2: 0xac7cebe051a6dbbe,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x45cc7cfa0084f61eff2c55b,
                        limb1: 0x6419c168903005a03c11c17a,
                        limb2: 0xdf714a758256bfc4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x51ebd8f55d2ffb3e4c38c263,
                        limb1: 0xf5dd6d419df79243ce9be0bf,
                        limb2: 0xe661e5fe6aaad9e3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2ff40730ed4faf644a9a58f1,
                        limb1: 0x2071e0d1524351fa845e5d35,
                        limb2: 0x4f28c082f2e015a5,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x7b424fcc9b19a5970f8a7889,
                        limb1: 0x751dd445551ca06df7292de5,
                        limb2: 0x67751346680674dc,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe758f0cf6925b17f8a687fa,
                        limb1: 0xa1bde6742cb62a8d20fc66db,
                        limb2: 0xc18fa407e04c0b97,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfec73f31fbf3260beaddfdc,
                        limb1: 0xd9427e1f14e3fb7199211ff5,
                        limb2: 0x7fcfc59683fc0a9c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x233a96f007bd29825d5877cc,
                        limb1: 0x7ecd3d230530e243679be8fa,
                        limb2: 0xac799126e60ab7a6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5aef2a607802894543454fd1,
                        limb1: 0xc37e2df93f078e1430c9adcd,
                        limb2: 0x9858cbb796d570f8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x70e180348f1485209fe454c3,
                        limb1: 0xb361ba1eac0aa717d4ae8027,
                        limb2: 0x421eeca46756c162,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xce0d4b410db15011f911186f,
                        limb1: 0xf4042319b3b11502f64c5780,
                        limb2: 0xd79196cb21d6a818,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5784a91a5e09d24e7c4a2665,
                        limb1: 0x7fffffffffffffff7c074594,
                        limb2: 0x7fffffff80000000,
                        limb3: 0x0
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x930b9ab3fb21f9d722a3fbe9,
                        limb1: 0xd87efe2f34e1ce7c8f4c072f,
                        limb2: 0x17553851540da845,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfadbac867d316525dfe3d27,
                        limb1: 0x5d022815e52e2f0450bb321a,
                        limb2: 0xe7d6032a111231e0,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xd94e11529a22d65737a40a2,
                        limb1: 0x64008c4424bcbdea3514dcbe,
                        limb2: 0xc98d9953968d73b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7a70797ab359296f4fb6cd31,
                        limb1: 0x1261095efd0b9ed9ccaa68b4,
                        limb2: 0xd7a8864f0ccac96e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6cf1a470f35dfb92fb1b3f8c,
                        limb1: 0xf28b98c374677684e1ce9441,
                        limb2: 0x8510090c592a83df,
                        limb3: 0x0
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x1e7f52e99d64f63e60ffe4df,
                        limb1: 0x21f9b7790a9c215bb3446d95,
                        limb2: 0x6ac260f76104ae91,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xea5ef1b6aa3bce230da69eac,
                        limb1: 0xb7e346d6dad5d49c18f194f6,
                        limb2: 0xd2ef116263327903,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9d4a809d0454f9470dd7a8d3,
                        limb1: 0x9ce54513c70df9af72eb7065,
                        limb2: 0xa3442c577703fe49,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x930b9ab3fb21f9d722a3fbe6,
                        limb1: 0xd87efe2f34e1ce7c8f4c072f,
                        limb2: 0x17553851540da845,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfadbac867d316525dfe3d27,
                        limb1: 0x5d022815e52e2f0450bb321a,
                        limb2: 0xe7d6032a111231e0,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x69885846433877e72248b548,
                limb1: 0x7b09868cd7634fbb21895d4f,
                limb2: 0x5bd3733f6a58e95e,
                limb3: 0x0
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x113c8d620e3745e45e4389b8,
                    limb1: 0x85b8ff52d905fd02fe191c3f,
                    limb2: 0xf5d132d685201517,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x60c0ba1b358f375b2362662e,
                    limb1: 0x6abfc829d93e09aa5174ec04,
                    limb2: 0x7bc4637aca93cb5a,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xd3ff147ff0ee4213f51f677d,
                    limb1: 0x431366a7732a6e4a6b942255,
                    limb2: 0x9fe743b25d39a591,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x7f8bb562ff60a902ef14bcb0,
                    limb1: 0xeb9420089fa531db62e806a6,
                    limb2: 0xfd028df433dfd5cc,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x46ae31f6fc294ad0814552b6,
                    limb1: 0x2d54cc811efaf988efb3de23,
                    limb2: 0x2a2cc02b8f0c419f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xaec889b9d8ce51c4a2c3586f,
                    limb1: 0xa2b07874c333bfee9f78e13e,
                    limb2: 0xc445de21be8d8709,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0x1846d424c17c627923c6612f48268673, high: 0xfcbd04c340212ef7cca5a5a19e4d6e3c
            },
            u256 {
                low: 0xb4862b21fb97d43588561712e8e5216a, high: 0x259f4329e6f4590b9a164106cf6a659e
            },
            u256 {
                low: 0x12e0c8b2bad640fb19488dec4f65d4d9, high: 0x5487ce1eaf19922ad9b8a714e61a441c
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 3
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xb2a60bc0dd8b8ee13a6c1fb1,
                    limb1: 0xd694821758e9d16d0d548853,
                    limb2: 0x6ba86041669b4d29,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x3ff4aad67ae0150cc663ba71,
                    limb1: 0x20491f6ec9a09b3a65f78e23,
                    limb2: 0x755517c39d1215c2,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256R1_10P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0x25d1a3c893718047539eb6e1,
                    limb1: 0x9b4041cff07fd2dbe9da2b60,
                    limb2: 0xd309a45be3d5092a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x30d69755292ed509791ee5a,
                    limb1: 0x5f4ea127722eae987f32fe53,
                    limb2: 0x591da7462a9198a5,
                    limb3: 0x0
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0x2ae5492e7c640788f25d9247,
                    limb1: 0xe0c327d25b75d88ef0a263eb,
                    limb2: 0x6378fee63621654a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xfdd5c97a0eaaf1d76bc49ba9,
                    limb1: 0x6fc6dc7aa6a9ea75bbf1dbc,
                    limb2: 0xe0b69dabeddce211,
                    limb3: 0x0
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0x6e4319cf45817544b4bd3e70,
                    limb1: 0xf042dc4ac606cb47341d59f4,
                    limb2: 0xc01a1b2c3961b092,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf5974a787c8b7db33323bc11,
                    limb1: 0x3d7dee392e99de8c61a5250d,
                    limb2: 0x8e1253c4a6653eb1,
                    limb3: 0x0
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xbbef1ef74375bf6e321508f2,
                        limb1: 0x612f6c9eacfc00dbb0b21c2f,
                        limb2: 0x4f6f471d28ab92ed,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3e71aba46b0328810db6415b,
                        limb1: 0x5272c9947e0d0d55b2c063b0,
                        limb2: 0x14163c46ebfe2ee8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x497b82436f2d26413ff0eb56,
                        limb1: 0x2974ab0bce18615157a3ae73,
                        limb2: 0xe928703f206c72eb,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3d6644b793254781597a1fd6,
                        limb1: 0xbf15492456403c66486b213e,
                        limb2: 0xf4e23dc89b4fbb8b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf6b4eed587e3a350e7025cfe,
                        limb1: 0x1d6b7e8d8081e6e04b9ba8d4,
                        limb2: 0xa98ece60c92d45e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa50f66b9e4c6419345b22244,
                        limb1: 0xbd7fe09d33a3bb6daa839237,
                        limb2: 0xde5f30509bda8387,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa10f4ed07830e92f29999d91,
                        limb1: 0xeee4da392f188ca09ed3b804,
                        limb2: 0xbd0be888de40aa45,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x43717d9bb6ca660f21c149fa,
                        limb1: 0xfc3c2e32bace70a164b0b81c,
                        limb2: 0xf978310ae551acee,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3825e33a2c2d1009e71f9de4,
                        limb1: 0xfffffffffffffffea1ac2d3a,
                        limb2: 0xffffffff00000000,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x9de719ad4fd61bd4f74e98f9,
                        limb1: 0xd2d79c6ea5b2d6d3a2ec7480,
                        limb2: 0xc5eec9345e20d89a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf797e460876a4e9c2ca8bda9,
                        limb1: 0xbfced2cb3239d4b685ed6831,
                        limb2: 0x5aaf309cf1e46efe,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe481adf7f775b58943e55e63,
                        limb1: 0xd50a10d510b807d3a5135098,
                        limb2: 0x6db5dbbbfa5b1211,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf3128a5699e1a96f6bd9274d,
                        limb1: 0xbdc6ec51d33edcd3f9f57cc3,
                        limb2: 0xef699843ac0c47d3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xcdf4c90ded5ddfb85cdd06a3,
                        limb1: 0x35eaf7c0444446de097ce548,
                        limb2: 0x7eaa8fd02b4dc997,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7212ce637bed458005063c7,
                        limb1: 0x1ad6da6d53036a80416d0b37,
                        limb2: 0x6fb0ce6e3f4aecbd,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6cddffe53e43b255adac1c9,
                        limb1: 0x9ee24da23c307cd0d14af253,
                        limb2: 0x504dfd90f2ad366f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9b8e0b6994805d7e801aa2c5,
                        limb1: 0x589952ab26ab70d01ce5319a,
                        limb2: 0x82f93548f29f4c90,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x740de5ce2b59f8b808d00b7,
                        limb1: 0x7a7e45d4e6e72e0699f760de,
                        limb2: 0x412cd75783e75e0d,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xc443868d526f587e4cf53dc9,
                        limb1: 0x26f55a9b27d688c64e4ac49c,
                        limb2: 0x3c0fba2519e60a7a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x45cfc5697b0a38f561d508c3,
                        limb1: 0xead7ff86467311b3e6a6212e,
                        limb2: 0x3664e4d6c196a999,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbcb8b88a14e3808baf78e780,
                        limb1: 0xb5de9053c8bd7febed0dab3d,
                        limb2: 0xa1af84db312604b2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc853aae8263b1b5b2a13eac1,
                        limb1: 0xefaed08aa6550c384b317be6,
                        limb2: 0x86fb620943efcd19,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfb1b2a528382f283a6f17813,
                        limb1: 0xfdb495e83cd971558bd30473,
                        limb2: 0x1ffc0461f94bffce,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbe54224438637379d45c0815,
                        limb1: 0x39b79c46cab0551445f81c55,
                        limb2: 0x5f0e86f407b272de,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4911b616e2266167a20d25a1,
                        limb1: 0x1f5af0f4454df40213e11c21,
                        limb2: 0x154f0a12c3a0aab7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xeea678a6c68d4843aca2b5be,
                        limb1: 0x9cc7e76bbfb9df5eedc4f1ac,
                        limb2: 0x1b121cf4c1e1c3c7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7b39ca45c217b058a2dd75eb,
                        limb1: 0xbabfe6e7c0dfc449908518be,
                        limb2: 0x599d5f0e3414c657,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2e30eb2180037345613f86ea,
                        limb1: 0x82fa4401c6a3f965b7885d20,
                        limb2: 0xa2c34470ab21ee11,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x9977b50c23c8a146910864de,
                        limb1: 0x7a49a918c4f5ff2f3179f04a,
                        limb2: 0xab4d4bb7c9cf5ad6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x332f6ba785d9705282e7179a,
                        limb1: 0xd36b474efb83be786814af1c,
                        limb2: 0xd0532faef20d3d04,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x80accc32cf2637519c89ac64,
                        limb1: 0xb1b6e5a104f1b9600b250adc,
                        limb2: 0x6ec90b8255b39a06,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbd6af830be5795f1679043e2,
                        limb1: 0x20cba5ccf6ffaff80a21ae34,
                        limb2: 0xaae40944cc6792a4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe0291dcf0c8062875511e565,
                        limb1: 0xb1a9833830e450cd0448baa6,
                        limb2: 0xe375254365fafacb,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe9a96a163feff87ce31ec62a,
                        limb1: 0xbb893cef1658afc8a4c69041,
                        limb2: 0xc12be578b2ca5857,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3601493d3e8848ba63df5bb6,
                        limb1: 0x37f6d0750b0815bea8926db7,
                        limb2: 0x6b323e78f1dcb783,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x302fca756441f1a76f13a78f,
                        limb1: 0xcc2c4192030ba6fd4e8cea82,
                        limb2: 0x5ff4fc3f38ac1fac,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x523dda5e2042a721e21346af,
                        limb1: 0xe30a9d92a62cc100cb60a540,
                        limb2: 0x7bcb314026713a75,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbd5ef5dde79198c101061fee,
                        limb1: 0xe3533978fe1379796881d66a,
                        limb2: 0xe78dad621131b02f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9b8e0b6994805d7e801aa2c2,
                        limb1: 0x589952ab26ab70d01ce5319a,
                        limb2: 0x82f93548f29f4c90,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x740de5ce2b59f8b808d00b7,
                        limb1: 0x7a7e45d4e6e72e0699f760de,
                        limb2: 0x412cd75783e75e0d,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x71ee10f44ec4c17fdff5d8a7,
                        limb1: 0x803f7e627804a67f24ac706a,
                        limb2: 0x588e2be0c25ee5d6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdb6e709e0d189635f34f20da,
                        limb1: 0x8fc7e332405f723794e937c1,
                        limb2: 0x1eb88f2d00fb3fa3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfb90c6db93507b85f1f590f1,
                        limb1: 0x64b0afdf8a4f88aa2e5efaf5,
                        limb2: 0xf6b101cb96b98771,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x374113178ea132c918a64a28,
                        limb1: 0xdb87ef86910294a57f7b47e3,
                        limb2: 0x90696f74517ef2ce,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7bb76751c64ecb2f8ac452d6,
                        limb1: 0xa5defa086613168828dd05bb,
                        limb2: 0x85953c080e4e8b0d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8dc360a3f04839a525c53f14,
                        limb1: 0x142dfe3a2a60d8cdfdae5350,
                        limb2: 0x3dc795fc6059e2cc,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc3864b507a69918881c20371,
                        limb1: 0xb385d4ee05fadf10d2066fd0,
                        limb2: 0xbe9dd85f63aa59a7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xda50308b2356d301f09495e2,
                        limb1: 0x2b9303444a112fe967ad48ca,
                        limb2: 0xd8b04a7325b13c60,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3421ab33b87bd3386bb8c039, limb1: 0x852d4ebf, limb2: 0x0, limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xe18f2e9aee69ec9e4ba239e1,
                        limb1: 0x667442b46f224b36f90ad3cd,
                        limb2: 0x332c18c89615fbe5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa8b56cfa0fac74e9f552535d,
                        limb1: 0x3748e578838a3a016133992f,
                        limb2: 0x7a36aedde726ff3e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfb617366a853f56f572a5c4c,
                        limb1: 0x1e9e91bb356f541a9c96df5e,
                        limb2: 0xf7aafbab58b01281,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7a02d9bee74ac2beff067361,
                        limb1: 0xc5ccb9e158cbbf7fcbc514c5,
                        limb2: 0xf632b3952b267fd1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x69ca836024bf51f3547e2972,
                        limb1: 0x4178fb6931cb470c590a43df,
                        limb2: 0xf2a9e058d14fdf1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xffc791928eafe8f393ebec8c,
                        limb1: 0xa78c8d2d1c58dc1ec7cd631,
                        limb2: 0x91a3db83988045b3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7d166c3c6a7f67b71622d443,
                        limb1: 0xa09544deab27d9c91bbda31,
                        limb2: 0x85f6920a36fafed1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe0ccdcc6b1877e8fa2653bcf,
                        limb1: 0x74d519ab32a9bf5b44d51f6a,
                        limb2: 0x4c58a3045e0b7572,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x22d38f6f9c31849e1ce2551,
                        limb1: 0x34fb5fd27bf12853932f2853,
                        limb2: 0xb0bd7ccd319b01ed,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xf06b0a1f2db1d67a476c3f8c,
                        limb1: 0xd74789b3472999853db83cc7,
                        limb2: 0x621e9b427aad00e5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xee7a39e0ab759333f9cfa512,
                        limb1: 0x26f90265e9ea236508526e09,
                        limb2: 0x123c45d5cfe23f1e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb0adb1cee0c42666c020f30f,
                        limb1: 0xf6b92fb3960f3fee16d57e0b,
                        limb2: 0x16eb691fa123420b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x70e428238fcdf9942c6ab1e4,
                        limb1: 0xc2e7a3b1dd50cbf0b6c8bd4e,
                        limb2: 0x4fd6084215740bd8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8f6a65b552f29d2c46d4bf6e,
                        limb1: 0xaa595df23414e0313d14ae95,
                        limb2: 0x955e2b8a930b599a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x45443f003b27fbddd01a31bd,
                        limb1: 0x970a24201394f9290a8b4c01,
                        limb2: 0xe943f9cb109e81c5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x48c8d652374a0ba5ca474529,
                        limb1: 0x3df560b1dae950a3c4c708bb,
                        limb2: 0x820b2b85a6daa745,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4eadbe3bacc6f940979f2d5e,
                        limb1: 0x982aa108eae69c10af27ce73,
                        limb2: 0x2dffc04d4dd3ff0a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x61079eeb41a87c7d0cac8ac5,
                        limb1: 0x4cc95ace6aa5aa3b69c4a0cb,
                        limb2: 0x6ba0883aff75e302,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7337e831643e33f6136f8700,
                        limb1: 0xf1de3e20b1d77395396674c9,
                        limb2: 0x15e4338c30ed291a,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xd3511d7c1ff45bb7cf3e78ff,
                        limb1: 0x5c74cd554a26360df12ee2f6,
                        limb2: 0x72d240e6ccdfec72,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbd1d3a28f1867aebf09e2968,
                        limb1: 0x6db6f42a3efa0581cc1e1c7f,
                        limb2: 0xe36b2512f8e0a0c9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xcd0c55c8ef619ff43f81248c,
                        limb1: 0x1b235a8fa5d2f54e2e7e00a7,
                        limb2: 0xc0ad1130f2d62c55,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf6ac89322f5feae4dbba5f00,
                        limb1: 0x63429a711eb262dfb3763343,
                        limb2: 0xea0431351ad22b3d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf23a325459c9e1df5b3774af,
                        limb1: 0x41c7f62ed6df4b5de787925,
                        limb2: 0xf6abea0e82b17b56,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf26df36b54314b96f11e2e2,
                        limb1: 0xee97eef8ac35105c095aaaec,
                        limb2: 0xcb71da41b26ceb29,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb025e7f064804cd1720cccaf,
                        limb1: 0xbf14bd2777d7ad5524e1f6ce,
                        limb2: 0x6b9432c401b4adbb,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb7e85790374ac034dd12303d,
                        limb1: 0x66bef997916d47a3a44d90d4,
                        limb2: 0x559927ab78cbb383,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfe40f49aec5e112b1e424c,
                        limb1: 0xd1695c06cfb5f929119707c,
                        limb2: 0x3678159b4c9132bf,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x42e2724db9045b17988ac499,
                        limb1: 0x1f02f22bed778b5e3d4b67eb,
                        limb2: 0xce8451794c648cf3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe0ccdcc6b1877e8fa2653bcc,
                        limb1: 0x74d519ab32a9bf5b44d51f6a,
                        limb2: 0x4c58a3045e0b7572,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x22d38f6f9c31849e1ce2551,
                        limb1: 0x34fb5fd27bf12853932f2853,
                        limb2: 0xb0bd7ccd319b01ed,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xcc6d355de177e27133a20d6e,
                        limb1: 0x35db921e88ad2f8a22d44244,
                        limb2: 0x1342255b8e75d9d1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5784a91a5e09d24e7c4a2665,
                        limb1: 0x7fffffffffffffff7c074594,
                        limb2: 0x7fffffff80000000,
                        limb3: 0x0
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xd358addd9e230def4c9aff10,
                        limb1: 0xc69672db3d3ea241f4380be6,
                        limb2: 0xa5a08c3334ad0876,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x66d79d023e1a833258e52f47,
                        limb1: 0x2ef9fbe2de835c29db404222,
                        limb2: 0xdc6ce5eb907cea24,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x33b085706efb55725771b8b1,
                        limb1: 0xa96603460d28b7f8fe4edd41,
                        limb2: 0xe0bee2c2afe81ea5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6953f1803a5b22ea9cab2ac5,
                        limb1: 0xc8f3cc52e024af2bcd589bbc,
                        limb2: 0xd7dfbeca6af373a0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7334d4d17c8174f0b543bf4e,
                        limb1: 0xb66c581b0a6781ea58f96e9f,
                        limb2: 0x3a526c7a805ad18d,
                        limb3: 0x0
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xb1d18cadf44ec593271a40f2,
                        limb1: 0xead7c19874ebe089319afa06,
                        limb2: 0x9f4c0ab0b2f262b7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8371cb2425920d6219e42401,
                        limb1: 0xb379af25ae08861a7559626f,
                        limb2: 0xb5e2b140597b20a5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x97ccd9ef817eb2a71d22d273,
                        limb1: 0x26fdc9acdb0e723ed35c404c,
                        limb2: 0xc57f8412f8c3d57e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd358addd9e230def4c9aff0d,
                        limb1: 0xc69672db3d3ea241f4380be6,
                        limb2: 0xa5a08c3334ad0876,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x66d79d023e1a833258e52f47,
                        limb1: 0x2ef9fbe2de835c29db404222,
                        limb2: 0xdc6ce5eb907cea24,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x77673e35d1c88ab8873dd798,
                limb1: 0x9f95c93fc237eb0a09a50865,
                limb2: 0x3c58cf513216206e,
                limb3: 0x0
            },
            g_rhs_sqrt: array![
                u384 {
                    limb0: 0x66c144d07ecd47509d5dd2ff,
                    limb1: 0x4ab379cf8f2065c9d8d90df4,
                    limb2: 0x1a33b2f04e67195c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3c03af3320a36e9ad2d72344,
                    limb1: 0xa80cfe034b4d57641ef44431,
                    limb2: 0x3cf2ee6957b3bebf,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x51c10b36a102451f763091d7,
                    limb1: 0x20d036ae73bf378c0d676a1,
                    limb2: 0x354d8fa3a917a404,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x81e37773d9204a0f71de8b79,
                    limb1: 0x22708c5206e1ff3c3ca2c760,
                    limb2: 0x691859efe8ef449a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x79fb95f225bcde6bd6242c6c,
                    limb1: 0x605fef7fc623b668086aa1ca,
                    limb2: 0x4d9150ed646d9cf4,
                    limb3: 0x0
                }
            ]
                .span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x113c8d620e3745e45e4389b8,
                    limb1: 0x85b8ff52d905fd02fe191c3f,
                    limb2: 0xf5d132d685201517,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x60c0ba1b358f375b2362662e,
                    limb1: 0x6abfc829d93e09aa5174ec04,
                    limb2: 0x7bc4637aca93cb5a,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xd3ff147ff0ee4213f51f677d,
                    limb1: 0x431366a7732a6e4a6b942255,
                    limb2: 0x9fe743b25d39a591,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x7f8bb562ff60a902ef14bcb0,
                    limb1: 0xeb9420089fa531db62e806a6,
                    limb2: 0xfd028df433dfd5cc,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x46ae31f6fc294ad0814552b6,
                    limb1: 0x2d54cc811efaf988efb3de23,
                    limb2: 0x2a2cc02b8f0c419f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xaec889b9d8ce51c4a2c3586f,
                    limb1: 0xa2b07874c333bfee9f78e13e,
                    limb2: 0xc445de21be8d8709,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x7e47d1c2d19c21b2f6870259,
                    limb1: 0xe701b40af42001c38bca00db,
                    limb2: 0xd87ea1720d4dd3d6,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x5b1d6cc74985ce49a1f737fe,
                    limb1: 0xb9127c572c3f091c031c249c,
                    limb2: 0x1392711e1576aa6f,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xb71f95ea692ed186e06e4c37,
                    limb1: 0x807276cd9cc59718bb11dbe9,
                    limb2: 0x10756a25836d67ca,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd34211b3520c83c5f9be99af,
                    limb1: 0x8f19a28ceef67bbda102ffe7,
                    limb2: 0x7ac2b92030d351cc,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x411bb5d0fbe844f025c7178c,
                    limb1: 0xcf603787227b7ac499d6d1c4,
                    limb2: 0x5f6b2479862eb2f8,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xce60303cfcb98726ff64a1e5,
                    limb1: 0xa64534c614754b3527588d25,
                    limb2: 0x44f75e245622181,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x8a703177da18d4ede707c057,
                    limb1: 0x7d6c11e754ab6fbe73deea43,
                    limb2: 0xdf9787168190a047,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x2e6585ab5f125a34fef37875,
                    limb1: 0xb70e9f02ce7744197172a117,
                    limb2: 0x60e305f9fe6f2298,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x712f72f3929408ff68af059d,
                    limb1: 0x4f72cea12cd115dc1c8639f5,
                    limb2: 0xc6d5ae1b897ffe77,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xfcf91f56bad0659142668837,
                    limb1: 0xa15458b49bcdad6c870e3889,
                    limb2: 0x81a1342e70b1b765,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x461d7579f9613d3168fc6220,
                    limb1: 0x7626024a6195fe0eafcea08b,
                    limb2: 0x32e91b268a032443,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xcdc7ae298071a741aafd4035,
                    limb1: 0x9a9bdfbdb824dc1278457a10,
                    limb2: 0x17fbec3713dfd145,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0xb5d32b1666194cb1d71037d1b83e90ec, high: 0xa0116be5ab0c1681c8f8e3d0d3290a4c
            },
            u256 {
                low: 0xd3fbf47a7e5b1e7f9ca5499d004ae545, high: 0xbaf3897a3e70f16a55485822de1b372a
            },
            u256 {
                low: 0x101fbcccded733e8b421eaeb534097ca, high: 0x38c1962e9148624feac1c14f30e9c5cc
            },
            u256 {
                low: 0x247a8333f7b0b7d2cda8056c3d15eef7, high: 0x1759edc372ae22448b0163c1cd9d2b7d
            },
            u256 {
                low: 0xe005b86051ef1922fe43c49e149818d1, high: 0x7d41e602eece328bff7b118e820865d6
            },
            u256 {
                low: 0x4a84eb038d1fd9b74d2b9deb1beb3711, high: 0x552f233a8c25166a1ff39849b4e1357d
            },
            u256 {
                low: 0x3405095c8a5006c1ec188efbd080e66e, high: 0x8c1745a79a6a5f92cca74147f6be1f72
            },
            u256 {
                low: 0x1775336d71eacd0549a3e80e966e1277, high: 0x5129fb7c6288e1a5cc45782198a6416d
            },
            u256 {
                low: 0x2f1205544a5308cc3dfabc08935ddd72, high: 0x870e15c2fcd81b5d24bace4307bf326
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 3
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x617117bf1151fd79fc71b779,
                    limb1: 0x4e2f6459c4115850de36db63,
                    limb2: 0x3e7e9f9d44a05b03,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf05f55006d626fa5d91a695d,
                    limb1: 0xd2cf263e6037971f0c923d96,
                    limb2: 0x5cffe1dc97fa2157,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256R1_11P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0x396217fb094172485ed71701,
                    limb1: 0x86d8b0c7d1a5e4c7a5f9bc6d,
                    limb2: 0x71f625cb03b8ef6e,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xe98177c6d14f501e14485170,
                    limb1: 0x1a7ca5a7ace37e332a4c11f6,
                    limb2: 0x983fcff92b02e21,
                    limb3: 0x0
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0xb2a7ea53b9538de66e7e743,
                    limb1: 0xd60f5b3e71a8f46db68ceef2,
                    limb2: 0x9c1ad67a074850c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x2dd4f91dabff063662e0d3a3,
                    limb1: 0xf06ae0503f3f8ea7bde84f8e,
                    limb2: 0x5e760d2ef3c9e447,
                    limb3: 0x0
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0x2f71d6eb303b3bf480fc702d,
                    limb1: 0x68910d569e6682c2fa1032ee,
                    limb2: 0x82845286591c8fd2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x73d8aa453b7a7f95d4951130,
                    limb1: 0x73e64c911c98638f780f7279,
                    limb2: 0xee21dbae9f50d5d7,
                    limb3: 0x0
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x5e17612e442ca0eec2232748,
                        limb1: 0x45d67c1513c63832254222b7,
                        limb2: 0xb9d9dca53f12029a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbc599d6e2fc58549d2024592,
                        limb1: 0x9c520dd5fd1654f42eb13dbf,
                        limb2: 0xcf755b8de8b25949,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x136c32049a4130e8df2fed80,
                        limb1: 0xcaa00f638258411189e26b39,
                        limb2: 0xc596eb4fd0e5bb3f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x398a6af230379c88f6a124a8,
                        limb1: 0xc9c5d6faed0e20b3a1e470ca,
                        limb2: 0xd0c35fb1a680bed1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6c680bf01af81989c8e68700,
                        limb1: 0xd802a04b887c1eac21701c03,
                        limb2: 0x1426f17d1a795544,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf71dd3228fcf87eb1d446fcb,
                        limb1: 0x90b2d51ea5d064137010be91,
                        limb2: 0x7c8c873d0be45d5b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe006d9b7cd03b49f064ba92b,
                        limb1: 0xa2e7087b830fb047349c0ccf,
                        limb2: 0x91fc964610ae526e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x36713ea248f9a1d301fef80e,
                        limb1: 0xb18ed33815490016af236441,
                        limb2: 0x3694c5da0bb93133,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x54edf407c23a4a37b1c47805,
                        limb1: 0x27cfad772f2fc3880bbc73ef,
                        limb2: 0x479be38d15ad8871,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb567e88c38eb2c5271b1a2e3,
                        limb1: 0xffffffffffffffff40a797b9,
                        limb2: 0xffffffff00000000,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xdc1aba2998e6b8a58529a3a7,
                        limb1: 0x644876871f74d74bebbe9477,
                        limb2: 0xe65ab11fa39ef993,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x17099f47b73ece2a509432c5,
                        limb1: 0x3fa7afc2f60c7b439bb332dc,
                        limb2: 0xa4863f027c779b09,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x117eba257a1b701d1ed12799,
                        limb1: 0x9da675e5c02802df3af3cf35,
                        limb2: 0xe41afafb4f0b067b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8b92ac786618f1073736c9f9,
                        limb1: 0x21c9e27964c231b2f780278a,
                        limb2: 0xbec5846b0b42757e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7f85c8364de6a761b608facc,
                        limb1: 0xbb8d5a3a4523f32562271331,
                        limb2: 0xba2e183ca67c3b5a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbdf5cb7f4b4b8c57008fe644,
                        limb1: 0x659be137b94602041d4309e3,
                        limb2: 0x3ba9c34550804cf1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x187b941e56958652de6e1d7c,
                        limb1: 0x958bce021aad77f4a1e0d1db,
                        limb2: 0x15a48509ac16849b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x61dd0bb49ea77fbac541b015,
                        limb1: 0x67f440d9071adba0cbf038d0,
                        limb2: 0x332f62190403bd0a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x55a58a7c7c88a9a76d52327b,
                        limb1: 0xeb189f2810dd2687a3294435,
                        limb2: 0x3ff2c647f18924ef,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x582b64e538fbdb47652e41b7,
                        limb1: 0x3d1a1f41df9b57e5239413e1,
                        limb2: 0x8268361d5097152e,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xe37f86a9624a3b228ed6d8e8,
                        limb1: 0xd35f5458538634ff6a22abe6,
                        limb2: 0x6a7d7d8db8ce841e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe76dd024d50a1c6c8cd58c5e,
                        limb1: 0x4a70c2fa41766dced0262d05,
                        limb2: 0x759eb256aefe5d16,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdb28975fa1955ab5e1f86625,
                        limb1: 0x24df9b7b3c711eaac2874781,
                        limb2: 0x680fb0e80339b3c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4e34e5b010c14feeeae153d,
                        limb1: 0x8d90f275ed6bf45653ca9891,
                        limb2: 0x3ea2de235dfd7ce2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x959ac0b66a846b90de419e81,
                        limb1: 0x362390d100b927fb016f0beb,
                        limb2: 0x68a384dc8fd7e183,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7140b6ea57007b6988d2dce,
                        limb1: 0x394154c680c661bd1f3aae39,
                        limb2: 0x42153b80dee7f797,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2bace4387a4e086651944b2d,
                        limb1: 0x6591e6f564af70358dc4139f,
                        limb2: 0x50aa024b2ad32794,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3b9ceb5895067db3a65f9962,
                        limb1: 0xc4b947b8c7a0310fd7d182a4,
                        limb2: 0xecd6b7ec5f7d32c3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x95d56b69bd93471c81fd3fdd,
                        limb1: 0xa2841f31c00888a3c78667cf,
                        limb2: 0x461984b8b40a0788,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x11f151f3a45b3bda6e0770d2,
                        limb1: 0x28892a6669e464591cdb846b,
                        limb2: 0xd7bd8c7855ddcd46,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbf6a28b204d397119f84a80b,
                        limb1: 0x148ab4c930afe8372b91bde9,
                        limb2: 0xfb9db5b99682fa5,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xfcb9704c36940d7712611cb5,
                        limb1: 0x3725047cd3c05075d2d8f4bb,
                        limb2: 0xf58e07b86581cbf9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc5df17298786734eaf16c9dc,
                        limb1: 0x1bd682e351af778323b51804,
                        limb2: 0x60a0a17d77c7c17e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x100aca4e837e4f084c7399dc,
                        limb1: 0xf06f031c5347d2cb4316ada0,
                        limb2: 0x9c84798958e13978,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2f5fec2738387660d3903db0,
                        limb1: 0xfb868fcbef8ffcd5d7c2ad35,
                        limb2: 0xf9d435f0844556b4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x55e52ee242ef33d6152bf1cf,
                        limb1: 0x649113291bea2a278e1ed83e,
                        limb2: 0x1ef7d72642962f1e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x102c4add0fd8c03296bbad07,
                        limb1: 0x6d1a068aec7309c2222ec3c2,
                        limb2: 0xd0c0dfa11edbb1e2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5352da2c8b2457f7aea04828,
                        limb1: 0x89e231bb8f7d5956476011ed,
                        limb2: 0x229d2860fd270783,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x86755f17419b80921414858f,
                        limb1: 0xc87e537d044ba28383ffddce,
                        limb2: 0x7cc27575209a02de,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x66344c5dcc2093b90d5ed253,
                        limb1: 0xfb61d3fb1e5992b6282b830a,
                        limb2: 0x4f72497f96ed1d37,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8c8003649cdfda6cbbfb5c98,
                        limb1: 0x7866e10ba7d25809dd3ee75a,
                        limb2: 0xc20751b0b9267622,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x25ae8dfb2f822a22bd894b3a,
                        limb1: 0x6491a068dee15aadc65103de,
                        limb2: 0x6bcf598bc791168,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x55a58a7c7c88a9a76d523278,
                        limb1: 0xeb189f2810dd2687a3294435,
                        limb2: 0x3ff2c647f18924ef,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x582b64e538fbdb47652e41b7,
                        limb1: 0x3d1a1f41df9b57e5239413e1,
                        limb2: 0x8268361d5097152e,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x19bf9dfd2e01a6219fdc1fe,
                        limb1: 0x99bf0a0bd5fc71ddc8ea2b03,
                        limb2: 0x52755556a0d111bd,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5e55d3f221137638549c1088,
                        limb1: 0x631a2668a46ac547a7e745fb,
                        limb2: 0x90fe1cc834ad8e47,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1c74deee8b8c0cea491aa2cb,
                        limb1: 0xd93f084d09cb8520b8c25224,
                        limb2: 0xe72ebbf52278cf28,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x49ffe0a4abcd776a6956bc61,
                        limb1: 0xa06b558f932f2ee24d9d14d8,
                        limb2: 0x2c4cee7db395fbcd,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x12cece240593aceb64496c3b,
                        limb1: 0x1f5a0a339912b4854539e625,
                        limb2: 0xaf5c2b98a3a857bc,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe1efd3bdf426d4dab5d77618,
                        limb1: 0x1f0b29a83e67e19f73f7abb1,
                        limb2: 0x2fd278d97fa656ab,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x30bba17081c9a0954503984f,
                        limb1: 0xdc637edd27abd643557d96c8,
                        limb2: 0xd2a585948d35e173,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x588b64ec66677096839b66f,
                        limb1: 0xccc6e69640ff146e7571cdf7,
                        limb2: 0xb758d6888eec176e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x61256a03ab1038e7b94e570d,
                        limb1: 0x3c8a497b67e4fb9843f3fe5d,
                        limb2: 0x8570a32a8cb71060,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x19df3f5ba6361a3986a8e9ce,
                        limb1: 0xffffffffffffffffe345814a,
                        limb2: 0xffffffff00000000,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x863633c5717e4ddd8a50185b,
                        limb1: 0x56394813381a8523473b7439,
                        limb2: 0xe6cca89568f9cf1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3627766b110991ad6ff306f4,
                        limb1: 0x2481dd2b208c443efb411bf4,
                        limb2: 0x8b31fb3039314e2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4f9132663119c45ed14ccba7,
                        limb1: 0x6a4172ccaf6c178330ed7f4d,
                        limb2: 0xefcc0c929b431a41,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x766ba5aa3177e4de18dcdb56,
                        limb1: 0xb862ff0bb14593e72191c5d0,
                        limb2: 0xb2886011c71d5263,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4660d839591cee96eaecbf2d,
                        limb1: 0xd8abc0fb55ff8c9653d6b5e8,
                        limb2: 0xbbc9806a9f897307,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb00ce8acebfe6dcef8c596c6,
                        limb1: 0x24fd66fd5a761dabc91a0607,
                        limb2: 0xf867b86d5b73d4b2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x67baeea0fcb0eda50bde9875,
                        limb1: 0x1e960a8b9dd7deffe6415003,
                        limb2: 0x979180b61a192054,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4f0bbbd278292c7f53da2a3b,
                        limb1: 0x1dc132901db5509de6271bfd,
                        limb2: 0xa1f28a3f2cd962e6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x88c30a7868efd343787403f0,
                        limb1: 0x6c10fd73e0723affdd59a67f,
                        limb2: 0xb9fa15e0b6fcbdfc,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8662fe3b06a814b15d1d7175,
                        limb1: 0xede374cb3f98483f1300e15c,
                        limb2: 0xea9cae80b3db7f8f,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x342b9f289862bc6ff4299302,
                        limb1: 0x19711479ea626f7394438199,
                        limb2: 0x89c545e547457f8d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8116065880c2f307032d1e58,
                        limb1: 0xbdf3fdb7414a66678e116247,
                        limb2: 0x5b1d6eeac544ca97,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb100a3bb320eebd3a5aa112,
                        limb1: 0x9aa8156764e935246aa8f849,
                        limb2: 0x35754d846c511fda,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5714de89bf5cbd45cd4c16c5,
                        limb1: 0x7196ba218afa768ba21aa3e4,
                        limb2: 0xd617adbd4c9eabb,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5f6f363517ff14880b5a24da,
                        limb1: 0x41108544b69617aed0fc0026,
                        limb2: 0x626532256f3547e5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4387a11c87bfab14fb8f1ab4,
                        limb1: 0x1019ff00e6eabbf9b928207b,
                        limb2: 0xac1d74c93e474d6b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4c39fcf1c408ff96260f8f7,
                        limb1: 0xbf0d18d2fa42ade8a94c4461,
                        limb2: 0xc4f970753b0f7092,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe399495fa40aad85793fead,
                        limb1: 0x45a5ffb7f07749752a4d503e,
                        limb2: 0xdd7dda9bdd3bab75,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd92c9548ca3f95da04e23c1a,
                        limb1: 0x4cb93730e66cd97ee5b9724,
                        limb2: 0x8a892a1197e7ac5a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xee4c42273ae883033b6d0edf,
                        limb1: 0xd359c8b4ad66db39f46447ce,
                        limb2: 0x5f2787adbe065ac4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xac91e7e621466616e7ec6b66,
                        limb1: 0xfba75cdaacc12e5b356a976a,
                        limb2: 0xbfa19ebd5517d79,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x154dfd510c7bd5d27354f733,
                        limb1: 0x70fbc2cda06685d980754e60,
                        limb2: 0x934651e0e0972864,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe47c7a8002e9b4b6b996bd62,
                        limb1: 0x2c8118ee964b4aed7ab80be5,
                        limb2: 0xfc83d85adcb5057a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x586f72debfc6a0471a10c550,
                        limb1: 0x39a969a12420bb8550b66b96,
                        limb2: 0xb9fa5fbbfa9d67a1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x81410b69131b67a6ca3d7a1c,
                        limb1: 0x7742923a3b53f8ea6dffafc5,
                        limb2: 0xfa41ddf6d1c91942,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xed415715b9a95d277f93e365,
                        limb1: 0xca0bbabe39b971e57f5983a4,
                        limb2: 0xb7114c27d016c967,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8b88da93b03c46aec7093079,
                        limb1: 0x46d000cdf3535840454c6ae1,
                        limb2: 0xc3e4a2528d50cbb4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x18f67108e161e2ee4e8c92fb,
                        limb1: 0xd5c4eefa50b0efeb06916269,
                        limb2: 0x59e2de74023797ac,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1c3d8699f2eff5ed4f1c5db0,
                        limb1: 0x612e7e5f72a548568f930a77,
                        limb2: 0xf64e87bde2174502,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xca4d73f5dde285727e3ee396,
                        limb1: 0x5858d04c9aa6f02e187b9165,
                        limb2: 0x9d0e71018013f45e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x83240315f13f041e64c47e5e,
                        limb1: 0xf39b6faf32a0842e5b87d662,
                        limb2: 0xbd7566021972f9a7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x883672179fff2aa964543625,
                        limb1: 0x8029183d584fe9d12417e9a,
                        limb2: 0x3ce2b493bb817820,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x88c30a7868efd343787403ed,
                        limb1: 0x6c10fd73e0723affdd59a67f,
                        limb2: 0xb9fa15e0b6fcbdfc,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8662fe3b06a814b15d1d7175,
                        limb1: 0xede374cb3f98483f1300e15c,
                        limb2: 0xea9cae80b3db7f8f,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x80a0b38c7176c0250e79070c,
                        limb1: 0xc695ba87128f20ed6caa6b04,
                        limb2: 0x3e723be71a83eed8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5784a91a5e09d24e7c4a2665,
                        limb1: 0x7fffffffffffffff7c074594,
                        limb2: 0x7fffffff80000000,
                        limb3: 0x0
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xd170b840986da92a4b7c9e4e,
                        limb1: 0xc0c9437d125cd96f57410e4f,
                        limb2: 0x44e09215ade0b15e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc563aa6f942f8b2d181ba88f,
                        limb1: 0xc15f976aeff088cf4f62de20,
                        limb2: 0x73ba0011066eeb21,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xb89371da8293063f446e1684,
                        limb1: 0xdbd378849db8542b4bb9c5d7,
                        limb2: 0x1fd7b291e8a2dda,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x771ffbb381f2feb2d07353ef,
                        limb1: 0xddb40afc3384b7282995afd5,
                        limb2: 0x4f15c60e1c119e47,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf2771ab2d83cce7763e0d479,
                        limb1: 0x370d5414592569cd1374666,
                        limb2: 0x704e0c967da3d667,
                        limb3: 0x0
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xe672ae4db636f197035cccd4,
                        limb1: 0x58ca161bbb76dc452ac5c05,
                        limb2: 0xd17080de9f0bdb95,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x384666a216de738c9cd6d0c2,
                        limb1: 0x2565b371ca4582950ce392ea,
                        limb2: 0x82160b6ecf76a36f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7c28b1a77f3f9ab6df7f669c,
                        limb1: 0x6fccf714a6c6ec4e76f46c50,
                        limb2: 0xff9835a396edd284,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd170b840986da92a4b7c9e4b,
                        limb1: 0xc0c9437d125cd96f57410e4f,
                        limb2: 0x44e09215ade0b15e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc563aa6f942f8b2d181ba88f,
                        limb1: 0xc15f976aeff088cf4f62de20,
                        limb2: 0x73ba0011066eeb21,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0xf888193a208fcfbd8f58e726,
                limb1: 0x17dc1c330754b90fe68364e7,
                limb2: 0x1764c4a79c00c331,
                limb3: 0x0
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x113c8d620e3745e45e4389b8,
                    limb1: 0x85b8ff52d905fd02fe191c3f,
                    limb2: 0xf5d132d685201517,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x60c0ba1b358f375b2362662e,
                    limb1: 0x6abfc829d93e09aa5174ec04,
                    limb2: 0x7bc4637aca93cb5a,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xd3ff147ff0ee4213f51f677d,
                    limb1: 0x431366a7732a6e4a6b942255,
                    limb2: 0x9fe743b25d39a591,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x7f8bb562ff60a902ef14bcb0,
                    limb1: 0xeb9420089fa531db62e806a6,
                    limb2: 0xfd028df433dfd5cc,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x46ae31f6fc294ad0814552b6,
                    limb1: 0x2d54cc811efaf988efb3de23,
                    limb2: 0x2a2cc02b8f0c419f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xaec889b9d8ce51c4a2c3586f,
                    limb1: 0xa2b07874c333bfee9f78e13e,
                    limb2: 0xc445de21be8d8709,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x7e47d1c2d19c21b2f6870259,
                    limb1: 0xe701b40af42001c38bca00db,
                    limb2: 0xd87ea1720d4dd3d6,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x5b1d6cc74985ce49a1f737fe,
                    limb1: 0xb9127c572c3f091c031c249c,
                    limb2: 0x1392711e1576aa6f,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xb71f95ea692ed186e06e4c37,
                    limb1: 0x807276cd9cc59718bb11dbe9,
                    limb2: 0x10756a25836d67ca,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd34211b3520c83c5f9be99af,
                    limb1: 0x8f19a28ceef67bbda102ffe7,
                    limb2: 0x7ac2b92030d351cc,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x411bb5d0fbe844f025c7178c,
                    limb1: 0xcf603787227b7ac499d6d1c4,
                    limb2: 0x5f6b2479862eb2f8,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xce60303cfcb98726ff64a1e5,
                    limb1: 0xa64534c614754b3527588d25,
                    limb2: 0x44f75e245622181,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x8a703177da18d4ede707c057,
                    limb1: 0x7d6c11e754ab6fbe73deea43,
                    limb2: 0xdf9787168190a047,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x2e6585ab5f125a34fef37875,
                    limb1: 0xb70e9f02ce7744197172a117,
                    limb2: 0x60e305f9fe6f2298,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x712f72f3929408ff68af059d,
                    limb1: 0x4f72cea12cd115dc1c8639f5,
                    limb2: 0xc6d5ae1b897ffe77,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xfcf91f56bad0659142668837,
                    limb1: 0xa15458b49bcdad6c870e3889,
                    limb2: 0x81a1342e70b1b765,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x461d7579f9613d3168fc6220,
                    limb1: 0x7626024a6195fe0eafcea08b,
                    limb2: 0x32e91b268a032443,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xcdc7ae298071a741aafd4035,
                    limb1: 0x9a9bdfbdb824dc1278457a10,
                    limb2: 0x17fbec3713dfd145,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x9b85054533e9d24310265ee0,
                    limb1: 0x51cbb79b2625c435ba43bbef,
                    limb2: 0x1fd81fcb136c629b,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x96378a2e47ab50246a9cf131,
                    limb1: 0x4d0f08867537268cf39eae04,
                    limb2: 0x4eeb60396f3e5f52,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0xd3fbf47a7e5b1e7f9ca5499d004ae545, high: 0xbaf3897a3e70f16a55485822de1b372a
            },
            u256 {
                low: 0x101fbcccded733e8b421eaeb534097ca, high: 0x38c1962e9148624feac1c14f30e9c5cc
            },
            u256 {
                low: 0x247a8333f7b0b7d2cda8056c3d15eef7, high: 0x1759edc372ae22448b0163c1cd9d2b7d
            },
            u256 {
                low: 0xe005b86051ef1922fe43c49e149818d1, high: 0x7d41e602eece328bff7b118e820865d6
            },
            u256 {
                low: 0x4a84eb038d1fd9b74d2b9deb1beb3711, high: 0x552f233a8c25166a1ff39849b4e1357d
            },
            u256 {
                low: 0x3405095c8a5006c1ec188efbd080e66e, high: 0x8c1745a79a6a5f92cca74147f6be1f72
            },
            u256 {
                low: 0x1775336d71eacd0549a3e80e966e1277, high: 0x5129fb7c6288e1a5cc45782198a6416d
            },
            u256 {
                low: 0x2f1205544a5308cc3dfabc08935ddd72, high: 0x870e15c2fcd81b5d24bace4307bf326
            },
            u256 {
                low: 0x42930b33a81ad477fb3675b89cdeb3e6, high: 0xadc0da7a16febaa011af923d79fdef7c
            },
            u256 {
                low: 0x2648ee38e07405eb215663abc1f254b8, high: 0x148b2758d7ab792809e469e6ec62b2c8
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 3
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x8bb75ba627234dc63e79a70b,
                    limb1: 0xf80598ab2773419027b1531f,
                    limb2: 0xcf5ff5f040bbf9f9,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x74e9046434afc5dcf31ffcca,
                    limb1: 0x7a10638d5630b338c33f51f4,
                    limb2: 0x581c177d075c1692,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256R1_12P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0x63c70f94dcf043039d5b06fd,
                    limb1: 0xaea5b5d016d780fc3268e4c0,
                    limb2: 0xaab7cc308e570714,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x2ccddde18a7ebaea35b7e5a6,
                    limb1: 0x77890d800c548f0895b91ba5,
                    limb2: 0x38f62d852b001d58,
                    limb3: 0x0
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0xb8703d4eb1e2bfd5d9961829,
                    limb1: 0x1842a9aca84733324c506a00,
                    limb2: 0x4d0d88487505dfdb,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x3ed04afc6933b3f7805988f7,
                    limb1: 0x52d3fe01f66a332d0085908c,
                    limb2: 0xfdb0892e58dcbc1b,
                    limb3: 0x0
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0xa03532a10c75403f0d217fb8,
                    limb1: 0x3e4656ee3a4f973d11c76c19,
                    limb2: 0x29c888c3b44f0160,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x3a168c8dac103d557d99273,
                    limb1: 0xf0dc9ffb09bdf06ec71bc3ad,
                    limb2: 0x9acb520c6222d492,
                    limb3: 0x0
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x6f1cd29c0bd0632afeca1bae,
                        limb1: 0x6882ae2068b8830c7bf450b1,
                        limb2: 0x29b8db3861b69b3a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x74cd196ef937beae85083e36,
                        limb1: 0x8f63df86b5b5e0519445f1c,
                        limb2: 0x8850598a9b1503aa,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5b7ad8d718ce6f6120e86042,
                        limb1: 0x15767c51b0267e780a4f0082,
                        limb2: 0xd34cc791dd9122c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb4ed73c27062bacd01bdabb6,
                        limb1: 0x4def284c9b48221cfbdc62ed,
                        limb2: 0xc7a85ba3a9f69036,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3f953f2e96408cce5c839755,
                        limb1: 0xed6f30539e9f584ecc447837,
                        limb2: 0x9b81b3baadcb6433,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x54bc915bee3c0c03f5e47b00,
                        limb1: 0xf57da7ecfa9bb334d673bebe,
                        limb2: 0x80f9514a8f34d57b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8dfccb20428e2ddab4c13f46,
                        limb1: 0xa9d4d966589f6a2dcb7518e4,
                        limb2: 0xea7cf24ed0ee58c8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfb0677ded10d2a44ea0eed82,
                        limb1: 0xaeecaa5035bd31ccb8d8cc5b,
                        limb2: 0x6b8101c9d4f9099c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf730b84c25c18e9763b488c7,
                        limb1: 0x8d500c41d4f9f30ff9c8d6da,
                        limb2: 0x4310991eed58e9b6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3087945086b4fec19fccfd89,
                        limb1: 0xebec86984ad1fbd361748542,
                        limb2: 0x3b3753833925f72b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb06a8352bacb73a1de43473a,
                        limb1: 0x7fffffffffffffff2cc719d7,
                        limb2: 0x7fffffff80000000,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x855d56666877537078b417b3,
                        limb1: 0xd232a57de1a7ebef85b7ba08,
                        limb2: 0xd416a16bd8fb0d62,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf0736372020160ee1daa9b80,
                        limb1: 0xdf87b07426ad6517bb231ede,
                        limb2: 0x96efaf2bedce81a9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x59feb891cbf31be615ef500d,
                        limb1: 0xf11cd8e8aba12c504652c683,
                        limb2: 0xd6293e89b493ba4b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe5c11fb3f5a39956d4ffaa8,
                        limb1: 0xda00dd0c971feb2909e761b7,
                        limb2: 0xe10f28bbe66fdb6f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa84e93aafc6b0a35ef6c88f2,
                        limb1: 0xa6d2a4af363e411b8d80bf44,
                        limb2: 0x4f2e63c078526667,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe5075d56356608c8288f8622,
                        limb1: 0xaa129bac1e9862d4049e3025,
                        limb2: 0x8bb059abb57a32ba,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x39728c1634b36e7624b23037,
                        limb1: 0xb99a0a1be7e4a4a2e911bdab,
                        limb2: 0x207b3d369d695363,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4c8d6da4b413df4098eb69bc,
                        limb1: 0x932b1948f91f1aa6eb229e8f,
                        limb2: 0xbc1cea72e92f7507,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb58d010fa1ac42bf8aaceadf,
                        limb1: 0x4f82c834af4fdb180ad4ad89,
                        limb2: 0xcce875b85a5f1aa7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x72c3ed2ea6f03246d543de73,
                        limb1: 0xc7e5e4f9d80395f15ced28ab,
                        limb2: 0xaadcc74b663b9f65,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdf2d0c776303badb0f853865,
                        limb1: 0x545214dbb412e5046b801108,
                        limb2: 0xc99c6dce6459b8f9,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x147ba3c1a381b8a504a08ad3,
                        limb1: 0x6f222cea9e71f9f84bd91ae7,
                        limb2: 0xba2479dc38543b7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5ee590afa7d5c91f902588,
                        limb1: 0x7cdd4815a4499e844f6ea8f6,
                        limb2: 0x119fe356db4f214d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6e41155c16609641c634c30b,
                        limb1: 0xf331072caa53249d6a4eb134,
                        limb2: 0x861eb12eb4575003,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x72ed5a1441bf260e2fac63b8,
                        limb1: 0x2bc533aa15d6635a04047bd5,
                        limb2: 0xb1ede6a71afaef14,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd80ab32df3ef23c7373ea3a1,
                        limb1: 0x4bd9356d3f6455b120818102,
                        limb2: 0xe23c4b4abe3df575,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9352b95573a6202e407fd7f8,
                        limb1: 0x660b82e6cc07a9487c2edfe3,
                        limb2: 0x4c4bf8041507d758,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd26ce50116693d26c4a4934a,
                        limb1: 0xce026c4a79c96f98d62b6ddc,
                        limb2: 0xac0496036e34f964,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xae1705d431f4e63d8feead0f,
                        limb1: 0xe7f5eda93abea4c7a5d0478d,
                        limb2: 0x1bd98128bd1bc2a8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdb4321da032187ab54ed2fd9,
                        limb1: 0xbe54afde73b8132816e478cf,
                        limb2: 0x44628cb291c8dd4f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2259351c8ce8e079b3a28a89,
                        limb1: 0xfaf792dee2d34c789de22ac7,
                        limb2: 0x8659ed04ce56916a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2929b8c78dbaf233ea899c01,
                        limb1: 0x15fd45305330ad60a5a5f515,
                        limb2: 0x779b60c96961f8d7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x79b082907f423da73c471e61,
                        limb1: 0x4b3d4b006cce15c5c9ac2bcb,
                        limb2: 0x2fbeadbeb589de1d,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xed4fde5a0708c5a7f004de9f,
                        limb1: 0x62440d05901656930fe199ed,
                        limb2: 0x9a934dbf535c776d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfc3eb38fce83d90edf420230,
                        limb1: 0x712625d97013c2fecf2e843a,
                        limb2: 0xf68643bca1aa6ce2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf405a98b84c96c8457dbde6,
                        limb1: 0x85e48e682dc44982109d4091,
                        limb2: 0x9efab2e94c83d4f0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9e385270c033e9e3bfdc23ca,
                        limb1: 0x886bfdd8364af1b858575375,
                        limb2: 0xb729fe5680ff8887,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2f0db559ac863169c6c01c97,
                        limb1: 0xfb71225bdad50056f57071a8,
                        limb2: 0xb2ce7163a17ba844,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x393cb4b6a0f00ef71f0e6a11,
                        limb1: 0xa20a64d9986b881dc7076003,
                        limb2: 0x9dd461ccf2a6aaf4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x86e9531d673609b9d022fd63,
                        limb1: 0x77e2f3f561a7eb8c5310350c,
                        limb2: 0xdd0e1b7035103e90,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1f2689963b07925287a48f83,
                        limb1: 0xef41ed07aa1f04bce5645b84,
                        limb2: 0xeb7a8c8ff971bc10,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4dff98008b3416304969a8bf,
                        limb1: 0xd8ddc28cc4feed9cee240699,
                        limb2: 0x734ea7498a5083be,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdabdad05add2dd40c0bf61f7,
                        limb1: 0x5392a53ec780f24a4021233f,
                        limb2: 0x7da14f9fe4972f65,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7fecd82dcc55c941b2144a04,
                        limb1: 0xe5114e61b176443f1a636be6,
                        limb2: 0xe2e6b4b0ca836cbd,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe4598c9fb46f4e6c83efa1f9,
                        limb1: 0x67846f709afb2c72d718121,
                        limb2: 0xcad96223d78c83a5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x72c3ed2ea6f03246d543de70,
                        limb1: 0xc7e5e4f9d80395f15ced28ab,
                        limb2: 0xaadcc74b663b9f65,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdf2d0c776303badb0f853865,
                        limb1: 0x545214dbb412e5046b801108,
                        limb2: 0xc99c6dce6459b8f9,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x1acfe9d2fd6b3f8d8f518559,
                        limb1: 0x18e928b571d2073b234996c8,
                        limb2: 0xc8a2b9b768e7bc68,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa9fe1cbbbc3b1342b32d9a80,
                        limb1: 0x8bb1de944ef821cde847abc,
                        limb2: 0x4f9ddbbfd1f97ce8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdd05e7b4d8cd8922e56f18d8,
                        limb1: 0xe9cb20bcfd4a01f26b7e360d,
                        limb2: 0x161be09fac63158d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1bf649c7638814200c56e18b,
                        limb1: 0x7f5b862ec929d15140f3d7cf,
                        limb2: 0x182d482e8e0fee1d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4bd9750537c9f69968cca47f,
                        limb1: 0xd925d7bf1562ccd1a02b6268,
                        limb2: 0x77798e70823a3e32,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7ee24bf51dad1eb7abdc4970,
                        limb1: 0x83b311cc70b7b8deb9e0407f,
                        limb2: 0xacefca25ba42903a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xed42ed98aa4ce68e7ea4d6ca,
                        limb1: 0xd28e3b7f89ade788b9c53cad,
                        limb2: 0x6ba0aeb1597ac48b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x37eb6c5d6f69d8d2ef18d8ce,
                        limb1: 0x2c106d33c89b4e6c62170554,
                        limb2: 0xcdb16225edd0ed7c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb1668f6d2e2aa62f48d1e83a,
                        limb1: 0x5357db4a870b502b71800112,
                        limb2: 0x42485e47e873ccf8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x77e0b14d4d43ae31a0127011,
                        limb1: 0xa1bcb077967e831bd82ee2e9,
                        limb2: 0x351a21a4d89218a0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc000a2984961390a20d3451e,
                        limb1: 0x7fffffffffffffffeace0e22,
                        limb2: 0x7fffffff80000000,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x2988e037d75f2efad547bde,
                        limb1: 0xad9cf2f4863788faac7f3f5a,
                        limb2: 0x7831e733952bca68,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa1f9578d6e4fcf9a89b6c7a5,
                        limb1: 0x64a059fbdd4a728f6ee7d40c,
                        limb2: 0x449c214333b4f6b0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd9c3ce3c87d7fbb39cddc196,
                        limb1: 0x83a9c56dd60fdd48f3ff2d3,
                        limb2: 0xf01735af79c4c47c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x57f0c9d0e08aa1bb41bf4c1f,
                        limb1: 0x99c7c5f8c18e660833f5ea9d,
                        limb2: 0x6d4f626ff62c9e66,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xff03541aceed41d647a68eeb,
                        limb1: 0x7a360e250b1d78fe939e2679,
                        limb2: 0x306c02418e1107e4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x55b2fcea0cf297a6564afc06,
                        limb1: 0x352c9dbf2723b9ebaa8e0dda,
                        limb2: 0x9956a723ba0cfeb9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8f3113457b0ea1b36242e13f,
                        limb1: 0x1f49aba4112fe64c89c72f45,
                        limb2: 0x695e17929256c680,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa6246443c530dc016e9925b7,
                        limb1: 0x945bdbfea7de78be1ce0898d,
                        limb2: 0x3952f117d1b17447,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xeae0cea857b30f6d52e01f70,
                        limb1: 0x50ec3e833940859cb5fc9b83,
                        limb2: 0xab8ae7a01aac605d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8a166479ff752e1f302407ec,
                        limb1: 0xc7014339e35f8e2f96b64d5c,
                        limb2: 0x76ebc75ba545ecb6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8a83debd8e113e08d34a273a,
                        limb1: 0xeab520ff22a332ce51988bc7,
                        limb2: 0x2746b1b77daae031,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x8989995b9f22c0fd005529d,
                        limb1: 0x5f79b2ef0d4b0e08f5aba8ad,
                        limb2: 0xbef5fda891b529c9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x880dc23026a67befb486c2ed,
                        limb1: 0xdeeb6b46303750a0d087c17a,
                        limb2: 0xcc83456e349cfa26,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9e6fa2f9c183aeb0a5e36966,
                        limb1: 0x1b618e62a0b6deee51f070d5,
                        limb2: 0x1da849d3b48e002f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6467430af937e19db956b451,
                        limb1: 0x4ff8ec085d90433f8ae02193,
                        limb2: 0x8f0f464bca0f79b4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x75651203c003ac2d983b8883,
                        limb1: 0x6bdfa51a35a60fc841fbe6a,
                        limb2: 0x94db8e7d598bcdc8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x737f3e3c4f1392d416f49687,
                        limb1: 0xead48dbabdc98518b130f2e1,
                        limb2: 0x8fffd223c75baae8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa94521c785b4a52c8dfb1343,
                        limb1: 0xd8f51f21c8bb4db2df90fe18,
                        limb2: 0x3127571bdc6d53fe,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfcffd519f779d4768c86f5d6,
                        limb1: 0xfee8020022d3fe8534fc97a8,
                        limb2: 0x5278c98f579c70fb,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x473e864f410aa4316880467c,
                        limb1: 0xb5f4d705b8b176fc01ddb9f5,
                        limb2: 0x28cc0bafaccc4e2e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbe2d8a153eb0cb541601723,
                        limb1: 0x11f23e1267e26959b91043da,
                        limb2: 0x36dd251d0515ed3a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8ce1321c1dd1ba9ad184a577,
                        limb1: 0xb360c25aeb985037736fb142,
                        limb2: 0x5d5beab9dfd3d157,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3854cfedc8e4bf0be42dcf25,
                        limb1: 0x70829390ecaddd1752576468,
                        limb2: 0x775ef3f6241f0698,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x97c964a175109e2a779b3c5a,
                        limb1: 0xcf79a91c17f3ce4e9129f64f,
                        limb2: 0xd73fc938d576da9f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x12877501d8d2a7ee65c11da6,
                        limb1: 0x69741a8d66bccc043d3b4923,
                        limb2: 0x5e84e63d0919f48f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xee3b00ae97b310e953818556,
                        limb1: 0xc63f2d7af2cd35dde1f1025d,
                        limb2: 0x1e48bf9edd9429a8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb8d3d312c959696fe3e616dd,
                        limb1: 0xe6355698e79014711f349c80,
                        limb2: 0xbeb94b8d13b903d8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfebe039c361a8dbf13d88971,
                        limb1: 0x2360e77335f77147bf717ffd,
                        limb2: 0xc5db45478cc914df,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1a5d2a00aa025bb4530bb442,
                        limb1: 0x4dd3172aa3870456c31d946,
                        limb2: 0xd988b64bf789e4c4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x410343040bf3d739ab351dd1,
                        limb1: 0x659ea70314683bd12cb0e888,
                        limb2: 0xcdfd3cccec809e12,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd5075ae510e633d5de061223,
                        limb1: 0xaf8e4ae50f011931e7ebe058,
                        limb2: 0xf6b15c8319b8b03,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5ea61bb90bc81eab8bbf872,
                        limb1: 0x84bfae92c34caefb28415d90,
                        limb2: 0xa1636a3bc2da2e5d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8afa59ca262e2670d18cf9aa,
                        limb1: 0xe58d943660c31a89aaa54f35,
                        limb2: 0x9d5567b5fdf892f2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4f419b46401ed1e4dd936ab6,
                        limb1: 0xc3a9cb03e4100957a6a1e951,
                        limb2: 0x75ca5e45ff3a034e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x17a8e365e94d919100d40a0d,
                        limb1: 0x44b898db47ef73ee264ffede,
                        limb2: 0x907d08524be653af,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8a166479ff752e1f302407e9,
                        limb1: 0xc7014339e35f8e2f96b64d5c,
                        limb2: 0x76ebc75ba545ecb6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8a83debd8e113e08d34a273a,
                        limb1: 0xeab520ff22a332ce51988bc7,
                        limb2: 0x2746b1b77daae031,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x3e9ac697de0fb0d0bce9e3ef,
                        limb1: 0x28985cbd67d2d6017f0dd303,
                        limb2: 0x13a079b2cde7de95,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5784a91a5e09d24e7c4a2665,
                        limb1: 0x7fffffffffffffff7c074594,
                        limb2: 0x7fffffff80000000,
                        limb3: 0x0
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x6513eefffd639c329a99afbd,
                        limb1: 0x9ce22fc8742ec540b0de3d3b,
                        limb2: 0xd7ded2c9aae14c61,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa75a901041a7ffeb1948681e,
                        limb1: 0xa976ff651d693590a1e829e6,
                        limb2: 0x8929eef2d6ab1ec5,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xb07e6b3a5ed7e67301728245,
                        limb1: 0x4e03a7d7de2ac24de5407ee0,
                        limb2: 0x7f29759598e3c0b0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5c5f301b858022994d465031,
                        limb1: 0xc08d2938fbd48b5fdf581bc4,
                        limb2: 0xe9a6466ac0ffe09e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x10e1ea826b745f369ca22ab1,
                        limb1: 0xc9b830e8f333460c1ff36087,
                        limb2: 0x3fab8dee60bc7026,
                        limb3: 0x0
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x9eb5e43afd29d4ed8ac81960,
                        limb1: 0x27eab19e46b6f4f553dd838e,
                        limb2: 0x82214f6ce87b4222,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa25aed65db09fb487c4bebe5,
                        limb1: 0x4e0a6296e09ebecfc4c7d301,
                        limb2: 0x5a1c435318378829,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd64400c576d63c7cdbf927ef,
                        limb1: 0xb786bf261e5ce60a7f6488fe,
                        limb2: 0xbf4868fe26393798,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6513eefffd639c329a99afba,
                        limb1: 0x9ce22fc8742ec540b0de3d3b,
                        limb2: 0xd7ded2c9aae14c61,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa75a901041a7ffeb1948681e,
                        limb1: 0xa976ff651d693590a1e829e6,
                        limb2: 0x8929eef2d6ab1ec5,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x598feb375d68c3ce3bc7b10e,
                limb1: 0x20ad5063310df40ccd214d9f,
                limb2: 0x5681ef803a412634,
                limb3: 0x0
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x113c8d620e3745e45e4389b8,
                    limb1: 0x85b8ff52d905fd02fe191c3f,
                    limb2: 0xf5d132d685201517,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x60c0ba1b358f375b2362662e,
                    limb1: 0x6abfc829d93e09aa5174ec04,
                    limb2: 0x7bc4637aca93cb5a,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xd3ff147ff0ee4213f51f677d,
                    limb1: 0x431366a7732a6e4a6b942255,
                    limb2: 0x9fe743b25d39a591,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x7f8bb562ff60a902ef14bcb0,
                    limb1: 0xeb9420089fa531db62e806a6,
                    limb2: 0xfd028df433dfd5cc,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x46ae31f6fc294ad0814552b6,
                    limb1: 0x2d54cc811efaf988efb3de23,
                    limb2: 0x2a2cc02b8f0c419f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xaec889b9d8ce51c4a2c3586f,
                    limb1: 0xa2b07874c333bfee9f78e13e,
                    limb2: 0xc445de21be8d8709,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x7e47d1c2d19c21b2f6870259,
                    limb1: 0xe701b40af42001c38bca00db,
                    limb2: 0xd87ea1720d4dd3d6,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x5b1d6cc74985ce49a1f737fe,
                    limb1: 0xb9127c572c3f091c031c249c,
                    limb2: 0x1392711e1576aa6f,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xb71f95ea692ed186e06e4c37,
                    limb1: 0x807276cd9cc59718bb11dbe9,
                    limb2: 0x10756a25836d67ca,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd34211b3520c83c5f9be99af,
                    limb1: 0x8f19a28ceef67bbda102ffe7,
                    limb2: 0x7ac2b92030d351cc,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x411bb5d0fbe844f025c7178c,
                    limb1: 0xcf603787227b7ac499d6d1c4,
                    limb2: 0x5f6b2479862eb2f8,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xce60303cfcb98726ff64a1e5,
                    limb1: 0xa64534c614754b3527588d25,
                    limb2: 0x44f75e245622181,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x8a703177da18d4ede707c057,
                    limb1: 0x7d6c11e754ab6fbe73deea43,
                    limb2: 0xdf9787168190a047,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x2e6585ab5f125a34fef37875,
                    limb1: 0xb70e9f02ce7744197172a117,
                    limb2: 0x60e305f9fe6f2298,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x712f72f3929408ff68af059d,
                    limb1: 0x4f72cea12cd115dc1c8639f5,
                    limb2: 0xc6d5ae1b897ffe77,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xfcf91f56bad0659142668837,
                    limb1: 0xa15458b49bcdad6c870e3889,
                    limb2: 0x81a1342e70b1b765,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x461d7579f9613d3168fc6220,
                    limb1: 0x7626024a6195fe0eafcea08b,
                    limb2: 0x32e91b268a032443,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xcdc7ae298071a741aafd4035,
                    limb1: 0x9a9bdfbdb824dc1278457a10,
                    limb2: 0x17fbec3713dfd145,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x9b85054533e9d24310265ee0,
                    limb1: 0x51cbb79b2625c435ba43bbef,
                    limb2: 0x1fd81fcb136c629b,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x96378a2e47ab50246a9cf131,
                    limb1: 0x4d0f08867537268cf39eae04,
                    limb2: 0x4eeb60396f3e5f52,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x4e9960d402494fb117251955,
                    limb1: 0xc0fb055de656d6ac2ba4da86,
                    limb2: 0x800a21e8619f448f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x21ba9af739425b664464e3d5,
                    limb1: 0xd09194888c2ffcf16e93e0c9,
                    limb2: 0x5d4d3cd0684b6cd1,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0x101fbcccded733e8b421eaeb534097ca, high: 0x38c1962e9148624feac1c14f30e9c5cc
            },
            u256 {
                low: 0x247a8333f7b0b7d2cda8056c3d15eef7, high: 0x1759edc372ae22448b0163c1cd9d2b7d
            },
            u256 {
                low: 0xe005b86051ef1922fe43c49e149818d1, high: 0x7d41e602eece328bff7b118e820865d6
            },
            u256 {
                low: 0x4a84eb038d1fd9b74d2b9deb1beb3711, high: 0x552f233a8c25166a1ff39849b4e1357d
            },
            u256 {
                low: 0x3405095c8a5006c1ec188efbd080e66e, high: 0x8c1745a79a6a5f92cca74147f6be1f72
            },
            u256 {
                low: 0x1775336d71eacd0549a3e80e966e1277, high: 0x5129fb7c6288e1a5cc45782198a6416d
            },
            u256 {
                low: 0x2f1205544a5308cc3dfabc08935ddd72, high: 0x870e15c2fcd81b5d24bace4307bf326
            },
            u256 {
                low: 0x42930b33a81ad477fb3675b89cdeb3e6, high: 0xadc0da7a16febaa011af923d79fdef7c
            },
            u256 {
                low: 0x2648ee38e07405eb215663abc1f254b8, high: 0x148b2758d7ab792809e469e6ec62b2c8
            },
            u256 {
                low: 0xd450fe4aec4f217bb306d1a8e5eeac76, high: 0xd67e55fd642bfa42aef9c00b8a64c1b9
            },
            u256 {
                low: 0x85940927468ff53d864a7a50b48d73f1, high: 0x37176e84d977e9933c49d76fcfc6e625
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 3
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xef4b4e197306579c6764d18d,
                    limb1: 0xcad67ed94cd304765c5ef1d0,
                    limb2: 0x3aaf8e6e9efeb7a8,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xaa6037d51b7470230cec4f93,
                    limb1: 0x65094a2650b8285563a053b4,
                    limb2: 0x312f741cf953042d,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256K1_1P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high_shifted: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x1f09ea597dd1b76ad0589c17,
                limb1: 0xdb92b549b432162903e3e952,
                limb2: 0x7812a16bfa702609,
                limb3: 0x0
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![u256 { low: 0x0, high: 0x0 },].span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 2
        );
        assert!(
            res == G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            }
        );
    }


    #[test]
    fn test_msm_SECP256K1_2P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high_shifted: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x7eaaa823bf2e8ea170ebfece,
                limb1: 0xc9db82034b10fa27593cd4b,
                limb2: 0x18f1b81a89a11888,
                limb3: 0x0
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x393dead57bc85a6e9bb44a70,
                    limb1: 0x64d4b065b3ede27cf9fb9e5c,
                    limb2: 0xda670c8c69a8ce0a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x789872895ad7121175bd78f8,
                    limb1: 0xc0deb0b56fb251e8fb5d0a8d,
                    limb2: 0x3f10d670dc3297c2,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0xeb1167b367a9c3787c65c1e582e2e662, high: 0xf7c1bd874da5e709d4713d60c8a70639
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 2
        );
        assert!(
            res == G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            }
        );
    }


    #[test]
    fn test_msm_SECP256K1_3P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0x81f93764cd87ff5af9aad87f,
                    limb1: 0x8aa0792747a5b8ca16b9e369,
                    limb2: 0xce30fe4be7b17451,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x5b77703ae4639b17cfca6124,
                    limb1: 0x86b771c3a15eee8b1ca9feaa,
                    limb2: 0x5acc99b6152d28a4,
                    limb3: 0x0
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0xff8927eca139c99d7960c8ef,
                    limb1: 0xec91eee7a0301418e07f41fc,
                    limb2: 0xb49b07479d1c26aa,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xe496c28fbc13ed8a0324b632,
                    limb1: 0x2d5583856241be833fec7c9d,
                    limb2: 0xff1c723bbb39f40b,
                    limb3: 0x0
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0x3efedfaf5b7ce0a80c4fa5a1,
                    limb1: 0x2c16205bc2efe9dcc6eefa9a,
                    limb2: 0x3f2cefb8efbcc695,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc3eeedd13fa2c621a214d57,
                    limb1: 0x5e42015603c2cf1a184c7bdb,
                    limb2: 0x8ab02685472a4433,
                    limb3: 0x0
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x21ca4954703e20a32a53c14e,
                        limb1: 0x77928094e2384846615f9f3,
                        limb2: 0xb0933d87df5f16c0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x39104445c9ee329d5ab7969d,
                        limb1: 0xffffffffffffffff8f41b07b,
                        limb2: 0x7fffffffffffffff,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x1287ed4d64ace9b7a43a0e54,
                        limb1: 0xa8bd72a441196b6133cce959,
                        limb2: 0xc692b7558ef0a607,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x800903913f0f465f70dde2a5,
                        limb1: 0xe77cd0cd60e03364f10ac507,
                        limb2: 0x6ef16ab1aefb800b,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xa4ddcdaa4d1f21498a8e60e2,
                        limb1: 0x3139c084333af9819a02b0ae,
                        limb2: 0x7805f31083be707c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x671b070bbd9488ed6f637c14,
                        limb1: 0x15d2edbf03b6ef7a39eb1db0,
                        limb2: 0xdc5754685cf24343,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x95886720b10b40982ba07bbc,
                        limb1: 0x7722212fe97468b0f47f0f64,
                        limb2: 0x1a324051317a343d,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x81b77d1dc0ba640a7d967761,
                        limb1: 0x9d2e227dc7b1efa86a9a616f,
                        limb2: 0x6e030356e8948a35,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x803f18f8b96aec9f16113df6,
                        limb1: 0x5469b59da62167c2974b6334,
                        limb2: 0x899eadbc8e08053,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 {
                        limb0: 0x1287ed4d64ace9b7a43a0e54,
                        limb1: 0xa8bd72a441196b6133cce959,
                        limb2: 0xc692b7558ef0a607,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x800903913f0f465f70dde2a5,
                        limb1: 0xe77cd0cd60e03364f10ac507,
                        limb2: 0x6ef16ab1aefb800b,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x4bb28979b0b79c1777f1fc30,
                        limb1: 0xb5224e011b2f31ce93f717ab,
                        limb2: 0x43c2e0f9ce3d46a9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x18d0afe0edb98065b4e3232d,
                        limb1: 0xffffffffffffffffee22305e,
                        limb2: 0xffffffffffffffff,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xcac2235c929f3b69ad67b0f5,
                        limb1: 0x79851b8757cf23514a81081c,
                        limb2: 0xcae3cc5dad5be629,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x27913096b5d7c1cf127f235,
                        limb1: 0x858b5b0d0855d81627456674,
                        limb2: 0x888761b5f990cdb2,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x41944f6c68d802cae76fecb5,
                        limb1: 0xb68878783c315c2955f84db0,
                        limb2: 0x9e6ecc5374b776d3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6303520371c13385e632d785,
                        limb1: 0x166eb934b430a9de83ef040e,
                        limb2: 0x43c0f15a5445867b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x32f780ed8e7def611a1f885f,
                        limb1: 0x18358fe9b350098a2327a652,
                        limb2: 0xe46a2879949b53d7,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x8b4ef788025a9fe8bdd5e9c8,
                        limb1: 0x52a3c0b366a9f739098738c9,
                        limb2: 0x8c3a968fbd834b22,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x114f8541ef8e64cd9817aae6,
                        limb1: 0xa6cf7d5b3a58e89b12e5cd2c,
                        limb2: 0xbbb3abf9d2f59fe1,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 {
                        limb0: 0xcac2235c929f3b69ad67b0f5,
                        limb1: 0x79851b8757cf23514a81081c,
                        limb2: 0xcae3cc5dad5be629,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x27913096b5d7c1cf127f235,
                        limb1: 0x858b5b0d0855d81627456674,
                        limb2: 0x888761b5f990cdb2,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xcd8a7b62cfcea038501befeb,
                        limb1: 0x4713597234ad41eaac4558da,
                        limb2: 0x80e4af25ec15667,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd784a91a5e09d24dfc4a247d,
                        limb1: 0xffffffffffffffff7c074593,
                        limb2: 0x7fffffffffffffff,
                        limb3: 0x0
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x8340be3f51dbe72cd3a11c66,
                        limb1: 0x3f5e87376a3a6565abe95a96,
                        limb2: 0x726d640994dd9b14,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc177f864034955b97a4f8d9f,
                        limb1: 0xe757f0bc9ce0020a5891c368,
                        limb2: 0xc3808ff732712bf,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x62690bd5c84ce92d37608041,
                        limb1: 0xa00cf01b83ee2270a792302,
                        limb2: 0x7e56f00b06c537aa,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3af32c63776a038f2db2cba0,
                        limb1: 0xc9c24f93b2218a2c2843c50d,
                        limb2: 0xa4ec9825cf07cda9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8ca46d17a4af2bfba87d85eb,
                        limb1: 0xaec1825b52f8612c11d67e30,
                        limb2: 0xe70921f36970a3c1,
                        limb3: 0x0
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x96c533bb3d03523cc967d23d,
                        limb1: 0xbb95b283e798c5c7b3617a1d,
                        limb2: 0x20fdbc43120f3d8d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4a47cabc17015812582cdf59,
                        limb1: 0x536795284a200e486bfc57dd,
                        limb2: 0x55883efc2611833f,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 {
                        limb0: 0x8340be3f51dbe72cd3a11c66,
                        limb1: 0x3f5e87376a3a6565abe95a96,
                        limb2: 0x726d640994dd9b14,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc177f864034955b97a4f8d9f,
                        limb1: 0xe757f0bc9ce0020a5891c368,
                        limb2: 0xc3808ff732712bf,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x5988327c732efe751b2c9aba,
                limb1: 0x6b4110ddcbbb0e7c4826662f,
                limb2: 0x243035d34ac20498,
                limb3: 0x0
            },
            g_rhs_sqrt: array![
                u384 {
                    limb0: 0x738294b7d794fa4fbd1ae3cc,
                    limb1: 0x9fc0ded6631c62d69739edaf,
                    limb2: 0x5b10679078ad2a2c,
                    limb3: 0x0
                }
            ]
                .span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x393dead57bc85a6e9bb44a70,
                    limb1: 0x64d4b065b3ede27cf9fb9e5c,
                    limb2: 0xda670c8c69a8ce0a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x789872895ad7121175bd78f8,
                    limb1: 0xc0deb0b56fb251e8fb5d0a8d,
                    limb2: 0x3f10d670dc3297c2,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xfdfdc509f368ba4395773d3a,
                    limb1: 0x8de2b60b577a13d0f83b578e,
                    limb2: 0xc2dd970269530ba2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x589fa250d638e35400c12ddf,
                    limb1: 0xb3aac19fcb5095808402aa7f,
                    limb2: 0xed6de6590d0195d1,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0xe443df789558867f5ba91faf7a024204, high: 0x23a7711a8133287637ebdcd9e87a1613
            },
            u256 {
                low: 0x1846d424c17c627923c6612f48268673, high: 0xfcbd04c340212ef7cca5a5a19e4d6e3c
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 2
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x55909ba28af82ea934a4b85d,
                    limb1: 0x4bf448ca5d57fb119c843e0a,
                    limb2: 0x6a2275491b991ee3,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x5bf4bf0cefc9553422e60eb0,
                    limb1: 0x178d55925d3d72f44783f626,
                    limb2: 0xe13a21d7302f8139,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256K1_4P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0x8d0166bbf7e071295729418b,
                    limb1: 0xdd542b48fa7df1e7e4e9d09d,
                    limb2: 0xa21f38683fe17143,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x700402df5c88156eeeba2331,
                    limb1: 0x5e608cc7fd03942d78c3d40c,
                    limb2: 0xc8e85b1af8bfc00d,
                    limb3: 0x0
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0x657faa148353381fc9ac1d0c,
                    limb1: 0x4a7ef201b9db61fbb9c9495d,
                    limb2: 0x1e87a915d7439340,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x70e1a8484ebeb69366e77b38,
                    limb1: 0xd7ccd4a605455a2bf8f36b6e,
                    limb2: 0x993c64100bc56c8a,
                    limb3: 0x0
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0x2c45ea101d19f12cad40ffe8,
                    limb1: 0xbbfb500f69aac418d22f893c,
                    limb2: 0x75f7dcfb2d65ce2d,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf94b1079627a99b6e7f182c7,
                    limb1: 0xd1b1c151888d2b8b4cd9ed17,
                    limb2: 0xac00455a2a419172,
                    limb3: 0x0
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x89888c72d09a572c00cee966,
                        limb1: 0xc53ef5856b08cfa414484239,
                        limb2: 0x8881b71fa130bb76,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x23b9dca7bc40144b5b40e162,
                        limb1: 0xc14e8817a8f8d47323d7b39c,
                        limb2: 0x4a1c897575867f82,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd2eb4c69b0a6de0046011d58,
                        limb1: 0xffffffffffffffff7024d873,
                        limb2: 0xffffffffffffffff,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x11b338305c1ea8980ebcecfe,
                        limb1: 0xde4e23180e593396311f1995,
                        limb2: 0x7e48779b6f3ade6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdaacf3550937a73806149be0,
                        limb1: 0x4b7d37c9d4206f50b821e86f,
                        limb2: 0xcdb64ea021b8f1d2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4b9ae5862896ed096cb38d54,
                        limb1: 0x60e6ca4c2b4c8f6a20624c45,
                        limb2: 0xa57c7487a395ab61,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xb31ca5011384270867d59b53,
                        limb1: 0x5a953c8e049df79996503fe3,
                        limb2: 0xd6bea30734a2e830,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8ed2cd98a404ff8e51fea9fd,
                        limb1: 0x5d6d0e2819a1865dc937b6a,
                        limb2: 0x8cdc581014ae98d7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x259331abc25b6c6391cf52a7,
                        limb1: 0x59cdc38548a1dfcc50113934,
                        limb2: 0xa222e6c19f215537,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x84ca0b384a3c090b76840af4,
                        limb1: 0x6fbd707fba903f9bd089964a,
                        limb2: 0xa506ad0411122f3e,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x7be6895284d69c28672a7af2,
                        limb1: 0x1422f5a86470691b57d9b313,
                        limb2: 0x373fb45400a9c150,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfabaa7534085928d2a905635,
                        limb1: 0x106c8684cce30b3508ed5b0e,
                        limb2: 0x9ffc2660ec0e9cc0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x113c46ab1c207b45f8e8ec90,
                        limb1: 0xa64f88152f17ebe6e2b015e5,
                        limb2: 0x86672fb57917afa9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x11b338305c1ea8980ebced05,
                        limb1: 0xde4e23180e593396311f1995,
                        limb2: 0x7e48779b6f3ade6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdaacf3550937a73806149be0,
                        limb1: 0x4b7d37c9d4206f50b821e86f,
                        limb2: 0xcdb64ea021b8f1d2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4b9ae5862896ed096cb38d54,
                        limb1: 0x60e6ca4c2b4c8f6a20624c45,
                        limb2: 0xa57c7487a395ab61,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x8b855791f4943105bc6455be,
                        limb1: 0x3f1f4630510c01c0a8295428,
                        limb2: 0xc87d93c6ff7550f7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x827fbf60587914648bed9ea1,
                        limb1: 0x9c06ff98113401852edd747c,
                        limb2: 0xcce4b56c1add3351,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfbc03718caec8c85589651d,
                        limb1: 0xffffffffffffffff7071f4bf,
                        limb2: 0x7fffffffffffffff,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x14a2da87f1f40e937aac850d,
                        limb1: 0x5f304d09a4ed11c02d08529a,
                        limb2: 0x3ab0a24b31f5900b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x23b217fbbf3eb5b751441540,
                        limb1: 0xb672e644cb045d23c62ebd50,
                        limb2: 0x4d7cf07c6fef3616,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x731ca22d9d242613fa30b5a4,
                        limb1: 0xf3bc03936bef1f564b82d385,
                        limb2: 0x291403da0c338964,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xf738684e87cef2658039dc30,
                        limb1: 0xf66fdcda2e340e80153bb145,
                        limb2: 0x6672c65ae6592d48,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xae0a3cb82deb6f81f9b2a8d8,
                        limb1: 0xfab496593b35da72ff6de4bc,
                        limb2: 0xca0d80a512115e2a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x59163b728d53ee0259764c80,
                        limb1: 0x6395f9bcaadcbfc6984bdb47,
                        limb2: 0x39cc54991317bc92,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8a66afc990ea4b3987a0c3f1,
                        limb1: 0xb67119a79c9ef63fdbcd68a1,
                        limb2: 0xf6782942e78856d3,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x9073f9b79dac66095ab7a72c,
                        limb1: 0x9a521b43827b7c413b3a4236,
                        limb2: 0x9ad4700e5db6f04f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf9dea7e23ab6f80538dc9c62,
                        limb1: 0xfd244be18d1e8bfa6b472d30,
                        limb2: 0x1e6a93670f8a7a9e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x25c86f3f4bfd0a8cd754fb4d,
                        limb1: 0xaa241907f389db5c1093c8a6,
                        limb2: 0x1f8c1af65568c1c2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x14a2da87f1f40e937aac8514,
                        limb1: 0x5f304d09a4ed11c02d08529a,
                        limb2: 0x3ab0a24b31f5900b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x23b217fbbf3eb5b751441540,
                        limb1: 0xb672e644cb045d23c62ebd50,
                        limb2: 0x4d7cf07c6fef3616,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x731ca22d9d242613fa30b5a4,
                        limb1: 0xf3bc03936bef1f564b82d385,
                        limb2: 0x291403da0c338964,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x8f492c375e58941c39e05e9f,
                        limb1: 0x1bd6116d8ad593cea56e9b9e,
                        limb2: 0x307c4e72bf83c5de,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd784a91a5e09d24dfc4a247d,
                        limb1: 0xffffffffffffffff7c074593,
                        limb2: 0x7fffffffffffffff,
                        limb3: 0x0
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xfa8afa844b9b3eb7e307bfce,
                        limb1: 0xaa6326ac3b1de6b610c7410,
                        limb2: 0x31ec5b757d55f905,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6e3a6bdb5f92d6b28912df3b,
                        limb1: 0xf985bdeedc79d9eb74072d66,
                        limb2: 0x6b8079eefb569e91,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xf1ab6443dc318288289f40a8,
                        limb1: 0x116eab47d34b1a0a9dfdad9a,
                        limb2: 0x9545e64ced7af79,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf4bfb93fa56d758eae446d2b,
                        limb1: 0x9e406b913811e03a76ae3a0c,
                        limb2: 0x685142a109d27054,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe84a325cde438aa56f5fa99,
                        limb1: 0xa04d24383960ccb972843ddf,
                        limb2: 0x4de806900ae5531d,
                        limb3: 0x0
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xd9ccd99e113eb70835364273,
                        limb1: 0x4a8b60eb59dd14efa7572c76,
                        limb2: 0x5d7680366d59cf23,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x398f2ff9d03dee3bf84223f,
                        limb1: 0xd2a831880754f5702c323dcd,
                        limb2: 0xf0835588df5e55fd,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 {
                        limb0: 0xfa8afa844b9b3eb7e307bfce,
                        limb1: 0xaa6326ac3b1de6b610c7410,
                        limb2: 0x31ec5b757d55f905,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6e3a6bdb5f92d6b28912df3b,
                        limb1: 0xf985bdeedc79d9eb74072d66,
                        limb2: 0x6b8079eefb569e91,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0xce9f97c8af956e32f62995f4,
                limb1: 0xe6494bedf4289c5ca2562d0d,
                limb2: 0x3a8245bec86922cd,
                limb3: 0x0
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x393dead57bc85a6e9bb44a70,
                    limb1: 0x64d4b065b3ede27cf9fb9e5c,
                    limb2: 0xda670c8c69a8ce0a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x789872895ad7121175bd78f8,
                    limb1: 0xc0deb0b56fb251e8fb5d0a8d,
                    limb2: 0x3f10d670dc3297c2,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xfdfdc509f368ba4395773d3a,
                    limb1: 0x8de2b60b577a13d0f83b578e,
                    limb2: 0xc2dd970269530ba2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x589fa250d638e35400c12ddf,
                    limb1: 0xb3aac19fcb5095808402aa7f,
                    limb2: 0xed6de6590d0195d1,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x2965eeb3ec1fe786a6abe874,
                    limb1: 0x33e2545f82bb6add02788b8e,
                    limb2: 0xf586bc0db335d7b8,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x155b35991489db2fdf4de620,
                    limb1: 0xf24ce461346a182d67eeccf0,
                    limb2: 0xb4122bb4b37cc7d5,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0x1846d424c17c627923c6612f48268673, high: 0xfcbd04c340212ef7cca5a5a19e4d6e3c
            },
            u256 {
                low: 0xb4862b21fb97d43588561712e8e5216a, high: 0x259f4329e6f4590b9a164106cf6a659e
            },
            u256 {
                low: 0x12e0c8b2bad640fb19488dec4f65d4d9, high: 0x5487ce1eaf19922ad9b8a714e61a441c
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 2
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x6bd8241f742b28cb66aa56f2,
                    limb1: 0x24d0ea2018173320c8f31889,
                    limb2: 0x9163c7b68d703c1e,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x50b9bcebc2b4fc80224f5146,
                    limb1: 0x756704c3a78f9ab2c60ececd,
                    limb2: 0x9ecbe5fd68546ab7,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256K1_10P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0x4afd2ec2a6643712421d0683,
                    limb1: 0x11cef224f19a309e96679abb,
                    limb2: 0xcffd675843f0be43,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf5ae7a1fdb6de2954712a3fd,
                    limb1: 0x71fe17f155aa123b146132b8,
                    limb2: 0xb35f7d31dd603448,
                    limb3: 0x0
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0x53307d00341d76bbf188df94,
                    limb1: 0xd91bee3612e221fb6683efa1,
                    limb2: 0xa0bbd123c52b1348,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x2cfa22fc764c5f4080fb4f30,
                    limb1: 0x9cb2f17fc11214eb4fbaa9cc,
                    limb2: 0xef04c79d8aebbaec,
                    limb3: 0x0
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0x670172a1e64a26ed422d2b12,
                    limb1: 0xd73418d6e8577e0dbcb65dea,
                    limb2: 0xfbcb3aac9382ad3,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb12045b32e75ce2d977fca84,
                    limb1: 0x98bf7be3e9b1c1c9364d70d6,
                    limb2: 0x87549411a3123384,
                    limb3: 0x0
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x51f1762ae0a9a0ccb4a5a416,
                        limb1: 0x694dcf1b0bd4b38bddd318aa,
                        limb2: 0xc6628af70597152e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6b8009c8dbb028d86ba15107,
                        limb1: 0xfb2d1055d01a3104d91c0aea,
                        limb2: 0xe10ff997a3d21d53,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9b892dc6c1e0582c76be62e0,
                        limb1: 0x3566c36fbcb04aca6a5365ea,
                        limb2: 0x23e764f26e3f0fe7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7cef7929189ff47930749bc2,
                        limb1: 0xc9608a5fa0b29b03afab69e7,
                        limb2: 0x9e99a936a2d167d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8203d2f32869765019a6e701,
                        limb1: 0xbc936a0b55aeb1f5d5a5ef06,
                        limb2: 0xf9c08a604709fec,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x85d1b8451197f8c11ea96f10,
                        limb1: 0x4e858cb5d708f4dc19115c91,
                        limb2: 0x2fd4309a52263a23,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd7c53d3f4bb1ff6d69cc0284,
                        limb1: 0x352513f2b7ca80964de17cc7,
                        limb2: 0x3239bbf86b85309e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1bfa3e664a2bc19f6864f583,
                        limb1: 0xc4b57e5d3d880984ba198ecf,
                        limb2: 0xa039d63a77c8d557,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3825e33a2c2d1008e71f9a14,
                        limb1: 0xfffffffffffffffea1ac2d39,
                        limb2: 0xffffffffffffffff,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x1e83fdc747e456254952f77d,
                        limb1: 0x6a5bec98ee4c9b34e8ead003,
                        limb2: 0x42c67e8c74b14e12,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x559e9a57095b30c627cadf77,
                        limb1: 0x279329da5fdcab8ac72975ca,
                        limb2: 0x68d469e2069caeee,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x87059c900aefa3cdef069367,
                        limb1: 0x99f96d580bcc1770a34edf81,
                        limb2: 0xafca171da001a00c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xab5cf09cc7986b957ca4806a,
                        limb1: 0x226b7b2a3c9e92112d15af15,
                        limb2: 0x46a9023ed95b09c5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb2178b1d4bcfe3e68285dc3a,
                        limb1: 0x9f5bd4e35e1ec4b35188be19,
                        limb2: 0xd73446059e83efe5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x38b0243a8ce54d79dc8337a1,
                        limb1: 0x3efcd48d3ac638166ab338f5,
                        limb2: 0x4c3e589a9f5f9c3a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdfc82a15bd1e690fa0ac5715,
                        limb1: 0x86c006e5cff53a091abdecd9,
                        limb2: 0xa7d8e90ad4587652,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x79ca10f6010bea13f4531461,
                        limb1: 0x2d26e9e1d1c4de8d39771f82,
                        limb2: 0x264ac2470d45cc29,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x782079845792b2091bea1ae7,
                        limb1: 0xfb3a401c4a62913507411aa3,
                        limb2: 0x6515155842e06c1d,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xfb287b18d7e536c30f121b9e,
                        limb1: 0x1923389e18f44c306898741d,
                        limb2: 0x66282866c1bb69e5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5b12da817a12cbd9d84528bf,
                        limb1: 0x5d0157e4d7914cc8264f32b5,
                        limb2: 0xe61125f178158a6c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6acaa26a3936fc2409ae433a,
                        limb1: 0xbbe7d9a159d1efc6e8b620d6,
                        limb2: 0xcfdedf920bf12436,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc98b7d575ac2ed84b62ed1d5,
                        limb1: 0x55fd933ca7643efeb2e505e6,
                        limb2: 0x5e6fb69598d554d4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbe95a9e0ba1de7ca4b311e56,
                        limb1: 0x2134a7ab1c69dc76b5a62cfe,
                        limb2: 0xbd86dfdbcea06a83,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xcc0cf8641b19a365d8d76e03,
                        limb1: 0x42a34a2cfa50e57f93c2ac80,
                        limb2: 0x7d0b7a0fa2977730,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x911347a29ae6f6172f6f4845,
                        limb1: 0x8f467e9f380eddc4dfa593dc,
                        limb2: 0x66d6b41bc95e0aa7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xab3970ca1746f7b2ab249211,
                        limb1: 0x2ca6cf656bec38934bf53f56,
                        limb2: 0xa46f7d9206e95935,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf0a1bebe6eb78a9ac0f81405,
                        limb1: 0x8c1a2bb08413bd046c94bc87,
                        limb2: 0x221d32c790a0515,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1730790e04740cba14fd0c76,
                        limb1: 0x812c772c90e9f30ffd358043,
                        limb2: 0x4f96c0150a219510,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xd59bf072f73e5b060144c83c,
                        limb1: 0xe883782e84183e725e6bb015,
                        limb2: 0xd36d75d730d92280,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x57563861417e556d168c23e3,
                        limb1: 0x150624f89f08b0cb72223888,
                        limb2: 0xddcee52e2e48c883,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb12747f04c8d7aa5892e1715,
                        limb1: 0x35d1fd685294a41477281c8a,
                        limb2: 0xce86a1cf600b6058,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xce0e9210bd0f473db1d28205,
                        limb1: 0x5b4c4ac096a299ad2482999a,
                        limb2: 0x31658e44662e9276,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x344368241c0a6c19b973fbf3,
                        limb1: 0x8315fc11f2b40c7201e6a87e,
                        limb2: 0x4b4254095c383e35,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x13d69a29e534c224f69d2070,
                        limb1: 0x52e33d34a737a00d8e356e36,
                        limb2: 0xc57e8357fb9ee5a4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc9d61734f36d4b06e15af141,
                        limb1: 0xd1abab72ec532850e847290a,
                        limb2: 0xdd97618aa7c64606,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x69e01d753234a7330cb6eb2,
                        limb1: 0xdb6c3a101a80da8fe3ca9aab,
                        limb2: 0xe33f95f6fb6c8505,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x819376d8f1e82bbc9fe9ff65,
                        limb1: 0x1d949553437830899d7af36d,
                        limb2: 0xfd1ee047382910c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdfc82a15bd1e690fa0ac571c,
                        limb1: 0x86c006e5cff53a091abdecd9,
                        limb2: 0xa7d8e90ad4587652,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x79ca10f6010bea13f4531461,
                        limb1: 0x2d26e9e1d1c4de8d39771f82,
                        limb2: 0x264ac2470d45cc29,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x782079845792b2091bea1ae7,
                        limb1: 0xfb3a401c4a62913507411aa3,
                        limb2: 0x6515155842e06c1d,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x999b14ce30aebbe429fc0466,
                        limb1: 0x4ade2d4c86663deefa451362,
                        limb2: 0x80c7c8603b0bfceb,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa2b98955d153ec0c8be5df54,
                        limb1: 0xaa85d110dfeb983978e925e6,
                        limb2: 0x6d7df230c65e89ed,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5e505d4d9775b325bb3058e6,
                        limb1: 0x9a3e56dc8a48402c468e9674,
                        limb2: 0xabfbfe6fa8e8ef1f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x29290010a167e2cf3e7a2732,
                        limb1: 0x8fd277ec692da1cf70182c72,
                        limb2: 0x7f954ff22108945e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6716950d50780be8ca9236c8,
                        limb1: 0xbf7594ec712684a853ba246,
                        limb2: 0xa3a69d92021884d8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x619895c5c6fbb66bc7e809e2,
                        limb1: 0x91cdb13d861b4fd091666f31,
                        limb2: 0x9e3d9ce5d79d0e02,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfdfd429ebdd3c844602d5858,
                        limb1: 0xff9289443743594812166164,
                        limb2: 0x132565c4a188895c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd6db54f8c6e917767e53b64,
                        limb1: 0x24174ba48be231d8c3147267,
                        limb2: 0xfef800fdcad7e736,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3421ab33b87bd3386bb8c039, limb1: 0x852d4ebf, limb2: 0x0, limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xa9fbbcac1b3245f51deeb945,
                        limb1: 0x6f012d7dec5d0be839546c56,
                        limb2: 0x467b10e7e59197e0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x962291bb151bc4523913ed92,
                        limb1: 0xfa2c7f9ed79cc9466dee213e,
                        limb2: 0x10cc3b66311cf979,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x76d1ed3b0ed035b6b27a26c5,
                        limb1: 0xd1459c6493699fc6b51a1fb0,
                        limb2: 0x5d36f9f53164de7b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe7442531758f58778632661e,
                        limb1: 0x836dd486bd7ba074c07f9538,
                        limb2: 0xd69ee99e6c0781cf,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xcd3235676500f1faffa084d6,
                        limb1: 0xf0864af5afb7d4950cac23f0,
                        limb2: 0xedc152935eb9415f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8b270bec1899f33a2616e7f5,
                        limb1: 0x10879701f898ee5c11a9bd69,
                        limb2: 0x1c48df2fa862cf73,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8a120569853f4f9d031f871,
                        limb1: 0x394d530b71da9227f715cda3,
                        limb2: 0xda16742545f4286,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2ded90341892c8cd1fc1096f,
                        limb1: 0x16f141ebba0563d1aaff4f8b,
                        limb2: 0x73cf0c5f31d4e077,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6fed2b46c9d9725f6c7e41d6,
                        limb1: 0x33ed440b291a9fd83724c5bd,
                        limb2: 0x9456ab8cc1a61718,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x4a6a37bbe0175fb3575d0568,
                        limb1: 0x244096daa79c159abd89935a,
                        limb2: 0x880722100ac7d32c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7e6a2f6e413c155fa78ba463,
                        limb1: 0xaad5ed249d615906684922cd,
                        limb2: 0x7f2668edec51e865,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xcec1990ade370c8ba54e0836,
                        limb1: 0x21d6d1667a7b3e5b3d29ccff,
                        limb2: 0x8da7d641dbd4ed49,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x53eb0fb187699e6698b0e084,
                        limb1: 0x201b3bcfe1afeeeea259e9db,
                        limb2: 0xcc8fa288163e8e1c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa9abada8b5d172c679c3caca,
                        limb1: 0x40d76f32c9f05392b829d166,
                        limb2: 0x5e69403fed62d5a4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd79410a7998292a940603b13,
                        limb1: 0xbb9a31222d0c6ce2a1eea10d,
                        limb2: 0xfbbac9ba1ab4e221,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2fbd6e0e4bac125e7459293d,
                        limb1: 0xa32cb4c993496ce4e181b857,
                        limb2: 0x5a972a83a99be294,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7202af65a27349c2d96ced8c,
                        limb1: 0xd8171f061563aa4aec6a5c5b,
                        limb2: 0x36bb25c063fc8122,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xcdabed9c3e23bd49c6103c29,
                        limb1: 0x4d35cedc57880f403930007c,
                        limb2: 0xf2833f256a1c5e91,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x98de9d084a0c816d1fae5338,
                        limb1: 0xc972b89fa907f927d2fa131a,
                        limb2: 0xc34648d5e60f22e4,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xa5e228b4be5fe9b4d18714b4,
                        limb1: 0x9083e71768b5359914ef65e,
                        limb2: 0xed5d765746fb2723,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1af1fc1d93c25e3f8f8b7efe,
                        limb1: 0xd7377d57e54980ed0182e8b6,
                        limb2: 0x75959fcb57cad255,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3fbd7c9d67b17800e1571705,
                        limb1: 0xb8e746c007e35e6ef3b6ddd3,
                        limb2: 0x8c80d5b459c21562,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfcd8c106521db13fc94f9afd,
                        limb1: 0x701fd2d1abe6f197cd180e4,
                        limb2: 0x24d3743cd9c6248d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3282078ed82262353677a652,
                        limb1: 0x8dd88c56a5a39959c6a31cd4,
                        limb2: 0x91157d6dc82dc319,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x44e340afbb05dc4ebd1a8249,
                        limb1: 0x44fabd725f98244b30be4d93,
                        limb2: 0x23351442cc188aa1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x23ac078f9fdb0b4d37903506,
                        limb1: 0x148b19d6da759f8c821834ae,
                        limb2: 0x3608bc6ebaa2537b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xeb126d411046f9adde7d623,
                        limb1: 0x911f1867c5dd8f50b9a750bf,
                        limb2: 0x186aa92dbb8b64a1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9aa33adb9d8c13da1d8ac413,
                        limb1: 0x7c04735018534d4593ab2597,
                        limb2: 0x2aa79008f3ed711c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8a120569853f4f9d031f878,
                        limb1: 0x394d530b71da9227f715cda3,
                        limb2: 0xda16742545f4286,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2ded90341892c8cd1fc1096f,
                        limb1: 0x16f141ebba0563d1aaff4f8b,
                        limb2: 0x73cf0c5f31d4e077,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6fed2b46c9d9725f6c7e41d6,
                        limb1: 0x33ed440b291a9fd83724c5bd,
                        limb2: 0x9456ab8cc1a61718,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x87c42601da57e77c024198f5,
                        limb1: 0x96666391563fb8237575ce9f,
                        limb2: 0x3a0d13ab334e0322,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd784a91a5e09d24dfc4a247d,
                        limb1: 0xffffffffffffffff7c074593,
                        limb2: 0x7fffffffffffffff,
                        limb3: 0x0
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x828b66c2f4abd6b76c4402fb,
                        limb1: 0xa09e2a2176a0ebb1a8943c2c,
                        limb2: 0x4ed4d3b44044036c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x45ce105de5986255cc49f189,
                        limb1: 0x4faff8f304c65ff6dcc5b274,
                        limb2: 0x4f877b31719cc1e3,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x1af6e70efb9fb372f3b1ff25,
                        limb1: 0x9f1beb6fc683da8f7489b5a1,
                        limb2: 0xff14045a17b8469a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xae7840efa60f4527ff3163fb,
                        limb1: 0xca4d5c9777cf6444c2c0a3c1,
                        limb2: 0x12cf45ab2344b293,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2b023846820914e34f8fdb80,
                        limb1: 0x5147b7aa545a1f7607de33e8,
                        limb2: 0x2849ac30000429c6,
                        limb3: 0x0
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x91cfcf54b0b2df05f5dc1c7f,
                        limb1: 0x645326ea3e6671db9c0da537,
                        limb2: 0x27d1c9edc1dc17f8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe8a27291472ab05a9605a261,
                        limb1: 0x2dcfcea5216c9fc00967e12d,
                        limb2: 0x2cb45e5a1b494d37,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 {
                        limb0: 0x828b66c2f4abd6b76c4402fb,
                        limb1: 0xa09e2a2176a0ebb1a8943c2c,
                        limb2: 0x4ed4d3b44044036c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x45ce105de5986255cc49f189,
                        limb1: 0x4faff8f304c65ff6dcc5b274,
                        limb2: 0x4f877b31719cc1e3,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0xabed33669606ce828f10d56b,
                limb1: 0x27c1ade62e7fce2cd83f4623,
                limb2: 0x1c725a86d9c025d3,
                limb3: 0x0
            },
            g_rhs_sqrt: array![
                u384 {
                    limb0: 0x778e2c101d7d92a37c8f461b,
                    limb1: 0xef3d089a5d0ab7f2c3d531b8,
                    limb2: 0x349926a5b5f5ab1c,
                    limb3: 0x0
                }
            ]
                .span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x393dead57bc85a6e9bb44a70,
                    limb1: 0x64d4b065b3ede27cf9fb9e5c,
                    limb2: 0xda670c8c69a8ce0a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x789872895ad7121175bd78f8,
                    limb1: 0xc0deb0b56fb251e8fb5d0a8d,
                    limb2: 0x3f10d670dc3297c2,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xfdfdc509f368ba4395773d3a,
                    limb1: 0x8de2b60b577a13d0f83b578e,
                    limb2: 0xc2dd970269530ba2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x589fa250d638e35400c12ddf,
                    limb1: 0xb3aac19fcb5095808402aa7f,
                    limb2: 0xed6de6590d0195d1,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x2965eeb3ec1fe786a6abe874,
                    limb1: 0x33e2545f82bb6add02788b8e,
                    limb2: 0xf586bc0db335d7b8,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x155b35991489db2fdf4de620,
                    limb1: 0xf24ce461346a182d67eeccf0,
                    limb2: 0xb4122bb4b37cc7d5,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x12815740835b12f70b96c66f,
                    limb1: 0xbfa76a8b80aec9f2e31c40cc,
                    limb2: 0xcd8a26d17d33c7c1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x9a8f496f09402b8fd6beb89b,
                    limb1: 0x28e48918dad2123d7f202bef,
                    limb2: 0xcdd11b6ffb3f8614,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xb5076be8537cff2a42c6db68,
                    limb1: 0x1066d40cbd01a3752e4e069c,
                    limb2: 0x123ec2fd302cb0f9,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc85f5e5efdf415f8081bf53f,
                    limb1: 0xadc5010e9d9ac6c64000d33d,
                    limb2: 0xf81314011d8852e4,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xd5915098d3d2001310b0b935,
                    limb1: 0x88bb4507ebf1be82cfba2397,
                    limb2: 0x8a463f1c00ce885f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x414858f8a83f9d4498890137,
                    limb1: 0xa09c4658c47ace74c42cdb60,
                    limb2: 0x8aaf300ff3ab7d98,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x1772eb803ddc8a82e23b1c05,
                    limb1: 0xc26baeb89b03fd69eb64b337,
                    limb2: 0x4ea7131b2d873a45,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc9d16330db15efd90235eed9,
                    limb1: 0x1b586ef360673d36baa16189,
                    limb2: 0xee652d2b848ad111,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x68f9e7942638253f3b596f1f,
                    limb1: 0xb37e6153d9accd97a344f384,
                    limb2: 0xda48eae9ff614551,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc58be8ed857035b34f51c620,
                    limb1: 0x3b14ed53116cb7c1db000006,
                    limb2: 0x7dfa292fe99b77dd,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xf7f7bd2513c1b31de932bbd2,
                    limb1: 0x627e2fa74b7ac891f7d555c7,
                    limb2: 0x7f8a094f818e7192,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x9b47b9326b668e62071faf18,
                    limb1: 0xe21058cb6937afa89be6931a,
                    limb2: 0x21a4bfb4cce2ac8c,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0xb5d32b1666194cb1d71037d1b83e90ec, high: 0xa0116be5ab0c1681c8f8e3d0d3290a4c
            },
            u256 {
                low: 0xd3fbf47a7e5b1e7f9ca5499d004ae545, high: 0xbaf3897a3e70f16a55485822de1b372a
            },
            u256 {
                low: 0x101fbcccded733e8b421eaeb534097ca, high: 0x38c1962e9148624feac1c14f30e9c5cc
            },
            u256 {
                low: 0x247a8333f7b0b7d2cda8056c3d15eef7, high: 0x1759edc372ae22448b0163c1cd9d2b7d
            },
            u256 {
                low: 0xe005b86051ef1922fe43c49e149818d1, high: 0x7d41e602eece328bff7b118e820865d6
            },
            u256 {
                low: 0x4a84eb038d1fd9b74d2b9deb1beb3711, high: 0x552f233a8c25166a1ff39849b4e1357d
            },
            u256 {
                low: 0x3405095c8a5006c1ec188efbd080e66e, high: 0x8c1745a79a6a5f92cca74147f6be1f72
            },
            u256 {
                low: 0x1775336d71eacd0549a3e80e966e1277, high: 0x5129fb7c6288e1a5cc45782198a6416d
            },
            u256 {
                low: 0x2f1205544a5308cc3dfabc08935ddd72, high: 0x870e15c2fcd81b5d24bace4307bf326
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 2
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x2950159ef4b04fdc0dc934a9,
                    limb1: 0x9e463011388a15f56d6f38f4,
                    limb2: 0xef8d0de25e526f1c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x93ff053c58374ab5fd2530ab,
                    limb1: 0xb09af339bdbe0090a3d72802,
                    limb2: 0xd7d9e3078702fe93,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256K1_11P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0x74408414d91a69f35f61bc6b,
                    limb1: 0xb4948f35f0aba81a568e7a8b,
                    limb2: 0x9d9c716f70218bbc,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x18f14196f216ed9367a2698a,
                    limb1: 0xe422cce7320bc65f4959ae9f,
                    limb2: 0xc1e171c2a4df7f1e,
                    limb3: 0x0
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0x7028fdc386b9c76dc3c4a0c8,
                    limb1: 0x63bfc9828a51db91045c2a84,
                    limb2: 0x52713bd3cf273e01,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x573f68d756aa76e18879cd7f,
                    limb1: 0xdc646d36c276f220bd9bf719,
                    limb2: 0xe7ffb91a35ad131c,
                    limb3: 0x0
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0x346aac78eda91ff42e459dd4,
                    limb1: 0x1f7e2485a95b04359515aa5a,
                    limb2: 0x720a7b0cb20237a7,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x9f608d816585bb091fe579d,
                    limb1: 0x295f0370475510aaad79a2f,
                    limb2: 0x10674a790fac2d80,
                    limb3: 0x0
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xfdfb75c4734f31b619a0c5f1,
                        limb1: 0xba74d0c06d0d4c1fd796ad28,
                        limb2: 0x23257541df1f5735,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xab26a6424ed832cffc142a96,
                        limb1: 0x8dbae9fdc5012e2f8a0fb112,
                        limb2: 0xbe97e3454d290f7a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe8cf17b6604360f32ab77237,
                        limb1: 0x941ba36adedd795eea2f88ec,
                        limb2: 0x46b13df3b3543320,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x74d04220af4a111f98c4a80d,
                        limb1: 0x7f964393edb14213ddad6c4,
                        limb2: 0xb4a442caba3be3b7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa7c4f15e3544b7b726fe2d89,
                        limb1: 0x91f9773f24630d275b1757a4,
                        limb2: 0x43a3f67bb72a70cd,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x647dfdd082ca5764d2aea380,
                        limb1: 0x648aef3906a78e71ce84fbf1,
                        limb2: 0x572879220c9de7e8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x47c7c88d2240e57c0d5226d4,
                        limb1: 0xeace595f6900b9f47c2e43ad,
                        limb2: 0x4ebcb1883d0f149a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc4aa3aea8aebeb279c7512e5,
                        limb1: 0x29aff1d64f7597b4437bcea2,
                        limb2: 0xf2c22a667568d0c5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1e1b388b804a12111c5d4e00,
                        limb1: 0x21f2f24208b8d6ec36743cf8,
                        limb2: 0x37c77a7c5181011a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb567e88c38eb2c5171b19f13,
                        limb1: 0xffffffffffffffff40a797b8,
                        limb2: 0xffffffffffffffff,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x20a0466ffab73a0eb787d833,
                        limb1: 0x42d7831ab2e5f55370e8f913,
                        limb2: 0x7bede22b852750c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8f9e2ea621ceaaa06e7ae3d7,
                        limb1: 0x2c82bb6d252b317710cd25aa,
                        limb2: 0x3a0ec8762e957e25,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8429dbd2cd9933b80cdf60d7,
                        limb1: 0x119fc81f25bf55d752f56904,
                        limb2: 0xbf710bea13ba5e43,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5b2939e6e583a9e35c41b8c0,
                        limb1: 0xe32df116e437500f4a272fca,
                        limb2: 0x36a4758f118c150d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x221c90301678dbd8a80531ef,
                        limb1: 0x79d682d8f3763cf37e6c16dd,
                        limb2: 0xff08e9b2c27aaa53,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa30c3110ad1b7bef6d2dce9,
                        limb1: 0x2fa5e726dac79ef7de2d2207,
                        limb2: 0x6d8af0aab229a2ac,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x567c843c0dd1cfa906dbdbb4,
                        limb1: 0x44a42a44f9cebda5fbafcd90,
                        limb2: 0xa044adb80835fa18,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1898d9e537bac00bfd355345,
                        limb1: 0x7c8ae56a259845dbe703255c,
                        limb2: 0x28fae5e9832d3d71,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x669598d21c086d7992a32b4d,
                        limb1: 0x92660a932cb3d42beb15da0b,
                        limb2: 0x8a922205e339b7bc,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9f924f5a4f59ce1ce9dbe693,
                        limb1: 0xaa7c9a42ecdaab1fc8d32b02,
                        limb2: 0x7061b422be32ba36,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x237c10e8ab5064dd98b84aa4,
                        limb1: 0xbe451a2a23b9db328e180930,
                        limb2: 0xd1381c477cd4ef1f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x46ea59ede242805df8760573,
                        limb1: 0x653a34f58f01de993daa011b,
                        limb2: 0xc605b6e53e68c708,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x14285649e8290fca9ab7bfd6,
                        limb1: 0x34dbb68e379cc6e5d799893a,
                        limb2: 0xb854ba5ced2e101e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x908f961f7f9ab396ac48f2d1,
                        limb1: 0xdf3021d64d43e953cb95ea08,
                        limb2: 0x8d967db0c1e9cd39,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc7199a9cc15053d9098cf9fd,
                        limb1: 0x9fbdbd771e8ebbdc51d4ab2e,
                        limb2: 0xe8ed9adbed4c2fdd,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xacfad2735fb1db3fa77bde44,
                        limb1: 0x423e10dde34d94b78323c790,
                        limb2: 0xa308b261589b9ea,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4a7fd079590cf1919d9f7016,
                        limb1: 0xcf7c2f0d7b4e47251e882e83,
                        limb2: 0x6f08df67ae898367,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3ee3a2369b9847cd71df2ec0,
                        limb1: 0x89af83db77d2eb6fd9c510dc,
                        limb2: 0xc7f5708762cc1a5c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf0c1c1af9131633a6ab06d41,
                        limb1: 0xed522093d95eb507abe47539,
                        limb2: 0x12d674c1d5212ba7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb4d6ee4b0525f214dc789ac2,
                        limb1: 0x8850d79d90d5b8e0016d8ff9,
                        limb2: 0x25052f699e7b0be4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x316411eac4a87cd6b601da54,
                        limb1: 0xbf2d10855f07258661a78c97,
                        limb2: 0xbae70a235b5a0c18,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xe461ed0fdb02966704b6e965,
                        limb1: 0xd3e495bae449b548165ecf85,
                        limb2: 0x363812f30a413355,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xed53468aeca6aa64055c3eb2,
                        limb1: 0x37931ffc042e5a41759c07a9,
                        limb2: 0x96677b3b46167304,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9d2502c39f306a0d5a1bb8f6,
                        limb1: 0x7b5e78da083b58e344b5df1f,
                        limb2: 0x3c1753668a1893d5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9ec0dbc04150df473d53e944,
                        limb1: 0x79191abaf06925be77fb479b,
                        limb2: 0x863e150c3327086d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7e661ff6bf1cad94069f5c17,
                        limb1: 0x81604f5bcd66dc1f85c1c5b6,
                        limb2: 0x334d2c597ff0266d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xcb7f314a195539f3cca376a9,
                        limb1: 0x5f291a2f2134ae9e66315735,
                        limb2: 0xbe3da094f2ddd0f8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb890d78b464057868c44c9f0,
                        limb1: 0xc3ab18f9b8de7f992bf5cebc,
                        limb2: 0x988535974b05ebb7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xce4a85749c941c2e947a8074,
                        limb1: 0xe1a2c8bffaa025f6cf821c61,
                        limb2: 0x1de5331558b7586d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd847f0cfcf0cb615f9491b48,
                        limb1: 0x3070312d13b26c2b4bc61856,
                        limb2: 0x3789ded3e8bda8d4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb37cafb4394672766bdf352c,
                        limb1: 0xee0c621973c96b847975faa2,
                        limb2: 0xb2f09aab3b991196,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1898d9e537bac00bfd35534c,
                        limb1: 0x7c8ae56a259845dbe703255c,
                        limb2: 0x28fae5e9832d3d71,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x669598d21c086d7992a32b4d,
                        limb1: 0x92660a932cb3d42beb15da0b,
                        limb2: 0x8a922205e339b7bc,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9f924f5a4f59ce1ce9dbe693,
                        limb1: 0xaa7c9a42ecdaab1fc8d32b02,
                        limb2: 0x7061b422be32ba36,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x5ed63d0a2ea76da21b86d138,
                        limb1: 0x8967dbdd92956e220fe5526a,
                        limb2: 0x26cd889c35d0d6c3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbef7628597eaa5340695c1d4,
                        limb1: 0xe5dd098ddbacb41b36864fb7,
                        limb2: 0x6ca70886fa955f53,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4e8a0415336aaf5cdd1eddb1,
                        limb1: 0x37270568016acf83220d3acd,
                        limb2: 0x7b057cadff61316a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x75a9fece90ba04ba55d4430a,
                        limb1: 0x8fbda1c256abfdc48c5ea557,
                        limb2: 0x5abcb0f47b7ec63b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x82010793be208dfdd8153cd8,
                        limb1: 0xa754e20483b4f79e76424a00,
                        limb2: 0x5917652a57c31631,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9586989c5953380d7c1cd07c,
                        limb1: 0x8537e433bc5009f68c7d04be,
                        limb2: 0xcb4dc33c612e04,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfabfadf9d7f4ab24d4a6021c,
                        limb1: 0xf7551666d9be5144c59694ec,
                        limb2: 0x88ab69057cbd6bef,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf24714a66018da9a7c19582e,
                        limb1: 0x7e22c6b5c3f38b199a7b5af5,
                        limb2: 0x49848ad86d3bbe27,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x67742565349b4e00666d4748,
                        limb1: 0xe9d9e9f5789eb3c30857f230,
                        limb2: 0xe6d73482ba72f07b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x19df3f5ba6361a3886a8e5fe,
                        limb1: 0xffffffffffffffffe3458149,
                        limb2: 0xffffffffffffffff,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xa6d8d52d74a2289f96c7d896,
                        limb1: 0xc4aa878dd93dc122980d7454,
                        limb2: 0xbb4af90c6b681fcb,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x577a16e7691b713e1258bbeb,
                        limb1: 0x28ac69fa35b413f6ba877a34,
                        limb2: 0x4d4603503763155f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x42231410b72a2c58a26f34a9,
                        limb1: 0x54e0a522ea109a7d8e8f0037,
                        limb2: 0xae3dd06a862293f3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfe03dd8d8826bca266b6af61,
                        limb1: 0xa031390fdcb3768057ec564e,
                        limb2: 0xae943c99c61d61ed,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x802cddce9506028bb1c98417,
                        limb1: 0x18604cdfcb4c41188adab06b,
                        limb2: 0xb0fcbef1a3e1d3df,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x97f313fb1ac14bdc3697ebdb,
                        limb1: 0x10ec2511ea08a6776d8feffa,
                        limb2: 0x26d1c6f16fe9b081,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9b9dec7660945356ab3266d7,
                        limb1: 0xa8147712681c8dd7a405d88,
                        limb2: 0xb50e55d227d3e6b3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x889f83f45dc41afaada3e26,
                        limb1: 0xd2d3fa92e65556fe5b1e0dd9,
                        limb2: 0x4c376c87416facf5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x431877aa55bc77b663ccb06b,
                        limb1: 0x46b1cf702c351d9ac27afe9a,
                        limb2: 0x7372a320b6d34b53,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa3a9d5aba1ba70a285790236,
                        limb1: 0xfb515ff6533477a91b057b09,
                        limb2: 0xbb8ce9be5f2d07f1,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x884db83a512445a34c6b47f2,
                        limb1: 0xda56d891790108942d034a90,
                        limb2: 0xf39e0a231ba6e81a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd5b7a0ffec3e77d1cf4c6268,
                        limb1: 0x47404f4f32de7c2e0789e1c0,
                        limb2: 0xa6d72beea9078874,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x97203299040a16726929ea9e,
                        limb1: 0xfe3a07dccaa35a145f9e7c71,
                        limb2: 0x3dc2be099194f53a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xcd1a933497bd9d1c750641f7,
                        limb1: 0x89a0b6554a1ca16f32eccd2d,
                        limb2: 0x9239c613d6a9f41b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa44c6fd38383a95cb246fa22,
                        limb1: 0x57986671d5a39a885406dfee,
                        limb2: 0xe001b2216adca08f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xda1c02e3bf14435448975d06,
                        limb1: 0x607872eacf3eb3f99d3add65,
                        limb2: 0xa1046d057e7d5974,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6845e5039a8edae3086adb93,
                        limb1: 0x83ac9c583c5cdaeef28e9150,
                        limb2: 0x972facc557a41444,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xee2153c6047657b397883343,
                        limb1: 0xc2802798c023dfacec9cedbe,
                        limb2: 0x6ba53ac83d75bdd9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdf0ccf0e212ce552d788784,
                        limb1: 0x46e51deddaa6417ee8e43969,
                        limb2: 0x6e271cfa65c80158,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x926cb4be424a8daab5179cfa,
                        limb1: 0xc6b701fb9871f28a2e7ed9d9,
                        limb2: 0x246e248f36a42676,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x21a1fc73eb9884bbef3634b5,
                        limb1: 0x76e01c4d860872acc90f4c5e,
                        limb2: 0x8608fee2bf5ad6b2,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x8fedd43e306f1c621f76ff2f,
                        limb1: 0x60a9b4e0f0b047f2285e2e50,
                        limb2: 0x1f0ccf56efd8de92,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6456a053dfc018b4806d2b0f,
                        limb1: 0x1cb6e5d777ec8bbf19b4576e,
                        limb2: 0x1cea173183b5959a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xcef58c7502273670710a7fe3,
                        limb1: 0x522483f46674396ee5e90182,
                        limb2: 0xc3b0b2e9aaf20ba7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x98f3e40c2db1511565c6b752,
                        limb1: 0x260316fce225fea4ff83d07d,
                        limb2: 0x8158a140d635cd4b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd8b4278d7c458314eedb6ba1,
                        limb1: 0xd34e8418c4c9dba286824d24,
                        limb2: 0x242f3bebb28fe078,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x69c89fee72733f5f2096ab77,
                        limb1: 0xcb55a8a0504d27c18d7e9011,
                        limb2: 0xbdfa41049586677a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3f5554ca2c35040615179257,
                        limb1: 0xe9ba2d27ea3ff48eafaee50b,
                        limb2: 0xa1f89558dce8b0d2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbbf2a7897e0bce5b5dc13ec3,
                        limb1: 0xdc2c26e417a1a20d08ad115a,
                        limb2: 0xc680b6a46def8e97,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6d9e59a372e891dbf130ca3b,
                        limb1: 0xffc8d1231f7c75b2beece632,
                        limb2: 0x4ef43cd66fb0bfc7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1542c427ccad67cd51818966,
                        limb1: 0xe9bae72d6cf10e7d3766bacc,
                        limb2: 0xd5e8ba06c20f1e50,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x889f83f45dc41afaada3e2d,
                        limb1: 0xd2d3fa92e65556fe5b1e0dd9,
                        limb2: 0x4c376c87416facf5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x431877aa55bc77b663ccb06b,
                        limb1: 0x46b1cf702c351d9ac27afe9a,
                        limb2: 0x7372a320b6d34b53,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa3a9d5aba1ba70a285790236,
                        limb1: 0xfb515ff6533477a91b057b09,
                        limb2: 0xbb8ce9be5f2d07f1,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x83004223a1a60e0a9dd7e9c2,
                        limb1: 0x84c2fdd3e571a939c475f976,
                        limb2: 0x5ea778e903cad5d3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd784a91a5e09d24dfc4a247d,
                        limb1: 0xffffffffffffffff7c074593,
                        limb2: 0x7fffffffffffffff,
                        limb3: 0x0
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xca4b2ce00141fcc507e15ad1,
                        limb1: 0xd62b34453cef4793395e4145,
                        limb2: 0xc515d4613516afa3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5b6c55c38b9d189d0df5bd93,
                        limb1: 0x7cc211f7cc532039668e2b21,
                        limb2: 0x3b84491f7ed68a57,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x9facade4bfa83d19a7ba259b,
                        limb1: 0x8279d4b95d7b22124c2444c1,
                        limb2: 0x98fa4a916d5186e2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc6f6c09255fae4a212c9c057,
                        limb1: 0x57f1fc192b142f3492cf79a1,
                        limb2: 0x1f7f3b7d1c9d1234,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x17493d6af010058c645a957a,
                        limb1: 0x640b56438d91635daf336056,
                        limb2: 0xbce1121da696801,
                        limb3: 0x0
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x880e3a2008cde96837298ecc,
                        limb1: 0xdb2e6de4aa8af5069193c8e8,
                        limb2: 0x6398cea8739ecd7a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7ff65858d14bac4c61b832d6,
                        limb1: 0x694e7dc69645e191cde32de9,
                        limb2: 0xa09dffdc77ddc864,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 {
                        limb0: 0xca4b2ce00141fcc507e15ad1,
                        limb1: 0xd62b34453cef4793395e4145,
                        limb2: 0xc515d4613516afa3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5b6c55c38b9d189d0df5bd93,
                        limb1: 0x7cc211f7cc532039668e2b21,
                        limb2: 0x3b84491f7ed68a57,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x5fae94d6396b7f4ba6ca2d57,
                limb1: 0x1b9c61bd0be7850f8cc95a73,
                limb2: 0x64f63be6657f5511,
                limb3: 0x0
            },
            g_rhs_sqrt: array![
                u384 {
                    limb0: 0x5cb2ac8ea4f91cca894e1c35,
                    limb1: 0xa32d4b8d9ba11248efec9421,
                    limb2: 0x6b648328937edbca,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x36057cfecc2706ea71bc329,
                    limb1: 0x1bcda3874a72b90b02d66655,
                    limb2: 0x5e01c092fff58fe8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2ec4251b19cfbd86ebb38e04,
                    limb1: 0x1b4d9ab7659a4e038c21d34f,
                    limb2: 0x6537d443422750ce,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3e5a6dc7441fbac7d503b2fb,
                    limb1: 0x809f61ea98846e73cb29caf6,
                    limb2: 0x3bdf1cd7526e4ad6,
                    limb3: 0x0
                }
            ]
                .span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x393dead57bc85a6e9bb44a70,
                    limb1: 0x64d4b065b3ede27cf9fb9e5c,
                    limb2: 0xda670c8c69a8ce0a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x789872895ad7121175bd78f8,
                    limb1: 0xc0deb0b56fb251e8fb5d0a8d,
                    limb2: 0x3f10d670dc3297c2,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xfdfdc509f368ba4395773d3a,
                    limb1: 0x8de2b60b577a13d0f83b578e,
                    limb2: 0xc2dd970269530ba2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x589fa250d638e35400c12ddf,
                    limb1: 0xb3aac19fcb5095808402aa7f,
                    limb2: 0xed6de6590d0195d1,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x2965eeb3ec1fe786a6abe874,
                    limb1: 0x33e2545f82bb6add02788b8e,
                    limb2: 0xf586bc0db335d7b8,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x155b35991489db2fdf4de620,
                    limb1: 0xf24ce461346a182d67eeccf0,
                    limb2: 0xb4122bb4b37cc7d5,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x12815740835b12f70b96c66f,
                    limb1: 0xbfa76a8b80aec9f2e31c40cc,
                    limb2: 0xcd8a26d17d33c7c1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x9a8f496f09402b8fd6beb89b,
                    limb1: 0x28e48918dad2123d7f202bef,
                    limb2: 0xcdd11b6ffb3f8614,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xb5076be8537cff2a42c6db68,
                    limb1: 0x1066d40cbd01a3752e4e069c,
                    limb2: 0x123ec2fd302cb0f9,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc85f5e5efdf415f8081bf53f,
                    limb1: 0xadc5010e9d9ac6c64000d33d,
                    limb2: 0xf81314011d8852e4,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xd5915098d3d2001310b0b935,
                    limb1: 0x88bb4507ebf1be82cfba2397,
                    limb2: 0x8a463f1c00ce885f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x414858f8a83f9d4498890137,
                    limb1: 0xa09c4658c47ace74c42cdb60,
                    limb2: 0x8aaf300ff3ab7d98,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x1772eb803ddc8a82e23b1c05,
                    limb1: 0xc26baeb89b03fd69eb64b337,
                    limb2: 0x4ea7131b2d873a45,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc9d16330db15efd90235eed9,
                    limb1: 0x1b586ef360673d36baa16189,
                    limb2: 0xee652d2b848ad111,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x68f9e7942638253f3b596f1f,
                    limb1: 0xb37e6153d9accd97a344f384,
                    limb2: 0xda48eae9ff614551,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc58be8ed857035b34f51c620,
                    limb1: 0x3b14ed53116cb7c1db000006,
                    limb2: 0x7dfa292fe99b77dd,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xf7f7bd2513c1b31de932bbd2,
                    limb1: 0x627e2fa74b7ac891f7d555c7,
                    limb2: 0x7f8a094f818e7192,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x9b47b9326b668e62071faf18,
                    limb1: 0xe21058cb6937afa89be6931a,
                    limb2: 0x21a4bfb4cce2ac8c,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xaf4ad4d7d582b10b14c97e6c,
                    limb1: 0xadf808c85e766e997e470fd0,
                    limb2: 0x2714571e587ce46d,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x86a7815dad7e8a53b19fee2,
                    limb1: 0x1922fc1efcc51e68146ffa1b,
                    limb2: 0x9e19b7c1f886488e,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0xd3fbf47a7e5b1e7f9ca5499d004ae545, high: 0xbaf3897a3e70f16a55485822de1b372a
            },
            u256 {
                low: 0x101fbcccded733e8b421eaeb534097ca, high: 0x38c1962e9148624feac1c14f30e9c5cc
            },
            u256 {
                low: 0x247a8333f7b0b7d2cda8056c3d15eef7, high: 0x1759edc372ae22448b0163c1cd9d2b7d
            },
            u256 {
                low: 0xe005b86051ef1922fe43c49e149818d1, high: 0x7d41e602eece328bff7b118e820865d6
            },
            u256 {
                low: 0x4a84eb038d1fd9b74d2b9deb1beb3711, high: 0x552f233a8c25166a1ff39849b4e1357d
            },
            u256 {
                low: 0x3405095c8a5006c1ec188efbd080e66e, high: 0x8c1745a79a6a5f92cca74147f6be1f72
            },
            u256 {
                low: 0x1775336d71eacd0549a3e80e966e1277, high: 0x5129fb7c6288e1a5cc45782198a6416d
            },
            u256 {
                low: 0x2f1205544a5308cc3dfabc08935ddd72, high: 0x870e15c2fcd81b5d24bace4307bf326
            },
            u256 {
                low: 0x42930b33a81ad477fb3675b89cdeb3e6, high: 0xadc0da7a16febaa011af923d79fdef7c
            },
            u256 {
                low: 0x2648ee38e07405eb215663abc1f254b8, high: 0x148b2758d7ab792809e469e6ec62b2c8
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 2
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xfd3ebb89d10fe461e552fc52,
                    limb1: 0xec1cd433c40d59e89a0a67c6,
                    limb2: 0x718e281769552f5,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x5765daf8dcb6b393eba165cd,
                    limb1: 0x106a5fd0eb158dcde70d802e,
                    limb2: 0xe30701a5d0fa2198,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256K1_12P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0x1d36d633760b3c55c81a8d8c,
                    limb1: 0xd079c33f8b0673c89e3a9bd0,
                    limb2: 0x70ff81f33501ba92,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xcff3e05d854ed659f6cd040c,
                    limb1: 0x33f2728d006bc9e70866e303,
                    limb2: 0x2f4943938395998b,
                    limb3: 0x0
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0x1db4213156986f28879aba6b,
                    limb1: 0x5a33215ee31af0cdd996b80a,
                    limb2: 0x62cfcf2de05e2009,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xa9552c8f1c96a1c163a43cae,
                    limb1: 0x6230406918f0da360db56e32,
                    limb2: 0x35ace69b06cd8541,
                    limb3: 0x0
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0x5942b3e3f39ff916f02cf401,
                    limb1: 0xa8740c9f663c8f149c7f7be4,
                    limb2: 0x6f066ce3dd1f0f5,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x4aa3daffc076e92ff6b946d1,
                    limb1: 0x3818f620414525abc495e44b,
                    limb2: 0xae70f24112363941,
                    limb3: 0x0
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x43803ccffd89de52f2d9f46a,
                        limb1: 0x724317072cf04c481ce975db,
                        limb2: 0x38a2caabed77bef3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd0b180103c81513e21c2fb6a,
                        limb1: 0xd3e66804ea0043637896eb1e,
                        limb2: 0xeb75e9241d1e7aeb,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x943f36084a3aa9db3a28aee2,
                        limb1: 0x8233499815815fa1a21bf7e0,
                        limb2: 0xc5113727a0066e2d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9c6be7e356ee7b82c18d424c,
                        limb1: 0x2877b97733cd240acf8d45a1,
                        limb2: 0x64009f4b48dcf594,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x944b2b4d2e174e24f4725eae,
                        limb1: 0x809abde1b36f8af96b11e0df,
                        limb2: 0x970556c1ef3c74b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2366044932cfb2d6cd92269c,
                        limb1: 0x78305b4e79bb9a2dbfd8d92e,
                        limb2: 0x737c9fe513052cc8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2fe5d0a1ccebc36313af9c0f,
                        limb1: 0xa88a2c61770c96aa42d63136,
                        limb2: 0xf29e6708df5f07d0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbfb469c15cf813d99e4c8e78,
                        limb1: 0x19029891e210e3e94ddf37f1,
                        limb2: 0xee06acfe4a24332,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4b379b29f4ab331175f62846,
                        limb1: 0x3e661d1f3fde0e0164e326e3,
                        limb2: 0x91d5c066844c1ffe,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9c35f5300117b7016b6639c4,
                        limb1: 0x6f0dbce576d037d9034816c7,
                        limb2: 0x9550442a2929082f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x306a8352bacb73a15e434552,
                        limb1: 0xffffffffffffffff2cc719d7,
                        limb2: 0x7fffffffffffffff,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x4d4f90373b52c6bce721c2e4,
                        limb1: 0xaf49e3b223236ae79b4a1573,
                        limb2: 0x86964322091375ef,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x674ca422b48ee61b5ba1a16d,
                        limb1: 0x919bfc67da8a8c273e9bf150,
                        limb2: 0xafbc6531fd6e788e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf9593c9b2a388feb60deded1,
                        limb1: 0x7e12b82e2c90aa45dd465a6b,
                        limb2: 0x135cd8354cd14f13,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x82ce8441363012899363288b,
                        limb1: 0xc5498011898a291855cf4fc1,
                        limb2: 0x8c77bba67357d042,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa357006b997208fd260bf7bc,
                        limb1: 0x95b7f965d86ffa806d816fb7,
                        limb2: 0xaf1eba6c9536a74,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4b3f63f339c056eaed839476,
                        limb1: 0x408e12de5101bbb4a60eba55,
                        limb2: 0x5113bf87221cc134,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf1976a57cbcf166e1526d452,
                        limb1: 0x1cd20c88bf06c52bce6ed5df,
                        limb2: 0x6a96d5a13c7237bf,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xddff949f4808dd4c0d97d9e,
                        limb1: 0xc861463e2ae9bf55d9736843,
                        limb2: 0xe94178b5df6b2c4c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbd3d9a0ef15e9776584c0abe,
                        limb1: 0x1792b8c9898d1ba217dc3f21,
                        limb2: 0x27e5f599d8ca10b0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x24273e002797096b085c2abe,
                        limb1: 0xb446c121e58d9b3ef42b93ae,
                        limb2: 0x4feeac840d9cbcde,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdedf8877a94fe18f5ed93beb,
                        limb1: 0x999906bf7746ec6b31aa007f,
                        limb2: 0x67c7d59acff4611d,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x1ba8c9dafbb7518be9d6926,
                        limb1: 0x9a72b74b5d2af292ba1a9381,
                        limb2: 0x37090e386e6ee1f3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x33b6037e55e9ecbdb19e5a7d,
                        limb1: 0x6a90abf343c9d5b18b9bacfb,
                        limb2: 0x99f84ac927e269fa,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x187a9c28f7bbcb32363b67cf,
                        limb1: 0xa916dec7d206c42bde34779c,
                        limb2: 0x7d17b384d651c6d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x49591e5add2cfea5098e8081,
                        limb1: 0x5041e696c65cfb42c77f87f,
                        limb2: 0x1005e632ef762554,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe364eef820184e6d48b1a4e5,
                        limb1: 0x780853372e58c794ce405ddd,
                        limb2: 0x568fd3fa2ccbf043,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x28439e6ed4d98bb17dcca3cf,
                        limb1: 0x2ec614fbf92d99b72a12019d,
                        limb2: 0x3edec9406bbd20de,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2091b208695626a9acb2b93d,
                        limb1: 0xd23e567d774eed7119d326fd,
                        limb2: 0xf8480ca5c21f33fc,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x62a7aa38cc9d1891c0b6af75,
                        limb1: 0x45a3977abb3c2c8eca21c5cc,
                        limb2: 0x15af60cb2b91b77f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x609aeb122307d2a139c6dfb6,
                        limb1: 0x3d1549ebce785df3456c93d4,
                        limb2: 0x1eacc84c0db67171,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbe75c21275a9b859e1bb36a2,
                        limb1: 0x463efa6df133f606f7c19dae,
                        limb2: 0xc4f352ad094f3cba,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1f4c1667b5f7ba4c4fc40287,
                        limb1: 0xde141eac7667fbbb313f3766,
                        limb2: 0x3aaf1bc91892061c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4cbd76a43610cf7be59fa1e9,
                        limb1: 0x49e0ce6cb72cca250432cb68,
                        limb2: 0x1971bf11e3da30dd,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x1d2cf1829f436f2d51ec5faf,
                        limb1: 0xcb0539def5f7ec553f069627,
                        limb2: 0xae1bd5ee3f88398d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd3187cf2efe84ac3816b793f,
                        limb1: 0xfb43e6d6f9c9d512b6439932,
                        limb2: 0xce26c45dee054be5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd170a83e278bef6fa61817b7,
                        limb1: 0x7283094337f4a7e90cec78f3,
                        limb2: 0x8789e97519b92988,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe0f52dffb6a34883eed7edf5,
                        limb1: 0x144c642ce5ea8a91f3f543bd,
                        limb2: 0x5ddc64af307a27c3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdeada713e6ad250765f56791,
                        limb1: 0xa9a3ce30c59a65aa3d25ff55,
                        limb2: 0xfc59d6c17eb661be,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x814f841be7af059df77f5ad,
                        limb1: 0x41f53c42639ccc3667ad72c1,
                        limb2: 0x4ae714e73b9a9781,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1df26ca7c8d9af8f2773023c,
                        limb1: 0x8f07d7cec2b98d4afad728e1,
                        limb2: 0x7697930f1a77567c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x476d17148f5e9d46bfe7df4,
                        limb1: 0x1060e51904d435d95fa9498d,
                        limb2: 0x6bbc389fe541a08e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x77ee9a5bd3567b285797e379,
                        limb1: 0xe591206113dd7d234d147441,
                        limb2: 0x685d76bc0fa33604,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xeeaa1c58e0f0585d4fac0726,
                        limb1: 0xac1547605e603e47b9fdfa2,
                        limb2: 0x9a1d8d3d9bbb61d6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x25fcb48f95afb8c358ca2c7e,
                        limb1: 0xfb90757a6dda364435196bc2,
                        limb2: 0xbfb84ff18f19d41b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbd3d9a0ef15e9776584c0ac5,
                        limb1: 0x1792b8c9898d1ba217dc3f21,
                        limb2: 0x27e5f599d8ca10b0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x24273e002797096b085c2abe,
                        limb1: 0xb446c121e58d9b3ef42b93ae,
                        limb2: 0x4feeac840d9cbcde,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdedf8877a94fe18f5ed93beb,
                        limb1: 0x999906bf7746ec6b31aa007f,
                        limb2: 0x67c7d59acff4611d,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xa6870e138629683e4faaea9e,
                        limb1: 0x6dc6750f8f627cd92f97f52f,
                        limb2: 0xbc92a5af395c365d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x884ad20af29732bbb455ab0f,
                        limb1: 0xdc7b43242c13716c81d8599,
                        limb2: 0xdb1c380054741d88,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6035370615fbd47e26d5f04f,
                        limb1: 0xf0bf0c89c7015ae3818cd5a6,
                        limb2: 0xf1f1aecee11f7847,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe17b83fa44aa786aca3bd172,
                        limb1: 0x39c99efed6741f59b7d0b3cf,
                        limb2: 0xf6a98c172a8468d0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xcd7451187ce45f748e81920b,
                        limb1: 0xfff133431095328b7d1822dd,
                        limb2: 0xd4ad33d8bd0698b7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4f9bfbf925d59d71127114d6,
                        limb1: 0x4a89c28f90a3c935ea10f9eb,
                        limb2: 0x5411fb8d89c5844c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd82ed12c4b731ab6eb107720,
                        limb1: 0x9b07dee2afe23121e8140a1d,
                        limb2: 0x4aa80a3bd9dacfc9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5505bbb3fce9649a0778a3b5,
                        limb1: 0x8b783dabf19cc103bf841143,
                        limb2: 0xcbccf740ed70c407,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x95b10da10b5baab55c07f887,
                        limb1: 0xe6b2d2bfcd8ebaad75c90633,
                        limb2: 0x97579b447d02ba9e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2141e4211d8f3096cbd5488d,
                        limb1: 0x3511434d795c6e3da249542e,
                        limb2: 0x2f4bddf79fe0e3ad,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4000a29849613909a0d34336,
                        limb1: 0xffffffffffffffffeace0e22,
                        limb2: 0x7fffffffffffffff,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xb250ea4693e8362a7975b29d,
                        limb1: 0x464209627f1f9585f55ac767,
                        limb2: 0x52f444724f83f778,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc083f21e797f441b4c5a4704,
                        limb1: 0x14325d4855a9974b59da0efe,
                        limb2: 0xe18d8cbd32c163e1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x12aeb84f6aba7f5327c6bfe7,
                        limb1: 0x95d02159235dacda1a5e7138,
                        limb2: 0xc2d0ad34dac30f1b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1d104c6b37ed4d93180506a6,
                        limb1: 0x6750d06d646d6ad736dd19bf,
                        limb2: 0x5f1b02f9ba50af72,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc9246853437175516a2525d5,
                        limb1: 0x8abff09a04aa440bcc26064,
                        limb2: 0x83aef02a8f9f5d3a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5c5d4ee962e2e1b7dd4b34fe,
                        limb1: 0xf8fb1da4dcfe44c7bbadf393,
                        limb2: 0xdb1ffdd7e842eebc,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd50c7be07323ae77304e4771,
                        limb1: 0x595164a4dc2d3db5d629b024,
                        limb2: 0xe4c4f48439a4fd9b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8195237dfcb0c25b7d434885,
                        limb1: 0x34bd1c7b1847621627900f1d,
                        limb2: 0x67433e9e0a26e9ab,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc790da7919334bdcf03dd494,
                        limb1: 0x16e2e556dae0b9f601bada3f,
                        limb2: 0xe4d88cf6c6bb19cc,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1bf7dda07ee5be71a707e79a,
                        limb1: 0x892bb989a853177b6b292977,
                        limb2: 0x85c3a477ece55c69,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xde623d79c8c2aebc9f590f0c,
                        limb1: 0xfdfa8a01f326f65f64de445,
                        limb2: 0x75f788602497fba7,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xba8bb9c81570769362931798,
                        limb1: 0xa1082c60fc4f2bfe9184b460,
                        limb2: 0x5b5db2d50c85ec24,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x75286350ab10c0a1eeac390f,
                        limb1: 0x5b47b806b4b56d06b233683d,
                        limb2: 0x8d4f97ce14a7f59f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x163a99d61d1702e1b03b6624,
                        limb1: 0xc754f0bbca1bd31c025acbea,
                        limb2: 0x69e004be92162886,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9bd732d7f5bda0e6bf80810,
                        limb1: 0x8b230d9ff8e0dbb3ab28d91e,
                        limb2: 0xa23ea8f8481c1609,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa8a3bde74a6ce6d3e59ab4f3,
                        limb1: 0x16d9807375b7d8557f334ceb,
                        limb2: 0x55ca4c02e5fc5e8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe51166fa7af9d038f12e4bdb,
                        limb1: 0x90f63789d373ed6b8902eb68,
                        limb2: 0x6e69b6a9ef2f7ace,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbdf1ea31e1cc4f37c458a58c,
                        limb1: 0x4f16903b8633013d68d33f65,
                        limb2: 0x28aeb879c078acb7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x917e2ffada93d494f13c5a75,
                        limb1: 0xf81ac75ba681c7d9fa68835c,
                        limb2: 0x60fbc3f9c5ac8d42,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd678d5d916bf5ca2b94e92a9,
                        limb1: 0xbf74e1f22cca38999d040e6b,
                        limb2: 0x22a46d9975b0ef67,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa9b252c0dc489bf114e781dc,
                        limb1: 0xb36157631d461bd0c11e47ad,
                        limb2: 0xce2e93a2ddf87d0d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3a9db879fde4a591354a3d36,
                        limb1: 0x18766a0e913db86094591625,
                        limb2: 0xd03dcb69d47a7b24,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe2ad103f8599656aac39ac02,
                        limb1: 0x9b0d17777365266369bf7052,
                        limb2: 0x91513ed506efe462,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xe03667ee0b597b2b5237e9ed,
                        limb1: 0xebce41b179dd16a9b57b73d5,
                        limb2: 0x44addf202c9bc449,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x439b9ed5527adcc516780802,
                        limb1: 0x8d608cfa57a3230f74f668f7,
                        limb2: 0x2aded92c6349bb27,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x82c70a2beb197b4b166f5266,
                        limb1: 0x18b0e96ff78fb9f6b8951888,
                        limb2: 0x53b4bc71fb5569c1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7dc301351b6555322198e8c9,
                        limb1: 0x1977bc603e1d816875667ba1,
                        limb2: 0xecb1594667b8c399,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4082cc6551997959335e5f1b,
                        limb1: 0x50e6568bb7b41510832ab1c0,
                        limb2: 0x7b561de7201cf077,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x993be0b11eeeab6034d549bf,
                        limb1: 0x64adf0db2e518e503c201a3f,
                        limb2: 0xc0b09e1c34979646,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf067af8e5de712db6a2911a3,
                        limb1: 0xd88a90ef69aa1ad01200eac0,
                        limb2: 0xa07db2974dd39eb1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x543860c52c46c5d4d6fc2ceb,
                        limb1: 0x79d7c6674a3e52dbd1b2ca33,
                        limb2: 0x5685a67cd6afc0e8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd15348391349f4c96efc1fc1,
                        limb1: 0x992f6304d9235a81c7c9eb51,
                        limb2: 0x1d0bd8975760a351,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x98d38b43eb6be396c185abeb,
                        limb1: 0x198377687672e215c449d266,
                        limb2: 0x8d1e73cbb3ea847e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9644d1d27a038986d8b2bd4c,
                        limb1: 0xa3dab8dbf2a86ddfe3b14d06,
                        limb2: 0xa107f93f0a4ecb3c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc790da7919334bdcf03dd49b,
                        limb1: 0x16e2e556dae0b9f601bada3f,
                        limb2: 0xe4d88cf6c6bb19cc,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1bf7dda07ee5be71a707e79a,
                        limb1: 0x892bb989a853177b6b292977,
                        limb2: 0x85c3a477ece55c69,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xde623d79c8c2aebc9f590f0c,
                        limb1: 0xfdfa8a01f326f65f64de445,
                        limb2: 0x75f788602497fba7,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xb621bb1d78329bff02939c71,
                        limb1: 0x6c9ceb92565c4cc31a427e2,
                        limb2: 0x216d8c060d466edc,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd784a91a5e09d24dfc4a247d,
                        limb1: 0xffffffffffffffff7c074593,
                        limb2: 0x7fffffffffffffff,
                        limb3: 0x0
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x390dfcfd480ce0a51a109981,
                        limb1: 0x8dfb7f29ef62a9808912090e,
                        limb2: 0xf256c141b0e285a0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x89092aeab5c797bf88384dc3,
                        limb1: 0xfd58d201b6a8801d89e9cc11,
                        limb2: 0x963fca03e1cfef00,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xf9072ad2fb9bd0d63920e90a,
                        limb1: 0xe18a3a917b1d15a130e81eb2,
                        limb2: 0x73c7ef9b43da47db,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4cb52aa599f88c2b1f1a6d61,
                        limb1: 0x5f45824e4c6e3f44353cb34a,
                        limb2: 0x74a5837f049ef683,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9afd957b86faf28110e9a93e,
                        limb1: 0xf86cada873e172ff55d162f7,
                        limb2: 0xb779862a4187abcd,
                        limb3: 0x0
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x8f61eaecf85a2489b674496d,
                        limb1: 0xe1e07a258bb2a283bf7e3f63,
                        limb2: 0xa05f48cbd631a763,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbf402c6af8752640b98a2f99,
                        limb1: 0xed6dbe0bfe9b80cec564947a,
                        limb2: 0x1bbe861b2caf8906,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 {
                        limb0: 0x390dfcfd480ce0a51a109981,
                        limb1: 0x8dfb7f29ef62a9808912090e,
                        limb2: 0xf256c141b0e285a0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x89092aeab5c797bf88384dc3,
                        limb1: 0xfd58d201b6a8801d89e9cc11,
                        limb2: 0x963fca03e1cfef00,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x13fa35739992e4e47458f158,
                limb1: 0xb4ee782cd6d40e6ab53b53de,
                limb2: 0x5f5146224ec030c3,
                limb3: 0x0
            },
            g_rhs_sqrt: array![
                u384 {
                    limb0: 0x1bb16c0dce1175e3877b6696,
                    limb1: 0xbe55ae456874071133079b36,
                    limb2: 0x3167c6dfa829c4,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1c1a50cc9dee6e70f8301358,
                    limb1: 0x3a2120d6b5c865f4baf6daed,
                    limb2: 0x5aeb786ff2fb767b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5302fe5974e17b77b1aa8476,
                    limb1: 0x31da45bdfd509fd59a7aec7a,
                    limb2: 0x290ab7b904a1cae7,
                    limb3: 0x0
                }
            ]
                .span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x393dead57bc85a6e9bb44a70,
                    limb1: 0x64d4b065b3ede27cf9fb9e5c,
                    limb2: 0xda670c8c69a8ce0a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x789872895ad7121175bd78f8,
                    limb1: 0xc0deb0b56fb251e8fb5d0a8d,
                    limb2: 0x3f10d670dc3297c2,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xfdfdc509f368ba4395773d3a,
                    limb1: 0x8de2b60b577a13d0f83b578e,
                    limb2: 0xc2dd970269530ba2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x589fa250d638e35400c12ddf,
                    limb1: 0xb3aac19fcb5095808402aa7f,
                    limb2: 0xed6de6590d0195d1,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x2965eeb3ec1fe786a6abe874,
                    limb1: 0x33e2545f82bb6add02788b8e,
                    limb2: 0xf586bc0db335d7b8,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x155b35991489db2fdf4de620,
                    limb1: 0xf24ce461346a182d67eeccf0,
                    limb2: 0xb4122bb4b37cc7d5,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x12815740835b12f70b96c66f,
                    limb1: 0xbfa76a8b80aec9f2e31c40cc,
                    limb2: 0xcd8a26d17d33c7c1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x9a8f496f09402b8fd6beb89b,
                    limb1: 0x28e48918dad2123d7f202bef,
                    limb2: 0xcdd11b6ffb3f8614,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xb5076be8537cff2a42c6db68,
                    limb1: 0x1066d40cbd01a3752e4e069c,
                    limb2: 0x123ec2fd302cb0f9,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc85f5e5efdf415f8081bf53f,
                    limb1: 0xadc5010e9d9ac6c64000d33d,
                    limb2: 0xf81314011d8852e4,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xd5915098d3d2001310b0b935,
                    limb1: 0x88bb4507ebf1be82cfba2397,
                    limb2: 0x8a463f1c00ce885f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x414858f8a83f9d4498890137,
                    limb1: 0xa09c4658c47ace74c42cdb60,
                    limb2: 0x8aaf300ff3ab7d98,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x1772eb803ddc8a82e23b1c05,
                    limb1: 0xc26baeb89b03fd69eb64b337,
                    limb2: 0x4ea7131b2d873a45,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc9d16330db15efd90235eed9,
                    limb1: 0x1b586ef360673d36baa16189,
                    limb2: 0xee652d2b848ad111,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x68f9e7942638253f3b596f1f,
                    limb1: 0xb37e6153d9accd97a344f384,
                    limb2: 0xda48eae9ff614551,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc58be8ed857035b34f51c620,
                    limb1: 0x3b14ed53116cb7c1db000006,
                    limb2: 0x7dfa292fe99b77dd,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xf7f7bd2513c1b31de932bbd2,
                    limb1: 0x627e2fa74b7ac891f7d555c7,
                    limb2: 0x7f8a094f818e7192,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x9b47b9326b668e62071faf18,
                    limb1: 0xe21058cb6937afa89be6931a,
                    limb2: 0x21a4bfb4cce2ac8c,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xaf4ad4d7d582b10b14c97e6c,
                    limb1: 0xadf808c85e766e997e470fd0,
                    limb2: 0x2714571e587ce46d,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x86a7815dad7e8a53b19fee2,
                    limb1: 0x1922fc1efcc51e68146ffa1b,
                    limb2: 0x9e19b7c1f886488e,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x17bc74c409191a2b2249d987,
                    limb1: 0xf4fe5f79db38f3064f7d093e,
                    limb2: 0x3536ce04295e2a42,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb1d36a10f008c1c24de1ad7d,
                    limb1: 0xa4f2190c71ee5e0ff07c48f8,
                    limb2: 0x21c1a2d4cfff3233,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0x101fbcccded733e8b421eaeb534097ca, high: 0x38c1962e9148624feac1c14f30e9c5cc
            },
            u256 {
                low: 0x247a8333f7b0b7d2cda8056c3d15eef7, high: 0x1759edc372ae22448b0163c1cd9d2b7d
            },
            u256 {
                low: 0xe005b86051ef1922fe43c49e149818d1, high: 0x7d41e602eece328bff7b118e820865d6
            },
            u256 {
                low: 0x4a84eb038d1fd9b74d2b9deb1beb3711, high: 0x552f233a8c25166a1ff39849b4e1357d
            },
            u256 {
                low: 0x3405095c8a5006c1ec188efbd080e66e, high: 0x8c1745a79a6a5f92cca74147f6be1f72
            },
            u256 {
                low: 0x1775336d71eacd0549a3e80e966e1277, high: 0x5129fb7c6288e1a5cc45782198a6416d
            },
            u256 {
                low: 0x2f1205544a5308cc3dfabc08935ddd72, high: 0x870e15c2fcd81b5d24bace4307bf326
            },
            u256 {
                low: 0x42930b33a81ad477fb3675b89cdeb3e6, high: 0xadc0da7a16febaa011af923d79fdef7c
            },
            u256 {
                low: 0x2648ee38e07405eb215663abc1f254b8, high: 0x148b2758d7ab792809e469e6ec62b2c8
            },
            u256 {
                low: 0xd450fe4aec4f217bb306d1a8e5eeac76, high: 0xd67e55fd642bfa42aef9c00b8a64c1b9
            },
            u256 {
                low: 0x85940927468ff53d864a7a50b48d73f1, high: 0x37176e84d977e9933c49d76fcfc6e625
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 2
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x25e0ae5146eead827adbb1d,
                    limb1: 0x609aab8b2f94654f9d6cac6,
                    limb2: 0x853097dfea39f246,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x25fd09e456853bffe637add8,
                    limb1: 0x44330f663f6d9da943dbb0df,
                    limb2: 0x31632aa05863e742,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_ED25519_1P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high_shifted: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x2b32584420d7ce3cd4a11930,
                limb1: 0x7f0e9c3b3f207c90986c3546,
                limb2: 0x2fb2291daeffdfce,
                limb3: 0x0
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![u256 { low: 0x0, high: 0x0 },].span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 4
        );
        assert!(
            res == G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            }
        );
    }


    #[test]
    fn test_msm_ED25519_2P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high_shifted: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x21b051e599886cc144eb97ce,
                limb1: 0x26a4f46e7f4c9c9c99d8f2f8,
                limb2: 0x2a61add1aea2f3a5,
                limb3: 0x0
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x7238f02b9f20e09c2181a557,
                    limb1: 0x2cedcc5b0be371c337fd7e9e,
                    limb2: 0x41f3bbeb280fe8a2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf046f8cd6e5a75fca71dd19b,
                    limb1: 0x892b4613ef5c58df4ef692a4,
                    limb2: 0x7527fa36f5738847,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0xb4862b21fb97d43588561712e8e5216a, high: 0x4b3e865e6f4590b9a164106cf6a659e
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 4
        );
        assert!(
            res == G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            }
        );
    }


    #[test]
    fn test_msm_ED25519_3P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0x6889d75e36c152c1cc46f152,
                    limb1: 0xab6c91609cc41b1c6148652e,
                    limb2: 0x6d04cda48b959e7b,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd12689aa4a75942f20369ac5,
                    limb1: 0x5d6ae4c0a9977c4e19538008,
                    limb2: 0x101fd900dd268a39,
                    limb3: 0x0
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0x4cf7cf1e83ac6ddeb4c0d88,
                    limb1: 0xdf032c7d359dec2b1b30b922,
                    limb2: 0x1b4e7ef7358304ab,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x90887d2f101702d94aa5377f,
                    limb1: 0x3fdfadebd967a872d02af758,
                    limb2: 0x2ea0b09931ec6dc4,
                    limb3: 0x0
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0x506c121a6c7fd9aa60e121a3,
                    limb1: 0x23b636b641b29ef8bdd1c639,
                    limb2: 0x791b6ec60b5f8598,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x59f9c615c1fecf831ca3b5fc,
                    limb1: 0x2f6fb1f6358caa9cb6f8c9f7,
                    limb2: 0x6e62064b941a23df,
                    limb3: 0x0
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x90d2e8727e5fd1a5c5e58e14,
                        limb1: 0xa929a53579aa9e3e81f805cf,
                        limb2: 0x38b87adcae1fcece,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xed700380fc6bb9738c6114eb,
                        limb1: 0xfffffffffffffffff21a53ed,
                        limb2: 0x7fffffffffffffff,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x9bf920910c9471cd86fa6936,
                        limb1: 0xaf3a5a2000fbb57b2915971d,
                        limb2: 0x2520dc914ad73ef1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x149185623af054bc4c27361d,
                        limb1: 0x97e30c5c0852f883c3ccd612,
                        limb2: 0x7b5d16acd65ac24f,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xff8777d8fa0d0d9e90803a6,
                        limb1: 0x3200ea1f027c0194c591be9a,
                        limb2: 0x7bf9cf6188a57b24,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x298347e8f997fe0e45013dda,
                        limb1: 0x18573b7ce42e6aa818d64105,
                        limb2: 0x247c8fcba4de35d2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd378ec11faf7730e2ff20bfb,
                        limb1: 0xb34729bedbbffe0680bb052c,
                        limb2: 0x29082e707a1931f5,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xc12680bbd361470deefc0ddb,
                        limb1: 0x260a8dd5e5c9670b883202d1,
                        limb2: 0xc6013fb41d22ac3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf528de61fe449f365ba6277e,
                        limb1: 0xf6a6d966694aa0bb75ed1cb2,
                        limb2: 0x6823ce0d3d23cc34,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd9f30aacb5f76e970a2c52f3,
                        limb1: 0xe032ad62c9c9dff5c6d18e99,
                        limb2: 0x4a31a0ff430ab173,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa89e4b88b906535c7fb68076,
                        limb1: 0xe0d23b2d6276f35194ce4d7a,
                        limb2: 0x26f8964f090fdd7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x149185623af054bc4c27361d,
                        limb1: 0x97e30c5c0852f883c3ccd612,
                        limb2: 0x7b5d16acd65ac24f,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x16f9ccb6b1a4ee0a7c8af534,
                        limb1: 0x16e1bd321d501968a5ba6c6e,
                        limb2: 0x32bb63a6dd7258ce,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9d6582305ba4fa41292552df,
                        limb1: 0x69dd814,
                        limb2: 0x4000000000000000,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x6a276e6ef83fd83c3ec14fa0,
                        limb1: 0xb35e6c0db7ecc805c5801ddf,
                        limb2: 0x28b6574f0efd540d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x784bdfce8976e0a02d2219fa,
                        limb1: 0x644c713f6f79277509e4821e,
                        limb2: 0x4d13655a2c6d5c1f,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x87bddb06d00da5ddeedbe34e,
                        limb1: 0x641cd510e86c01094e54c4d7,
                        limb2: 0x5791fae9d6d59e29,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xebe59226513f05d9ac1dfdad,
                        limb1: 0x67b26d524d321d7297848669,
                        limb2: 0x5484da3645564e03,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1ae3a2ac4a1808a78bf21862,
                        limb1: 0xcdf04e6a46d59cdd8fa6fe81,
                        limb2: 0x1a27e76d43576aa3,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x29518fdc2f6f4b7e3af6fc8d,
                        limb1: 0xb5d116a383ff28b270fc0e6f,
                        limb2: 0x22ab18d3b0dbde11,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa93ec09a846f9568f9497ab2,
                        limb1: 0xc088c6dd025aa1bd2adec66c,
                        limb2: 0x337b5ade5aec450a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x823f114d726ddc68aa7d465c,
                        limb1: 0x3abc1a8b9b7f7bde51a40a70,
                        limb2: 0x5409b6ac561a869e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x76cc9966a4b1b9cb377d66e0,
                        limb1: 0xe4f64d1b196805dc3138d43c,
                        limb2: 0x6050422b4b712f3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x784bdfce8976e0a02d2219fa,
                        limb1: 0x644c713f6f79277509e4821e,
                        limb2: 0x4d13655a2c6d5c1f,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xf875b534306df460ee0d985e,
                        limb1: 0x14bb5248b1bfeb4f33e44e64,
                        limb2: 0x1c0d4f3659c663ab,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd784a91a5e09d24e7c4a265c,
                        limb1: 0xffffffffffffffff7c074593,
                        limb2: 0x3fffffffffffffff,
                        limb3: 0x0
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xb2bd31cef772299e248100fb,
                        limb1: 0xe2e37ba99be92e642e4970b7,
                        limb2: 0x1d994c998fb6f912,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xaac470f3ab455f77b3d2d0af,
                        limb1: 0xfd469ccc88af74dc26fd80a4,
                        limb2: 0x6b961242bf1d75bb,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xc316db8f32ead8e5fa73e8c4,
                        limb1: 0xc7ac3cff14a66b146dbde807,
                        limb2: 0x7691cc9dfaeb0690,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x453c6d0f9cb833ca7695fc60,
                        limb1: 0xa9ddb9bec0dcec51b206c2d6,
                        limb2: 0x6c152397ed2af5f9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x96bfa7f73e741cfc4bab31d0,
                        limb1: 0x37ab0460cc1ba50393f29313,
                        limb2: 0x710785ba6f464b06,
                        limb3: 0x0
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x23cc11574d322656c47cee39,
                        limb1: 0xb5d617759a31e0feaec9c138,
                        limb2: 0x48f9c4b67a8eae9c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2c9ad04dcf9080fb918e5e0,
                        limb1: 0x208d8792ec75709d38203ad1,
                        limb2: 0x647646be18ad1460,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdb5bcdff18467c33beb22738,
                        limb1: 0x955ebf726cd5759ac3fe0c11,
                        limb2: 0x64c844f6ca0b7bc4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbf625cc6a3e40b2d1d3d1828,
                        limb1: 0x147b5cb6fd646c3a9a022714,
                        limb2: 0x7ae7f96d3570b7f9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xaac470f3ab455f77b3d2d0af,
                        limb1: 0xfd469ccc88af74dc26fd80a4,
                        limb2: 0x6b961242bf1d75bb,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x8dde75daee844ddb23d3eb28,
                limb1: 0x61f5b12591c14254255bb040,
                limb2: 0x3efc9a5fa9221231,
                limb3: 0x0
            },
            g_rhs_sqrt: array![
                u384 {
                    limb0: 0x38ac3353b681af9826a7847f,
                    limb1: 0x6bb03cf542cfa058b9510783,
                    limb2: 0x331271a539381b51,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8f9f3a51824594097ff66ee1,
                    limb1: 0x411288e0b33c3e518ba2c8b3,
                    limb2: 0x2980af51bc30759d,
                    limb3: 0x0
                }
            ]
                .span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x7238f02b9f20e09c2181a557,
                    limb1: 0x2cedcc5b0be371c337fd7e9e,
                    limb2: 0x41f3bbeb280fe8a2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf046f8cd6e5a75fca71dd19b,
                    limb1: 0x892b4613ef5c58df4ef692a4,
                    limb2: 0x7527fa36f5738847,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x82e4a33f8e4e5881e791d86b,
                    limb1: 0xbcb062435ae8ec5fdaeac4bf,
                    limb2: 0x179e1bae9e0f9f34,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x19657783ba5660e255c21849,
                    limb1: 0x7ed7474bcea7551fc71e46bc,
                    limb2: 0x596c0a76b75f4756,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0x12e0c8b2bad640fb19488dec4f65d4d9, high: 0xa90f9c3af19922ad9b8a714e61a441c
            },
            u256 {
                low: 0xeb2083e6ce164dba0ff18e0242af9fc3, high: 0x2fc154703983ca8ea7e9d498c778ea6
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 4
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xf7d884feff5aba51d9990dce,
                    limb1: 0x999f1d302046c6266257ff5,
                    limb2: 0x7f9caa5ee5815899,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x6d71279424538e87f8ecf2cc,
                    limb1: 0x8a8a1d74581da5996a52bbaf,
                    limb2: 0x29acff692eccea25,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_ED25519_4P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0x4294ed9005d37292f5249462,
                    limb1: 0xb9dea23ee010208506806803,
                    limb2: 0x16031442f6384311,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x7fa969c45724b811994c64c0,
                    limb1: 0xf428138bac627a290dd35105,
                    limb2: 0x3da98277c2dd5c48,
                    limb3: 0x0
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0x87cbb10853f51a0d7e8a9269,
                    limb1: 0xebcb43a99df5add16574dccf,
                    limb2: 0x1b8613d1c8f4df23,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x686cbe3acd25538efa3b9366,
                    limb1: 0xbe1fcf5f60e8d7d953189e25,
                    limb2: 0x4a1d28d3efde830a,
                    limb3: 0x0
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0xdb595542dfeb4f13942824b7,
                    limb1: 0xd68b7cd8156fbe5dd6a83d78,
                    limb2: 0x3060395777cff710,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xef83f2592b0828d47429e8b5,
                    limb1: 0x6af76f6b2e1231c02a5b3e78,
                    limb2: 0x4319a9f39260d0e7,
                    limb3: 0x0
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xc307bf571b4e6ce6bdcd1e02,
                        limb1: 0xf7f425fb7047f17544e695fb,
                        limb2: 0x3f886b1f487d5235,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5beb71743ece3b892b8e1c4a,
                        limb1: 0x1a5395d5c2f0bc3b5f8be5f4,
                        limb2: 0x1632f5895520fee4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7ea3928d140ad3c292615269,
                        limb1: 0xffffffffffffffff9abf1052,
                        limb2: 0x7fffffffffffffff,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x742fe36ea5fc6718f24a7f13,
                        limb1: 0x68c41299b6c2e8b9945c2c1f,
                        limb2: 0x4aaaeb7d35995db0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2385cacd7da51fcac1ee6822,
                        limb1: 0xba41ef29f92be3b87ff49eb5,
                        limb2: 0x75c63204fe4ed30d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x940340386d463d6d3b7bf8ab,
                        limb1: 0x97e68aa1d32a98a4580ef8f2,
                        limb2: 0x679d184ea7af0c19,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x8bf065ac34f5b5c837f9e992,
                        limb1: 0xfdb51c2c34128c5aea907150,
                        limb2: 0x3145a9e408755e1f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc86d0ed3f6b3053cf3bbd045,
                        limb1: 0x9ff9e8fd11d51d7a9085ba8,
                        limb2: 0x15e55197cd6b0315,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf65417ca98872bed2e5c62ab,
                        limb1: 0x26e3679ef2dd3528b9fa027f,
                        limb2: 0x2e2c31871aa5c24c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x35ba61f3f9a729a2e9de5e25,
                        limb1: 0xfc0e3b6c3577c12995eb99f3,
                        limb2: 0x1657af36c98825a1,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x7e8ed46ce9395439f2204e7c,
                        limb1: 0x2c9a681ec00b85f7aedcb31b,
                        limb2: 0x4bfe1ba067590c20,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x55462d10f9ec47835a88f374,
                        limb1: 0x933ec565a24a61b62b3fd0c2,
                        limb2: 0x3641aac3bff8ed7e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf73802077074a96e97b9a66b,
                        limb1: 0x45591685d213485a92a8578a,
                        limb2: 0x2d22ced3abdaeb3d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3bd5d7f95e250acdc3dd8a4b,
                        limb1: 0xf0a7694d2609436c939d9cc1,
                        limb2: 0x12d0c3083fbffe1b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x302af5c52a170159baaa7f62,
                        limb1: 0xebd9d0375aa7218eebad5512,
                        limb2: 0x5314ded8a40891f3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x940340386d463d6d3b7bf8ab,
                        limb1: 0x97e68aa1d32a98a4580ef8f2,
                        limb2: 0x679d184ea7af0c19,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x1951f4b86eea18d761f77c56,
                        limb1: 0x6e75f00205f7365d3a17975d,
                        limb2: 0x2d12bc1deb2f5526,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa040d07e3e7ec0e4e532e69b,
                        limb1: 0x82e78afaedf6af69a6e6f9e1,
                        limb2: 0x4b5cf8e006e1c231,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4fd6a65321df62683fb88b63,
                        limb1: 0x31788d0,
                        limb2: 0x4000000000000000,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x984a097aee1ac47434dc064a,
                        limb1: 0xa8996150c1aa128efdf2ee18,
                        limb2: 0x78fd5382ecb640af,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa01b3bdcb3d58b6ba9a959e6,
                        limb1: 0xe958f5593e7d7011e5c7c15a,
                        limb2: 0x24b897a5a05ea3b7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4ecc7cc01f2495f2b215faa4,
                        limb1: 0x65f9e93715450b57f91a8426,
                        limb2: 0x621a18bfd4f27007,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x21cb8d8672361d002ec936c8,
                        limb1: 0xebf3eadf7d25254307367c6c,
                        limb2: 0x27f020a3b881c455,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x26d7d2fba20f68c26bb463e8,
                        limb1: 0xeb7882ce7727fde3d5a18427,
                        limb2: 0x57efb7442374f4f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x637a17cf2eb4ed79b3577485,
                        limb1: 0xac9d0823ff6126501a3b6abb,
                        limb2: 0x9360baa0ef2e4d8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6a381be5ebdaec5327797e20,
                        limb1: 0xb8bd3c46987627a3d652f482,
                        limb2: 0xd41029afb8d39da,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x53f4b1f98e1c38bae061009,
                        limb1: 0xb1f63df1293720ed7bcf4f6b,
                        limb2: 0x20e8952eb5a877cb,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x29c44d569838ed5a56850f84,
                        limb1: 0x966b4be17054c664c283f3ab,
                        limb2: 0x5397afdbadc2b61e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x59b66507b60a3705ef6f60a5,
                        limb1: 0xfecafccdbbcccd50938d5a47,
                        limb2: 0x6bebc58474a0fe78,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x723789c592d26b74ac4354a4,
                        limb1: 0x34c24d4fd7d5d7e156862fb0,
                        limb2: 0x32ec1c5a4ebd80ac,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xacc066d460476cfaa2657126,
                        limb1: 0x1af0d6669ff8ade8518077b7,
                        limb2: 0x20744794618629e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4ecc7cc01f2495f2b215faa4,
                        limb1: 0x65f9e93715450b57f91a8426,
                        limb2: 0x621a18bfd4f27007,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x153cfc024d7f29d6d1a3d4a8,
                        limb1: 0xa5847be644a046e886f14a63,
                        limb2: 0x71ad2ee6fc91dc48,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd784a91a5e09d24e7c4a265c,
                        limb1: 0xffffffffffffffff7c074593,
                        limb2: 0x3fffffffffffffff,
                        limb3: 0x0
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x52ea69163c48df06093e80f,
                        limb1: 0xca205a065d1b50c7beb7c2c7,
                        limb2: 0x1772f2ba208a0515,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9cdaf9b4cc1f96deed4d48cd,
                        limb1: 0x3da93f7e4c9a93d0c3e2e5b7,
                        limb2: 0x3419b2d6bf3b29cb,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xf4214fe68008100fcbddf9fa,
                        limb1: 0x2fcad08b0ecdbbb9e29d0873,
                        limb2: 0x39eb42eba6665d6d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x57c23244e63bfc1fd28b349e,
                        limb1: 0x6f47a0b6c1d6dcd1cdc077aa,
                        limb2: 0x5a7be3a42b8d091f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd13fb1f0e272d5df8b0a2988,
                        limb1: 0x13e925bfac4aa6984a20a7b0,
                        limb2: 0x3dde5e327d00807d,
                        limb3: 0x0
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xf55f33bf84aac7f903274bb0,
                        limb1: 0xd4a905966dd91d942fb4d25e,
                        limb2: 0xb63422a03e37d4c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd66c5a6aa35de3418852d5f7,
                        limb1: 0x9bfbfd5df80e93ebdbb06b8c,
                        limb2: 0x576cd9e92d162b63,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbd4cbf283474236ff2366f2e,
                        limb1: 0x50b4ea027f6f0bf240a846ae,
                        limb2: 0x76a0a9d3be8b0499,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x11d3d18910366f7f594fff3c,
                        limb1: 0xfbb83b13be968e9e2a707924,
                        limb2: 0x74c19f8dc643c3fb,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9cdaf9b4cc1f96deed4d48cd,
                        limb1: 0x3da93f7e4c9a93d0c3e2e5b7,
                        limb2: 0x3419b2d6bf3b29cb,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0xf3cdcc2cf8e98e891b8df1f0,
                limb1: 0x76a1c463801af2c391cefa00,
                limb2: 0x1ab08f1129580430,
                limb3: 0x0
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x7238f02b9f20e09c2181a557,
                    limb1: 0x2cedcc5b0be371c337fd7e9e,
                    limb2: 0x41f3bbeb280fe8a2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf046f8cd6e5a75fca71dd19b,
                    limb1: 0x892b4613ef5c58df4ef692a4,
                    limb2: 0x7527fa36f5738847,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x82e4a33f8e4e5881e791d86b,
                    limb1: 0xbcb062435ae8ec5fdaeac4bf,
                    limb2: 0x179e1bae9e0f9f34,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x19657783ba5660e255c21849,
                    limb1: 0x7ed7474bcea7551fc71e46bc,
                    limb2: 0x596c0a76b75f4756,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xa6832ef7fe97f77de7cd9a62,
                    limb1: 0xf18a70dbf1dc5a76c685da4a,
                    limb2: 0x6ac1b7bfc409119f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x7751161b1a9ef600b865a5af,
                    limb1: 0xed28aad4835a39a9e8318ceb,
                    limb2: 0x572e95c429f0e07a,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0xeb2083e6ce164dba0ff18e0242af9fc3, high: 0x2fc154703983ca8ea7e9d498c778ea6
            },
            u256 {
                low: 0x101fbcccded733e8b421eaeb534097ca, high: 0x71832c59148624feac1c14f30e9c5cc
            },
            u256 {
                low: 0x247a8333f7b0b7d2cda8056c3d15eef7, high: 0x2eb3db872ae22448b0163c1cd9d2b7d
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 4
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xc90d60304c5ae1ed8e6a7452,
                    limb1: 0x9b1adf93edd9e9d89e46bb66,
                    limb2: 0x2354b27669ad10ec,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xaeb348edde7fa116aa741cc1,
                    limb1: 0x401b6f0f1099439b965ba00c,
                    limb2: 0x165e684174b4ed0b,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_ED25519_10P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0xc6a2dadd7bfa3f0e246e658b,
                    limb1: 0x35fef39b5deb611ff2012432,
                    limb2: 0x69111c4bba88905b,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf8f8b650214ea0042241e1af,
                    limb1: 0x9c0c86816e5b32d3958069ab,
                    limb2: 0x4f7c96eef9002e62,
                    limb3: 0x0
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0xfdd785e0b0c8c7cc6c9d28de,
                    limb1: 0x8122f1bdba903598618e0cc8,
                    limb2: 0x1cee60d8a8b3f4b1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x76aab4f568a16f049413f213,
                    limb1: 0x69ce55459d82821adb310e48,
                    limb2: 0x6491ade0e5fcad87,
                    limb3: 0x0
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0x7f4c4fae4ccc048a1ec31085,
                    limb1: 0xc699c0ce71f1b1891d539ca3,
                    limb2: 0x6cec90835491d044,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb956cd0696fbe12afef76c13,
                    limb1: 0x91ab61eaed3055a23afad034,
                    limb2: 0x24109e0f46a426c1,
                    limb3: 0x0
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x227c6e25297ca3819da464f1,
                        limb1: 0x571b21226157c006ab563ee3,
                        limb2: 0x504887f8395c09cf,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9250ed6bc8b378fbfac1897e,
                        limb1: 0xa85a8d9aa8006c0e380f2e82,
                        limb2: 0x79d378e80069e8dc,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x291bad70f4dcf5da1030c62a,
                        limb1: 0x94fd014fe61d8a79305576c0,
                        limb2: 0x403856574c6f6dd5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe64e8fd202989f848fe10dfc,
                        limb1: 0x5620dd7e2b37a6e8ee5882db,
                        limb2: 0x33e9d7aeac7a5ba0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa006b233f56f29917e01ed1f,
                        limb1: 0xab4652ce19dacaace6450042,
                        limb2: 0x13ff48db50f037fa,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4dda587ca11b2c2884f27577,
                        limb1: 0xd6fc1d52b40a3d2a504953f1,
                        limb2: 0x3a8272dcd2222f7a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x825c3855024edfce54b4f7cc,
                        limb1: 0xa1ae5583465b73129fdb41cb,
                        limb2: 0x6d636258088a8f4d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x671c8161232d0c902ddc84c9,
                        limb1: 0xd454ae8b7111191c35729c8b,
                        limb2: 0x6ee962acb1edc8d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2ad6d2d1562f684598e2df7f,
                        limb1: 0xffffffffffffffff47f9c934,
                        limb2: 0x3fffffffffffffff,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xeae53b5689b34217bac39f2b,
                        limb1: 0xc10c576f565e7d132685d600,
                        limb2: 0x7281e5b1ee7f7f1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xcdf3e1e15b5be2eb4a0f1b34,
                        limb1: 0x758995c461e112d20ce25ffb,
                        limb2: 0x6e8647e138c3a2a9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x28937aa2b174eadda504b8d0,
                        limb1: 0x9a65d524f5415c7413f378db,
                        limb2: 0x6d58c556393b49ec,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x76e838e534b43ff5dbe3b4c8,
                        limb1: 0xf2a76c2215ba5dec2438ee0,
                        limb2: 0x270bce0c4b679bc8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x30bf0b1098230932944eb1ea,
                        limb1: 0xa1fb746d2aeed2521210800c,
                        limb2: 0xdd1e3c4ead890a7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xad0051681836add0764b1b9b,
                        limb1: 0xb9f6eeb29bbf0d1b564141a9,
                        limb2: 0x587b7f413b8350e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x489b0ad19d42c3a85e16f14b,
                        limb1: 0xd8823d0d7e9014c3b3270de0,
                        limb2: 0x6644fafa45a8bc7b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xcdfdf91385ebd6e107424e01,
                        limb1: 0xe67f3d7a9de0119a0a2b773c,
                        limb2: 0x56436a4749bc3e76,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x78d0ee32a3a1f9a5d701b30a,
                        limb1: 0xd8ee9d420c80f0cfa1a69bd7,
                        limb2: 0x734918c74733471c,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xc937d95d8cadd3a5baea9f9,
                        limb1: 0xcdb3c920c8f99da81bc8c3bf,
                        limb2: 0x2d1a86c456c954c1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x807f12efd5a90792ff981d23,
                        limb1: 0x4105f51029a82d11b10da204,
                        limb2: 0x1b74df6945c86cbd,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1506bf95ed6bc60247131702,
                        limb1: 0x252488c487118904127bde,
                        limb2: 0x30de927219fd6952,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x958235eb16090c99f7d5ef0d,
                        limb1: 0x344e1f71130a560435008093,
                        limb2: 0x38cc6f1cfeae3986,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8294f5f287627c52819789b2,
                        limb1: 0x70ceb1275868863c4746185,
                        limb2: 0x362e3bb43a45def4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5d4bfc1af0c909365590a854,
                        limb1: 0xa3f621b7fe61804672886e3a,
                        limb2: 0x4bdb010f15f56d4c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x464631b9495eb1b784e07568,
                        limb1: 0x6026647c9dc37aefc084fc88,
                        limb2: 0x29295786a71c9ea0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf12a80d2c25386bc9de4ed59,
                        limb1: 0x6d0769ccf6553441fff1816f,
                        limb2: 0x2ca460cce5a35fc9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7cc151f33e67a5ae8d7df066,
                        limb1: 0x63ca426ba9e6b6e306f2cefe,
                        limb2: 0x5d77b1ee4b8273c7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4de68a885c9ec128cd0e3885,
                        limb1: 0x17befac077817b1c5362076a,
                        limb2: 0x3a2e856b253f3378,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x167495d51eacc22a55b3265d,
                        limb1: 0xc2f565c607cb484a7adcac47,
                        limb2: 0xf33ee4fc0751d38,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x45017625b2895c94dba6d988,
                        limb1: 0xfc53587b5a45a573d311e597,
                        limb2: 0x4c5b5e9090d29ab5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6fd3f14e6ce705ef59c9cbc1,
                        limb1: 0x3616f16dfdc4b355c4ca5f7f,
                        limb2: 0x4debe015f017603f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3464627b8f30a0b4400be7bc,
                        limb1: 0x222a61d5b96a9126cf17eaaf,
                        limb2: 0x36697db2eaff49e7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7aed5101d33b5afa812a43a,
                        limb1: 0x7cde898d03defd5ca6e1d7b1,
                        limb2: 0x771f4571a0832e72,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa359ebb450016c2a18a95f43,
                        limb1: 0xedd06403f1eb1821bea559f4,
                        limb2: 0x687652f8c1020398,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf523e3d1f8a6035e147bceb0,
                        limb1: 0xa421ea5bdb8eccd3960b9278,
                        limb2: 0x6f9ce5787512638,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x25d3c74588d707d5fb80eaa3,
                        limb1: 0x699362ab1cdd4c1082e13de,
                        limb2: 0x5e88901e999006f6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9a65cc55a934e93e7f308cfe,
                        limb1: 0xa5370e7c23d2951484e28b23,
                        limb2: 0x653634367a58a2f2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x163db6c37922f603c5a8953a,
                        limb1: 0xcb8ee64590dd3537075bfdac,
                        limb2: 0x5c4df3bee8de051,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdaa3240b325db86ffffe6541,
                        limb1: 0x18171e87ff5b4f7075e42d99,
                        limb2: 0x3392171aef75fd5d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x78d0ee32a3a1f9a5d701b30a,
                        limb1: 0xd8ee9d420c80f0cfa1a69bd7,
                        limb2: 0x734918c74733471c,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x59fee50dc97145c45d8f3ed3,
                        limb1: 0x6c776291ffe0ae1c72df8ace,
                        limb2: 0x267562c49576086e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x26d6aa5041b6f7359782e9e1,
                        limb1: 0x4619f6bd132c5aa7fa2f521,
                        limb2: 0x55286a6cb4c399d4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf9d39911578532cc840bcd96,
                        limb1: 0xbf61af4764523ceb685e0173,
                        limb2: 0x1985d443ace8e4e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x16301da5eb2b7fbfa847f5c1,
                        limb1: 0x716b7856ddd70396c8fcbc71,
                        limb2: 0x35fbb38603984916,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8389d33ab8abfd12a8d52c1b,
                        limb1: 0x41fe0638341e56e64c21cc20,
                        limb2: 0x92270366a6db6ec,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x25c689390740c6a97cf017ae,
                        limb1: 0x9c54b1556cc9858d3876541f,
                        limb2: 0x2e2c2fa65fe1be1a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xed59141e1fa0ed62190a8f89,
                        limb1: 0xc5fb16a4b1d95ca87c9b28d2,
                        limb2: 0x3dfde32439424864,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4b986ff1eab63af9eb019449,
                        limb1: 0xe23819083d8dac480525ef00,
                        limb2: 0x1ce2eba885e100d4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4a595795038c4668e348fa33,
                        limb1: 0x1566e794,
                        limb2: 0x4000000000000000,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xcf6f74d3362d0a2cc602fede,
                        limb1: 0xc36d61793f08aa2b3892a41,
                        limb2: 0xaeeb28d31724037,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe1358b64a35d0fac96d250cb,
                        limb1: 0x4c3eebf0819b46407826bd03,
                        limb2: 0x2621e16ebac44ec9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x577e07104fe6fea5e4354136,
                        limb1: 0x97c7fe2de83474aba1a69ed4,
                        limb2: 0x2c9e942f673fa067,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x84398ffc19c5c9203a2a2ddd,
                        limb1: 0xf17a493ab9525320b4e4021,
                        limb2: 0x6755065f1cd40a11,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6de5a993ad47a2757353e4bc,
                        limb1: 0xaa08cd6e30a482883f97a4cf,
                        limb2: 0x3362f8fb6ce50461,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x39a7cf83a16df9d8b0ad2d16,
                        limb1: 0xcd6ed73c6b2e832a7ebee841,
                        limb2: 0x5345a533032f7eb,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x91924908c1ae6da60ea22d10,
                        limb1: 0x4f3cab487c8bb36285aa7027,
                        limb2: 0x1538e3072d10373,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8b1eb430f25056ec3a038f57,
                        limb1: 0xcaab590877d219858f7721a2,
                        limb2: 0x11d8d66fc9ca4aa1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x419c432f6ed370e78ed2efca,
                        limb1: 0x8dca9f1fafdc1c573219b341,
                        limb2: 0x3f6bd43a5907e2c6,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xb12a5cd4a21798a423f1e0b7,
                        limb1: 0xdbcf95a539f4241281a18559,
                        limb2: 0x2987b917f883d528,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf8cd3d3c813624de9c8250db,
                        limb1: 0x1519deed44aac2e616c68228,
                        limb2: 0x608466e0954521af,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3279875f0378d928da80389c,
                        limb1: 0xc1221f86b74d1bc2d31d678e,
                        limb2: 0x372d2328dadb68d8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf6e2f137b7d5296bead7b706,
                        limb1: 0x20704995c9b09b9c93e493e3,
                        limb2: 0xa89d5269d9a6258,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x62e63cc6b59015f31be992b0,
                        limb1: 0x2f67943770e8b28fa4bd8358,
                        limb2: 0x53b55bd97eaa5f3f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x98fde822964ea5e8997c5df4,
                        limb1: 0xb00b139c18343fc57dccecc4,
                        limb2: 0x3bde86da5426045b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf89d2c8e46b0edf00711705,
                        limb1: 0x5a3e047b1f135502c39ae530,
                        limb2: 0x2577653f4b4047b8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf358e9e02cd3c52e50ad496d,
                        limb1: 0xb8352bdd43a93772cd21dd1a,
                        limb2: 0x7d373b64678d34c8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc1948bcf12577f079bf06a68,
                        limb1: 0x1806f09b85fa59c083d0b99d,
                        limb2: 0x443ce0054a7c9360,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2b69c91c593cef93dc0213cc,
                        limb1: 0xc53f1d8d98881e71bfca37d2,
                        limb2: 0xc02f7dd7d54284a,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xde14568d9f35c09f59110531,
                        limb1: 0xc66aef13a82b2d254dc961c4,
                        limb2: 0x282e9e52aa8dfacd,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x736c0a0aa805f9e07406beb1,
                        limb1: 0xe1b7698b472f67111701e311,
                        limb2: 0x25b230ad347b2f8e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8c8d0de4a12c74b90a1eeaf,
                        limb1: 0xabc2022d540416bbe66d42b6,
                        limb2: 0x387ebad8bc137122,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2f9d5c635ff0f00c65033970,
                        limb1: 0x11f9209639e1866299321d3b,
                        limb2: 0xc3ea1be18842370,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x96bd099bc616f227f07e4cf1,
                        limb1: 0xa3eded9f8e5c16df867bdb8,
                        limb2: 0x73b2ae14c785277a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa636fd3dba40ef91e7986138,
                        limb1: 0x4d48a1d0efa2e5f6d60e3496,
                        limb2: 0x4eb96afcbf30d471,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf96c1d20e791a99dd0a3ac92,
                        limb1: 0x929f94c68e66a8a314e715ca,
                        limb2: 0x5da321e882eeec48,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc16aadc0da26ed3c3e1f3b07,
                        limb1: 0x7f76e4c6acdc2a500d86a5fb,
                        limb2: 0x2ab55c8b30be3315,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfbd5f76b49635c7e03171bf0,
                        limb1: 0xd76650994509bc6202005464,
                        limb2: 0x734f31a27134222b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4030a64316d4dbfe5ce15e60,
                        limb1: 0x398d13f34885692777da4d9,
                        limb2: 0x52c35e89b7d4a667,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x97c3df289ec2387b32bfa684,
                        limb1: 0xfc433a15d94d575bfb2fd7ff,
                        limb2: 0x6f2783436f840987,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x419c432f6ed370e78ed2efca,
                        limb1: 0x8dca9f1fafdc1c573219b341,
                        limb2: 0x3f6bd43a5907e2c6,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x892d2011d819b87f4a62e6a0,
                        limb1: 0x8bd84cafbcb2fcbc91063a3c,
                        limb2: 0x50e7b809bee1e100,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd784a91a5e09d24e7c4a265c,
                        limb1: 0xffffffffffffffff7c074593,
                        limb2: 0x3fffffffffffffff,
                        limb3: 0x0
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xb6ab374e277db2494a3c0259,
                        limb1: 0xd31c988d353f3cf66f9f8c70,
                        limb2: 0x2264767fde620dd0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x82dc2a71026b33a9749fc677,
                        limb1: 0xb8434d73d37e18de811e5693,
                        limb2: 0x76250ea402ba3b09,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xf671178f2c9fc54371a4eed5,
                        limb1: 0x11d745bb6161eaec1270503,
                        limb2: 0x283ff4bcf9701b87,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf7c7e964ac9873e25c6fb22c,
                        limb1: 0x352e2614976b881cb97ffaae,
                        limb2: 0x1497c83b5a65540d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9e426d1aead7431d23eee210,
                        limb1: 0x7f82765c7cec109886e54027,
                        limb2: 0x2434bf678d677c93,
                        limb3: 0x0
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x476852eb8a78f382d3959644,
                        limb1: 0xa288d9ac309e22f45d29e6e8,
                        limb2: 0x62af8dda283600f8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xac4b66fff3ecf70f39fef4c1,
                        limb1: 0x9a8a4a418bb8eedc089e9d31,
                        limb2: 0x39f2216305163523,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x608bb8785e281ab8281a0dab,
                        limb1: 0x44b8f2ad5cceae658e3b053d,
                        limb2: 0x7bd370e2f3560949,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc3506245d3ef93d842f81986,
                        limb1: 0x4b4799a96ba7accdb5842cd,
                        limb2: 0x7fb32353841bccb7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x82dc2a71026b33a9749fc677,
                        limb1: 0xb8434d73d37e18de811e5693,
                        limb2: 0x76250ea402ba3b09,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x89c7b21c40cc88e188197953,
                limb1: 0xd6fc6c72e70a5dfe82fd85b5,
                limb2: 0x9f6c6fb4cffb0a2,
                limb3: 0x0
            },
            g_rhs_sqrt: array![
                u384 {
                    limb0: 0xd2ff7946e4787cf29c4e9729,
                    limb1: 0xfe72805311c0d94e6bc22d84,
                    limb2: 0x2e16c5afda2cc7c6,
                    limb3: 0x0
                }
            ]
                .span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x7238f02b9f20e09c2181a557,
                    limb1: 0x2cedcc5b0be371c337fd7e9e,
                    limb2: 0x41f3bbeb280fe8a2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf046f8cd6e5a75fca71dd19b,
                    limb1: 0x892b4613ef5c58df4ef692a4,
                    limb2: 0x7527fa36f5738847,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x82e4a33f8e4e5881e791d86b,
                    limb1: 0xbcb062435ae8ec5fdaeac4bf,
                    limb2: 0x179e1bae9e0f9f34,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x19657783ba5660e255c21849,
                    limb1: 0x7ed7474bcea7551fc71e46bc,
                    limb2: 0x596c0a76b75f4756,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xa6832ef7fe97f77de7cd9a62,
                    limb1: 0xf18a70dbf1dc5a76c685da4a,
                    limb2: 0x6ac1b7bfc409119f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x7751161b1a9ef600b865a5af,
                    limb1: 0xed28aad4835a39a9e8318ceb,
                    limb2: 0x572e95c429f0e07a,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x5e71d0fc5d1c016834779173,
                    limb1: 0xadd002dfc0ebf1b25c23c252,
                    limb2: 0x40a868d928ae5233,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x423fa293418d6e3f59c2e830,
                    limb1: 0x7a4bcf26f93e71ffd903e68e,
                    limb2: 0x7837b851ad8da6e3,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x5907087f8e8e4dacdd039371,
                    limb1: 0xc390e2073b4e64b9ede0570d,
                    limb2: 0x6b039a85962f1594,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc45eefa03155b8f7eb780b42,
                    limb1: 0x3db57eb22f9b0394a4d7b78e,
                    limb2: 0x6cf45b6d90883f60,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x60dd8ed0a614b596fb37eb1f,
                    limb1: 0xabb99f371be41e26ec2d8e4b,
                    limb2: 0x187ecd72c40f159d,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x7b66c9263de5e1663622985d,
                    limb1: 0x118b032cc27a1d6dd192eca6,
                    limb2: 0x312fb405788616e8,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xf4ac3e1f1f068dd64c86fdda,
                    limb1: 0x24594e591d82a7f964b5ec9f,
                    limb2: 0x6ca311b5421c57fc,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x42745cd7b146012455434d0f,
                    limb1: 0x6aa4f552b7bdc93a613bd9df,
                    limb2: 0x5832a065d7199c7a,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x341786b7854e3e0104e2e416,
                    limb1: 0xbb368441c295043bee7b1d2f,
                    limb2: 0x35c88542e11463b4,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x3c36e7fcc4e2fde28308132,
                    limb1: 0xf58043d0e3d1a36d1f8137fc,
                    limb2: 0x58c1508fbe8868a8,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x560a37951d69a6c8d7138239,
                    limb1: 0x462d454a509846714184ef71,
                    limb2: 0x3aaf8fb4f60e3e9c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb70cea4e13db5322899753f9,
                    limb1: 0x6c62656b6d7ffb5c2af44fd5,
                    limb2: 0x4b5ae4567dc6a7c0,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0x2f1205544a5308cc3dfabc08935ddd72, high: 0x10e1c2b2fcd81b5d24bace4307bf326
            },
            u256 {
                low: 0x2648ee38e07405eb215663abc1f254b8, high: 0x29164ebd7ab792809e469e6ec62b2c8
            },
            u256 {
                low: 0x85940927468ff53d864a7a50b48d73f1, high: 0x6e2edd0d977e9933c49d76fcfc6e625
            },
            u256 {
                low: 0xd344749096fd35d0adf20806e5214606, high: 0x8ce86e89466e4726b5f5241f323ca74
            },
            u256 {
                low: 0x30bcab0ed857010255d44936a1515607, high: 0x8ac57cfbb42e0b20426465e3e37952d
            },
            u256 {
                low: 0x5f3f563838701a14b490b6081dfc8352, high: 0xda2ddc3552116dd2ba4b180cb69ca38
            },
            u256 {
                low: 0xc87a746319c16a0d0febd845d0dfae43, high: 0x7003168b29a8b06daf66c5f2577bffa
            },
            u256 {
                low: 0x176ea1b164264cd51ea45cd69371a71f, high: 0x3b6a666fb0323a1d576d4155ec17dbe
            },
            u256 {
                low: 0x9edfa3da6cf55b158b53031d05d51433, high: 0x23d79a9428a1c22d5fdb76a19fbeb1d
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 4
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x953e7b69bc51afd0e8ee14e8,
                    limb1: 0x88f2a3f463abe0e4d99ed2b4,
                    limb2: 0x282277c34990a0db,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc4b37aaf5a797b777a89ebc3,
                    limb1: 0xec1836313170e0d9647efdf3,
                    limb2: 0x63f08f0867a4694d,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_ED25519_11P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0xf7f73668ed31827e6a25b1e8,
                    limb1: 0xa31457d7a2c542bbf3b3c13,
                    limb2: 0x7d799610c8f16ab4,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x6c03502900d94323a740e874,
                    limb1: 0xc399c691ef16e90aa7f2e45a,
                    limb2: 0x6c1d54069d32fa1e,
                    limb3: 0x0
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0x9f5046b366b4e82578ea7cfd,
                    limb1: 0x5657ceee8f185b72bd049708,
                    limb2: 0x53c3ed1e985a9f2a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf14204086006b6971e3d450,
                    limb1: 0x8c84b71627d8b4bd5d0713cc,
                    limb2: 0x13f218899f7041e4,
                    limb3: 0x0
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0x25b995ad06874ea339c7afd3,
                    limb1: 0x68f3a5868e23705dbaa50f78,
                    limb2: 0x2a0c6e906ba7ad96,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x1135152280c1d9643c6ae557,
                    limb1: 0xf2529e96d78f463c1cf0d966,
                    limb2: 0x6b61d89001e0d390,
                    limb3: 0x0
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xdadddc16a44369ff41dbc60b,
                        limb1: 0x512def54926da5aa2d18ed85,
                        limb2: 0x12c9232965a48b69,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfffef82f6b86f062107bb8e8,
                        limb1: 0x9437bbb07ad3e326a4a265e4,
                        limb2: 0x5f66a83f375f8ed7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x139906dbec5b12ea281e61de,
                        limb1: 0x1b283b48d2873f5d346b0b61,
                        limb2: 0x576e5aab9546a593,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x60ee25b955a7ad25f1fd29c9,
                        limb1: 0x166bbeb3d716aa7b0054d128,
                        limb2: 0x1d843ffed2981e24,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6ab1429f90d6c73d5feec03e,
                        limb1: 0x2294009f175f67b102d6cd9a,
                        limb2: 0x3a54584178fb0b9b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x506a98d7da7122177618f274,
                        limb1: 0x998a4bef7ac5866d7e79674,
                        limb2: 0x9cb3b5a371be916,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8a29ba2e2252c6619b92fd36,
                        limb1: 0xc4552f025624e43ab034fbec,
                        limb2: 0x69c0145245b52166,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa3992edce127cf1acfea9bd4,
                        limb1: 0xd1752ad492690fadeac9a419,
                        limb2: 0x72fa4447c24461b8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x125a5980617f7ee39245419b,
                        limb1: 0x74b0a1be7a2caf7658ed8e36,
                        limb2: 0x140db41514d8bf01,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xee41e073e880838ff4e4ddb7,
                        limb1: 0xffffffffffffffffa576dd97,
                        limb2: 0x3fffffffffffffff,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xd295f2c630cb7e2c97aa5db5,
                        limb1: 0x6ef3b2bbf45d45f97a1c8d6c,
                        limb2: 0x38bb79c32bf6db88,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x773c1386069c56925a67dd7e,
                        limb1: 0x83fd3d25d9eeef1e18c9a772,
                        limb2: 0x37c87b5243e6ba92,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc9b3a0bb0885c23c9b919de6,
                        limb1: 0xc2c4f53f0974381eff065f63,
                        limb2: 0x7993b80125e63baa,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa893912e6ca5d31fd2e45524,
                        limb1: 0x9a0f5ba6d7827f95ec4469ac,
                        limb2: 0x7046ab2d32babc9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4f6d38a7efcacd992317463a,
                        limb1: 0x6fe3b81b093f8acbd2e591b,
                        limb2: 0xddaa4dbdd33f142,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x402e2c26b6a1e116bcbc17f9,
                        limb1: 0xfe1d0acccc1a9fa78d04ea61,
                        limb2: 0x28114f0b1f72ecd3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfd02f0029d80c82273bd4a13,
                        limb1: 0xc96db153a205b733e523e1c9,
                        limb2: 0x3386c27668f5c25a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3a783ad1d76f5f128c764c87,
                        limb1: 0xb2abe7de119bdcd37efa3d6b,
                        limb2: 0x4f62279f1c3d5bd5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4a2756d241f4702735e4d897,
                        limb1: 0xe8706f27de3bb0aa26fec3ed,
                        limb2: 0x30e3c2c0d398abd3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x970fc5f27e44e11df1f7e43d,
                        limb1: 0x36bacf37d6079c6ccd65b66f,
                        limb2: 0x1c0f56bb5c820c18,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x2f95e19fb0bf609faabd391f,
                        limb1: 0x67251db0061cc37a32cabebd,
                        limb2: 0x70b9538fda576670,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9c073dfd61fcdf7d67a2c167,
                        limb1: 0xbee1b6a72efec939c654846,
                        limb2: 0x522c14350326987a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdfebe36f7ae45881818cd4cc,
                        limb1: 0x5e4e5b22dc520048203f5ade,
                        limb2: 0x757ff9984cf3723d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x85b26c31620799baf9c82e6d,
                        limb1: 0x293cf2f64d0e28541ffa7627,
                        limb2: 0x2c9a15b6f9b76e54,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x80f0dbbd91562a985c06748f,
                        limb1: 0x2a141f7c616c57a80c56f276,
                        limb2: 0x1a71289ca15e3818,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x28bd5d0ab302915700a243b,
                        limb1: 0x67d916182ab604ddb32d2724,
                        limb2: 0x8d8c37e9a8206d7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x76c5672b8b4d701fd3dd1ff0,
                        limb1: 0xb0b5f8df87d28ed5edec04ae,
                        limb2: 0x3bcece5d52b3ff85,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc0f097c47d3c78948776540b,
                        limb1: 0x523bdf89c1541dc77339381,
                        limb2: 0x36e007b7aa6c9c58,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb56aaf3cb7f439e03bafe56f,
                        limb1: 0x22ca46333af83960527dc434,
                        limb2: 0x34de52f2e417908,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x634dd86775c45c225f1ff20a,
                        limb1: 0xc2757749edb7339e59c8138e,
                        limb2: 0x27b52262ed81e312,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7513d3f1180c088453472689,
                        limb1: 0xf5d7733a2199f02b1469e30d,
                        limb2: 0x4f9d349ded23052a,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xa8d7540aaa5469a81449fcab,
                        limb1: 0x3f97ce4b70c01d1edde0a34a,
                        limb2: 0x316dac7b262d923c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x392e456e8433df7911f69724,
                        limb1: 0xce70f217c8dda1f7da755eb0,
                        limb2: 0x31c0349d06a031bf,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x28ff4b448c3fb09c92d8eb6f,
                        limb1: 0x5d9da4e2cf2e70c7be27f4dd,
                        limb2: 0xf8936f00faa10a5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3a7aaa4c6fa2c28cd9375cd8,
                        limb1: 0x219508c636c65cf9ae7fb9af,
                        limb2: 0x4c72b70c3b7d214e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xae7ad5b72a492e34856d5ef2,
                        limb1: 0xeba953f3e3fbe578bdd56d17,
                        limb2: 0x1ef58fe208474c8e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6fb3cf83aaaeaa2fce5736e1,
                        limb1: 0x8965dab9fb83f1f1fc0c6e5d,
                        limb2: 0x275a4a12f6901796,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1709aca2b543bd733598d8e8,
                        limb1: 0xb9badd545ec19569d9ca1c90,
                        limb2: 0x1ac9bbe0238b65b5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdc3c836244a2586ee5ab19d,
                        limb1: 0x367052b0bbb9457327d06fd9,
                        limb2: 0x64dda8501ec679ed,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb364ffa83f8c5677f839112c,
                        limb1: 0xe44e100b863932786bd5236,
                        limb2: 0x43db3e973506b4e7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xac5928b7bc9e13dc60bca79f,
                        limb1: 0x896d2c55392e3989dada62ed,
                        limb2: 0x334403ae73cce09c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x97ef479bcda982fb96cb55a2,
                        limb1: 0x8f4b976ebaf04f0450f9be64,
                        limb2: 0x307061ae0b61d18d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x56cc81c9ee6651b62ea0efd7,
                        limb1: 0x1a0850353fb6ee8092b77a4a,
                        limb2: 0xe326f9479526aba,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x970fc5f27e44e11df1f7e43d,
                        limb1: 0x36bacf37d6079c6ccd65b66f,
                        limb2: 0x1c0f56bb5c820c18,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x6d7452347d75340b10b84889,
                        limb1: 0xbe1cbb263ca91dc1ae24fd24,
                        limb2: 0x6346fdf2fe1771bb,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7eab65364edee845b4b9e0de,
                        limb1: 0x2c37591693a43b7044cfa00f,
                        limb2: 0x568f817bf41c8bc4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd7861e1d628042c71c972ef2,
                        limb1: 0x470c93fdb32a001a3a36a82f,
                        limb2: 0x1798f6acf82b1bad,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf71945f9e97faee055f3965a,
                        limb1: 0xc5b8a2b79a7d86a09cfbfa09,
                        limb2: 0x4c80298e3bd4c539,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe6b3b3e188eea2ef16ce7558,
                        limb1: 0x360f720306af1104c97d4660,
                        limb2: 0x6d3c43567a8921ae,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb7be2d0bd693e5bb81246bcc,
                        limb1: 0x7270b812dd1a264dfba765a5,
                        limb2: 0x525250c727d21e5f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa5743d214921869e9a3f069d,
                        limb1: 0xe678391136e2a8338506a6b6,
                        limb2: 0x7ad650dace045fdb,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5d958d034a03ac9067e1396d,
                        limb1: 0x65deac7c07a993927b287a48,
                        limb2: 0x4fddb19f679380d2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x481359fcb6e62409bbb5bac8,
                        limb1: 0xaa766bddaec789723e802481,
                        limb2: 0x12dad3eb394b282a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf981b568a165da3fce3f46df, limb1: 0x13bf5c44, limb2: 0x0, limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x281b849d6b5ae936fa787cda,
                        limb1: 0x55003f62e1ea6751f315449,
                        limb2: 0x3c7bb17d60701e74,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe9324f8e7ba82e65ef06a27d,
                        limb1: 0x46e0104055bddafd2810a8ef,
                        limb2: 0x87140322f072bf7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x16e43e9868885b29f016a816,
                        limb1: 0x5fb19bd7054b8177f7d3c978,
                        limb2: 0x1141d1e19d26996e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbf7f2e6d55409f7177d83fe5,
                        limb1: 0x87c0e434ea70a1c989121bcc,
                        limb2: 0x189ba44dae4a0043,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3933a166c9494df19ff32aa2,
                        limb1: 0x672b9c16da6ef3dc8d7f08ca,
                        limb2: 0x1f6ed6b0096bc2dd,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xaf51cda3490954f61f5b6646,
                        limb1: 0x540039240f8feb4893f3a2c0,
                        limb2: 0x4bcddaf72365bea3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd19ec8d6212f550882230794,
                        limb1: 0x24aaee5534eb705a08916b6,
                        limb2: 0x3d9bad35acddba4f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x475dab4a81121738f66fd14e,
                        limb1: 0xb3282e80aaff11c50dacd6b6,
                        limb2: 0x5d0171001ef8f4ea,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xddb0842b13a44084c57b9e94,
                        limb1: 0xc6b6e36f7b2160094461e8a0,
                        limb2: 0x7aa22ca83fefc6bc,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xefb6b5a804c17b76e3331928,
                        limb1: 0xea9445c6c11b9525cf9c5b7a,
                        limb2: 0x45c4ffad8d18d7a1,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xce16977fbf4d8b2510205b2a,
                        limb1: 0x3e13232cb3f6371f81443a3e,
                        limb2: 0x21721b3742970df1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xee3489e01430a97b738b8a3b,
                        limb1: 0xda9fd266a4a2c946f78692be,
                        limb2: 0x258ba3101aa452e2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x47cbadf740af29cf9eb75926,
                        limb1: 0xb4b32fdb0ce7f05cb0ce205a,
                        limb2: 0x7160eadd0c55993e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdb780c236e85c8896e79cc82,
                        limb1: 0x370d3ea9527a0d640ecfe591,
                        limb2: 0x6a494cd4bbc93450,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x11ea2c62e85ecf4cd33694de,
                        limb1: 0xaea78a9f55b777ec83085853,
                        limb2: 0x4b3fd45d70d8945e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x267469c019ca327f24278760,
                        limb1: 0x8b1d447fcc32d31fba45683e,
                        limb2: 0x37cb05813304ecc8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfad58ec5aebc699ed439af16,
                        limb1: 0x157dbc53728a709ec9804eca,
                        limb2: 0x29de895f3ed8f018,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x120718926cf41aec52a70063,
                        limb1: 0xc012755c2144e5e9fa91269,
                        limb2: 0x4eae075b3d3299d1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5e131987d809c3ae50875f2d,
                        limb1: 0x2dd4fe4c1897b2ebe22fd40e,
                        limb2: 0x3fd00551d73725c6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1f8b253562ddb3dc71609801,
                        limb1: 0x847f331536a5d8d1abf276ef,
                        limb2: 0x5a355c8658ac88cd,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe0f111570919a2d422fece0f,
                        limb1: 0xd9237d912399108827e815ef,
                        limb2: 0x18b36c4907836000,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x282f51d0fa327f6467e58a69,
                        limb1: 0x6c5d3fe8dee398118652caa1,
                        limb2: 0x49388ffe64f7d48f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3c2506f3433db0cdecf398af,
                        limb1: 0xbbfec42b01d76341bb67baca,
                        limb2: 0x7dd73cce32328bab,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb519ce37fcf8f06b50220b9a,
                        limb1: 0xe676b20b497708256c9af8f7,
                        limb2: 0xb6eaccaea26c6fb,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x33530228f9de878ab4b3b382,
                        limb1: 0x65f576391c06b068eef05062,
                        limb2: 0x1427e4e4e953f944,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x87de0c173eb0f780ac86c511,
                        limb1: 0x77fdeecf42d5d212a47a4cbf,
                        limb2: 0x27bea95c365c3238,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x941b07d0db295f9d3c2bb9c0,
                        limb1: 0xe639625e385344f21673e342,
                        limb2: 0x6b136c36b20422df,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2c5765fd290736b2abd3f181,
                        limb1: 0x5bfb644fb8ab62dd933cdfbe,
                        limb2: 0x2572fe2f15a056ef,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb949e70a7e498f929287ef88,
                        limb1: 0x1f87f426b7694738c5100e9f,
                        limb2: 0x3d29809e02befcb1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdfedd88583b482434957c2ad,
                        limb1: 0x9778f60e0d93bc43ac709008,
                        limb2: 0x6496712987579569,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xac20967d54ba005249856b10,
                        limb1: 0x9d0d31f5a2be3a6d4311ad08,
                        limb2: 0x4495ac047a165f73,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6f82a3a67da1b7e6828f4fdf,
                        limb1: 0xddad17b67fecf0de8c08ef10,
                        limb2: 0x4e90dd3ac9a71c64,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xea55af22c0162213be37b5d4,
                        limb1: 0xf84ec47cdc9c9ddfb01a9efd,
                        limb2: 0x57f0d97be5a985a2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xefb6b5a804c17b76e3331928,
                        limb1: 0xea9445c6c11b9525cf9c5b7a,
                        limb2: 0x45c4ffad8d18d7a1,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xb3556e8b325bcba83491750f,
                        limb1: 0x20b413c28750bc90e2cea54b,
                        limb2: 0x48ddbddb9d00f1e6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd784a91a5e09d24e7c4a265c,
                        limb1: 0xffffffffffffffff7c074593,
                        limb2: 0x3fffffffffffffff,
                        limb3: 0x0
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x40b0711334b3c9868b4599a6,
                        limb1: 0xaa0d48f3581550410fdbded0,
                        limb2: 0x62ce0aeaca06fd57,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3af6239f92c3c9374d4dd31d,
                        limb1: 0x40b48b8ae2c4342f8856597f,
                        limb2: 0x22fa450fbfdb33f,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x5ca52eeaa24e14f348d9c520,
                        limb1: 0xe52e4c8a649876ca986bc47c,
                        limb2: 0x67b984afde522ce1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x10ded84279ea38cde4e91b71,
                        limb1: 0x68737e427f15a10a1fb4c1bb,
                        limb2: 0x6edfe0985e380a70,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4ba439fb641b44795a0e766d,
                        limb1: 0xe6cf0b002c84a2915ae89e7e,
                        limb2: 0x3966621425eebedf,
                        limb3: 0x0
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xa2fabbb2d54595adcebbac83,
                        limb1: 0x9558ada9a84bbc0edb300a87,
                        limb2: 0x3d736d1bdbb5741d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x92ed6fee18a648d0812d7ad8,
                        limb1: 0x2e340faa337865a59548719c,
                        limb2: 0x3d316710005b65d9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x49d4bddbcc6570bdeabe8a26,
                        limb1: 0xf36ddee75164dbb5dd3cf07d,
                        limb2: 0x5c5a8e2cd2d30c07,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4d559c0ae125ab158401b0e6,
                        limb1: 0xdba52a00b9908e177b94952d,
                        limb2: 0x401cb7be6fc0bc3d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3af6239f92c3c9374d4dd31d,
                        limb1: 0x40b48b8ae2c4342f8856597f,
                        limb2: 0x22fa450fbfdb33f,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0xe8ace386fe3ea98e63f61ccc,
                limb1: 0xdd024595a0f790ac70aafef1,
                limb2: 0x1a35e333bc24f91c,
                limb3: 0x0
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x7238f02b9f20e09c2181a557,
                    limb1: 0x2cedcc5b0be371c337fd7e9e,
                    limb2: 0x41f3bbeb280fe8a2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf046f8cd6e5a75fca71dd19b,
                    limb1: 0x892b4613ef5c58df4ef692a4,
                    limb2: 0x7527fa36f5738847,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x82e4a33f8e4e5881e791d86b,
                    limb1: 0xbcb062435ae8ec5fdaeac4bf,
                    limb2: 0x179e1bae9e0f9f34,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x19657783ba5660e255c21849,
                    limb1: 0x7ed7474bcea7551fc71e46bc,
                    limb2: 0x596c0a76b75f4756,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xa6832ef7fe97f77de7cd9a62,
                    limb1: 0xf18a70dbf1dc5a76c685da4a,
                    limb2: 0x6ac1b7bfc409119f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x7751161b1a9ef600b865a5af,
                    limb1: 0xed28aad4835a39a9e8318ceb,
                    limb2: 0x572e95c429f0e07a,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x5e71d0fc5d1c016834779173,
                    limb1: 0xadd002dfc0ebf1b25c23c252,
                    limb2: 0x40a868d928ae5233,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x423fa293418d6e3f59c2e830,
                    limb1: 0x7a4bcf26f93e71ffd903e68e,
                    limb2: 0x7837b851ad8da6e3,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x5907087f8e8e4dacdd039371,
                    limb1: 0xc390e2073b4e64b9ede0570d,
                    limb2: 0x6b039a85962f1594,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc45eefa03155b8f7eb780b42,
                    limb1: 0x3db57eb22f9b0394a4d7b78e,
                    limb2: 0x6cf45b6d90883f60,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x60dd8ed0a614b596fb37eb1f,
                    limb1: 0xabb99f371be41e26ec2d8e4b,
                    limb2: 0x187ecd72c40f159d,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x7b66c9263de5e1663622985d,
                    limb1: 0x118b032cc27a1d6dd192eca6,
                    limb2: 0x312fb405788616e8,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xf4ac3e1f1f068dd64c86fdda,
                    limb1: 0x24594e591d82a7f964b5ec9f,
                    limb2: 0x6ca311b5421c57fc,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x42745cd7b146012455434d0f,
                    limb1: 0x6aa4f552b7bdc93a613bd9df,
                    limb2: 0x5832a065d7199c7a,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x341786b7854e3e0104e2e416,
                    limb1: 0xbb368441c295043bee7b1d2f,
                    limb2: 0x35c88542e11463b4,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x3c36e7fcc4e2fde28308132,
                    limb1: 0xf58043d0e3d1a36d1f8137fc,
                    limb2: 0x58c1508fbe8868a8,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x560a37951d69a6c8d7138239,
                    limb1: 0x462d454a509846714184ef71,
                    limb2: 0x3aaf8fb4f60e3e9c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb70cea4e13db5322899753f9,
                    limb1: 0x6c62656b6d7ffb5c2af44fd5,
                    limb2: 0x4b5ae4567dc6a7c0,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xb06cccb4b425d5179f528270,
                    limb1: 0xce017c281a3861570706cd86,
                    limb2: 0x42d14846dc4860ab,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x646bf486f6e77663c597ece8,
                    limb1: 0xd87c8c36a430a6fe42305b88,
                    limb2: 0x7964c7742b6f13da,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0x2648ee38e07405eb215663abc1f254b8, high: 0x29164ebd7ab792809e469e6ec62b2c8
            },
            u256 {
                low: 0x85940927468ff53d864a7a50b48d73f1, high: 0x6e2edd0d977e9933c49d76fcfc6e625
            },
            u256 {
                low: 0xd344749096fd35d0adf20806e5214606, high: 0x8ce86e89466e4726b5f5241f323ca74
            },
            u256 {
                low: 0x30bcab0ed857010255d44936a1515607, high: 0x8ac57cfbb42e0b20426465e3e37952d
            },
            u256 {
                low: 0x5f3f563838701a14b490b6081dfc8352, high: 0xda2ddc3552116dd2ba4b180cb69ca38
            },
            u256 {
                low: 0xc87a746319c16a0d0febd845d0dfae43, high: 0x7003168b29a8b06daf66c5f2577bffa
            },
            u256 {
                low: 0x176ea1b164264cd51ea45cd69371a71f, high: 0x3b6a666fb0323a1d576d4155ec17dbe
            },
            u256 {
                low: 0x9edfa3da6cf55b158b53031d05d51433, high: 0x23d79a9428a1c22d5fdb76a19fbeb1d
            },
            u256 {
                low: 0x4d125e7fa59cec98126cbc8f38884479, high: 0x1f40f472e2950656fa231e959acdd98
            },
            u256 {
                low: 0x98b33c6e0a14b90a7795e98680ee526e, high: 0xc8555a9fcfcfa81b306d70019d5f970
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 4
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x9689eff36e40c5d4f7aa9e26,
                    limb1: 0x4fca2ba1936adf005148db8e,
                    limb2: 0x61682ebc3050d122,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x8c505d80ce528ebd36300c7b,
                    limb1: 0xad9bf81c921211418dd07111,
                    limb2: 0x228d83528b2b7ad0,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_ED25519_12P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0x12d1b444ec39ae839807573c,
                    limb1: 0x50cb70680dcb8804e2a1c6cb,
                    limb2: 0x5d529b896d65150a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf0fbd5d96b7a64beee6206b7,
                    limb1: 0x6982ef15e68d6f6c204de74a,
                    limb2: 0x12537fc27fadb2bf,
                    limb3: 0x0
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0x5a69deb6f89b3673b868547b,
                    limb1: 0x4bff35db66fccba1976a7225,
                    limb2: 0x77f294fd97e3f80d,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x9d0b7c8c5ae15973adfe68fd,
                    limb1: 0xdcfad41176059fc275b3c281,
                    limb2: 0x56e82a35fc7cab60,
                    limb3: 0x0
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0x9e594e333ff5e969a7e67fe2,
                    limb1: 0x6f1c567b169fb2641e9523af,
                    limb2: 0x5f281f6b0b94ae25,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xfcf298a0835b6605577aba8d,
                    limb1: 0xcbc74b0c4dd9416799ec7c87,
                    limb2: 0x2bc94fc7f719122c,
                    limb3: 0x0
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xdb44e4d5d39e5b445fd461cd,
                        limb1: 0x5de76996b6025fbbb5cb57b,
                        limb2: 0x16cd6688877abc88,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x35971a35f5985164f7bb1fec,
                        limb1: 0x7495a32a8afec0a9ddf3c128,
                        limb2: 0x2478ea95fce07ee2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x40a90497e19d5777a45457a7,
                        limb1: 0x4b0ef5a2d7c33a6a9564018b,
                        limb2: 0x2791cfb0b48683e0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3ca5bf1da07f04bcaac55a41,
                        limb1: 0x3969c32ff4aecc516da66441,
                        limb2: 0x4c4c8e919901cae8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x940b6df952ba977fcd0eec41,
                        limb1: 0x484764488eac704c20aa8b90,
                        limb2: 0x1374bddd4c669814,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3d167b842edfc1f9810c5ba,
                        limb1: 0x4e7272f688ddc0b9a0aa8e31,
                        limb2: 0x67385e6205d26e96,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb364f4bfac648412726f9278,
                        limb1: 0xcf5c58ab88c40cfda7008063,
                        limb2: 0x11a606b808172898,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4ba33ce17650ebfc04e2bee9,
                        limb1: 0xd0c8493b971a5a0b8503b1ce,
                        limb2: 0x784a3b72924bc7f2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbc8d5443c3ddd12c47dc8589,
                        limb1: 0xf5e5481ec85c0703a5b0967a,
                        limb2: 0x43227df665e43653,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x983f456d4beea2bcffaf4f0f,
                        limb1: 0xd74e6c3348fcdac2b6a63053,
                        limb2: 0x1a202b1f3fbc347a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x553c93aa10d8d0c2a8db9626,
                        limb1: 0xffffffffffffffff71963fab,
                        limb2: 0x7fffffffffffffff,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x25b10eb6ec116f6b3b17dde5,
                        limb1: 0x1df3aa520847b39ee191b363,
                        limb2: 0x3f195c6d1aaa8987,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb95f60050dd136130e5a4ee4,
                        limb1: 0xeaa6e9d0efddbc65d61247f7,
                        limb2: 0x768030bca15a666b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc772b6dc53990a4937b654f0,
                        limb1: 0x54ef97c07cea208239fa5dad,
                        limb2: 0x270261942563a73,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2119c826f0c445ae91c2c91e,
                        limb1: 0x29c88debd390eddeca0f9403,
                        limb2: 0x4657be6ee5f550c1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x80b4518376e20ef05e9c682a,
                        limb1: 0x1452591ae3c8749ab97eb5f3,
                        limb2: 0x20b26b915ff65dfe,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe41a24a56d81b4fc7ade087,
                        limb1: 0x1b00a518b4b0c73a91a73055,
                        limb2: 0x4f7e02deb39ad167,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x94fa64f00e1b8546c3c1946b,
                        limb1: 0x4fd5c3a628f89b0dd08476a,
                        limb2: 0x7d232e0e1d9587c8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd1fbbbd833aebeb812de048a,
                        limb1: 0xee80e4a9cf8cfdd8116f491d,
                        limb2: 0x49359c7ad7a5438c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x941082b0c5a458c4b05ff101,
                        limb1: 0x85f549ed9f8cfd4ca12ccffa,
                        limb2: 0x1a9d04f8d06b9165,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd0cc426303f89577717267c5,
                        limb1: 0xa292e0a655c7a1b7ad8524a,
                        limb2: 0x1a37757b7186a962,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2970c0750616ebf58e83de77,
                        limb1: 0xdd0b47488b254688003a4e87,
                        limb2: 0x2b2f890fcf29416a,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xabc92f01e698d284665f91f4,
                        limb1: 0xe3e269f37e33c385a1823a1f,
                        limb2: 0x2ff379ce980ddee2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xde7d16c79c9691830d5e7850,
                        limb1: 0xbf31755cf2df1d4d5570e36,
                        limb2: 0x708d0b996083e242,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb83cf02a303d184135d8df6f,
                        limb1: 0xc6f7e0fb8ceef48147dbe92b,
                        limb2: 0x463c937a63c3029f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdeaa6fb072e91d32f7855129,
                        limb1: 0xc9cc8b7f4a9ec04e9d8eee9c,
                        limb2: 0x73ff694d61d81e5b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x97f1d0f288df90bdae0fafcf,
                        limb1: 0xb93021dfdfb29110b23deff9,
                        limb2: 0x5615b78cb49ecab6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9e16bce6faa8b8a4d67fc604,
                        limb1: 0xbf2670ae2c775ccb2cdc0ec0,
                        limb2: 0x3b176ae13263e5e9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbb808385758f7c64f1c6edab,
                        limb1: 0xf6f328dae073fa5bbab8523f,
                        limb2: 0x6389ee27802ddda1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x647acc4fcf25308ecd66202e,
                        limb1: 0x5baacfc90e2278f0661f8730,
                        limb2: 0x1e2d1f54917b0650,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd868b39bdd3d898368357a63,
                        limb1: 0xb356686da6cf9512439c0ee8,
                        limb2: 0x248ca4eb16f06e7a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbe9c3f38ed44c93f0ad5b8b9,
                        limb1: 0x5a059ac65aa31c1aef588a8a,
                        limb2: 0x3ea9c980cf2f76b5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x758defcb11d9b358981bf023,
                        limb1: 0x410bef2c30189706daefabfc,
                        limb2: 0x6a1f466263c41c27,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x24ac099c781a4f817a931137,
                        limb1: 0x37190532f3e54f2fb26a5a2,
                        limb2: 0x479bb748998a32ff,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x5bf741ccaf24c0d5ca7ba758,
                        limb1: 0x79362ac8e5b6b83adba1c963,
                        limb2: 0x323212bf74cd0fec,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfafa7d8fd48650b5a5eb46ad,
                        limb1: 0xbea8660ed84931d5ad2c33e8,
                        limb2: 0x52e64034cfe719a3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x14cf5440d577a9e6e03c4c12,
                        limb1: 0xc93a80f2cf907a21df1578a5,
                        limb2: 0x55ac51dc45727977,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x695d52f129673ab43e9e4159,
                        limb1: 0xf45510d443f991e40a1ebd4,
                        limb2: 0x560cf07cc38f881a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe1cdff59d458b7f938d64240,
                        limb1: 0x5497430c3e9c36c2a7146b9,
                        limb2: 0x1f4db48a0d6cf3b0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x45afd9d15360d2a97acf8804,
                        limb1: 0xd99e7f7d812632bfea922c5d,
                        limb2: 0x7eb4b3c8efe3787b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x83d63929850b1c64291cc07f,
                        limb1: 0x3718ff66d8c9ce41fb1a1837,
                        limb2: 0x709937b8f73f9ba,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf5c5bbe50228077178dd6e17,
                        limb1: 0x15f81ada464e341d22902b4c,
                        limb2: 0x10d8e606c53130a2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x205b3cdc823753f7101a681d,
                        limb1: 0xd42222d31a190f7fed4d4fdf,
                        limb2: 0x5b2e2001fafcedc4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4288d160040927e8a2c3f91b,
                        limb1: 0x4b55e49a75ebb3e07954e48f,
                        limb2: 0x24256ebb54e3afe0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2dc343e58459d9924722f337,
                        limb1: 0xce98274a0dadd57523f27fab,
                        limb2: 0x75dc49a3e486ff68,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x72e26997ee1764d693fb3965,
                        limb1: 0xb3209a776fa2839878037733,
                        limb2: 0x47d7d1f5955b49e6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdd716d5ab06a77066a2e7ef2,
                        limb1: 0x3bc10f17c6d7b7f1e69108a7,
                        limb2: 0x7786224f17406848,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2970c0750616ebf58e83de77,
                        limb1: 0xdd0b47488b254688003a4e87,
                        limb2: 0x2b2f890fcf29416a,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xd4932627f99e857faad37206,
                        limb1: 0xd9cf43a1447d9ed5a009ca4,
                        limb2: 0x67e5a311743fe931,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x152f1aa8d954f25ace61acc0,
                        limb1: 0x3087b93a8adb27a0fc4ea3bf,
                        limb2: 0x34447a197492dbe1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf0aec22414d16dd36fc7b237,
                        limb1: 0xe97d05d001e9ce9bff67fdce,
                        limb2: 0x518875fc65490c02,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc844185c504657197d01a1db,
                        limb1: 0xe5db1892054c60268a557d1b,
                        limb2: 0x6e21f37cdf241220,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x85f6007c5824f145a226dc69,
                        limb1: 0x98207ea8370d783baf7749c1,
                        limb2: 0x61a1c3450394c690,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa2d9b96367a5a418dd5ef304,
                        limb1: 0xff7f58a4b9f94b3e202d3a28,
                        limb2: 0x1832e7aead2a6fe9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc15aff659923f922a0b62a4,
                        limb1: 0x22d4864c2805280a5e43e363,
                        limb2: 0x239acb03a25e1fe1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6d8e1bc8dd1778467abd8970,
                        limb1: 0x96b83caeffba04db7293663e,
                        limb2: 0x58fa49c3736799cc,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1168c979a7bae62182f560d0,
                        limb1: 0xa3412c978187eda909e6fa02,
                        limb2: 0x272c5e45816fd629,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x928d0096723f5ad8e55f1cf5,
                        limb1: 0xc82351bbba54b7b37a7ee38b,
                        limb2: 0x2eccaef0a0bf526c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xea63d93f9ccc67726c917ba9,
                        limb1: 0x1b0d91f4,
                        limb2: 0x4000000000000000,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x2a54d54fb5687603745272f0,
                        limb1: 0x632e0b23d0bd38512245985b,
                        limb2: 0x2a8654e484dbf0f0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa683e16b5989a8c130afd1b1,
                        limb1: 0x8c20aa6e3eb137a9405361d4,
                        limb2: 0x786a2a6c729998d9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xef6bfe443901a6ef183a78ae,
                        limb1: 0x719b099e558da97b0377185c,
                        limb2: 0x275ba9c58f30faf9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbeb0a637f931564d796f7be4,
                        limb1: 0xd75d2b8e1a5bd92857f18033,
                        limb2: 0xd3654095e5d1543,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1e1ec8b1a3f923d94a7bd1f1,
                        limb1: 0xc901d97f95ffb41c5cacc06b,
                        limb2: 0x7d2881e9a1d53558,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x44aea2ccbb9687bdb7ebf093,
                        limb1: 0xfedec7e4b2e36ed60d04308c,
                        limb2: 0x7cfe726e18e71eb8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4f8566e0b232b9cb43a967f4,
                        limb1: 0xda83bf192529ff5db2cd32e2,
                        limb2: 0x4355d27a7c60cf8d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf6ad08cb5c267580cdc3c4be,
                        limb1: 0xe55f6bf87ff219214ef4259c,
                        limb2: 0x5345f9dd0bbdb275,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb78ec1a02846e8a5ee2e33d7,
                        limb1: 0xc402ad4a625307437b4bd666,
                        limb2: 0x71bcf953b849b780,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd56c9a219cce14bd3c2d323a,
                        limb1: 0x4ca4850ac67fff405bc6dfc8,
                        limb2: 0x1ff177fed17bd235,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe1d89602f9b564056e22e138,
                        limb1: 0xe1d781d531f402eb4b71a32c,
                        limb2: 0x108f8f9ba4aa5e67,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x9c045cba449207ff15d7a416,
                        limb1: 0x8991e57020e268c74c31bd49,
                        limb2: 0x47b174498b73d2f4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa8e68dcc98bdd022a5c2d119,
                        limb1: 0x85b28603931eb2067621a906,
                        limb2: 0x27f22d992a6cf6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x40610d4331ed47884d22fdc0,
                        limb1: 0x8667e33afb983a0f9f6cd8f6,
                        limb2: 0x36abca8e90383621,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x92753f16843d34a787241acd,
                        limb1: 0xe4a9b51d2febd74660d86212,
                        limb2: 0x4fc8fa6648b86d64,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd4b600b1cd38d6ffd75471e7,
                        limb1: 0x21e72951f2fe8780c689a3c,
                        limb2: 0x1f7cba236739269b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x77ffe88894b7970b21fd7df1,
                        limb1: 0x6187b44397859c59226a181a,
                        limb2: 0x34bcfaf92767c6d2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd1c4ea2dee6523409fe2c819,
                        limb1: 0x58484a67caad1dd6fc57a68c,
                        limb2: 0x254f7bde36fe537b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1a4cd9a500f15c6804a4eec3,
                        limb1: 0x44ebc957dfc81f6b1cf29245,
                        limb2: 0x19d0105a2c739492,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5f31eee51a17a3c2987f5db5,
                        limb1: 0xfb982635f63379c319dcb8f8,
                        limb2: 0x5cc6bda70a34d0e1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6a43ea88816d97ed05bd9203,
                        limb1: 0x3615dd127ae56e401e5a5aea,
                        limb2: 0x25c0fa0517f2d46f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2eb1fc1bb6dcaf89169fff00,
                        limb1: 0x3a95a54e22dcfa183c1d1578,
                        limb2: 0x462cbbe0a0ca8bb1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf192e7acb6608fd72b614f9c,
                        limb1: 0x7f629b1fd7cdb946be293fff,
                        limb2: 0x283cb88b3687cb57,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xe28e3b12e7a33edad715a938,
                        limb1: 0x8f9a4c1e4d82326cba527c10,
                        limb2: 0x102e52f670374112,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x359d75b5349f9b6773c3d674,
                        limb1: 0x969ecae128c360cb0ea8480a,
                        limb2: 0x36daa933692e1589,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xcfa187172a5429a7c1ecbc3f,
                        limb1: 0x6dfec27eb6164dbc4e790e76,
                        limb2: 0x4018d8176a1637e1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7f3d28bd2d4f3d9d1077bf97,
                        limb1: 0x63832d28c54b1b20e4ad16f1,
                        limb2: 0x6f0ae3ed4ba89e6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x118a790096d7c5cd864e7a5e,
                        limb1: 0xe113ee755f7d0005ad95f893,
                        limb2: 0x35f1cdcab1163c8f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xff78b43870f591e351b6b971,
                        limb1: 0xa28dcebb41b8578c03c26613,
                        limb2: 0x20fd5579566710b4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3c38f77ff25e4c441053f8d6,
                        limb1: 0xfd60a7377d811aa3edc3ac06,
                        limb2: 0x452076b40bccad62,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa2bfcd1da6b87d7b1a636c8b,
                        limb1: 0x38ba9de58707d24373d30997,
                        limb2: 0x469033654f6a3d00,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1f3ff603cc4633bb5508a611,
                        limb1: 0x3c6c7a761513f7af9d31685c,
                        limb2: 0x29cfa20b22a9614b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9a189a8ec19acbbe3bdb93d0,
                        limb1: 0x82a7afe182972c8bae65b020,
                        limb2: 0x5ffe8f227ea3c24,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2059db424e35473dba14b875,
                        limb1: 0x80e868b87c6f594e483df09,
                        limb2: 0x269f1df5a682c1c1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa249a84852697e0eec7e3805,
                        limb1: 0xdf964499f56ec684b116776f,
                        limb2: 0x6936510caea6bd02,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe211c519493ff64c34e94967,
                        limb1: 0x7e3c661827fb3d16c77f9625,
                        limb2: 0x7d4024d27735911b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe1d89602f9b564056e22e138,
                        limb1: 0xe1d781d531f402eb4b71a32c,
                        limb2: 0x108f8f9ba4aa5e67,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x934671c7a1167ed93ade9628,
                        limb1: 0x98ace981e4f674f9668fab8c,
                        limb2: 0x7a85cbe8c8fdcf94,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd784a91a5e09d24e7c4a265c,
                        limb1: 0xffffffffffffffff7c074593,
                        limb2: 0x3fffffffffffffff,
                        limb3: 0x0
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xa7a1657d4b465f527f2f3a54,
                        limb1: 0xd0606bfc0dbf1d9a448ae64d,
                        limb2: 0x7331f4a2e62b9c20,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x73cd315c76ee0229fb12b7d,
                        limb1: 0x44e473a9826381fa4a006a2b,
                        limb2: 0x28e54b975c8759cd,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x275ec955c0f3b6bcfffb4910,
                        limb1: 0x854f095f2e8b7ab3a1b3fe67,
                        limb2: 0x6cef0595cce71e8f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6bbf20bfffdfe473b6234424,
                        limb1: 0x196d64364d38a11fcfac329f,
                        limb2: 0x36248c053bbd00e8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6ca813bc47fee425e920bb92,
                        limb1: 0x15cb86ae6f46118422599133,
                        limb2: 0x3c61b4077d281f72,
                        limb3: 0x0
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xe787a9e30b6310b244f0a8d1,
                        limb1: 0xa92e77b70b036a1f649bc431,
                        limb2: 0x361accb0d2ee31a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3580dfba30b97d37aa9e49c9,
                        limb1: 0x663c37b0d1de4e0f6e480e21,
                        limb2: 0x5d77dc44cca63176,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc55c5a8afd35357b92874a72,
                        limb1: 0xb4f10b58d4fc6bb0afd144b9,
                        limb2: 0xa5b17075e9ddf5d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb4469074f7b840e177eb5194,
                        limb1: 0x1f84d096f3a5b70b0439caa,
                        limb2: 0x5080a1768be55b07,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x73cd315c76ee0229fb12b7d,
                        limb1: 0x44e473a9826381fa4a006a2b,
                        limb2: 0x28e54b975c8759cd,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x3c276a53f90132ac81e4daa7,
                limb1: 0xb1e1dd19f096db9feda0408e,
                limb2: 0x22f305051b370945,
                limb3: 0x0
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x7238f02b9f20e09c2181a557,
                    limb1: 0x2cedcc5b0be371c337fd7e9e,
                    limb2: 0x41f3bbeb280fe8a2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf046f8cd6e5a75fca71dd19b,
                    limb1: 0x892b4613ef5c58df4ef692a4,
                    limb2: 0x7527fa36f5738847,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x82e4a33f8e4e5881e791d86b,
                    limb1: 0xbcb062435ae8ec5fdaeac4bf,
                    limb2: 0x179e1bae9e0f9f34,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x19657783ba5660e255c21849,
                    limb1: 0x7ed7474bcea7551fc71e46bc,
                    limb2: 0x596c0a76b75f4756,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xa6832ef7fe97f77de7cd9a62,
                    limb1: 0xf18a70dbf1dc5a76c685da4a,
                    limb2: 0x6ac1b7bfc409119f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x7751161b1a9ef600b865a5af,
                    limb1: 0xed28aad4835a39a9e8318ceb,
                    limb2: 0x572e95c429f0e07a,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x5e71d0fc5d1c016834779173,
                    limb1: 0xadd002dfc0ebf1b25c23c252,
                    limb2: 0x40a868d928ae5233,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x423fa293418d6e3f59c2e830,
                    limb1: 0x7a4bcf26f93e71ffd903e68e,
                    limb2: 0x7837b851ad8da6e3,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x5907087f8e8e4dacdd039371,
                    limb1: 0xc390e2073b4e64b9ede0570d,
                    limb2: 0x6b039a85962f1594,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc45eefa03155b8f7eb780b42,
                    limb1: 0x3db57eb22f9b0394a4d7b78e,
                    limb2: 0x6cf45b6d90883f60,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x60dd8ed0a614b596fb37eb1f,
                    limb1: 0xabb99f371be41e26ec2d8e4b,
                    limb2: 0x187ecd72c40f159d,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x7b66c9263de5e1663622985d,
                    limb1: 0x118b032cc27a1d6dd192eca6,
                    limb2: 0x312fb405788616e8,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xf4ac3e1f1f068dd64c86fdda,
                    limb1: 0x24594e591d82a7f964b5ec9f,
                    limb2: 0x6ca311b5421c57fc,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x42745cd7b146012455434d0f,
                    limb1: 0x6aa4f552b7bdc93a613bd9df,
                    limb2: 0x5832a065d7199c7a,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x341786b7854e3e0104e2e416,
                    limb1: 0xbb368441c295043bee7b1d2f,
                    limb2: 0x35c88542e11463b4,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x3c36e7fcc4e2fde28308132,
                    limb1: 0xf58043d0e3d1a36d1f8137fc,
                    limb2: 0x58c1508fbe8868a8,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x560a37951d69a6c8d7138239,
                    limb1: 0x462d454a509846714184ef71,
                    limb2: 0x3aaf8fb4f60e3e9c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb70cea4e13db5322899753f9,
                    limb1: 0x6c62656b6d7ffb5c2af44fd5,
                    limb2: 0x4b5ae4567dc6a7c0,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xb06cccb4b425d5179f528270,
                    limb1: 0xce017c281a3861570706cd86,
                    limb2: 0x42d14846dc4860ab,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x646bf486f6e77663c597ece8,
                    limb1: 0xd87c8c36a430a6fe42305b88,
                    limb2: 0x7964c7742b6f13da,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x52c487a17925c92335926072,
                    limb1: 0x13155d04b743220ba9c4dd31,
                    limb2: 0x1106c832e8e52057,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xbc69df5aa9a21ba08f160d5f,
                    limb1: 0xc207c95ac5d454f546b05fc3,
                    limb2: 0x574515b32b35f440,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0x85940927468ff53d864a7a50b48d73f1, high: 0x6e2edd0d977e9933c49d76fcfc6e625
            },
            u256 {
                low: 0xd344749096fd35d0adf20806e5214606, high: 0x8ce86e89466e4726b5f5241f323ca74
            },
            u256 {
                low: 0x30bcab0ed857010255d44936a1515607, high: 0x8ac57cfbb42e0b20426465e3e37952d
            },
            u256 {
                low: 0x5f3f563838701a14b490b6081dfc8352, high: 0xda2ddc3552116dd2ba4b180cb69ca38
            },
            u256 {
                low: 0xc87a746319c16a0d0febd845d0dfae43, high: 0x7003168b29a8b06daf66c5f2577bffa
            },
            u256 {
                low: 0x176ea1b164264cd51ea45cd69371a71f, high: 0x3b6a666fb0323a1d576d4155ec17dbe
            },
            u256 {
                low: 0x9edfa3da6cf55b158b53031d05d51433, high: 0x23d79a9428a1c22d5fdb76a19fbeb1d
            },
            u256 {
                low: 0x4d125e7fa59cec98126cbc8f38884479, high: 0x1f40f472e2950656fa231e959acdd98
            },
            u256 {
                low: 0x98b33c6e0a14b90a7795e98680ee526e, high: 0xc8555a9fcfcfa81b306d70019d5f970
            },
            u256 {
                low: 0xebe2136898c752051e01a934402d0baf, high: 0x6c2a492cc0f859aa6524ab713b7e05
            },
            u256 {
                low: 0x637e0edc5b6e4ae7a62081434fbaecc0, high: 0x4e8c1e4403d1f83a859890cd670f668
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 4
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x7c410eb46bef1f4bbd9bc435,
                    limb1: 0xf8e9e58aa621db96880b0f17,
                    limb2: 0xd09eb5f2667189b,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xdc7785ceb6c9231f86e4b328,
                    limb1: 0xa8f46608017bf64838b1e72f,
                    limb2: 0x5a4e1c9619ed8aa3,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_GRUMPKIN_1P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high_shifted: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x5be9cd33c24d73ebc135039a,
                limb1: 0xe6367f6a20a10841e359bc14,
                limb2: 0x117b52588ff93701,
                limb3: 0x0
            },
            g_rhs_sqrt: array![
                u384 {
                    limb0: 0x3a6f69faa3a18fe97322832e,
                    limb1: 0x11cceede4dca8a3cd115016c,
                    limb2: 0x11edbb61d27eb894,
                    limb3: 0x0
                }
            ]
                .span(),
        };
        let points = array![
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![u256 { low: 0x0, high: 0x0 },].span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 5
        );
        assert!(
            res == G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            }
        );
    }


    #[test]
    fn test_msm_GRUMPKIN_2P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high_shifted: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x8ac5f837037348d49c751d6,
                limb1: 0xda6d3905ae9a7923b92ad213,
                limb2: 0x5b96a2638607680,
                limb3: 0x0
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x86b402ce02e7c7ca81f13d51,
                    limb1: 0x39493672733a9289a36020c1,
                    limb2: 0x7f40d91dc5413d3,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x371e7b6a5c01505bd4334e81,
                    limb1: 0x2f596ae4492a87c66f7bda1a,
                    limb2: 0x9dffb4dcdb94df9,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0xb4862b21fb97d43588561712e8e5216a, high: 0x967d0cae6f4590b9a164106cf6a659e
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 5
        );
        assert!(
            res == G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            }
        );
    }


    #[test]
    fn test_msm_GRUMPKIN_3P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0x37c9a46b0612fc1b353fe24a,
                    limb1: 0xeb374db12bd7d7711f2705b4,
                    limb2: 0x253453fe507b50b6,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x33cd021aeba5ea18a2e20a56,
                    limb1: 0x3e392b55f320a528391fcef8,
                    limb2: 0x14fbdf9fd7fbfcdd,
                    limb3: 0x0
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0x60e6980f95d8e5261423f38e,
                    limb1: 0x3079cdd992636bb28a5984df,
                    limb2: 0x14368ee41c0e5576,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xa3597535ddd5b8336fde7418,
                    limb1: 0xc0329958cee690ca2b691fb,
                    limb2: 0x2a11389e1b5a9b57,
                    limb3: 0x0
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0xc294148f233ee2e2eb301899,
                    limb1: 0xe1d7d7726b8c2ea638d0879e,
                    limb2: 0x1599a751984c9cbc,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xfb70f5613f53701f0d60d44f,
                    limb1: 0x1bc69554d8e00e30700a9bad,
                    limb2: 0x1e3d7a04c2e60b68,
                    limb3: 0x0
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x8e15747a6971ec654c9538a6,
                        limb1: 0x7fdd3c43d4599a79a98e4365,
                        limb2: 0x27464b0ede2a7457,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x67297412404daf077c6114ff,
                        limb1: 0xb85045b68181585d1a4e3c36,
                        limb2: 0x30644e72e131a029,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x258553d2c9ee963312b79ff8,
                        limb1: 0x438888d4a7a12112b3e57098,
                        limb2: 0xe4cb46dbea9de49,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9b429dc6585bf628eef768e5,
                        limb1: 0x4bfece4993685c63de2eabf9,
                        limb2: 0x2a50bc4485c254af,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xd6decae815941319bdaf969f,
                        limb1: 0x9101d60097d93e695385fb85,
                        limb2: 0x2bf7dd07ea4fd22c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xcecdd84482b1a7bd65ad8aff,
                        limb1: 0xd20554a9ff932c44b0724efc,
                        limb2: 0x97ab331d38c3260,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1df3869130399d7294160dff,
                        limb1: 0xe3d0a12a18c4534529ef57b4,
                        limb2: 0x170c626545e0c5aa,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x5c7e12682e73c81361ce608e,
                        limb1: 0xd5d08c27e754dff0fefaf798,
                        limb2: 0x2f41db679de1fe1c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd2711e571c220af3319208da,
                        limb1: 0xc0c862cecca60ad399f130ab,
                        limb2: 0x684182e5000c2cd,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x79b9709143e1f593effffff0,
                        limb1: 0xb85045b68181585d2833e848,
                        limb2: 0x30644e72e131a029,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x258553d2c9ee963312b79ff8,
                        limb1: 0x438888d4a7a12112b3e57098,
                        limb2: 0xe4cb46dbea9de49,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9b429dc6585bf628eef768e5,
                        limb1: 0x4bfece4993685c63de2eabf9,
                        limb2: 0x2a50bc4485c254af,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x6c9094e91dc1419df8ac17d2,
                        limb1: 0x1d37212cf26d121d10526534,
                        limb2: 0xd74cea3fa3eafe3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe489456a743fff37e6265cf4,
                        limb1: 0xdc2822db40c0ac2e8584ab0b,
                        limb2: 0x183227397098d014,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xce0be3b48c90db0b600f9647,
                        limb1: 0x179564f06356564259574cbf,
                        limb2: 0xc0ea53f1b5ae40c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf86c399084b4178a201357a0,
                        limb1: 0x4e6c086aab5b6fc54ac84485,
                        limb2: 0xaea32ebd8fdafc6,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x7b948850701e9dd524248c65,
                        limb1: 0xae7a7baf9cfe902f2aa2d975,
                        limb2: 0x1facd72538b25505,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xeeb017e8d63197897bbe5863,
                        limb1: 0x73ed90d8ce4961c8611416e8,
                        limb2: 0xff6ecff1a2f06d4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x26a0783ec6052c25936892a3,
                        limb1: 0xe34125f29d2dda477d8b7067,
                        limb2: 0x163e664e71f6f426,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xb1d513d8fdcb40224ef7054e,
                        limb1: 0x8a5a899eecaff69da3770ad,
                        limb2: 0x24fc8f0d94eefc03,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x67b5efac3f9246239eb72e64,
                        limb1: 0xac1487c4a4f2f55aa983143c,
                        limb2: 0x803d8221bedd47b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x79b9709143e1f593effffff0,
                        limb1: 0xb85045b68181585d2833e848,
                        limb2: 0x30644e72e131a029,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xce0be3b48c90db0b600f9647,
                        limb1: 0x179564f06356564259574cbf,
                        limb2: 0xc0ea53f1b5ae40c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf86c399084b4178a201357a0,
                        limb1: 0x4e6c086aab5b6fc54ac84485,
                        limb2: 0xaea32ebd8fdafc6,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xe90507f02c8a4b62e851076d,
                        limb1: 0xfbeef957f36c71de0a3a5c17,
                        limb2: 0x28de86d1c2705cdb,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x14616162fffacd18744a2666,
                        limb1: 0xdc2822db40c0ac2e102139b8,
                        limb2: 0x183227397098d014,
                        limb3: 0x0
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xa546f985809a17ae515a728c,
                        limb1: 0x191e2152367d78fe0141ada3,
                        limb2: 0x29b6ff1ffef8b375,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x563ec3f28aca2d8af0abf3da,
                        limb1: 0xa5fea06a8391be046509dbca,
                        limb2: 0x694183d2cd6adf6,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xad9b0b7d14eda847ad2d988f,
                        limb1: 0xea4ba18699ca196c1c67bf1a,
                        limb2: 0x1c938086ab194bcc,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdb8a34d8c7adf1036f90f389,
                        limb1: 0x883ec94e38c731970d329f6b,
                        limb2: 0x17879279bc43bcef,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x593e562533466b7dd9a7828e,
                        limb1: 0xa15054f5463097ab204592c3,
                        limb2: 0xf7280157dd58ef1,
                        limb3: 0x0
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x282706a57001d117a8fe64c3,
                        limb1: 0x21b3df3bf83f249745ae1461,
                        limb2: 0x10b9a79b436477ab,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb3014e989438da81d494ce89,
                        limb1: 0x23082a10c7d66accc2f42069,
                        limb2: 0x21574f48a953531c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x79b9709143e1f593effffff0,
                        limb1: 0xb85045b68181585d2833e848,
                        limb2: 0x30644e72e131a029,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa546f985809a17ae515a728c,
                        limb1: 0x191e2152367d78fe0141ada3,
                        limb2: 0x29b6ff1ffef8b375,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x563ec3f28aca2d8af0abf3da,
                        limb1: 0xa5fea06a8391be046509dbca,
                        limb2: 0x694183d2cd6adf6,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0xf624625c1e7830369add8466,
                limb1: 0xdf4ba3dc8774a170e55c3776,
                limb2: 0x108c5a431b372b80,
                limb3: 0x0
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x86b402ce02e7c7ca81f13d51,
                    limb1: 0x39493672733a9289a36020c1,
                    limb2: 0x7f40d91dc5413d3,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x371e7b6a5c01505bd4334e81,
                    limb1: 0x2f596ae4492a87c66f7bda1a,
                    limb2: 0x9dffb4dcdb94df9,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x20669ef12954f8e3bbc8b4d3,
                    limb1: 0x396a6f7243c27ce553121ee3,
                    limb2: 0x11438ca2ec259aed,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xa560a5759c90985fde99aca0,
                    limb1: 0xc5b21186cc6dcd0421026513,
                    limb2: 0x21fb1f47c6ac55b3,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0x12e0c8b2bad640fb19488dec4f65d4d9, high: 0x1521f387af19922ad9b8a714e61a441c
            },
            u256 {
                low: 0x5a92118719c78df48f4ff31e78de5857, high: 0x28fcb26f9c6316b950f244556f25e2a2
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 5
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xf47b4ee8eecf8576c38173d8,
                    limb1: 0x755d90a26c30d7d6fb33afd3,
                    limb2: 0x5e835e05fdb55c5,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x990d5f4767a8d057f8695e4e,
                    limb1: 0x5f8dd4e272c268c0d2ce4a39,
                    limb2: 0x1704905427d31a82,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_GRUMPKIN_4P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0x7fca404cf28b7c01bc2a273c,
                    limb1: 0x21b13979cfab5b2c39925bc7,
                    limb2: 0x25c83abfb9a6cf23,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xbbd55bc3ba04437bce8521a9,
                    limb1: 0xf464d5315dd920e277df247b,
                    limb2: 0x8144b996cb87869,
                    limb3: 0x0
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0xafef69f2e967ce258ede0fab,
                    limb1: 0x3bded90a47a831e62a8312d8,
                    limb2: 0x23fcbf1035f058be,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x4bf0c01fe73cdbbc883c9ac9,
                    limb1: 0x8eb8106c85aa9de02e07517a,
                    limb2: 0x1b5257e9e2a9db7c,
                    limb3: 0x0
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0x93eac8ab0434b3dc0c76ec25,
                    limb1: 0x695c9f3078b835272ecde3f0,
                    limb2: 0x84e3b8cc47abe19,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb271bb87ca31ff4bc3dcbbb7,
                    limb1: 0x499ee0e5ba9f5da55bc7654c,
                    limb2: 0x1b425a934de04557,
                    limb3: 0x0
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x5b3114fdcbe3ea12af860d4,
                        limb1: 0xf3bcbd756e272089a257b609,
                        limb2: 0x2886ec65d53534cf,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x130e9d5b8486635b9669fe01,
                        limb1: 0x46f4550a52ebd1a681af6348,
                        limb2: 0x6ebb71b3fd76f04,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x60416bb07aa26060d453430d, limb1: 0x5302fc4c, limb2: 0x0, limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xcbf64aec56377e6f8430eef4,
                        limb1: 0x9af64232478b6c940229a679,
                        limb2: 0x2bb7ca91ed39438d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x76789be997d231b183614d52,
                        limb1: 0xf6c3de43313f7db33218c1ad,
                        limb2: 0xe3ab0dea82d325a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x171b0ce52478beca8bf4dc7d,
                        limb1: 0x58b9b5c6a8c59689b1d808d2,
                        limb2: 0x1d0917cd0245c05,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x3c66103387e0748da9dd2e25,
                        limb1: 0xa9fb407b0812b3edcb2991b6,
                        limb2: 0x1a8807e31a2ac127,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xff886d6474cf56f096b53084,
                        limb1: 0xd19abc920264bc17dafa8f8f,
                        limb2: 0xbac30177f98be63,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x15a6a308db2b1070fdb85d0b,
                        limb1: 0x114749f7c11a96ea8a2a715b,
                        limb2: 0x50030331cd6d76c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x690253abe523f52b11fc819d,
                        limb1: 0xbd48b3fe98cf73a725f8ab8a,
                        limb2: 0x1fef150b31df09cb,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x103c0f62846ff3d738c021dc,
                        limb1: 0x3aa9f61157d34ffe5e7a7671,
                        limb2: 0x1f10737d524c8634,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x829cd8533e747f19f689dd93,
                        limb1: 0x368f9a1a424f60eb755eace5,
                        limb2: 0xfc9753af7c8c6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf0ed9559d7dd4a20a4bd5bb4,
                        limb1: 0xd3fb33854c62593858db5254,
                        limb2: 0x118aa5290ec783ce,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xcbf64aec56377e6f8430eee3,
                        limb1: 0x9af64232478b6c940229a679,
                        limb2: 0x2bb7ca91ed39438d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x76789be997d231b183614d52,
                        limb1: 0xf6c3de43313f7db33218c1ad,
                        limb2: 0xe3ab0dea82d325a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x171b0ce52478beca8bf4dc7d,
                        limb1: 0x58b9b5c6a8c59689b1d808d2,
                        limb2: 0x1d0917cd0245c05,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xf4727a26dda5a1b495065eae,
                        limb1: 0x6ea016108b27a67de15191bb,
                        limb2: 0x29cfb71094aa66dd,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2eef8fdb1d604aa8a8779a53,
                        limb1: 0x50d12ba1e003ea0dcf72d9d7,
                        limb2: 0x2980ed53ad9e90cd,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd4266ba5008fd82e75450987,
                        limb1: 0xdc2822db40c0ac2e6ab736d4,
                        limb2: 0x183227397098d014,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x3c509420f659e72f9c20d321,
                        limb1: 0xefae81a6a955e0c3aa784ccc,
                        limb2: 0x13f3c37e8f77e7e4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xced313adc5b416fb95254961,
                        limb1: 0x38bec2897f725e3d56756d50,
                        limb2: 0x785990f3ab47616,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe6f5e33f2d9c6ca6b940f40e,
                        limb1: 0x3e8c163630c8bfcfc0e751c0,
                        limb2: 0x39c0d2c53dad26a,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x6f95403fbc327737636417c4,
                        limb1: 0xa84d3ee500ff2282bc072dc7,
                        limb2: 0x1060a1bfb8decc1f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1fc02829324c4cfdca46c249,
                        limb1: 0xfbd9d704477156f978a71b87,
                        limb2: 0xa9f1848f76978c3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc7de8a99fdeff40a07108b8,
                        limb1: 0x2b4bccdae8276b30cbe3d680,
                        limb2: 0x9142d0b0cb2df7d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1fc42b898b84f5d425784137,
                        limb1: 0x698feb99b04a3934dcdacd70,
                        limb2: 0x2f71c7167020ecaa,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xcc71ae59c317527621d1fad7,
                        limb1: 0xd7eb91a2cd56d5eaefa228b3,
                        limb2: 0x2ff2782f82969b19,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb1280329aab05a06e8862092,
                        limb1: 0x6445e6020debc704bacf767b,
                        limb2: 0x114dc155bd990903,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9d1ec9f08060b41592afcb14,
                        limb1: 0x495311d3c5adf3ee810b62c1,
                        limb2: 0x236bbcf430db4745,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3c509420f659e72f9c20d310,
                        limb1: 0xefae81a6a955e0c3aa784ccc,
                        limb2: 0x13f3c37e8f77e7e4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xced313adc5b416fb95254961,
                        limb1: 0x38bec2897f725e3d56756d50,
                        limb2: 0x785990f3ab47616,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe6f5e33f2d9c6ca6b940f40e,
                        limb1: 0x3e8c163630c8bfcfc0e751c0,
                        limb2: 0x39c0d2c53dad26a,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xc2b34a05ead1a5c1e206ce52,
                        limb1: 0x2a79ea4810e1561d52912925,
                        limb2: 0x21c41fdcb51674a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x14616162fffacd18744a2666,
                        limb1: 0xdc2822db40c0ac2e102139b8,
                        limb2: 0x183227397098d014,
                        limb3: 0x0
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x6b8d5841e0e9f2640f2628ce,
                        limb1: 0x647df32f676931fb6addaa32,
                        limb2: 0x13e57fc7d4309dd9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x35df3df35645739254ab0431,
                        limb1: 0x1314cd7bc120f14fcee2f17f,
                        limb2: 0x41953d5e6c68952,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x84df9c9d60124a1d0341d03f,
                        limb1: 0x724317d69b6774f76031adff,
                        limb2: 0x201280eb26d8b6ee,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5d59a538d48ac968cf43ea91,
                        limb1: 0x8f29386b12c1945f9f8d81b5,
                        limb2: 0x1a7ea644cced4e2d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x48d019fab55230546de29d1b,
                        limb1: 0x9d0e0334ce6fcd98b1a17f75,
                        limb2: 0x86c53cd76b42d7a,
                        limb3: 0x0
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x2faf3798eba49e668e774a59,
                        limb1: 0x5dd4c1d7ac8d18da00b30ca2,
                        limb2: 0x80a8df1120e5b4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5f9fc3f9cd273e7040a4b8c1,
                        limb1: 0x2c3ee6352fd2aa6d9355c71e,
                        limb2: 0x1b1a0bb16f3421e0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x79b9709143e1f593effffff0,
                        limb1: 0xb85045b68181585d2833e848,
                        limb2: 0x30644e72e131a029,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6b8d5841e0e9f2640f2628ce,
                        limb1: 0x647df32f676931fb6addaa32,
                        limb2: 0x13e57fc7d4309dd9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x35df3df35645739254ab0431,
                        limb1: 0x1314cd7bc120f14fcee2f17f,
                        limb2: 0x41953d5e6c68952,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x6f5c20cab2d3f0773fd79cba,
                limb1: 0x5934aa48887e338f93d98679,
                limb2: 0xb3e9990ef5f1e85,
                limb3: 0x0
            },
            g_rhs_sqrt: array![
                u384 {
                    limb0: 0x4d0f3fc467e3e1f6de60779a,
                    limb1: 0xc90194901d86045ce012a0a9,
                    limb2: 0x29e3a617966904f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf311cb851125efe96eb1f228,
                    limb1: 0x3e04f569884a82accde8bfbd,
                    limb2: 0x8d79d17e24e7b57,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9718189e268658a4637cecd8,
                    limb1: 0xa34e27f500a18918c162f079,
                    limb2: 0x85e801cf1ccf9ca,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x42f92a37e3c7e20f771e712c,
                    limb1: 0xad6fb5dfe13f4943f00a60a7,
                    limb2: 0xe5c8ca6dcf54069,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd71487c2546da95c255085bf,
                    limb1: 0xbb7ae521420e28dd50ad7d46,
                    limb2: 0x103d9fb8533aae9d,
                    limb3: 0x0
                }
            ]
                .span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x86b402ce02e7c7ca81f13d51,
                    limb1: 0x39493672733a9289a36020c1,
                    limb2: 0x7f40d91dc5413d3,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x371e7b6a5c01505bd4334e81,
                    limb1: 0x2f596ae4492a87c66f7bda1a,
                    limb2: 0x9dffb4dcdb94df9,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x20669ef12954f8e3bbc8b4d3,
                    limb1: 0x396a6f7243c27ce553121ee3,
                    limb2: 0x11438ca2ec259aed,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xa560a5759c90985fde99aca0,
                    limb1: 0xc5b21186cc6dcd0421026513,
                    limb2: 0x21fb1f47c6ac55b3,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x3c26f4ff476ab777dc184776,
                    limb1: 0xbccb2cba46cf421f11eb4d14,
                    limb2: 0x27ec44064c727a3d,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xa893636703904fcbe984618c,
                    limb1: 0x73b210a224190b9b7b28784c,
                    limb2: 0x20f05486689dff6c,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0x5a92118719c78df48f4ff31e78de5857, high: 0x28fcb26f9c6316b950f244556f25e2a2
            },
            u256 {
                low: 0x8d723104f77383c13458a748e9bb17bc, high: 0x215ddba6dd84f39e71545a137a1d5006
            },
            u256 {
                low: 0xeb2083e6ce164dba0ff18e0242af9fc3, high: 0x5f82a8f03983ca8ea7e9d498c778ea6
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 5
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xdd8f608cce44f84812570bb4,
                    limb1: 0x1a14a31827612753a0030aa0,
                    limb2: 0x92f0e5ea352aed1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb58c06876e2333cf38a0f096,
                    limb1: 0xbc1d90983cae6462c10cfeed,
                    limb2: 0x202c74ee1cf90bb5,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_GRUMPKIN_10P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0x9dfcd92715b6222cbb098482,
                    limb1: 0xd3945047066b23989eb3b9e3,
                    limb2: 0x116d66e83f4b4495,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xfbf94312b77c49728e67e899,
                    limb1: 0x970271de43b7f68191de9797,
                    limb2: 0x1a988f8bf089fe6a,
                    limb3: 0x0
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0x16b97231d5c9925069156e4d,
                    limb1: 0xdf3469ceab36997946976963,
                    limb2: 0x1fb5fa1943c43e59,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x8dbab6d460f7c22922c55eb8,
                    limb1: 0xddd8c23ff5d4a05087728205,
                    limb2: 0x29eb2a49e3284dae,
                    limb3: 0x0
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0x492c80f514e1a11f6b2b259e,
                    limb1: 0x458bc23a5411c8ce5922154b,
                    limb2: 0x51efbcd4e49ad5a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xff461ad6ee2ad825beaa8216,
                    limb1: 0xc1b2fdb212af7469ee8b1721,
                    limb2: 0x3d032fcfa6958e9,
                    limb3: 0x0
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x425d56f4517f3d2aa3aa31e1,
                        limb1: 0x83111f618e5ca99a859d6169,
                        limb2: 0x21fdef270063011c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5fa436089917df6821af70b3,
                        limb1: 0xda760434ecc9958edda7811a,
                        limb2: 0x25072296ed8d8630,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x34cc98ed29512faac45df0aa,
                        limb1: 0x65966cab2412f96e5996c644,
                        limb2: 0x63e95faf3fef6b3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc31132c8d14eb1df3cade438,
                        limb1: 0xac015362981906b6783723b5,
                        limb2: 0x57ef192414f951,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x890e8162919823970d7a87c5,
                        limb1: 0xe2b8c4393fb2fd797a6f3370,
                        limb2: 0x1011343676b59f01,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x51caa12b3df8994967de0bc2,
                        limb1: 0x61457619589511f19bb98fd,
                        limb2: 0x6ceb296dbc5e3b8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8b487653edc983c089dcfe4f,
                        limb1: 0xf233268b7692d35a8bbc0078,
                        limb2: 0x14147d2e5fe8cf3b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x555790a83b54fa5a0d98eb59,
                        limb1: 0xa53d7d1986963cc8bc7e4053,
                        limb2: 0x15eda6cd784ea63d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x846bd855404984dbbb11a00,
                        limb1: 0xdc2822db40c0ac2e278e2c6d,
                        limb2: 0x183227397098d014,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xc434a3551e9e42488e07bf90,
                        limb1: 0x6a3b96ff0b6288aa2b4f6cbb,
                        limb2: 0x1c5963d1c19d03d5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x32ff7e7cb866d888dcb4d052,
                        limb1: 0x4ce741b5d98f0752f9486a6e,
                        limb2: 0x1e3ba43ff97bd83,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xebfcc2505392d44a27cb2383,
                        limb1: 0x6f59c8c02124a189ecfc8c58,
                        limb2: 0x21bf34bc420de6c7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf16ae9e8a1f098ba95f87501,
                        limb1: 0x19dbabaefabd1a4d5e943101,
                        limb2: 0x21531c787450807c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x938dc2fa4ff43da341397742,
                        limb1: 0x918df141c9ef5c3e835d755d,
                        limb2: 0x14822a1bf07a7997,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xcf37ce00b4393b619f6cd58b,
                        limb1: 0x48dc3939d85d9191e087ac41,
                        limb2: 0xd702674ce3d3a6d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5ce6af9c614b257e3f19b51,
                        limb1: 0xf99bf75fc6dd0078487e9add,
                        limb2: 0x2a10300ba206ab71,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7bf55da414e100118cda7bbc,
                        limb1: 0xa8f0b37aa53ae93e596e628c,
                        limb2: 0x114d3d1b007e9447,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8ab4144bb8951ef9715b5a41,
                        limb1: 0x5aa9b6311048eed745240913,
                        limb2: 0x103a1c920b13d876,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xe4aae31077250ed68ae7947f,
                        limb1: 0x3a7306ca7c3811fb9c4d5935,
                        limb2: 0x18d8c709c0f39210,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x81d00d66f21d37d503988f95,
                        limb1: 0xd9aff679bbde4edd7e50d5d5,
                        limb2: 0x245fc626343978f9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x66a515512abe19be064381a7,
                        limb1: 0x7757634a88f9b38fd60c199b,
                        limb2: 0x9697d771902e2ea,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe45c9d70b5e4993576a7cfed,
                        limb1: 0xac1afb5f41e8702035a058d0,
                        limb2: 0x2ffe8db65b785780,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x23f0fe39bfa60e04e6892795,
                        limb1: 0x26514111b7eb3a23dbce5392,
                        limb2: 0x24d4bd98192f1838,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x890c24f363be42caa4e24ef7,
                        limb1: 0x14c12835c7b970e7348b87a4,
                        limb2: 0x207295985d7a05fc,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1b513758f396f76dd5f11ea1,
                        limb1: 0xeadd98c3a8fbbe23b849fa43,
                        limb2: 0x199599d347684e83,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x57657b4a6bc71e90d8e0a48d,
                        limb1: 0xd3f0eea45760205a70f649ed,
                        limb2: 0x257260077d9b9d1c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd3ada528cf28d56e7ee4021,
                        limb1: 0x592700c6e20eeb8986bae9c7,
                        limb2: 0xb1b2968ec4ee78c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x407a18ede344dbe2a7ba9fcb,
                        limb1: 0x8160beffa595d32f8b6c2ca,
                        limb2: 0x949a49bd0c4fa50,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xb9bf8d059e5130f5f17c477a,
                        limb1: 0x252db2314d826056b1c0da5c,
                        limb2: 0x1fb6f8ef0830075,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x16c20a49050d947d47fe2a8f,
                        limb1: 0x9cf4e8a30f01dbda9a64d6f7,
                        limb2: 0x1044efeee81e0a71,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8e85f79a1d76a029b82a459,
                        limb1: 0x3eccefcbdea16a3525a9917e,
                        limb2: 0x7012ce22b672eb6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x70cc61b18c3ba0d3d887fa8b,
                        limb1: 0x566874ee76e3ede4c5e70f00,
                        limb2: 0x2a882d349697fd8c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x34611067883e6d5107e3e4f8,
                        limb1: 0x64fc6a0b7cb4aa1581b2e17b,
                        limb2: 0x286162001102abc0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x89e7471aaf2faeb24190f54d,
                        limb1: 0x324b58794a74b0abccfda564,
                        limb2: 0x2f422f38f5f52656,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb09367d574ce248f82ed24af,
                        limb1: 0x533454045ca43fc5e9368493,
                        limb2: 0x2c20846de3c7805c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x329b2e7c844efdf086b73fcc,
                        limb1: 0xab73a863da0df14984405bbc,
                        limb2: 0x10baf2022f3c61cf,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x739b1861099dee48b85bd740,
                        limb1: 0x9578c23ecc8dc7753a5a83a8,
                        limb2: 0x1bee177359159b8b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5ce6af9c614b257e3f19b40,
                        limb1: 0xf99bf75fc6dd0078487e9add,
                        limb2: 0x2a10300ba206ab71,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7bf55da414e100118cda7bbc,
                        limb1: 0xa8f0b37aa53ae93e596e628c,
                        limb2: 0x114d3d1b007e9447,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8ab4144bb8951ef9715b5a41,
                        limb1: 0x5aa9b6311048eed745240913,
                        limb2: 0x103a1c920b13d876,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x2e747e23728dc753eaf508da,
                        limb1: 0x3af2c9ac01e72783715aaa50,
                        limb2: 0xefe075f28b636,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfdcdb4d952e4eecf88d57e09,
                        limb1: 0x2960f2045729b8adf3f60ac5,
                        limb2: 0x2f230d12b8654005,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfc0c424c4696d49b551128a1,
                        limb1: 0x7951917b3e5d242afe457e0a,
                        limb2: 0xd7a39d568bc99c8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x940364be1df4cbc554e3be5f,
                        limb1: 0x7a3b05db48d1a5655f895801,
                        limb2: 0x17ac78b62db83a2e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb7d6598e39e8d4ac3baa987c,
                        limb1: 0xef91e0b7ab5ca870af1afad1,
                        limb2: 0x16f1e671da19f321,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6d2b325a5aada17b3870ee6b,
                        limb1: 0x4569d2a057efefb1d55db6d4,
                        limb2: 0x1c26845d5027e452,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc7980cc94e8c2e7c4ab05284,
                        limb1: 0x89cff5ad9e2319a7e4503797,
                        limb2: 0xa4469b7672235c7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x92f291beac33703b4e5a191d,
                        limb1: 0xae076a4deb94c524d0046645,
                        limb2: 0x2032ad2d0d64b090,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6d5e87df5af605886e4e3dcf,
                        limb1: 0xb85045b68181585cd307fffd,
                        limb2: 0x30644e72e131a029,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x536058519b6c4d8f4112def,
                        limb1: 0x67f4caccecf3d384125590e,
                        limb2: 0xa1058702f9c2e9f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb201cf15f0ca114920990b2a,
                        limb1: 0xc1b74cd6e91d4771f9cbdd3,
                        limb2: 0x17d40f8657027e3e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf5d91436bb148e4749097f80,
                        limb1: 0x8af05dc756d3a56544f646b6,
                        limb2: 0x21698e5426c72450,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe98fd04efa42c97f1477398b,
                        limb1: 0x7cd39b181eede45fd1468877,
                        limb2: 0x18dd560a46a5fc82,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3becbb3cf2ecd57256dd247f,
                        limb1: 0xb08e61e7cccea55e731dd3d4,
                        limb2: 0x286677c53c033b45,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3b497929aa32257d2759d365,
                        limb1: 0xb58e0e1dfe997489162a6d35,
                        limb2: 0x12296c4d7d5a5ee1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc7a4f8e050900b63a9158124,
                        limb1: 0x43e98f7440de780c5b573237,
                        limb2: 0x17e43edf4135e0f1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb1617cb21b8d15049c548213,
                        limb1: 0x2ef0f0f25ee47d9195e5d288,
                        limb2: 0xa083a804b5c0d2c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x11f77b40f881aed5c34f7076,
                        limb1: 0x4f099ca96b7d78f69d405994,
                        limb2: 0x1f18961069adeb2,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xc56e3a6ce2f603f7a6a1db0e,
                        limb1: 0xf7a274159a646d241d75dae7,
                        limb2: 0x29add1b443c2f325,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe3a9f5e5d1d8be55b13d2ef5,
                        limb1: 0xd7cf3a498fa4ff61b5e5177d,
                        limb2: 0x2fc85c595925ab46,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa9285d078032287236b3207c,
                        limb1: 0xf90e060b7b43f362a3f2aee,
                        limb2: 0x2c2ab29e916cfc4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x92bccad0c3814af06f2e6958,
                        limb1: 0xd598e542306b17182d9c2b34,
                        limb2: 0x2f8d2c810552f5da,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xaf3ffaf05bdbf09044f3fee3,
                        limb1: 0x8f070bf12c8587e8708390b4,
                        limb2: 0x15609042b0fa8fd8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf936a6168bd9028d8dd05461,
                        limb1: 0x52204ab4acb0a132c180d07f,
                        limb2: 0x1bd2b139c560e04f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8b0e5da55521daa6b743f048,
                        limb1: 0x43605b57c676e1a0dc0364e5,
                        limb2: 0x4b91a712a7ec751,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xde5fee06b8d57eae47c0b58e,
                        limb1: 0x9d4db679a653e76fc5b28fa8,
                        limb2: 0x30144624808e7ca5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4ff33e6f3128772ce59b7372,
                        limb1: 0x49ab97f4d9d469cbe33a571c,
                        limb2: 0x9451c460ba13e98,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x34b848fe2a5dccb8ce5ded2c,
                        limb1: 0xae07bef847e97a4bb3523913,
                        limb2: 0x3b449b6a811fb38,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x8e4f646e5a64c3e78adbf325,
                        limb1: 0x72ccff604a4250b84d54b733,
                        limb2: 0x167b5a585b676817,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x756634a665867c5845d6423f,
                        limb1: 0xacffb1c635dcff5d506a8f7d,
                        limb2: 0x1e71ba1e23943f58,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6146ef2cc23a1033665e888c,
                        limb1: 0x69cd0a514e0228a44e14313f,
                        limb2: 0xcb139cbfb1a189b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xca2e2561de39059c08265bbd,
                        limb1: 0x3744737d4e8f2e21c54973a3,
                        limb2: 0x16e463cb69550b6c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5f6d87fb856b52c87be99ec9,
                        limb1: 0x670ac463e9ebae49ad7860b2,
                        limb2: 0xe8265b5ab8250e5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe050abda050bd26f4c1275d1,
                        limb1: 0xce63101077aafa79bd5c77e0,
                        limb2: 0xf0333e01af0984d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7566cdf3bfc1b4805a09a62f,
                        limb1: 0xbcd34213dc32ae77021b7507,
                        limb2: 0x5d79ccdfb9f0dca,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe19fc51cea3450dfc540813f,
                        limb1: 0xbb7f32f3042657caf7769199,
                        limb2: 0xf078098de7b3bd3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8393ba6a6d777edf1f135b90,
                        limb1: 0x2e3aec945cc5c485cd1862a8,
                        limb2: 0x21839b4eee433534,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc7a4f8e050900b63a9158113,
                        limb1: 0x43e98f7440de780c5b573237,
                        limb2: 0x17e43edf4135e0f1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb1617cb21b8d15049c548213,
                        limb1: 0x2ef0f0f25ee47d9195e5d288,
                        limb2: 0xa083a804b5c0d2c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x11f77b40f881aed5c34f7076,
                        limb1: 0x4f099ca96b7d78f69d405994,
                        limb2: 0x1f18961069adeb2,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x41f65ff065327e1fe95b115f,
                        limb1: 0x4ebd2c76ddf2ed2d678e5705,
                        limb2: 0x1d1ed5404785e9a4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x14616162fffacd18744a2666,
                        limb1: 0xdc2822db40c0ac2e102139b8,
                        limb2: 0x183227397098d014,
                        limb3: 0x0
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x7ac2618205fda87c7b4e3a7c,
                        limb1: 0x659d3766758c6fdbc6b06e52,
                        limb2: 0x60ae6d857e1c534,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x19d37d6a5936c2241bbf6c16,
                        limb1: 0x939019ad8238f615887a699a,
                        limb2: 0xb8f588c4f23b475,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x811bd8cbfc49c68e6c982913,
                        limb1: 0x60f64d3a7aaf94d4ecb54de7,
                        limb2: 0xe6fcc2aa71821f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9e370696d4c25884925cd43d,
                        limb1: 0x4ced623fcd259fc229b47e5c,
                        limb2: 0x256cf5f7fc710b2c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x872b8fd49985dd6dbe6dba27,
                        limb1: 0xa0d92e836174298cc03a874a,
                        limb2: 0x2b010fa84a95413,
                        limb3: 0x0
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x4643d81165cdb0779fce1dc7,
                        limb1: 0x69802355b6309b7f46e4655f,
                        limb2: 0x2a7396facd96c802,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa993dec666c6e77dd849d28f,
                        limb1: 0xccffa80ae1be6263b8e2862e,
                        limb2: 0x2d70a6ed24992501,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x79b9709143e1f593effffff0,
                        limb1: 0xb85045b68181585d2833e848,
                        limb2: 0x30644e72e131a029,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7ac2618205fda87c7b4e3a7c,
                        limb1: 0x659d3766758c6fdbc6b06e52,
                        limb2: 0x60ae6d857e1c534,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x19d37d6a5936c2241bbf6c16,
                        limb1: 0x939019ad8238f615887a699a,
                        limb2: 0xb8f588c4f23b475,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x987e27d1a784950477a02c04,
                limb1: 0xec14b47cecf5900f5a1b2fc6,
                limb2: 0xb4861a746693302,
                limb3: 0x0
            },
            g_rhs_sqrt: array![
                u384 {
                    limb0: 0xae38066a439cf179a25414e8,
                    limb1: 0xe26584239bc22a520cab7aba,
                    limb2: 0xd9e4331bdd7f48a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3c0bfd48136550b5cc324807,
                    limb1: 0x703ba42233416e862688f4a,
                    limb2: 0x1744b1fc804ba0b0,
                    limb3: 0x0
                }
            ]
                .span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x86b402ce02e7c7ca81f13d51,
                    limb1: 0x39493672733a9289a36020c1,
                    limb2: 0x7f40d91dc5413d3,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x371e7b6a5c01505bd4334e81,
                    limb1: 0x2f596ae4492a87c66f7bda1a,
                    limb2: 0x9dffb4dcdb94df9,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x20669ef12954f8e3bbc8b4d3,
                    limb1: 0x396a6f7243c27ce553121ee3,
                    limb2: 0x11438ca2ec259aed,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xa560a5759c90985fde99aca0,
                    limb1: 0xc5b21186cc6dcd0421026513,
                    limb2: 0x21fb1f47c6ac55b3,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x3c26f4ff476ab777dc184776,
                    limb1: 0xbccb2cba46cf421f11eb4d14,
                    limb2: 0x27ec44064c727a3d,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xa893636703904fcbe984618c,
                    limb1: 0x73b210a224190b9b7b28784c,
                    limb2: 0x20f05486689dff6c,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x74f2a24c1853d803c1b9e310,
                    limb1: 0x9e78bb9233603b686b9d27,
                    limb2: 0x1d13a84fbcd96e81,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xe5bc08950f2f1accd92245f4,
                    limb1: 0x3b653bbe7b6cfd9074b07f89,
                    limb2: 0x1638a8a07b89463b,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x549a4dee31909bd274709d7c,
                    limb1: 0x2628a928b4ed90e98d5de1f,
                    limb2: 0x1f2c2eeb200495b,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xbae71f4f781675cce1119290,
                    limb1: 0x18995b20b8d0966bac7f5c23,
                    limb2: 0x1f7a255155ab7785,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x616d2877cb47206e625b0076,
                    limb1: 0xa7255531af3575b0a682d6df,
                    limb2: 0xdd4a0db8187661d,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xea99c54030edacb739c9ad0f,
                    limb1: 0x1e2e84792f7a12b330406ecd,
                    limb2: 0x70f1e1a9673a240,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x4ca9473b8cae66da0baf8eca,
                    limb1: 0x9ca627187edabffeb80da281,
                    limb2: 0xda800cad866dc3c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x6dcd62554ccd88a00f3e90b3,
                    limb1: 0x141b8118cd6873dc9ac01a64,
                    limb2: 0x19146bc96fa6a4bd,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xd21eca6170588371cf0fef12,
                    limb1: 0x2aae89b6d1784d7fe5d6f233,
                    limb2: 0x2fa67b7cd137898c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb20856046d39da92c0a6898a,
                    limb1: 0xc9dba030db3ed937e781ae4d,
                    limb2: 0x695a8c76fb0f771,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x919e8724022c5bd17875261b,
                    limb1: 0x3a2b09cc9362be43a8573a0,
                    limb2: 0x2cf4abb949016ad7,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x89062bf5adf784b526337420,
                    limb1: 0xf710d8fb0beb9551fe0e08f3,
                    limb2: 0x1577b6c8f024c52d,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0x247a8333f7b0b7d2cda8056c3d15eef7, high: 0x5d67b7072ae22448b0163c1cd9d2b7d
            },
            u256 {
                low: 0xe005b86051ef1922fe43c49e149818d1, high: 0x1f507980eece328bff7b118e820865d6
            },
            u256 {
                low: 0x4a84eb038d1fd9b74d2b9deb1beb3711, high: 0x154bc8ce8c25166a1ff39849b4e1357d
            },
            u256 {
                low: 0x3405095c8a5006c1ec188efbd080e66e, high: 0x2305d1699a6a5f92cca74147f6be1f72
            },
            u256 {
                low: 0x1775336d71eacd0549a3e80e966e1277, high: 0x144a7edf6288e1a5cc45782198a6416d
            },
            u256 {
                low: 0x2f1205544a5308cc3dfabc08935ddd72, high: 0x21c38572fcd81b5d24bace4307bf326
            },
            u256 {
                low: 0x42930b33a81ad477fb3675b89cdeb3e6, high: 0x2b70369e16febaa011af923d79fdef7c
            },
            u256 {
                low: 0x2648ee38e07405eb215663abc1f254b8, high: 0x522c9d6d7ab792809e469e6ec62b2c8
            },
            u256 {
                low: 0x85940927468ff53d864a7a50b48d73f1, high: 0xdc5dba1d977e9933c49d76fcfc6e625
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 5
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x5bffd2a2faf5d4a0c935d50c,
                    limb1: 0x4084090271d00764d84b3590,
                    limb2: 0x20a4daac223feb77,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x5203a8edfe99a9265bfa3dee,
                    limb1: 0x69203f1c5320e35ca80b2090,
                    limb2: 0x2e2f28500b094e1d,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_GRUMPKIN_11P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0x37243e17b19c5ae4501ece31,
                    limb1: 0xfc13e3ef3c2d5605613146e6,
                    limb2: 0x1dc6a0e8ab0189de,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x5a82fd507de47e929ea6cb37,
                    limb1: 0x9391446bbd2773952a6649ca,
                    limb2: 0x4afdf8374d166b3,
                    limb3: 0x0
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0x328fbcfc7cae89b5c5fa4257,
                    limb1: 0xb1e9494927ed755e4d392933,
                    limb2: 0x2590494945eb8046,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xa0aa4dbec89f522c15d53a9c,
                    limb1: 0xfef9a4cd94f4a608443a99ec,
                    limb2: 0x2cde3d7d5e8ed3a4,
                    limb3: 0x0
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0x115cd91340716f078055dddb,
                    limb1: 0x54ee1a8df9774ca8c7a346fe,
                    limb2: 0x2841bb0bd2eb6b5d,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x95a7710a3d1483bcd6242af2,
                    limb1: 0x74b72028d41b6280f8685d53,
                    limb2: 0xe324254b42ffbe9,
                    limb3: 0x0
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xeec7b00d496b59fb5f3420cd,
                        limb1: 0x81c37f7d2211f1b89cb13fe4,
                        limb2: 0x24a574dab5e07c05,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9bb91b52c9d5e7f3b0b22db4,
                        limb1: 0x41c619607ca9361b3df7e0ed,
                        limb2: 0x81fd7d52524c356,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa6ad7e136fadce8e8e8126ef,
                        limb1: 0x8361f28cf4ec90eece9f50d2,
                        limb2: 0x4b5d2b1af681adf,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x63c274f020a50db61bf9eff2,
                        limb1: 0x311bc2d9391b309adf0f3187,
                        limb2: 0xb0bc70dd60c7ca5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x98b872c1fe91a901272e872d,
                        limb1: 0xafadbab194d8e629d64171ae,
                        limb2: 0x27992f6cf515132f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xed983688307224fd10a3036f,
                        limb1: 0x2ccea1e48595988b3caa5d92,
                        limb2: 0x298559b18a2697ed,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xecfa3159c47366fda7c7be69,
                        limb1: 0xeaa35f643fbf34cbbbf8ca97,
                        limb2: 0x23b32fdc6b83f59b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1459b8e23abf60824bfdf5e5,
                        limb1: 0x9f2deb4e0d47d4975ef183ac,
                        limb2: 0x2629c4276bcc14b2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x34f230ce43e0fe021fa6fd51,
                        limb1: 0xd72fb2a11c9c342a00150d46,
                        limb2: 0xf5b7e334cc7e293,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x41ef742d877bb45430e9f4b9,
                        limb1: 0xdc2822db40c0ac2dfb96fb50,
                        limb2: 0x183227397098d014,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xdd2f5ce238a93c204f213f08,
                        limb1: 0x4f9b4688b6032d5a49b43486,
                        limb2: 0x14a9218e8a58c338,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc1d0844e15b0e8619b904cd,
                        limb1: 0x6fe321b3b79523b467bbe600,
                        limb2: 0x3ea480ab06ea5fe,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2bd8199258d2c66d45cadf02,
                        limb1: 0x98f78796060a2ef748c78867,
                        limb2: 0x28b70a7154c2c895,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb5e2ca4e7ce671cc894e1630,
                        limb1: 0x1ef3ce51a17d4afcab4b3c4f,
                        limb2: 0x2aed275e50be002e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbf431937d433e4bfe37a7fa2,
                        limb1: 0x73deed45f3cb7ae2982d301e,
                        limb2: 0x16d56c4f865d9c6b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4589b0a49b4fdcfd3250257c,
                        limb1: 0x45aa64b14147f2dbb5e707aa,
                        limb2: 0x1dac5a13a1b5c062,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5540cf8cdc649af7ac660568,
                        limb1: 0x5872024a3ae27642cdc46ec8,
                        limb2: 0x382610276d27045,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x89899a40687b871f09cb368a,
                        limb1: 0x157c0e97c7e3f5b177dd7cc0,
                        limb2: 0x29a7b661d52fee63,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3938f62119c62a48d33aac8,
                        limb1: 0x52eb3e4bed7266696108a58d,
                        limb2: 0x1266214dd5c151f6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3e8f57b3f23f7757c9bd99f1,
                        limb1: 0xab8ef65bd5e4a4711a5334b8,
                        limb2: 0x284f2053a92118c7,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xd8ac4df3b5b1368e68d4773e,
                        limb1: 0xa6abed3bd439c58d125468b1,
                        limb2: 0x19a9ab48aaa0d961,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfb30eee86d9b8abc7ee00682,
                        limb1: 0x11caad5ca3af681b1ef96e6b,
                        limb2: 0x29c4dd7782b8aead,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9c62747c8b8dbc3a9041be1c,
                        limb1: 0x5c677638fdba2e65b691a41b,
                        limb2: 0x2a9a470565c828c4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x87eef8320f1d6d75366aaf75,
                        limb1: 0x45ec78beef889a57cca3a8c4,
                        limb2: 0x13bc768e729cd70d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xba40b04043b48b6b8647c219,
                        limb1: 0x96646bc9e4f98b8d41f5f321,
                        limb2: 0x2bd7f79781c217c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe5e98e6eed7d8cf2f1f4d605,
                        limb1: 0xe6ebcffe8b1418dcef52f90d,
                        limb2: 0x1a4e0c86ee76422f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x85ada97fb41ebbc3d4a57da,
                        limb1: 0x70c44f5af20339528878ee32,
                        limb2: 0x173f7fb24df06ad5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2f640245685ebf8e964f5720,
                        limb1: 0xb1c78255076bf2ec1ecbc2c8,
                        limb2: 0x4a2b4d57944753d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x91980c0b0e34e6f3b2d66c90,
                        limb1: 0x1eaae54fab038bc4dcc54b37,
                        limb2: 0x2f320a47b0779387,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1761947967dfd96bad76404e,
                        limb1: 0x7f6137168c1d15ed8cf1a0f1,
                        limb2: 0x232221969eb65a44,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x78611a904f0cc197c7868daa,
                        limb1: 0x611d8ec78edd597effffef9b,
                        limb2: 0x2a00d03666209add,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x1da659845bd2ae7a3ecad080,
                        limb1: 0x79327e9ff5d4bfea5ca7c54f,
                        limb2: 0x23e7391fd9a80a90,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2585548f90b7f4402ab6ae65,
                        limb1: 0x28b4e7dd21b51bf6ced8a90,
                        limb2: 0x1e39d4300b0a3a6e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3883e5cb143e36696d8730ed,
                        limb1: 0xa44414bb2fe70f0985ca8d65,
                        limb2: 0x21b8e73490f91082,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xeafd862ee799113640f1c5e7,
                        limb1: 0xe1ea8ce9345600844bfcf7a,
                        limb2: 0x10ca1d065fa3229a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2673e019e8f88a677e968b13,
                        limb1: 0x80978dc2931cbd918e5af639,
                        limb2: 0x2e08a59cdc44429,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4ef1c450af58b1644e7861d0,
                        limb1: 0x2bc990f1bf508203c67718ed,
                        limb2: 0x14301fa063a143b0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x864e72851e1a1cee0687ba49,
                        limb1: 0xf7b1ed1a39f4c8ea2973c94a,
                        limb2: 0x1fa904a74df62bbc,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbefd7373de3d4f5b4cfbe087,
                        limb1: 0xd3560ae3443c578efd828394,
                        limb2: 0x2892e88b90172a48,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe315ce890739118771e1ce3a,
                        limb1: 0x15ece3ed85b7380b358b7aff,
                        limb2: 0x73dfa99b7091001,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4f99951cc06b11ce56cecc76,
                        limb1: 0xc0a7bbe29d47b83569488acb,
                        limb2: 0x2c21d42f6d882d74,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x89899a40687b871f09cb3679,
                        limb1: 0x157c0e97c7e3f5b177dd7cc0,
                        limb2: 0x29a7b661d52fee63,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3938f62119c62a48d33aac8,
                        limb1: 0x52eb3e4bed7266696108a58d,
                        limb2: 0x1266214dd5c151f6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3e8f57b3f23f7757c9bd99f1,
                        limb1: 0xab8ef65bd5e4a4711a5334b8,
                        limb2: 0x284f2053a92118c7,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x506ed844f0aad45f0af6b414,
                        limb1: 0x3add70f6283fdf601f307e2c,
                        limb2: 0x287800930116bcdd,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x26d84a9696d0350bfb39ca92,
                        limb1: 0x30d2be1e1f400ea58c9b4f7f,
                        limb2: 0x28711d6d5d0c7105,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1f2c2106e63bdf9f241cd7af,
                        limb1: 0x65cdcf0af762f2e8fb1c74df,
                        limb2: 0x1576b8e41f1b28af,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x34c12cded1e86db23808dc22,
                        limb1: 0x8f30ec3114d765ec4928040c,
                        limb2: 0x21344641f70abeef,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4172f82b790700736fe906fd,
                        limb1: 0xab5e1bb1f25ce357d773f1d8,
                        limb2: 0x685767c1cfcea2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb5c33556883c2cb2b2b17fe3,
                        limb1: 0xff12f6fd74d0442be7301c4b,
                        limb2: 0x21e3a616300f822c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdf16455d893b11c06b580a40,
                        limb1: 0xb3c5a5ecde41f8843df3fbf0,
                        limb2: 0x2ded3a1bd14e56b7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9db74abee3c741fc9408e872,
                        limb1: 0x828e6fc6a817f792eec61e39,
                        limb2: 0xdb2aa55ec7a34f8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe73a7330076ced0f39fd6300,
                        limb1: 0x35046d5c8ff8a41fc4deb119,
                        limb2: 0x12d1de7df39034d7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4c848e9b0e141d0d9ce1d1ed,
                        limb1: 0xb85045b68181585ce00b6b13,
                        limb2: 0x30644e72e131a029,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x6403623351874fc3361c4f,
                        limb1: 0xebc4dc1ad82697a633497aa9,
                        limb2: 0xc1e71012775ec60,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4b228e91d99defbf42d12cfe,
                        limb1: 0x82d942244bf38dd01691f42,
                        limb2: 0x2cb726dd4bf8430,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x17f4a01cb1fadae132872324,
                        limb1: 0x2e3abe239592f58ea1bfe284,
                        limb2: 0x20f40d952c5c4038,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x41842962b0bb23905d50a114,
                        limb1: 0x51df37354145a800ad9a5566,
                        limb2: 0xeff5e7a4ff895,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x948fa83e51e40a251d984456,
                        limb1: 0xc9319a113db2a00d4f9abb63,
                        limb2: 0x9846e721134b6e4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x49a898000892178dad4b4adb,
                        limb1: 0x91fa3f032fc58c3e82c73ee1,
                        limb2: 0x1abc6c12a1fbff2f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4e26c7002ff9e083a7988e80,
                        limb1: 0x24353f98b909344abaf91530,
                        limb2: 0x3b0ef67afd9cc08,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x69cae320e0f2edbb5f1b0744,
                        limb1: 0xb418ca1bc5fb08cad35becee,
                        limb2: 0x240b8c3f4eb86dd8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2f54b22451508ea32a08af7f,
                        limb1: 0xbd1898bdccdfefae96867fb7,
                        limb2: 0x185515c05c530d43,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4323d8cf272d488653e225cb,
                        limb1: 0xf5b99101ea2485182e4b526b,
                        limb2: 0x208577f30e37225f,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x88e9712a28afc38a377d72a,
                        limb1: 0x997607576d9c039fc6bb6a54,
                        limb2: 0x28c19b34b4c67b5c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9faeb5316eb2ccf4f56439ef,
                        limb1: 0x92e50c32e4c99bf478509621,
                        limb2: 0x1577fca445ea2820,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x73c5c3221fba9ee6cdef8ba3,
                        limb1: 0x9f21bb36b634c61577780afd,
                        limb2: 0x9fb63990c99633c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6a3689608c51d25687950902,
                        limb1: 0x92996f29658f5cf191ee56e9,
                        limb2: 0x21ee5f3ce8d447e2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf4e7bc80a4d7ae8263d5d3d2,
                        limb1: 0x6923782af511c10ad44bb018,
                        limb2: 0x228fa4a79cd6a9fa,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xaf08a4de080b09d3b583a72d,
                        limb1: 0xf638b51e38cd75f1ef203378,
                        limb2: 0x121368c751cf5eee,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8c5e692f70f473c559555858,
                        limb1: 0x60e3bf412f398fe8c19a4804,
                        limb2: 0x2951035227736636,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4ecb1d3e3ed224b68ced1923,
                        limb1: 0x4b24ed583a58fbf36bc1abbc,
                        limb2: 0xd8ffbdb31d8f983,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x42ac0d71c0618ebf834e86,
                        limb1: 0x6a71c3488792b5a04298e1fb,
                        limb2: 0x2172f5204215e8b0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe3884d574045e38798b8fdfb,
                        limb1: 0x95bedc78459a52d8aefeb8bc,
                        limb2: 0x1581de9d3b809869,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x881a04dea16cab4928ed4c10,
                        limb1: 0x88f1e2085d4420b25d19dcff,
                        limb2: 0x1632935c42727bea,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x59faf950eaffcf97b9681ec6,
                        limb1: 0xf17ebec82cf6a7c861226431,
                        limb2: 0x23f0072ac7236e60,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7c6df8e1d06509e0801c0323,
                        limb1: 0x2d496f6ff0ce91b01038d4e1,
                        limb2: 0xe1b527c079d8f9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1d72a4e75ceef9fae506aaa8,
                        limb1: 0x91dca431234dd5e524b0d8a0,
                        limb2: 0x147ec67a9c333e39,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa69d43d476e42ab990db69fb,
                        limb1: 0x7bf2319182866f9aac09cede,
                        limb2: 0xb1f7bbb08266a76,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x547e24b3790119980bb4a34c,
                        limb1: 0x8d236fd731e7f96f58f24ec7,
                        limb2: 0x229156a63505dfa5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7b477d378338ecac20872aa2,
                        limb1: 0xf76f0257f700c0ae5c57e01a,
                        limb2: 0xdf7a262555eef86,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x463d38208e725fa1c2f2a96,
                        limb1: 0x5af6897dfaabdfc49377bdc2,
                        limb2: 0x2217b6618f3cac5e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbc814a6fd43bb936fcccc8df,
                        limb1: 0x2f9fb87dab9887505122cb3c,
                        limb2: 0x19d81a13467a8d9f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf2d44820c1484b5762b7a374,
                        limb1: 0xc5da481ca0f1648fc57805fa,
                        limb2: 0x386de38a051efd,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8d76a80dc48f928755940c11,
                        limb1: 0x76a5e3063eac820d8a677f76,
                        limb2: 0x1f87a5a64c84059d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x69cae320e0f2edbb5f1b0733,
                        limb1: 0xb418ca1bc5fb08cad35becee,
                        limb2: 0x240b8c3f4eb86dd8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2f54b22451508ea32a08af7f,
                        limb1: 0xbd1898bdccdfefae96867fb7,
                        limb2: 0x185515c05c530d43,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4323d8cf272d488653e225cb,
                        limb1: 0xf5b99101ea2485182e4b526b,
                        limb2: 0x208577f30e37225f,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x99ca10b9ed262c1191478bf5,
                        limb1: 0x333dd81c6485bd7a33b8c29f,
                        limb2: 0x1ecd0f9d8759108c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x14616162fffacd18744a2666,
                        limb1: 0xdc2822db40c0ac2e102139b8,
                        limb2: 0x183227397098d014,
                        limb3: 0x0
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x917316f86f1660047bf74bcd,
                        limb1: 0x6241e1bf06d2270a26455eaa,
                        limb2: 0x1305a6ce7b8d6223,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xaf864b12caa3f26a99afdfd0,
                        limb1: 0x69c92795e19deeb33b8b605f,
                        limb2: 0x12f69890a98c54af,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x32570a9d49059d6dc26d8af,
                        limb1: 0xa6a911aafe1f5a07b620e755,
                        limb2: 0x22607305b940cbdf,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf300b9e5a66eb68ec7743654,
                        limb1: 0xaebd32b73d83172681e7d84a,
                        limb2: 0x1a4548fa92088a9d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9df59dbc985a2c605b44ded7,
                        limb1: 0xacdc4d0deb3760fa99a0c32b,
                        limb2: 0x2990b2158ff48256,
                        limb3: 0x0
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xab6d8d797ab156bf5493f76a,
                        limb1: 0x83d1ea4e1694d2df8ed010a7,
                        limb2: 0xf5e116df3f7dcca,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xac2717b9664a9df75b522337,
                        limb1: 0x3d647098f0c90a52529f3a0,
                        limb2: 0x105e0388e609c17e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x79b9709143e1f593effffff0,
                        limb1: 0xb85045b68181585d2833e848,
                        limb2: 0x30644e72e131a029,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x917316f86f1660047bf74bcd,
                        limb1: 0x6241e1bf06d2270a26455eaa,
                        limb2: 0x1305a6ce7b8d6223,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xaf864b12caa3f26a99afdfd0,
                        limb1: 0x69c92795e19deeb33b8b605f,
                        limb2: 0x12f69890a98c54af,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0xc6afeb89e88d39d04b5e43d4,
                limb1: 0x8f830a53f149c32bba090f07,
                limb2: 0x149cf3ba180f61cc,
                limb3: 0x0
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x86b402ce02e7c7ca81f13d51,
                    limb1: 0x39493672733a9289a36020c1,
                    limb2: 0x7f40d91dc5413d3,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x371e7b6a5c01505bd4334e81,
                    limb1: 0x2f596ae4492a87c66f7bda1a,
                    limb2: 0x9dffb4dcdb94df9,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x20669ef12954f8e3bbc8b4d3,
                    limb1: 0x396a6f7243c27ce553121ee3,
                    limb2: 0x11438ca2ec259aed,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xa560a5759c90985fde99aca0,
                    limb1: 0xc5b21186cc6dcd0421026513,
                    limb2: 0x21fb1f47c6ac55b3,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x3c26f4ff476ab777dc184776,
                    limb1: 0xbccb2cba46cf421f11eb4d14,
                    limb2: 0x27ec44064c727a3d,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xa893636703904fcbe984618c,
                    limb1: 0x73b210a224190b9b7b28784c,
                    limb2: 0x20f05486689dff6c,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x74f2a24c1853d803c1b9e310,
                    limb1: 0x9e78bb9233603b686b9d27,
                    limb2: 0x1d13a84fbcd96e81,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xe5bc08950f2f1accd92245f4,
                    limb1: 0x3b653bbe7b6cfd9074b07f89,
                    limb2: 0x1638a8a07b89463b,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x549a4dee31909bd274709d7c,
                    limb1: 0x2628a928b4ed90e98d5de1f,
                    limb2: 0x1f2c2eeb200495b,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xbae71f4f781675cce1119290,
                    limb1: 0x18995b20b8d0966bac7f5c23,
                    limb2: 0x1f7a255155ab7785,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x616d2877cb47206e625b0076,
                    limb1: 0xa7255531af3575b0a682d6df,
                    limb2: 0xdd4a0db8187661d,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xea99c54030edacb739c9ad0f,
                    limb1: 0x1e2e84792f7a12b330406ecd,
                    limb2: 0x70f1e1a9673a240,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x4ca9473b8cae66da0baf8eca,
                    limb1: 0x9ca627187edabffeb80da281,
                    limb2: 0xda800cad866dc3c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x6dcd62554ccd88a00f3e90b3,
                    limb1: 0x141b8118cd6873dc9ac01a64,
                    limb2: 0x19146bc96fa6a4bd,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xd21eca6170588371cf0fef12,
                    limb1: 0x2aae89b6d1784d7fe5d6f233,
                    limb2: 0x2fa67b7cd137898c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb20856046d39da92c0a6898a,
                    limb1: 0xc9dba030db3ed937e781ae4d,
                    limb2: 0x695a8c76fb0f771,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x919e8724022c5bd17875261b,
                    limb1: 0x3a2b09cc9362be43a8573a0,
                    limb2: 0x2cf4abb949016ad7,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x89062bf5adf784b526337420,
                    limb1: 0xf710d8fb0beb9551fe0e08f3,
                    limb2: 0x1577b6c8f024c52d,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x2cb6c8386e51647e028876a2,
                    limb1: 0x3eeb71e38623705690872fa1,
                    limb2: 0xbf610b0d76e1a8f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x92f468ac225e9f9a2b52929d,
                    limb1: 0x28e7d79e30f3f4d4abf38c05,
                    limb2: 0x2e2ba523e6456871,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0xe005b86051ef1922fe43c49e149818d1, high: 0x1f507980eece328bff7b118e820865d6
            },
            u256 {
                low: 0x4a84eb038d1fd9b74d2b9deb1beb3711, high: 0x154bc8ce8c25166a1ff39849b4e1357d
            },
            u256 {
                low: 0x3405095c8a5006c1ec188efbd080e66e, high: 0x2305d1699a6a5f92cca74147f6be1f72
            },
            u256 {
                low: 0x1775336d71eacd0549a3e80e966e1277, high: 0x144a7edf6288e1a5cc45782198a6416d
            },
            u256 {
                low: 0x2f1205544a5308cc3dfabc08935ddd72, high: 0x21c38572fcd81b5d24bace4307bf326
            },
            u256 {
                low: 0x42930b33a81ad477fb3675b89cdeb3e6, high: 0x2b70369e16febaa011af923d79fdef7c
            },
            u256 {
                low: 0x2648ee38e07405eb215663abc1f254b8, high: 0x522c9d6d7ab792809e469e6ec62b2c8
            },
            u256 {
                low: 0x85940927468ff53d864a7a50b48d73f1, high: 0xdc5dba1d977e9933c49d76fcfc6e625
            },
            u256 {
                low: 0xd344749096fd35d0adf20806e5214606, high: 0x119d0dd09466e4726b5f5241f323ca74
            },
            u256 {
                low: 0x5306f3f5151665705b7c709acb175a5a, high: 0x2592a1c37c879b741d878f9f9cdf5a86
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 5
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x76eba6c48fca7e67a1167f1b,
                    limb1: 0x99d1cf8af0d7925a391bf9a3,
                    limb2: 0x15af0f993a050918,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x5e9e86e4463f32715e203759,
                    limb1: 0xfd925ca59f135f0fcf8d28a6,
                    limb2: 0x17f65bbc426d8da,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_GRUMPKIN_12P() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0xad8494e8136779204b79fdb0,
                    limb1: 0x1106e0faf7acbea85d7ccbc4,
                    limb2: 0x221173968566d58b,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x5d010b2ab18b8fd6aef2f88c,
                    limb1: 0xce45390beb6526076f61cc3e,
                    limb2: 0x3d0ba79090b4d5e,
                    limb3: 0x0
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0x4e37d4acce2bf823caff1a12,
                    limb1: 0x66f9c676be7d9688dde7314f,
                    limb2: 0x1719179a1a7ad9d0,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x548f444afdaa53322be5c4f9,
                    limb1: 0xa4c1c68ebd65cb1ac4dac08,
                    limb2: 0xdb6596c070650a,
                    limb3: 0x0
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0xe69d4894cb24aa574eeaa5fd,
                    limb1: 0xf22c899b13bb294507d3dcf2,
                    limb2: 0x216a1fcb358c5922,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x4f39b540b4a015c9056195a9,
                    limb1: 0x2a12714697de632f568353ad,
                    limb2: 0x13e9719e40183499,
                    limb3: 0x0
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x7d1121c636a6156a1d1fb454,
                        limb1: 0xebbfc94bda59595ffc0e422e,
                        limb2: 0xf56d66ae6146942,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8d02e0aba107e335c423c98f,
                        limb1: 0x99034a3eb9db260000f34194,
                        limb2: 0x1c2c900c1577826b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3f41d031478bcd75eb8f2dc5,
                        limb1: 0xfe9fbf7bf802cdb71179012e,
                        limb2: 0x2f341c5e020335a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xfcafd87f9c05b5745e77b55a,
                        limb1: 0x7237f688c70d6c15bbe06f2a,
                        limb2: 0x1c11b6044983b9a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x447dbb42690ba4c11769446c,
                        limb1: 0x45fd2d062b82a2f0479a0d5a,
                        limb2: 0x8e7f222926da7f2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1d1ab1f040607601faf86fa3,
                        limb1: 0x703d0a758ef5a8398afcc14f,
                        limb2: 0x5de9b7e0369bc77,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe7935495f33cf7889fcc5542,
                        limb1: 0xee0028ba86c48b6707fddf2,
                        limb2: 0x892641bc20d78c2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1b394b72f6fa28c5f9a67142,
                        limb1: 0x93e9c0bc5227a04cf2cfab16,
                        limb2: 0x1c1bc7d9bc9d7cf0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4f07d1767279a7f6b38f2358,
                        limb1: 0xd7bc7ef6be6ecfd10492323c,
                        limb2: 0x9ce2af1f44c983,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xded83c84a67d9e80d2128b3e,
                        limb1: 0x4151c0487391c5a7cadc26ae,
                        limb2: 0x22ac78cb82c0a775,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x59f53598cceb585386a22347,
                        limb1: 0xdc2822db40c0ac2e86c1eb28,
                        limb2: 0x183227397098d014,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xefb8ff7e7099bfe8635adccb,
                        limb1: 0x71e20aa39a8e9bd9f9109364,
                        limb2: 0x154c9b6796782836,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x47d2b5afab37273de48fba28,
                        limb1: 0xd460d4f4b98988a04f0256f0,
                        limb2: 0xd5ebd8b75fe78b7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa277dc34d6f83aa656121ba5,
                        limb1: 0x5d764aa35e08816b9e4a073b,
                        limb2: 0x176538bb270ba73a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd44ea2c1bb860d903e6dcd2b,
                        limb1: 0x76fb6d8757d96a7962d2d6c5,
                        limb2: 0x1993c6db1d278b20,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe30507187079f0d21a8965f4,
                        limb1: 0xba91f19349b70499b11ca5a4,
                        limb2: 0x1c13c8a9b2ed793,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x25121db3881e390d3080e1e8,
                        limb1: 0xaaaa7551ea112d00a6815088,
                        limb2: 0x151afb574dada714,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1d0dcb2b8494e292dcfb55cf,
                        limb1: 0x76c3dc924e957832171bdd5a,
                        limb2: 0x2a9de22f3554e76b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbe6755dc4885bab44e044391,
                        limb1: 0xdaba2da4dcbc908da2de96b7,
                        limb2: 0x180415a308894687,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5b08340665f9b7fc6771e46d,
                        limb1: 0x4e4d473ef2339f8231ac24b,
                        limb2: 0x681c71a0be51131,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3b9c7e4b8d055208bf3f9edc,
                        limb1: 0x8cf84385f9f7eb127119ce26,
                        limb2: 0xd32e84ad8fea7f9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4c304be2b7f7cbb1447eb572,
                        limb1: 0x854ffec269a34bc7bf93e03f,
                        limb2: 0x1165b14b987a1a8d,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x531d30c60a4d8bc245e06625,
                        limb1: 0xfa2fd0a3a38f76f25e56b5bf,
                        limb2: 0x14a8f0b894d2a6bc,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x944dfcc509c5c6236bf71350,
                        limb1: 0xa3c63d36b5919f27b9d4fcdd,
                        limb2: 0x1eaf53d5a81d7fb6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc4b3ba6b09d34246cfb0a08d,
                        limb1: 0xce630576b5f5c1cc4cfed3a2,
                        limb2: 0x2049c391b9b2b20e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2d0e54f94bcab34801244ba7,
                        limb1: 0x2808246021a30e23e68df9f5,
                        limb2: 0x2e468e13173ee7cd,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5562b2eb9d5dab88e057864d,
                        limb1: 0x385ef4f8134b819200edafdb,
                        limb2: 0x16a276e3bc61e48e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x60820a1afb1ff689df5b1ff7,
                        limb1: 0x84935b417177503c16b0720e,
                        limb2: 0x2f8d183292a781ca,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x60fb1aa9d07ac2868c2e5560,
                        limb1: 0x45e3a0f03c24c956cc538111,
                        limb2: 0x2bd253e071c6fe71,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbbc10e65b6f400011010d525,
                        limb1: 0xa0d5cddfe510fc5d28f88947,
                        limb2: 0x277b29495c4d13c7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe38832d32c9f5cc5e2335146,
                        limb1: 0x9f85506e802529aa937e7626,
                        limb2: 0x2f3e6161e5aff90c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa3b2d01e8c574eeca0c941a1,
                        limb1: 0xd0c965596f94fedc53c06733,
                        limb2: 0x1b434ee1e5257b4d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x47f1c9db23594a09a24cdc18,
                        limb1: 0x38828767397650044405e82e,
                        limb2: 0x11955d397648abe,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x272d006a3c38ddfdf646d1fc,
                        limb1: 0xa2fd31e7aa595182ffcd7186,
                        limb2: 0x29b9323a15ac024d,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xe2828d24a4d9ee30e6f7568d,
                        limb1: 0x327f78d6c892696fb785788f,
                        limb2: 0x190c21b60b9255b0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9ba1222bf4c030c78274a35d,
                        limb1: 0x7f2338503564a72c89dbc375,
                        limb2: 0xeaaf1fb90121c9b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7d8f55991c75bd27b8cc2a14,
                        limb1: 0x45f77e914efb8320e6e8af96,
                        limb2: 0x25cdfd9c52f88697,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1e0525bc5fa47b87ae103cf9,
                        limb1: 0x602381152aaa510d2e37ace,
                        limb2: 0x160328e491968c86,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xae36ada177001ede116ff4f5,
                        limb1: 0x29000fe355e392c8b44f3f45,
                        limb2: 0x1fee06ca0913c812,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8055f741a82427d1ad831b44,
                        limb1: 0x125668305d6deeeca91f082c,
                        limb2: 0x358ad1326deefff,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x841bd60e7e0657aa1bd1a7b,
                        limb1: 0x60addd81b6809c9b3503c009,
                        limb2: 0x1af85a73c46c8f6f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x85ad4893028a2d0c5c40e95c,
                        limb1: 0xaf075d0b2ebd86784a27cdfd,
                        limb2: 0x1d028ec0f4cfca05,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xcf98a694a4cec7231f0b6ad,
                        limb1: 0xc818e50c0bbd0440a2223a18,
                        limb2: 0x7455f8245dac326,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe8f2a6c36c2464de9c1c937,
                        limb1: 0xfb887786bb243d6d3534cdf2,
                        limb2: 0xbcdaf025132407f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x898aef35a85cf566619a3705,
                        limb1: 0x524be502e1ec9a78db442436,
                        limb2: 0x129d264f2f97441c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5b08340665f9b7fc6771e45c,
                        limb1: 0x4e4d473ef2339f8231ac24b,
                        limb2: 0x681c71a0be51131,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3b9c7e4b8d055208bf3f9edc,
                        limb1: 0x8cf84385f9f7eb127119ce26,
                        limb2: 0xd32e84ad8fea7f9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4c304be2b7f7cbb1447eb572,
                        limb1: 0x854ffec269a34bc7bf93e03f,
                        limb2: 0x1165b14b987a1a8d,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x64b28e1872cc982a75f00aa1,
                        limb1: 0xe7e9da21c9e90d0841c299fa,
                        limb2: 0x20e5ea37a5f8023b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb6807fc61093533cc41138dc,
                        limb1: 0xf6734adcd1a176a9478bf8f7,
                        limb2: 0x2be35ed14740fa89,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbf6e5dbfa3ee8624c59dfe2e,
                        limb1: 0x7f9cc67ef72b7c08a3d6c3c1,
                        limb2: 0x2e3b9c79cb013d3e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6767e30bb01e3b04b82cad59,
                        limb1: 0x46ab581f738fe49cfc24b5d6,
                        limb2: 0x40aa788908df8c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x988dd3dc543158f87c57dd7a,
                        limb1: 0x9d4c33626f4a70d26c30b0d2,
                        limb2: 0x18f256bb15f92a2e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa8923424398f61b575014a39,
                        limb1: 0xca750ddb88e199423cdd7819,
                        limb2: 0x1f77a2b3f709d69a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8068dcc1e9e55920f2cfa22d,
                        limb1: 0x699f33e79cfa7d8fa16a882e,
                        limb2: 0x4c9506127dfc979,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd235e19d1576666209c4c468,
                        limb1: 0xfcc715d9b88e6d49dca56a0d,
                        limb2: 0x1d03ed1a0f1b6df5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4d147c7d74128a4220193c3a,
                        limb1: 0x8dd4782d68919f5df86b7a84,
                        limb2: 0xeddcb21a36c9b38,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xede96982d0576a9903717dfc,
                        limb1: 0x582aa465c59b02ba4ad466a9,
                        limb2: 0x1d0406963b939aaf,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xde6d036c92a46c280c10054e,
                        limb1: 0xdc2822db40c0ac2e51cad69e,
                        limb2: 0x183227397098d014,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xe245eb424c0fe2686433c2ba,
                        limb1: 0xeba80885fa443da886bc251c,
                        limb2: 0x12aaacd03ec205df,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5969f4c7f2bcf527ae669f54,
                        limb1: 0x3f7466954453146664d49d16,
                        limb2: 0x768bda598bbdfbf,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x49a05ec264fc310fe8139792,
                        limb1: 0x67b22a30bcdd967eb1a178e9,
                        limb2: 0x2662ac1c968c7931,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xec465cf57888469b8019fc99,
                        limb1: 0xd942e8a7bd956332feef9f42,
                        limb2: 0x81dc3cad767c315,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc19e926e7e295df95d84c54e,
                        limb1: 0xebec0a3c845d62bde38884dc,
                        limb2: 0xb29481c46b37483,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdd8bfae75eea8100348d3475,
                        limb1: 0x5b76d22d5e5a0acb5f76833a,
                        limb2: 0x31645a26c4185f6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x54b7b495318b0aaa9c5dabe0,
                        limb1: 0x2c2f35506a47dd5730391990,
                        limb2: 0x29ce5edd9a9db995,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x34d0d4d25b91c9021b9040fd,
                        limb1: 0xfd1b3aea9f6af5ac5cabc719,
                        limb2: 0x1222bc9ca9fc17e9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4306057e45e0abd5964f7dc3,
                        limb1: 0x449c06d7a17e5b043b11d581,
                        limb2: 0x2da7d91a4439939d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x399b147a7078b9c362011589,
                        limb1: 0x5eec062c5e6c3a7a3e552a31,
                        limb2: 0x24d8aab026dad659,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xab7d0c1dfd334cadc4f99910,
                        limb1: 0x2f5d1946a2d273e73f297ab4,
                        limb2: 0x1c5e0d4803661648,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x80997b22fa68005b7ce60709,
                        limb1: 0xa00caec1d085f60fcd2c7e25,
                        limb2: 0x9fd1cf79040122f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf8727e39b21a34186c1ceb11,
                        limb1: 0xc57dbe73ce56f06a87e71a3a,
                        limb2: 0x113729c582c447c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7e0c6fb7873634780a96625b,
                        limb1: 0x44bb7318e9c630db5a1f58be,
                        limb2: 0x19397444fc8a30a7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x49b1ce55f9d22453de54e0e2,
                        limb1: 0x96842e36d4742f9f49a19011,
                        limb2: 0x10b07ffdceefcc25,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf8349f10985a30cc20678dd3,
                        limb1: 0xe995d419adf3917dad587bc4,
                        limb2: 0x13c1661909132c56,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x143dd839b9373382d8cfd3a7,
                        limb1: 0x47af77782844c34caac93cab,
                        limb2: 0x2481614a8346ae67,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xcb11e0f09a7531757129b0e9,
                        limb1: 0xa77a89012c5a61ea138b1a7,
                        limb2: 0x142c2b0b0392bc0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd4ef014b8a59dbe8ddc8d419,
                        limb1: 0x2a77422cd6fd95aa5ae5a293,
                        limb2: 0x2bb93be21beea4f9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x533887c97746afab0f4f0179,
                        limb1: 0xb54367fdfd1ae17f65fb5cf1,
                        limb2: 0x10d8dfdbb18a474b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe3b192e09493f9adfed2a21f,
                        limb1: 0x3b2db59f01ea0006cc1a4a21,
                        limb2: 0x1bf83ddb034ae6e8,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x46aa8c492fb77f042646cead,
                        limb1: 0xd14d1b0a5eab12517aa53d3a,
                        limb2: 0x149cda1210c44ba5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6cf9a075d49d3d5378c8e91b,
                        limb1: 0x48060ba4a0727e40a8e6454,
                        limb2: 0xe816b47af57564b,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x4d6d7491ce1fae1ce89011ad,
                        limb1: 0x64095717ec01525b26ece310,
                        limb2: 0x1568ab4ffd78fd45,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7d23106cad1999193b2f6b6f,
                        limb1: 0xf2360139faffae4ac67d4a5d,
                        limb2: 0x133853597f1b04c9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc47ddd09019c2c08b6b2ef5c,
                        limb1: 0x318f02be8a5bd6ae671dac78,
                        limb2: 0x18eedc625162b600,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9ec610a916a912d0b279fc94,
                        limb1: 0xa7276685e7dcb05d116e4a84,
                        limb2: 0x19dd97b09472f1e9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x64c7fdb6a1858de83895852a,
                        limb1: 0x7608cf6a8024e73ee9936b8f,
                        limb2: 0xb3c2d906b97a3a3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd0e25f65b4b95a05ab31bce,
                        limb1: 0xd1e7ae3fa64375a82f6aa49,
                        limb2: 0x224c5ac6476433ff,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6df0f7902889f4f22de192c8,
                        limb1: 0xb6d474024563ddde262f88ec,
                        limb2: 0x174a0fcec4d6d29f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x93d2846f44a8bbe118f07488,
                        limb1: 0x274f08a578cc7cd7d58ba62b,
                        limb2: 0x2998e6d925513f1e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5bca698f91e71103945da92,
                        limb1: 0x521eb943bd0b8555f685da2d,
                        limb2: 0x135c211f788bb20,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xafd60fd42c002d344a4b3dd4,
                        limb1: 0x3a9656a2b8a977f4173417f9,
                        limb2: 0x2c830500759a9fc4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x92c16c8131fd493f66fd16f7,
                        limb1: 0xb0f465ade7eb6f4bcf1b3ee,
                        limb2: 0x13ceeb513c24dec0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4306057e45e0abd5964f7db2,
                        limb1: 0x449c06d7a17e5b043b11d581,
                        limb2: 0x2da7d91a4439939d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x399b147a7078b9c362011589,
                        limb1: 0x5eec062c5e6c3a7a3e552a31,
                        limb2: 0x24d8aab026dad659,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xab7d0c1dfd334cadc4f99910,
                        limb1: 0x2f5d1946a2d273e73f297ab4,
                        limb2: 0x1c5e0d4803661648,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xa0dc42aa93414776c437858e,
                        limb1: 0x4820afea17f4a7e33d2b21cd,
                        limb2: 0x21ce53fd9aa22f31,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x14616162fffacd18744a2666,
                        limb1: 0xdc2822db40c0ac2e102139b8,
                        limb2: 0x183227397098d014,
                        limb3: 0x0
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x973669eb75388a38e5806536,
                        limb1: 0x8396da78974c26ef9af6744a,
                        limb2: 0x1a789b88bd261045,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbe9dc3e0ee7348acc6163ff3,
                        limb1: 0x177a3b5b30c9f0ec6aacc24e,
                        limb2: 0x28456580725c0d60,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xf69083c5cf1e9eae214850c0,
                        limb1: 0x18298bce9f9aebc7e0543b10,
                        limb2: 0x22503ff1f01e0efb,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8ad109fc2c76e1d900d455ea,
                        limb1: 0x177362cee3ed7c7c3ed836ef,
                        limb2: 0x1d0ad53790bebf87,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7c098b858a12d98ec0be3cca,
                        limb1: 0x486579d8ce39f446e4dbf284,
                        limb2: 0x1fedaf1ba56c3365,
                        limb3: 0x0
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xb6a15d09de126a0022794774,
                        limb1: 0x761e371f02feddba47a959e0,
                        limb2: 0x21e8bc683c692d03,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7963969324959031e885c0ec,
                        limb1: 0x3d9624a3592b2dc24591b504,
                        limb2: 0x2944db3399cb7f10,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x79b9709143e1f593effffff0,
                        limb1: 0xb85045b68181585d2833e848,
                        limb2: 0x30644e72e131a029,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x973669eb75388a38e5806536,
                        limb1: 0x8396da78974c26ef9af6744a,
                        limb2: 0x1a789b88bd261045,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbe9dc3e0ee7348acc6163ff3,
                        limb1: 0x177a3b5b30c9f0ec6aacc24e,
                        limb2: 0x28456580725c0d60,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x41a2045d547a05197dd45f5b,
                limb1: 0x4a657f10b2f35ec8eccb3f48,
                limb2: 0x132e641050e11e0c,
                limb3: 0x0
            },
            g_rhs_sqrt: array![
                u384 {
                    limb0: 0x1b7702f81bbddabd891daead,
                    limb1: 0xa03962c7fe2c4144ab1f7dd5,
                    limb2: 0x210a13f8b357f4e,
                    limb3: 0x0
                }
            ]
                .span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x86b402ce02e7c7ca81f13d51,
                    limb1: 0x39493672733a9289a36020c1,
                    limb2: 0x7f40d91dc5413d3,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x371e7b6a5c01505bd4334e81,
                    limb1: 0x2f596ae4492a87c66f7bda1a,
                    limb2: 0x9dffb4dcdb94df9,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x20669ef12954f8e3bbc8b4d3,
                    limb1: 0x396a6f7243c27ce553121ee3,
                    limb2: 0x11438ca2ec259aed,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xa560a5759c90985fde99aca0,
                    limb1: 0xc5b21186cc6dcd0421026513,
                    limb2: 0x21fb1f47c6ac55b3,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x3c26f4ff476ab777dc184776,
                    limb1: 0xbccb2cba46cf421f11eb4d14,
                    limb2: 0x27ec44064c727a3d,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xa893636703904fcbe984618c,
                    limb1: 0x73b210a224190b9b7b28784c,
                    limb2: 0x20f05486689dff6c,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x74f2a24c1853d803c1b9e310,
                    limb1: 0x9e78bb9233603b686b9d27,
                    limb2: 0x1d13a84fbcd96e81,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xe5bc08950f2f1accd92245f4,
                    limb1: 0x3b653bbe7b6cfd9074b07f89,
                    limb2: 0x1638a8a07b89463b,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x549a4dee31909bd274709d7c,
                    limb1: 0x2628a928b4ed90e98d5de1f,
                    limb2: 0x1f2c2eeb200495b,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xbae71f4f781675cce1119290,
                    limb1: 0x18995b20b8d0966bac7f5c23,
                    limb2: 0x1f7a255155ab7785,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x616d2877cb47206e625b0076,
                    limb1: 0xa7255531af3575b0a682d6df,
                    limb2: 0xdd4a0db8187661d,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xea99c54030edacb739c9ad0f,
                    limb1: 0x1e2e84792f7a12b330406ecd,
                    limb2: 0x70f1e1a9673a240,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x4ca9473b8cae66da0baf8eca,
                    limb1: 0x9ca627187edabffeb80da281,
                    limb2: 0xda800cad866dc3c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x6dcd62554ccd88a00f3e90b3,
                    limb1: 0x141b8118cd6873dc9ac01a64,
                    limb2: 0x19146bc96fa6a4bd,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xd21eca6170588371cf0fef12,
                    limb1: 0x2aae89b6d1784d7fe5d6f233,
                    limb2: 0x2fa67b7cd137898c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb20856046d39da92c0a6898a,
                    limb1: 0xc9dba030db3ed937e781ae4d,
                    limb2: 0x695a8c76fb0f771,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x919e8724022c5bd17875261b,
                    limb1: 0x3a2b09cc9362be43a8573a0,
                    limb2: 0x2cf4abb949016ad7,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x89062bf5adf784b526337420,
                    limb1: 0xf710d8fb0beb9551fe0e08f3,
                    limb2: 0x1577b6c8f024c52d,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x2cb6c8386e51647e028876a2,
                    limb1: 0x3eeb71e38623705690872fa1,
                    limb2: 0xbf610b0d76e1a8f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x92f468ac225e9f9a2b52929d,
                    limb1: 0x28e7d79e30f3f4d4abf38c05,
                    limb2: 0x2e2ba523e6456871,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x7bfeb500d87c8d6a89e3b500,
                    limb1: 0x114bfa8db0c1f0065e73cf9a,
                    limb2: 0x129e9c5a3641b28e,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x755ef61cf917721bfef36992,
                    limb1: 0x8f3d6b6348b89a2c0cfa9d3f,
                    limb2: 0x272de7db2186fd11,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0x4a84eb038d1fd9b74d2b9deb1beb3711, high: 0x154bc8ce8c25166a1ff39849b4e1357d
            },
            u256 {
                low: 0x3405095c8a5006c1ec188efbd080e66e, high: 0x2305d1699a6a5f92cca74147f6be1f72
            },
            u256 {
                low: 0x1775336d71eacd0549a3e80e966e1277, high: 0x144a7edf6288e1a5cc45782198a6416d
            },
            u256 {
                low: 0x2f1205544a5308cc3dfabc08935ddd72, high: 0x21c38572fcd81b5d24bace4307bf326
            },
            u256 {
                low: 0x42930b33a81ad477fb3675b89cdeb3e6, high: 0x2b70369e16febaa011af923d79fdef7c
            },
            u256 {
                low: 0x2648ee38e07405eb215663abc1f254b8, high: 0x522c9d6d7ab792809e469e6ec62b2c8
            },
            u256 {
                low: 0x85940927468ff53d864a7a50b48d73f1, high: 0xdc5dba1d977e9933c49d76fcfc6e625
            },
            u256 {
                low: 0xd344749096fd35d0adf20806e5214606, high: 0x119d0dd09466e4726b5f5241f323ca74
            },
            u256 {
                low: 0x5306f3f5151665705b7c709acb175a5a, high: 0x2592a1c37c879b741d878f9f9cdf5a86
            },
            u256 {
                low: 0x30bcab0ed857010255d44936a1515607, high: 0x1158af9fbb42e0b20426465e3e37952d
            },
            u256 {
                low: 0x5f3f563838701a14b490b6081dfc8352, high: 0x1b45bb86552116dd2ba4b180cb69ca38
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 5
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x58e8c62727bd58b1847d5e1d,
                    limb1: 0x20564e0613740967122967a3,
                    limb2: 0xc7c708c96cd0b25,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd893400d48ccf8414624fb95,
                    limb1: 0xc289afa9c3e752bb82dd8543,
                    limb2: 0x4f5b298e2aaddef,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_BN254_1P_edge_case() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high_shifted: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0xc7c2c14510d62220cdc7b3c7,
                limb1: 0x5a684b4bc2b37a7ee0634d2c,
                limb2: 0x17eef8e7e4dd2e33,
                limb3: 0x0
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![u256 { low: 0x0, high: 0x0 },].span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 0
        );
        assert!(
            res == G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            }
        );
    }


    #[test]
    fn test_msm_BN254_2P_edge_case() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high_shifted: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x60c349ba17c1d4434209b924,
                limb1: 0xb4b96efd8be92cde9de1280e,
                limb2: 0x6e55e1a8666f8e3,
                limb3: 0x0
            },
            g_rhs_sqrt: array![
                u384 {
                    limb0: 0xd35ab3554d3a17e69bc90c5e,
                    limb1: 0xffde96e368c26798d24bad63,
                    limb2: 0x1147ab0976577bd3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x48f5fc1455c8dd38358b75b1,
                    limb1: 0x806fc9ed4ccac3f93bbf2adf,
                    limb2: 0xa77478d31681d27,
                    limb3: 0x0
                }
            ]
                .span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x5c724369afbc772d02aed58e,
                    limb1: 0x2cd3bc838c66439a3d6160b,
                    limb2: 0x72f26b55fb56be1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x772ca79c580e121ca148fe75,
                    limb1: 0xce2f55e418ca01b3d6d1014b,
                    limb2: 0x2884b1dc4e84e30f,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0xb4862b21fb97d43588561712e8e5216a, high: 0x967d0cae6f4590b9a164106cf6a659e
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 0
        );
        assert!(
            res == G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            }
        );
    }


    #[test]
    fn test_msm_BN254_3P_edge_case() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0x5b9b511a35490c4f05d6e4e7,
                    limb1: 0xf11ec8642a0df9cb0b8f2cdd,
                    limb2: 0x2b568cd4a3e221ca,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb45c3680d8359a0fdb47de6f,
                    limb1: 0x4c17fe1c96f237095df8c737,
                    limb2: 0x118fc0474955ac2b,
                    limb3: 0x0
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0x47bec5e5e1f295cdcd7689e9,
                    limb1: 0xcb171283d651071401630545,
                    limb2: 0xa401c0298cd5f83,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xe5d2831c05e61956d8725b57,
                    limb1: 0x6bb84991518471727263fde0,
                    limb2: 0x15e82f62ee3caf32,
                    limb3: 0x0
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0xd15f8e23aaf3af13ab5ba169,
                    limb1: 0xb0ff9631870f189040aec289,
                    limb2: 0x1c77509b88d3bab7,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb620e3716b30b1003beab421,
                    limb1: 0x1d6aad1137155249c5d4f785,
                    limb2: 0xbf95d2db0be45f9,
                    limb3: 0x0
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x405f71fc00076527e6fc4c78,
                        limb1: 0x8f18daa35c7ff6a960bb5b70,
                        limb2: 0x1acf52b3d2e4d78c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x55e1ce0e388c458a64de1245,
                        limb1: 0xb85045b68181585d899bbe7f,
                        limb2: 0x30644e72e131a029,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x5216182e9954282e5165d882,
                        limb1: 0xee6d9c3bb968e7795eb593da,
                        limb2: 0x177a7ed9a366cff7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x21dbaba28fbba1e6e8e0352d,
                        limb1: 0x832ea73bd944e7d1c99a888c,
                        limb2: 0xfec2b187b6ab9bc,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x7f5148b9d01ce644c0551d1d,
                        limb1: 0xea7e65b88ff441961f0e382c,
                        limb2: 0x77540b6fa020ca1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9d966e013d09193481e80906,
                        limb1: 0x34a3efbaf588ae0deca14017,
                        limb2: 0xd794d7aa57b6d27,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x389f846ccb041083a10cb9ff,
                        limb1: 0x6a448b23b92648c8a242bcc3,
                        limb2: 0x228a9ea16b505f32,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x8dd07dfe8fdbec741bb48c3f,
                        limb1: 0x12f88efcaab95e0e849f50fd,
                        limb2: 0x160b2e1a0902cfbe,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x659302e7af32e5b4baa09f87,
                        limb1: 0x898bf5b38bceb7755ccf99a4,
                        limb2: 0x2fc4814972402d35,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 {
                        limb0: 0x5216182e9954282e5165d882,
                        limb1: 0xee6d9c3bb968e7795eb593da,
                        limb2: 0x177a7ed9a366cff7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x21dbaba28fbba1e6e8e0352d,
                        limb1: 0x832ea73bd944e7d1c99a888c,
                        limb2: 0xfec2b187b6ab9bc,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x27f4d0d676cdd860c4d1fa6f,
                        limb1: 0xe65386ac1951a13cd4f02a75,
                        limb2: 0xd2f1b8c9dfc2c96,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5be57268705f4a795a64db97,
                        limb1: 0xdc2822db40c0ac2ebd2b6c30,
                        limb2: 0x183227397098d014,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x56063c8c991bc325c89db352,
                        limb1: 0x714aae2911782fd7314a08b5,
                        limb2: 0x757a6155c5ca7ad,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xcd466c49a6f18c5148c392e4,
                        limb1: 0xf0e61765ab80822b3c454592,
                        limb2: 0x9e4d77a54ddbd9,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xf0c06ca91ca69b071361bb3b,
                        limb1: 0x14a5ec278cd5ce650ed8a951,
                        limb2: 0x1fe39905c3c30e6f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6273f5753079b21e51dc95d0,
                        limb1: 0xa13b582e80dd3ed1bd56b763,
                        limb2: 0x175816dcf2342dc4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8d515b1af421f13038e172f0,
                        limb1: 0xae4b61cb0c64b0a2f27bc490,
                        limb2: 0xdebd80bd3a7da0a,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x212b5a5cb53497159d919f6,
                        limb1: 0x53e00a7b34688f8593de1a20,
                        limb2: 0x1606f2401515f708,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x67d344dcf4d4a4f3da4ab8ac,
                        limb1: 0xd2b2463102818681b4cfd0b8,
                        limb2: 0x1dae866efe9938d,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 {
                        limb0: 0x56063c8c991bc325c89db352,
                        limb1: 0x714aae2911782fd7314a08b5,
                        limb2: 0x757a6155c5ca7ad,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xcd466c49a6f18c5148c392e4,
                        limb1: 0xf0e61765ab80822b3c454592,
                        limb2: 0x9e4d77a54ddbd9,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xf31bdf775ed460cbb09a77a4,
                        limb1: 0xbbc894efc25ad7150f2b950a,
                        limb2: 0x29528e7e585ce271,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8bbd8e60fc1a1859e888a509,
                        limb1: 0xdc2822db40c0ac2e47c7fadc,
                        limb2: 0x183227397098d014,
                        limb3: 0x0
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xf3f8288b819d04552d495ec1,
                        limb1: 0x5637b5a04eaec6328f049790,
                        limb2: 0x196a7a54ca00e273,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4f537683af3a47355faad1f5,
                        limb1: 0x3c399d01242138b9556fa2c2,
                        limb2: 0x9ace1d4bf9085ee,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xe42601d9feb3ab9f2b5ae3c1,
                        limb1: 0x45b721c6cecc99dcd79013a2,
                        limb2: 0x1d1a0e768059ba78,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf080a40759b90d6a683d3e76,
                        limb1: 0xe23206d3cafbfeab3d6884f,
                        limb2: 0x1cebdd881068dc2f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x7a61a762fe584ff4f91e5ac,
                        limb1: 0xfab1f33e1518d8901d1cc2c0,
                        limb2: 0x173b3f764519e6cd,
                        limb3: 0x0
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x7376af1548b680e8af5f1efc,
                        limb1: 0x4a56db2a6a8afa3a158c5c21,
                        limb2: 0x1bdb208b7cd10730,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xedfa638b0daed5a01f0075df,
                        limb1: 0xb4acd7036c63aa2c004ee846,
                        limb2: 0x1d06a57e3eb191ca,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 {
                        limb0: 0xf3f8288b819d04552d495ec1,
                        limb1: 0x5637b5a04eaec6328f049790,
                        limb2: 0x196a7a54ca00e273,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4f537683af3a47355faad1f5,
                        limb1: 0x3c399d01242138b9556fa2c2,
                        limb2: 0x9ace1d4bf9085ee,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x91b2f2a1b63488947587b29f,
                limb1: 0x272207211ee84c7a00242db6,
                limb2: 0x111e3c81a23fb2b4,
                limb3: 0x0
            },
            g_rhs_sqrt: array![
                u384 {
                    limb0: 0x258b01b2858d51de8acd178c,
                    limb1: 0x6a34cc2dcf1f37f6ab367139,
                    limb2: 0x28d10e632d4cdfe,
                    limb3: 0x0
                }
            ]
                .span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x5c724369afbc772d02aed58e,
                    limb1: 0x2cd3bc838c66439a3d6160b,
                    limb2: 0x72f26b55fb56be1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x772ca79c580e121ca148fe75,
                    limb1: 0xce2f55e418ca01b3d6d1014b,
                    limb2: 0x2884b1dc4e84e30f,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x536c985db33c69f7c242e07a,
                    limb1: 0xfc531bccffafcf1e59d91fb9,
                    limb2: 0x2585e4f8a31664cb,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x57fa42444057cf0c1d62ae3c,
                    limb1: 0x4f48d341183118d68ea41313,
                    limb2: 0x1d2d2799db056ed1,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0x12e0c8b2bad640fb19488dec4f65d4d9, high: 0x1521f387af19922ad9b8a714e61a441c
            },
            u256 {
                low: 0x5a92118719c78df48f4ff31e78de5857, high: 0x28fcb26f9c6316b950f244556f25e2a2
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 0
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x21725fdb9f487676e547051,
                    limb1: 0xc23930e4f96498a77a316418,
                    limb2: 0x1244cb13309195ed,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x6251c487cf0f5a44ac24a45b,
                    limb1: 0xf1db336c10ce7fae206dd8dd,
                    limb2: 0x1da9c56792006d76,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_BLS12_381_1P_edge_case() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high_shifted: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x933cf0c20f38001183ed9df6,
                limb1: 0xcb294eff7864b62ddb3adf3d,
                limb2: 0xe7801e5dd2b70de9e4b1af57,
                limb3: 0x4b3b4eaca402c3b711f869b
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![u256 { low: 0x0, high: 0x0 },].span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 1
        );
        assert!(
            res == G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            }
        );
    }


    #[test]
    fn test_msm_BLS12_381_2P_edge_case() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high_shifted: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0xbd7c0a86fc43972d8b51dd60,
                limb1: 0xcfceb99ca4a950898233fc8c,
                limb2: 0x830b2ea5189bbb6905ef8511,
                limb3: 0x1a2bb55cd901d35f38f4ff5
            },
            g_rhs_sqrt: array![
                u384 {
                    limb0: 0x4f4fd082399091404d2f02a7,
                    limb1: 0x81d93e4dc28e48b38d24fa0a,
                    limb2: 0xcc9039d4ba7ae8849e2f2064,
                    limb3: 0x680f0068cb18a987654e66b
                }
            ]
                .span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xe4f817e54aede0613c17035c,
                    limb1: 0xdff1f15010392a6da1f95a6,
                    limb2: 0xbed78d3d341e911d49f15454,
                    limb3: 0x18154782ce0913b21588066d
                },
                y: u384 {
                    limb0: 0x3d77d61326ef5a9a5a681757,
                    limb1: 0xd3070afd4f0e121de7fcee60,
                    limb2: 0xdf9ef4088763fe611fb85858,
                    limb3: 0x11a612bdd0bc09562856a70
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0xb4862b21fb97d43588561712e8e5216a, high: 0x12cfa194e6f4590b9a164106cf6a659e
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 1
        );
        assert!(
            res == G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            }
        );
    }


    #[test]
    fn test_msm_BLS12_381_3P_edge_case() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0xf6a31a9a41fd0378150dc360,
                    limb1: 0x7a355df87079a4cf4c78fd36,
                    limb2: 0xbd92b81f9f87a14ded17256e,
                    limb3: 0x1259b26908470ad4f6be037c
                },
                y: u384 {
                    limb0: 0xfbe2abbd7e05b561703438fe,
                    limb1: 0x892d1cc404bcc0c000d206cf,
                    limb2: 0x962b60138682dd48428b2a8d,
                    limb3: 0xa68b20ba71d8fde199d485b
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0x7c866be61fbaed5ef7d1122e,
                    limb1: 0x7fed89acb87ce49d38175a6f,
                    limb2: 0x30dbb6ee5876fa6873045668,
                    limb3: 0x60c4285948cc11859881060
                },
                y: u384 {
                    limb0: 0x5a931aaa036da6ee08c49738,
                    limb1: 0x1c92b3a560ce474174cfa275,
                    limb2: 0xa4f783dad6c9da34040c6553,
                    limb3: 0x8d9752128e5b2be6254e2b
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0x663acbe46ab1edf9e0302ddb,
                    limb1: 0x133eafb6b82660d39354a91b,
                    limb2: 0xec9146f8b18f4ccfa8f938e,
                    limb3: 0x1127139158d2558af3ede6c1
                },
                y: u384 {
                    limb0: 0x2e2dc7b89be127d3eee7e15f,
                    limb1: 0xb9b688b1096640c721587415,
                    limb2: 0xd09f1d870e1c2d4e08674d2b,
                    limb3: 0x12308a0685f2c08876496459
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x7bc762e158a515b52d821792,
                        limb1: 0x6ecca75faa6f0257a0026f0,
                        limb2: 0x54035e714db9d186af76bd14,
                        limb3: 0x6741a842e9567e705af8ef4
                    },
                    u384 {
                        limb0: 0x9ec40380b66ab9738c60bfa9,
                        limb1: 0x6730d2a0f6b0f62410c653ec,
                        limb2: 0x434bacd764774b84f38512bf,
                        limb3: 0x1a0111ea397fe69a4b1ba7b6
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x72e3a1aba373f660d9374982,
                        limb1: 0x7f6c533e38820545e6743293,
                        limb2: 0x4a14d7b2c73830dd1036e44b,
                        limb3: 0x163220ef11c45701b870d3ce
                    },
                    u384 {
                        limb0: 0x5e1fef3acc783347caf29623,
                        limb1: 0xb8764fb1d07b13e339cae211,
                        limb2: 0xeccab81b7e73d7d6d7d92107,
                        limb3: 0x114aa51d9c7f621b2257782d
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xc777357daa6aa6c4ebef18c7,
                        limb1: 0x80736b12a17997bf6e675de5,
                        limb2: 0x7695e787d8535cdeb6df21c3,
                        limb3: 0x45a863fbf06f8c4f9075629
                    },
                    u384 {
                        limb0: 0x9d9a9c620cf8011b609cd9bf,
                        limb1: 0x5e601cc474976cd361c63721,
                        limb2: 0xdc45e17f1a6a0e748a8474a5,
                        limb3: 0x70bdc9e64717c3a0bd18e8b
                    },
                    u384 {
                        limb0: 0xe99ceeb08e413423167a42d6,
                        limb1: 0xbbb460d6a22df80bf24d7d86,
                        limb2: 0xe8dbed95ff300f747a6b6edb,
                        limb3: 0xc798d1b717ca47003bdda9e
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xb79286af5fd2d98364de2607,
                        limb1: 0xc81ed515fdf532ab3dccca51,
                        limb2: 0x5e705844ef7ae0e5664c58ef,
                        limb3: 0xac54dfd9a91a83800705816
                    },
                    u384 {
                        limb0: 0x15d7bcebbde2cd1f2bcb0336,
                        limb1: 0x13779985548a6344a9d38848,
                        limb2: 0x2c9386bf30e0c851785a5ea0,
                        limb3: 0x112870a1fefdbb37f326914b
                    },
                    u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 {
                        limb0: 0x72e3a1aba373f660d9374982,
                        limb1: 0x7f6c533e38820545e6743293,
                        limb2: 0x4a14d7b2c73830dd1036e44b,
                        limb3: 0x163220ef11c45701b870d3ce
                    },
                    u384 {
                        limb0: 0x5e1fef3acc783347caf29623,
                        limb1: 0xb8764fb1d07b13e339cae211,
                        limb2: 0xeccab81b7e73d7d6d7d92107,
                        limb3: 0x114aa51d9c7f621b2257782d
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x5019495f08aacfea0142907a,
                        limb1: 0x5c6c84c98c4bdbff212b9f6f,
                        limb2: 0x74629b821dc449cf706989ca,
                        limb3: 0xd852403077491f348815589
                    },
                    u384 {
                        limb0: 0x515834b7b494091d02ac60ea,
                        limb1: 0xb39869507b587b11fb48a4ec,
                        limb2: 0x21a5d66bb23ba5c279c2895f,
                        limb3: 0xd0088f51cbff34d258dd3db
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x212dea0ff4fe177f1e0b0298,
                        limb1: 0x9f459b636eadb91eead4e97a,
                        limb2: 0x75eb15d611e1fb6bff9b473f,
                        limb3: 0x531c91c12c79d937ef79a92
                    },
                    u384 {
                        limb0: 0x26e89def34bb4960e82f9caa,
                        limb1: 0x4b8d515c91c6ddf12f8084da,
                        limb2: 0x36360c75610d33375e66dd4e,
                        limb3: 0x3970316d6b9c53d7471c394
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xce3933f42d6e07280a6555fd,
                        limb1: 0xcf6637cf3132966601952da7,
                        limb2: 0x1ba13bcd292f9580d238e4d5,
                        limb3: 0x55cb80b014630f65d21697c
                    },
                    u384 {
                        limb0: 0xec23d12308aea492320ab446,
                        limb1: 0xc547fbcf9c08f7a7b20a2f31,
                        limb2: 0x56f288207b6283a0c20629d3,
                        limb3: 0xb6493b88317b20ee1743bea
                    },
                    u384 {
                        limb0: 0x668633e5546177aa7d419d1a,
                        limb1: 0x6c68d1c1d2a25741cfd4c2df,
                        limb2: 0x1d5ec99fa64509524c49a8da,
                        limb3: 0xc601a6fda782877abd32782
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x84b7a83fd3f85dfc782c0a60,
                        limb1: 0x7d166d8dbab6e47bab53a5e8,
                        limb2: 0xd7ac57584787edaffe6d1cfe,
                        limb3: 0x14c724704b1e764dfbde6a49
                    },
                    u384 {
                        limb0: 0x9ba277bcd2ed2583a0be72a8,
                        limb1: 0x2e354572471b77c4be021368,
                        limb2: 0xd8d831d58434ccdd799b7539,
                        limb3: 0xe5c0c5b5ae714f5d1c70e50
                    },
                    u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 {
                        limb0: 0x212dea0ff4fe177f1e0b0298,
                        limb1: 0x9f459b636eadb91eead4e97a,
                        limb2: 0x75eb15d611e1fb6bff9b473f,
                        limb3: 0x531c91c12c79d937ef79a92
                    },
                    u384 {
                        limb0: 0x26e89def34bb4960e82f9caa,
                        limb1: 0x4b8d515c91c6ddf12f8084da,
                        limb2: 0x36360c75610d33375e66dd4e,
                        limb3: 0x3970316d6b9c53d7471c394
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x6768b46c349823ba55a416a1,
                        limb1: 0xce708c87c4ab529d7c4d4b51,
                        limb2: 0xc5de7d14d5274f9a7ec5131f,
                        limb3: 0x168d4b5ae1a7125dead907dc
                    },
                    u384 {
                        limb0: 0x302ea91a3b09524e7c49fbbb,
                        limb1: 0xb39869507b587b118b5d4593,
                        limb2: 0x21a5d66bb23ba5c279c2895f,
                        limb3: 0xd0088f51cbff34d258dd3db
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xbf233d2aee64158f2f91c838,
                        limb1: 0x3e0a4923172718281a48731d,
                        limb2: 0xbc29b375d5e4cf55bd898b0d,
                        limb3: 0xb2f255db19d2e8ee63ed7d
                    },
                    u384 {
                        limb0: 0xce92c8352f9224a727fe6aa2,
                        limb1: 0xd404993d860db0b3533ffc73,
                        limb2: 0x3a6e17980e75c4f85f128c8,
                        limb3: 0x2cdbbd34c20cff6fda5b095
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x5ed0334bc9993edb772b4442,
                        limb1: 0xd1c7bd63bc34515b01d4caae,
                        limb2: 0xb0d2ecc1d9a3f1d218d774ce,
                        limb3: 0xd5fb4713c434613fb837abd
                    },
                    u384 {
                        limb0: 0xf4156ff70f76f3b687c6eaf2,
                        limb1: 0x32d6c654ecc59021cc0fef3,
                        limb2: 0x45a693b73a054e74944cce5f,
                        limb3: 0xd189e878386807a0d2a27c7
                    },
                    u384 {
                        limb0: 0xc43d5cbf1370cafe7a75939d,
                        limb1: 0x9836263aaf4f3f064d1a1e83,
                        limb2: 0x9eaa6b8c07a5bbf633e387f7,
                        limb3: 0x5c57abc959b5cbb96eb1ecb
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xfc8cf4abb990563cbe4720e0,
                        limb1: 0xf829248c5c9c60a06921cc76,
                        limb2: 0xf0a6cdd757933d56f6262c34,
                        limb3: 0x2cbc9576c674ba3b98fb5f6
                    },
                    u384 {
                        limb0: 0x3a4b20d4be48929c9ff9aa88,
                        limb1: 0x501264f61836c2cd4cfff1cf,
                        limb2: 0xe9b85e6039d713e17c4a323,
                        limb3: 0xb36ef4d30833fdbf696c254
                    },
                    u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 {
                        limb0: 0xbf233d2aee64158f2f91c838,
                        limb1: 0x3e0a4923172718281a48731d,
                        limb2: 0xbc29b375d5e4cf55bd898b0d,
                        limb3: 0xb2f255db19d2e8ee63ed7d
                    },
                    u384 {
                        limb0: 0xce92c8352f9224a727fe6aa2,
                        limb1: 0xd404993d860db0b3533ffc73,
                        limb2: 0x3a6e17980e75c4f85f128c8,
                        limb3: 0x2cdbbd34c20cff6fda5b095
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x7de11bb33af7b669d3eea385,
                limb1: 0xf050e2b3645c76f4021a9145,
                limb2: 0xbb5dafe124843cb2bf90ab58,
                limb3: 0x83df3d15b1ef9fb0abffd31
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xe4f817e54aede0613c17035c,
                    limb1: 0xdff1f15010392a6da1f95a6,
                    limb2: 0xbed78d3d341e911d49f15454,
                    limb3: 0x18154782ce0913b21588066d
                },
                y: u384 {
                    limb0: 0x3d77d61326ef5a9a5a681757,
                    limb1: 0xd3070afd4f0e121de7fcee60,
                    limb2: 0xdf9ef4088763fe611fb85858,
                    limb3: 0x11a612bdd0bc09562856a70
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xde4f62a6588c9401ffefbd3,
                    limb1: 0x9bb5f797ac6d3395b71420b5,
                    limb2: 0xdc39e973aaf31de52219df08,
                    limb3: 0x105dcc4dce3960447d21d3c1
                },
                y: u384 {
                    limb0: 0xaefd0d854043fd325dd3c34f,
                    limb1: 0x9b63c98d9a7845c52e1e2b0f,
                    limb2: 0x9db0be660d847ccc58358f3f,
                    limb3: 0x17cb6c41f0c4e1a7394ab62a
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0x12e0c8b2bad640fb19488dec4f65d4d9, high: 0x2a43e70faf19922ad9b8a714e61a441c
            },
            u256 {
                low: 0x5a92118719c78df48f4ff31e78de5857, high: 0x51f964df9c6316b950f244556f25e2a2
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 1
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x2b828af1f5fe30bbe7a1074a,
                    limb1: 0x5669beaa69827b52dc874c9f,
                    limb2: 0x648af2c24d82a5a758c96b8e,
                    limb3: 0x188bc245620ae6b6afec9dc3
                },
                y: u384 {
                    limb0: 0xdc96192f803ef92f56d59758,
                    limb1: 0xfc6139925c05a030065d564,
                    limb2: 0xb24447300bec56efec94dcf4,
                    limb3: 0x156f97e5d31055c0a5fe154d
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256R1_1P_edge_case() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high_shifted: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x939295458800009ac8be94f9,
                limb1: 0x57a120ac49dc3782bcf1b6e1,
                limb2: 0x31036fb2f551a296,
                limb3: 0x0
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![u256 { low: 0x0, high: 0x0 },].span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 3
        );
        assert!(
            res == G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            }
        );
    }


    #[test]
    fn test_msm_SECP256R1_2P_edge_case() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high_shifted: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x47336a2358d87987148bcb8d,
                limb1: 0xead7957765acf9a1bbea50d9,
                limb2: 0x1f68715a44c3ef82,
                limb3: 0x0
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x113c8d620e3745e45e4389b8,
                    limb1: 0x85b8ff52d905fd02fe191c3f,
                    limb2: 0xf5d132d685201517,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x60c0ba1b358f375b2362662e,
                    limb1: 0x6abfc829d93e09aa5174ec04,
                    limb2: 0x7bc4637aca93cb5a,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0xeb1167b367a9c3787c65c1e582e2e662, high: 0xf7c1bd874da5e709d4713d60c8a70639
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 3
        );
        assert!(
            res == G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            }
        );
    }


    #[test]
    fn test_msm_SECP256R1_3P_edge_case() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0xf831856624736393b3b76d11,
                    limb1: 0xc165a27df5b76589fe2ce1e2,
                    limb2: 0x2a23444ace6bef77,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xa6bbeec6fb0369c3de339579,
                    limb1: 0xd394f6a5704d1de2da06048,
                    limb2: 0xe8057073c0fde87b,
                    limb3: 0x0
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0x3b1d72dc227f75f02874e08b,
                    limb1: 0xd395fa7c14d6ff33d03e1baf,
                    limb2: 0xbf16fcc65f95b486,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xe2461ebbe7a5b4d76dbef92b,
                    limb1: 0x3eecb75c5315cd3d2d0b9456,
                    limb2: 0x8192517353bc6523,
                    limb3: 0x0
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0xcff970bda4db69dac06ebad8,
                    limb1: 0xdee4204cca252abd67132509,
                    limb2: 0xa79c0006b6ca7fab,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x759642b853dd01b9d2d7bb18,
                    limb1: 0xe1e1d2f8bf0f2f5b463bfae0,
                    limb2: 0xbc3c71be130f204d,
                    limb3: 0x0
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xec4b7a43e1054882a2b8787f,
                        limb1: 0xfb71f01aab18dd64bf0290ef,
                        limb2: 0x739387fdd621db47,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb9104445c9ee329ddab79885,
                        limb1: 0x7fffffffffffffff8f41b07b,
                        limb2: 0x7fffffff80000000,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x8b184b2d84dda8fb47336e4a,
                        limb1: 0x7cc34072cf43d5f8c50e123,
                        limb2: 0x2ac6de072c8291de,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x33cf6619ea9e5a5857292b71,
                        limb1: 0xfb86f6da971e2c2b963efbc8,
                        limb2: 0x35f57801d45a6af7,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x7a1c2b0493c892201f4ed6b0,
                        limb1: 0xdfc0b649a4c1ffe41434c3e4,
                        limb2: 0x6b9772a42ab95dd0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x845a4b3e553c8b8b94d04830,
                        limb1: 0x2c2f8ddc08e40a6d5bd715f0,
                        limb2: 0xe64e5d836de3bc0d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8dae72c8fcd89cd4476749f2,
                        limb1: 0x7e3b93070af8aad22c1313f4,
                        limb2: 0xc65b8685c01c77dd,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x8658cb14baa19703d5c193c4,
                        limb1: 0x7a859f1d78a8d102d490ffb9,
                        limb2: 0x8810871891fb97f5,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb79f901e1c9df0b7a2aebda6,
                        limb1: 0x9aa214fa44a1511b0d6c8dcf,
                        limb2: 0x5a97091e3eb20750,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x30e57ea87bf32d352256ddf7,
                        limb1: 0xc156d8c5b13e0239a2601359,
                        limb2: 0xb8e5cdd22d2b5300,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8b184b2d84dda8fb47336e47,
                        limb1: 0x7cc34072cf43d5f8c50e123,
                        limb2: 0x2ac6de072c8291de,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x33cf6619ea9e5a5857292b71,
                        limb1: 0xfb86f6da971e2c2b963efbc8,
                        limb2: 0x35f57801d45a6af7,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x1eba51d293cb74b25730952a,
                        limb1: 0x906541fa014f7054082fbe21,
                        limb2: 0x2e106fda62d7fa85,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x18d0afe0edb98066b4e326fd,
                        limb1: 0xffffffffffffffffee22305f,
                        limb2: 0xffffffff00000000,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x79a28720b6f6c2901c1b6b21,
                        limb1: 0x704ddc3781df41868fe9f55e,
                        limb2: 0x518625728416a2bf,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf0e378a3ec9247fbe26bb7f6,
                        limb1: 0xe9569edc77fe9281c42dc1fc,
                        limb2: 0xa101bf854330a5e9,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x6d8fca3224e3136dcba20051,
                        limb1: 0x531ef14ca1e30be2b0bceb4c,
                        limb2: 0xb666fb69f3c379d6,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x97cac4a4fdff83f6161c6056,
                        limb1: 0xa0d567b311571677c37ca52e,
                        limb2: 0x6fc445a46fd466fd,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2d46378df71f30211f291fbd,
                        limb1: 0x6817355d6ca9352b06f4696f,
                        limb2: 0x975515b1e97470a4,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xdfb71a46102ad9dee734687e,
                        limb1: 0xd04da4108863a8238e9ea8b7,
                        limb2: 0xefe716b56f4b6c3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x84885b5b88da356c87aef9b5,
                        limb1: 0xac4230444d712eb17d097f09,
                        limb2: 0x169f510fa322d815,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf9a9470a7617644a808f3867,
                        limb1: 0xf7e7e0c00e9ccf371893c0bb,
                        limb2: 0x77c0f746e0a8a22b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x79a28720b6f6c2901c1b6b1e,
                        limb1: 0x704ddc3781df41868fe9f55e,
                        limb2: 0x518625728416a2bf,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf0e378a3ec9247fbe26bb7f6,
                        limb1: 0xe9569edc77fe9281c42dc1fc,
                        limb2: 0xa101bf854330a5e9,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xa9676ad3b9efcf4e461f93a4,
                        limb1: 0x45b3ccf12c2e3c619157a6de,
                        limb2: 0x3c0fc5c272f3b212,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x5784a91a5e09d24e7c4a2665,
                        limb1: 0x7fffffffffffffff7c074594,
                        limb2: 0x7fffffff80000000,
                        limb3: 0x0
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xef83b988624532b4d50958cc,
                        limb1: 0x7c751ca858569d5f9d6672ec,
                        limb2: 0x76a51d1761fa980c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf4e91c6638a52035171c649b,
                        limb1: 0x4d85e5372103d60ec8aebf48,
                        limb2: 0x994d0330e99fcbcf,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x95a032c38809b3674a705f22,
                        limb1: 0x5354b2074b618c858b289c7f,
                        limb2: 0x7665a34a8549ce9f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2e1e7ce6eeff836215e86895,
                        limb1: 0x83ec0565ce91000c75ae3f79,
                        limb2: 0x88a12adc65e89b5f,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc45977bd10156f2598c0d18c,
                        limb1: 0x9c0bc3988d833b0010a9e6bf,
                        limb2: 0x33a7d18b3006b094,
                        limb3: 0x0
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x8d66e8b7b483d3265ac1edeb,
                        limb1: 0x560d3627f7cdcf9c54522ca,
                        limb2: 0xc5d0f963ce8e175,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x382e9e19dfde37e65c9f124c,
                        limb1: 0xa722e47de4449f771e39dbd7,
                        limb2: 0x8579057707069afb,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xed985bc391dedb9ee27d3278,
                        limb1: 0xcb5a0db0138d04900b10c8d7,
                        limb2: 0x8edf2c43ed5b307b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xef83b988624532b4d50958c9,
                        limb1: 0x7c751ca858569d5f9d6672ec,
                        limb2: 0x76a51d1761fa980c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf4e91c6638a52035171c649b,
                        limb1: 0x4d85e5372103d60ec8aebf48,
                        limb2: 0x994d0330e99fcbcf,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0xb8ef2dfd1444c4e0efe00148,
                limb1: 0x967459cf9f622705ee83c962,
                limb2: 0x3a669994cff338be,
                limb3: 0x0
            },
            g_rhs_sqrt: array![
                u384 {
                    limb0: 0xf57dfd2e75b1ce26390a7a1a,
                    limb1: 0x609597792b488ee2b8b2a3f2,
                    limb2: 0x605b9279af8c238f,
                    limb3: 0x0
                }
            ]
                .span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x113c8d620e3745e45e4389b8,
                    limb1: 0x85b8ff52d905fd02fe191c3f,
                    limb2: 0xf5d132d685201517,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x60c0ba1b358f375b2362662e,
                    limb1: 0x6abfc829d93e09aa5174ec04,
                    limb2: 0x7bc4637aca93cb5a,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xd3ff147ff0ee4213f51f677d,
                    limb1: 0x431366a7732a6e4a6b942255,
                    limb2: 0x9fe743b25d39a591,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x7f8bb562ff60a902ef14bcb0,
                    limb1: 0xeb9420089fa531db62e806a6,
                    limb2: 0xfd028df433dfd5cc,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0xe443df789558867f5ba91faf7a024204, high: 0x23a7711a8133287637ebdcd9e87a1613
            },
            u256 {
                low: 0x1846d424c17c627923c6612f48268673, high: 0xfcbd04c340212ef7cca5a5a19e4d6e3c
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 3
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x33ee7695471a03192ef22266,
                    limb1: 0xb449dd8cfd0c3438e14a718c,
                    limb2: 0x1fbb33f079b828e2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb411f97aeec2eae6044122ec,
                    limb1: 0xcdce180b60667260d7ce284e,
                    limb2: 0xa73a7381dd3b07c,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256K1_1P_edge_case() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high_shifted: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x1f09ea597dd1b76ad0589c17,
                limb1: 0xdb92b549b432162903e3e952,
                limb2: 0x7812a16bfa702609,
                limb3: 0x0
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![u256 { low: 0x0, high: 0x0 },].span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 2
        );
        assert!(
            res == G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            }
        );
    }


    #[test]
    fn test_msm_SECP256K1_2P_edge_case() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high_shifted: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x7eaaa823bf2e8ea170ebfece,
                limb1: 0xc9db82034b10fa27593cd4b,
                limb2: 0x18f1b81a89a11888,
                limb3: 0x0
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x393dead57bc85a6e9bb44a70,
                    limb1: 0x64d4b065b3ede27cf9fb9e5c,
                    limb2: 0xda670c8c69a8ce0a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x789872895ad7121175bd78f8,
                    limb1: 0xc0deb0b56fb251e8fb5d0a8d,
                    limb2: 0x3f10d670dc3297c2,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0xeb1167b367a9c3787c65c1e582e2e662, high: 0xf7c1bd874da5e709d4713d60c8a70639
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 2
        );
        assert!(
            res == G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            }
        );
    }


    #[test]
    fn test_msm_SECP256K1_3P_edge_case() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0x81f93764cd87ff5af9aad87f,
                    limb1: 0x8aa0792747a5b8ca16b9e369,
                    limb2: 0xce30fe4be7b17451,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x5b77703ae4639b17cfca6124,
                    limb1: 0x86b771c3a15eee8b1ca9feaa,
                    limb2: 0x5acc99b6152d28a4,
                    limb3: 0x0
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0xff8927eca139c99d7960c8ef,
                    limb1: 0xec91eee7a0301418e07f41fc,
                    limb2: 0xb49b07479d1c26aa,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xe496c28fbc13ed8a0324b632,
                    limb1: 0x2d5583856241be833fec7c9d,
                    limb2: 0xff1c723bbb39f40b,
                    limb3: 0x0
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0x3efedfaf5b7ce0a80c4fa5a1,
                    limb1: 0x2c16205bc2efe9dcc6eefa9a,
                    limb2: 0x3f2cefb8efbcc695,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc3eeedd13fa2c621a214d57,
                    limb1: 0x5e42015603c2cf1a184c7bdb,
                    limb2: 0x8ab02685472a4433,
                    limb3: 0x0
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x21ca4954703e20a32a53c14e,
                        limb1: 0x77928094e2384846615f9f3,
                        limb2: 0xb0933d87df5f16c0,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x39104445c9ee329d5ab7969d,
                        limb1: 0xffffffffffffffff8f41b07b,
                        limb2: 0x7fffffffffffffff,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x1287ed4d64ace9b7a43a0e54,
                        limb1: 0xa8bd72a441196b6133cce959,
                        limb2: 0xc692b7558ef0a607,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x800903913f0f465f70dde2a5,
                        limb1: 0xe77cd0cd60e03364f10ac507,
                        limb2: 0x6ef16ab1aefb800b,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xa4ddcdaa4d1f21498a8e60e2,
                        limb1: 0x3139c084333af9819a02b0ae,
                        limb2: 0x7805f31083be707c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x671b070bbd9488ed6f637c14,
                        limb1: 0x15d2edbf03b6ef7a39eb1db0,
                        limb2: 0xdc5754685cf24343,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x95886720b10b40982ba07bbc,
                        limb1: 0x7722212fe97468b0f47f0f64,
                        limb2: 0x1a324051317a343d,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x81b77d1dc0ba640a7d967761,
                        limb1: 0x9d2e227dc7b1efa86a9a616f,
                        limb2: 0x6e030356e8948a35,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x803f18f8b96aec9f16113df6,
                        limb1: 0x5469b59da62167c2974b6334,
                        limb2: 0x899eadbc8e08053,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 {
                        limb0: 0x1287ed4d64ace9b7a43a0e54,
                        limb1: 0xa8bd72a441196b6133cce959,
                        limb2: 0xc692b7558ef0a607,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x800903913f0f465f70dde2a5,
                        limb1: 0xe77cd0cd60e03364f10ac507,
                        limb2: 0x6ef16ab1aefb800b,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x4bb28979b0b79c1777f1fc30,
                        limb1: 0xb5224e011b2f31ce93f717ab,
                        limb2: 0x43c2e0f9ce3d46a9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x18d0afe0edb98065b4e3232d,
                        limb1: 0xffffffffffffffffee22305e,
                        limb2: 0xffffffffffffffff,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xcac2235c929f3b69ad67b0f5,
                        limb1: 0x79851b8757cf23514a81081c,
                        limb2: 0xcae3cc5dad5be629,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x27913096b5d7c1cf127f235,
                        limb1: 0x858b5b0d0855d81627456674,
                        limb2: 0x888761b5f990cdb2,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x41944f6c68d802cae76fecb5,
                        limb1: 0xb68878783c315c2955f84db0,
                        limb2: 0x9e6ecc5374b776d3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x6303520371c13385e632d785,
                        limb1: 0x166eb934b430a9de83ef040e,
                        limb2: 0x43c0f15a5445867b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x32f780ed8e7def611a1f885f,
                        limb1: 0x18358fe9b350098a2327a652,
                        limb2: 0xe46a2879949b53d7,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x8b4ef788025a9fe8bdd5e9c8,
                        limb1: 0x52a3c0b366a9f739098738c9,
                        limb2: 0x8c3a968fbd834b22,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x114f8541ef8e64cd9817aae6,
                        limb1: 0xa6cf7d5b3a58e89b12e5cd2c,
                        limb2: 0xbbb3abf9d2f59fe1,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 {
                        limb0: 0xcac2235c929f3b69ad67b0f5,
                        limb1: 0x79851b8757cf23514a81081c,
                        limb2: 0xcae3cc5dad5be629,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x27913096b5d7c1cf127f235,
                        limb1: 0x858b5b0d0855d81627456674,
                        limb2: 0x888761b5f990cdb2,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xcd8a7b62cfcea038501befeb,
                        limb1: 0x4713597234ad41eaac4558da,
                        limb2: 0x80e4af25ec15667,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd784a91a5e09d24dfc4a247d,
                        limb1: 0xffffffffffffffff7c074593,
                        limb2: 0x7fffffffffffffff,
                        limb3: 0x0
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x8340be3f51dbe72cd3a11c66,
                        limb1: 0x3f5e87376a3a6565abe95a96,
                        limb2: 0x726d640994dd9b14,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc177f864034955b97a4f8d9f,
                        limb1: 0xe757f0bc9ce0020a5891c368,
                        limb2: 0xc3808ff732712bf,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x62690bd5c84ce92d37608041,
                        limb1: 0xa00cf01b83ee2270a792302,
                        limb2: 0x7e56f00b06c537aa,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x3af32c63776a038f2db2cba0,
                        limb1: 0xc9c24f93b2218a2c2843c50d,
                        limb2: 0xa4ec9825cf07cda9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x8ca46d17a4af2bfba87d85eb,
                        limb1: 0xaec1825b52f8612c11d67e30,
                        limb2: 0xe70921f36970a3c1,
                        limb3: 0x0
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x96c533bb3d03523cc967d23d,
                        limb1: 0xbb95b283e798c5c7b3617a1d,
                        limb2: 0x20fdbc43120f3d8d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x4a47cabc17015812582cdf59,
                        limb1: 0x536795284a200e486bfc57dd,
                        limb2: 0x55883efc2611833f,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 {
                        limb0: 0x8340be3f51dbe72cd3a11c66,
                        limb1: 0x3f5e87376a3a6565abe95a96,
                        limb2: 0x726d640994dd9b14,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xc177f864034955b97a4f8d9f,
                        limb1: 0xe757f0bc9ce0020a5891c368,
                        limb2: 0xc3808ff732712bf,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x5988327c732efe751b2c9aba,
                limb1: 0x6b4110ddcbbb0e7c4826662f,
                limb2: 0x243035d34ac20498,
                limb3: 0x0
            },
            g_rhs_sqrt: array![
                u384 {
                    limb0: 0x738294b7d794fa4fbd1ae3cc,
                    limb1: 0x9fc0ded6631c62d69739edaf,
                    limb2: 0x5b10679078ad2a2c,
                    limb3: 0x0
                }
            ]
                .span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x393dead57bc85a6e9bb44a70,
                    limb1: 0x64d4b065b3ede27cf9fb9e5c,
                    limb2: 0xda670c8c69a8ce0a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x789872895ad7121175bd78f8,
                    limb1: 0xc0deb0b56fb251e8fb5d0a8d,
                    limb2: 0x3f10d670dc3297c2,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xfdfdc509f368ba4395773d3a,
                    limb1: 0x8de2b60b577a13d0f83b578e,
                    limb2: 0xc2dd970269530ba2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x589fa250d638e35400c12ddf,
                    limb1: 0xb3aac19fcb5095808402aa7f,
                    limb2: 0xed6de6590d0195d1,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0xe443df789558867f5ba91faf7a024204, high: 0x23a7711a8133287637ebdcd9e87a1613
            },
            u256 {
                low: 0x1846d424c17c627923c6612f48268673, high: 0xfcbd04c340212ef7cca5a5a19e4d6e3c
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 2
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x55909ba28af82ea934a4b85d,
                    limb1: 0x4bf448ca5d57fb119c843e0a,
                    limb2: 0x6a2275491b991ee3,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x5bf4bf0cefc9553422e60eb0,
                    limb1: 0x178d55925d3d72f44783f626,
                    limb2: 0xe13a21d7302f8139,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_ED25519_1P_edge_case() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high_shifted: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x2b32584420d7ce3cd4a11930,
                limb1: 0x7f0e9c3b3f207c90986c3546,
                limb2: 0x2fb2291daeffdfce,
                limb3: 0x0
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![u256 { low: 0x0, high: 0x0 },].span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 4
        );
        assert!(
            res == G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            }
        );
    }


    #[test]
    fn test_msm_ED25519_2P_edge_case() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high_shifted: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x21b051e599886cc144eb97ce,
                limb1: 0x26a4f46e7f4c9c9c99d8f2f8,
                limb2: 0x2a61add1aea2f3a5,
                limb3: 0x0
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x7238f02b9f20e09c2181a557,
                    limb1: 0x2cedcc5b0be371c337fd7e9e,
                    limb2: 0x41f3bbeb280fe8a2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf046f8cd6e5a75fca71dd19b,
                    limb1: 0x892b4613ef5c58df4ef692a4,
                    limb2: 0x7527fa36f5738847,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0xb4862b21fb97d43588561712e8e5216a, high: 0x4b3e865e6f4590b9a164106cf6a659e
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 4
        );
        assert!(
            res == G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            }
        );
    }


    #[test]
    fn test_msm_ED25519_3P_edge_case() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0x6889d75e36c152c1cc46f152,
                    limb1: 0xab6c91609cc41b1c6148652e,
                    limb2: 0x6d04cda48b959e7b,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd12689aa4a75942f20369ac5,
                    limb1: 0x5d6ae4c0a9977c4e19538008,
                    limb2: 0x101fd900dd268a39,
                    limb3: 0x0
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0x4cf7cf1e83ac6ddeb4c0d88,
                    limb1: 0xdf032c7d359dec2b1b30b922,
                    limb2: 0x1b4e7ef7358304ab,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x90887d2f101702d94aa5377f,
                    limb1: 0x3fdfadebd967a872d02af758,
                    limb2: 0x2ea0b09931ec6dc4,
                    limb3: 0x0
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0x506c121a6c7fd9aa60e121a3,
                    limb1: 0x23b636b641b29ef8bdd1c639,
                    limb2: 0x791b6ec60b5f8598,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x59f9c615c1fecf831ca3b5fc,
                    limb1: 0x2f6fb1f6358caa9cb6f8c9f7,
                    limb2: 0x6e62064b941a23df,
                    limb3: 0x0
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x90d2e8727e5fd1a5c5e58e14,
                        limb1: 0xa929a53579aa9e3e81f805cf,
                        limb2: 0x38b87adcae1fcece,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xed700380fc6bb9738c6114eb,
                        limb1: 0xfffffffffffffffff21a53ed,
                        limb2: 0x7fffffffffffffff,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x9bf920910c9471cd86fa6936,
                        limb1: 0xaf3a5a2000fbb57b2915971d,
                        limb2: 0x2520dc914ad73ef1,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x149185623af054bc4c27361d,
                        limb1: 0x97e30c5c0852f883c3ccd612,
                        limb2: 0x7b5d16acd65ac24f,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xff8777d8fa0d0d9e90803a6,
                        limb1: 0x3200ea1f027c0194c591be9a,
                        limb2: 0x7bf9cf6188a57b24,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x298347e8f997fe0e45013dda,
                        limb1: 0x18573b7ce42e6aa818d64105,
                        limb2: 0x247c8fcba4de35d2,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd378ec11faf7730e2ff20bfb,
                        limb1: 0xb34729bedbbffe0680bb052c,
                        limb2: 0x29082e707a1931f5,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xc12680bbd361470deefc0ddb,
                        limb1: 0x260a8dd5e5c9670b883202d1,
                        limb2: 0xc6013fb41d22ac3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf528de61fe449f365ba6277e,
                        limb1: 0xf6a6d966694aa0bb75ed1cb2,
                        limb2: 0x6823ce0d3d23cc34,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd9f30aacb5f76e970a2c52f3,
                        limb1: 0xe032ad62c9c9dff5c6d18e99,
                        limb2: 0x4a31a0ff430ab173,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa89e4b88b906535c7fb68076,
                        limb1: 0xe0d23b2d6276f35194ce4d7a,
                        limb2: 0x26f8964f090fdd7,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x149185623af054bc4c27361d,
                        limb1: 0x97e30c5c0852f883c3ccd612,
                        limb2: 0x7b5d16acd65ac24f,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x16f9ccb6b1a4ee0a7c8af534,
                        limb1: 0x16e1bd321d501968a5ba6c6e,
                        limb2: 0x32bb63a6dd7258ce,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9d6582305ba4fa41292552df,
                        limb1: 0x69dd814,
                        limb2: 0x4000000000000000,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x6a276e6ef83fd83c3ec14fa0,
                        limb1: 0xb35e6c0db7ecc805c5801ddf,
                        limb2: 0x28b6574f0efd540d,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x784bdfce8976e0a02d2219fa,
                        limb1: 0x644c713f6f79277509e4821e,
                        limb2: 0x4d13655a2c6d5c1f,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x87bddb06d00da5ddeedbe34e,
                        limb1: 0x641cd510e86c01094e54c4d7,
                        limb2: 0x5791fae9d6d59e29,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xebe59226513f05d9ac1dfdad,
                        limb1: 0x67b26d524d321d7297848669,
                        limb2: 0x5484da3645564e03,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1ae3a2ac4a1808a78bf21862,
                        limb1: 0xcdf04e6a46d59cdd8fa6fe81,
                        limb2: 0x1a27e76d43576aa3,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x29518fdc2f6f4b7e3af6fc8d,
                        limb1: 0xb5d116a383ff28b270fc0e6f,
                        limb2: 0x22ab18d3b0dbde11,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa93ec09a846f9568f9497ab2,
                        limb1: 0xc088c6dd025aa1bd2adec66c,
                        limb2: 0x337b5ade5aec450a,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x823f114d726ddc68aa7d465c,
                        limb1: 0x3abc1a8b9b7f7bde51a40a70,
                        limb2: 0x5409b6ac561a869e,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x76cc9966a4b1b9cb377d66e0,
                        limb1: 0xe4f64d1b196805dc3138d43c,
                        limb2: 0x6050422b4b712f3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x784bdfce8976e0a02d2219fa,
                        limb1: 0x644c713f6f79277509e4821e,
                        limb2: 0x4d13655a2c6d5c1f,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xf875b534306df460ee0d985e,
                        limb1: 0x14bb5248b1bfeb4f33e44e64,
                        limb2: 0x1c0d4f3659c663ab,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd784a91a5e09d24e7c4a265c,
                        limb1: 0xffffffffffffffff7c074593,
                        limb2: 0x3fffffffffffffff,
                        limb3: 0x0
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xb2bd31cef772299e248100fb,
                        limb1: 0xe2e37ba99be92e642e4970b7,
                        limb2: 0x1d994c998fb6f912,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xaac470f3ab455f77b3d2d0af,
                        limb1: 0xfd469ccc88af74dc26fd80a4,
                        limb2: 0x6b961242bf1d75bb,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xc316db8f32ead8e5fa73e8c4,
                        limb1: 0xc7ac3cff14a66b146dbde807,
                        limb2: 0x7691cc9dfaeb0690,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x453c6d0f9cb833ca7695fc60,
                        limb1: 0xa9ddb9bec0dcec51b206c2d6,
                        limb2: 0x6c152397ed2af5f9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x96bfa7f73e741cfc4bab31d0,
                        limb1: 0x37ab0460cc1ba50393f29313,
                        limb2: 0x710785ba6f464b06,
                        limb3: 0x0
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x23cc11574d322656c47cee39,
                        limb1: 0xb5d617759a31e0feaec9c138,
                        limb2: 0x48f9c4b67a8eae9c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x2c9ad04dcf9080fb918e5e0,
                        limb1: 0x208d8792ec75709d38203ad1,
                        limb2: 0x647646be18ad1460,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdb5bcdff18467c33beb22738,
                        limb1: 0x955ebf726cd5759ac3fe0c11,
                        limb2: 0x64c844f6ca0b7bc4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xbf625cc6a3e40b2d1d3d1828,
                        limb1: 0x147b5cb6fd646c3a9a022714,
                        limb2: 0x7ae7f96d3570b7f9,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xaac470f3ab455f77b3d2d0af,
                        limb1: 0xfd469ccc88af74dc26fd80a4,
                        limb2: 0x6b961242bf1d75bb,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x8dde75daee844ddb23d3eb28,
                limb1: 0x61f5b12591c14254255bb040,
                limb2: 0x3efc9a5fa9221231,
                limb3: 0x0
            },
            g_rhs_sqrt: array![
                u384 {
                    limb0: 0x38ac3353b681af9826a7847f,
                    limb1: 0x6bb03cf542cfa058b9510783,
                    limb2: 0x331271a539381b51,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8f9f3a51824594097ff66ee1,
                    limb1: 0x411288e0b33c3e518ba2c8b3,
                    limb2: 0x2980af51bc30759d,
                    limb3: 0x0
                }
            ]
                .span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x7238f02b9f20e09c2181a557,
                    limb1: 0x2cedcc5b0be371c337fd7e9e,
                    limb2: 0x41f3bbeb280fe8a2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf046f8cd6e5a75fca71dd19b,
                    limb1: 0x892b4613ef5c58df4ef692a4,
                    limb2: 0x7527fa36f5738847,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x82e4a33f8e4e5881e791d86b,
                    limb1: 0xbcb062435ae8ec5fdaeac4bf,
                    limb2: 0x179e1bae9e0f9f34,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x19657783ba5660e255c21849,
                    limb1: 0x7ed7474bcea7551fc71e46bc,
                    limb2: 0x596c0a76b75f4756,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0x12e0c8b2bad640fb19488dec4f65d4d9, high: 0xa90f9c3af19922ad9b8a714e61a441c
            },
            u256 {
                low: 0xeb2083e6ce164dba0ff18e0242af9fc3, high: 0x2fc154703983ca8ea7e9d498c778ea6
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 4
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xf7d884feff5aba51d9990dce,
                    limb1: 0x999f1d302046c6266257ff5,
                    limb2: 0x7f9caa5ee5815899,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x6d71279424538e87f8ecf2cc,
                    limb1: 0x8a8a1d74581da5996a52bbaf,
                    limb2: 0x29acff692eccea25,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_GRUMPKIN_1P_edge_case() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high_shifted: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x5be9cd33c24d73ebc135039a,
                limb1: 0xe6367f6a20a10841e359bc14,
                limb2: 0x117b52588ff93701,
                limb3: 0x0
            },
            g_rhs_sqrt: array![
                u384 {
                    limb0: 0x3a6f69faa3a18fe97322832e,
                    limb1: 0x11cceede4dca8a3cd115016c,
                    limb2: 0x11edbb61d27eb894,
                    limb3: 0x0
                }
            ]
                .span(),
        };
        let points = array![
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![u256 { low: 0x0, high: 0x0 },].span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 5
        );
        assert!(
            res == G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            }
        );
    }


    #[test]
    fn test_msm_GRUMPKIN_2P_edge_case() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            Q_high_shifted: G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0x8ac5f837037348d49c751d6,
                limb1: 0xda6d3905ae9a7923b92ad213,
                limb2: 0x5b96a2638607680,
                limb3: 0x0
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x86b402ce02e7c7ca81f13d51,
                    limb1: 0x39493672733a9289a36020c1,
                    limb2: 0x7f40d91dc5413d3,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x371e7b6a5c01505bd4334e81,
                    limb1: 0x2f596ae4492a87c66f7bda1a,
                    limb2: 0x9dffb4dcdb94df9,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0xb4862b21fb97d43588561712e8e5216a, high: 0x967d0cae6f4590b9a164106cf6a659e
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 5
        );
        assert!(
            res == G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            }
        );
    }


    #[test]
    fn test_msm_GRUMPKIN_3P_edge_case() {
        let scalars_digits_decompositions = Option::None;
        let msm_hint = MSMHint {
            Q_low: G1Point {
                x: u384 {
                    limb0: 0x37c9a46b0612fc1b353fe24a,
                    limb1: 0xeb374db12bd7d7711f2705b4,
                    limb2: 0x253453fe507b50b6,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x33cd021aeba5ea18a2e20a56,
                    limb1: 0x3e392b55f320a528391fcef8,
                    limb2: 0x14fbdf9fd7fbfcdd,
                    limb3: 0x0
                }
            },
            Q_high: G1Point {
                x: u384 {
                    limb0: 0x60e6980f95d8e5261423f38e,
                    limb1: 0x3079cdd992636bb28a5984df,
                    limb2: 0x14368ee41c0e5576,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xa3597535ddd5b8336fde7418,
                    limb1: 0xc0329958cee690ca2b691fb,
                    limb2: 0x2a11389e1b5a9b57,
                    limb3: 0x0
                }
            },
            Q_high_shifted: G1Point {
                x: u384 {
                    limb0: 0xc294148f233ee2e2eb301899,
                    limb1: 0xe1d7d7726b8c2ea638d0879e,
                    limb2: 0x1599a751984c9cbc,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xfb70f5613f53701f0d60d44f,
                    limb1: 0x1bc69554d8e00e30700a9bad,
                    limb2: 0x1e3d7a04c2e60b68,
                    limb3: 0x0
                }
            },
            SumDlogDivLow: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x8e15747a6971ec654c9538a6,
                        limb1: 0x7fdd3c43d4599a79a98e4365,
                        limb2: 0x27464b0ede2a7457,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x67297412404daf077c6114ff,
                        limb1: 0xb85045b68181585d1a4e3c36,
                        limb2: 0x30644e72e131a029,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0x258553d2c9ee963312b79ff8,
                        limb1: 0x438888d4a7a12112b3e57098,
                        limb2: 0xe4cb46dbea9de49,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9b429dc6585bf628eef768e5,
                        limb1: 0x4bfece4993685c63de2eabf9,
                        limb2: 0x2a50bc4485c254af,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xd6decae815941319bdaf969f,
                        limb1: 0x9101d60097d93e695385fb85,
                        limb2: 0x2bf7dd07ea4fd22c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xcecdd84482b1a7bd65ad8aff,
                        limb1: 0xd20554a9ff932c44b0724efc,
                        limb2: 0x97ab331d38c3260,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x1df3869130399d7294160dff,
                        limb1: 0xe3d0a12a18c4534529ef57b4,
                        limb2: 0x170c626545e0c5aa,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x5c7e12682e73c81361ce608e,
                        limb1: 0xd5d08c27e754dff0fefaf798,
                        limb2: 0x2f41db679de1fe1c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xd2711e571c220af3319208da,
                        limb1: 0xc0c862cecca60ad399f130ab,
                        limb2: 0x684182e5000c2cd,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x79b9709143e1f593effffff0,
                        limb1: 0xb85045b68181585d2833e848,
                        limb2: 0x30644e72e131a029,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x258553d2c9ee963312b79ff8,
                        limb1: 0x438888d4a7a12112b3e57098,
                        limb2: 0xe4cb46dbea9de49,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x9b429dc6585bf628eef768e5,
                        limb1: 0x4bfece4993685c63de2eabf9,
                        limb2: 0x2a50bc4485c254af,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHigh: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0x6c9094e91dc1419df8ac17d2,
                        limb1: 0x1d37212cf26d121d10526534,
                        limb2: 0xd74cea3fa3eafe3,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xe489456a743fff37e6265cf4,
                        limb1: 0xdc2822db40c0ac2e8584ab0b,
                        limb2: 0x183227397098d014,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xce0be3b48c90db0b600f9647,
                        limb1: 0x179564f06356564259574cbf,
                        limb2: 0xc0ea53f1b5ae40c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf86c399084b4178a201357a0,
                        limb1: 0x4e6c086aab5b6fc54ac84485,
                        limb2: 0xaea32ebd8fdafc6,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0x7b948850701e9dd524248c65,
                        limb1: 0xae7a7baf9cfe902f2aa2d975,
                        limb2: 0x1facd72538b25505,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xeeb017e8d63197897bbe5863,
                        limb1: 0x73ed90d8ce4961c8611416e8,
                        limb2: 0xff6ecff1a2f06d4,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x26a0783ec6052c25936892a3,
                        limb1: 0xe34125f29d2dda477d8b7067,
                        limb2: 0x163e664e71f6f426,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0xb1d513d8fdcb40224ef7054e,
                        limb1: 0x8a5a899eecaff69da3770ad,
                        limb2: 0x24fc8f0d94eefc03,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x67b5efac3f9246239eb72e64,
                        limb1: 0xac1487c4a4f2f55aa983143c,
                        limb2: 0x803d8221bedd47b,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x79b9709143e1f593effffff0,
                        limb1: 0xb85045b68181585d2833e848,
                        limb2: 0x30644e72e131a029,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xce0be3b48c90db0b600f9647,
                        limb1: 0x179564f06356564259574cbf,
                        limb2: 0xc0ea53f1b5ae40c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xf86c399084b4178a201357a0,
                        limb1: 0x4e6c086aab5b6fc54ac84485,
                        limb2: 0xaea32ebd8fdafc6,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                    u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
            SumDlogDivHighShifted: FunctionFelt {
                a_num: array![
                    u384 {
                        limb0: 0xe90507f02c8a4b62e851076d,
                        limb1: 0xfbeef957f36c71de0a3a5c17,
                        limb2: 0x28de86d1c2705cdb,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x14616162fffacd18744a2666,
                        limb1: 0xdc2822db40c0ac2e102139b8,
                        limb2: 0x183227397098d014,
                        limb3: 0x0
                    }
                ]
                    .span(),
                a_den: array![
                    u384 {
                        limb0: 0xa546f985809a17ae515a728c,
                        limb1: 0x191e2152367d78fe0141ada3,
                        limb2: 0x29b6ff1ffef8b375,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x563ec3f28aca2d8af0abf3da,
                        limb1: 0xa5fea06a8391be046509dbca,
                        limb2: 0x694183d2cd6adf6,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span(),
                b_num: array![
                    u384 {
                        limb0: 0xad9b0b7d14eda847ad2d988f,
                        limb1: 0xea4ba18699ca196c1c67bf1a,
                        limb2: 0x1c938086ab194bcc,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xdb8a34d8c7adf1036f90f389,
                        limb1: 0x883ec94e38c731970d329f6b,
                        limb2: 0x17879279bc43bcef,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x593e562533466b7dd9a7828e,
                        limb1: 0xa15054f5463097ab204592c3,
                        limb2: 0xf7280157dd58ef1,
                        limb3: 0x0
                    }
                ]
                    .span(),
                b_den: array![
                    u384 {
                        limb0: 0x282706a57001d117a8fe64c3,
                        limb1: 0x21b3df3bf83f249745ae1461,
                        limb2: 0x10b9a79b436477ab,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xb3014e989438da81d494ce89,
                        limb1: 0x23082a10c7d66accc2f42069,
                        limb2: 0x21574f48a953531c,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x79b9709143e1f593effffff0,
                        limb1: 0xb85045b68181585d2833e848,
                        limb2: 0x30644e72e131a029,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0xa546f985809a17ae515a728c,
                        limb1: 0x191e2152367d78fe0141ada3,
                        limb2: 0x29b6ff1ffef8b375,
                        limb3: 0x0
                    },
                    u384 {
                        limb0: 0x563ec3f28aca2d8af0abf3da,
                        limb1: 0xa5fea06a8391be046509dbca,
                        limb2: 0x694183d2cd6adf6,
                        limb3: 0x0
                    },
                    u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
                ]
                    .span()
            },
        };
        let derive_point_from_x_hint = DerivePointFromXHint {
            y_last_attempt: u384 {
                limb0: 0xf624625c1e7830369add8466,
                limb1: 0xdf4ba3dc8774a170e55c3776,
                limb2: 0x108c5a431b372b80,
                limb3: 0x0
            },
            g_rhs_sqrt: array![].span(),
        };
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x86b402ce02e7c7ca81f13d51,
                    limb1: 0x39493672733a9289a36020c1,
                    limb2: 0x7f40d91dc5413d3,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x371e7b6a5c01505bd4334e81,
                    limb1: 0x2f596ae4492a87c66f7bda1a,
                    limb2: 0x9dffb4dcdb94df9,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x20669ef12954f8e3bbc8b4d3,
                    limb1: 0x396a6f7243c27ce553121ee3,
                    limb2: 0x11438ca2ec259aed,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xa560a5759c90985fde99aca0,
                    limb1: 0xc5b21186cc6dcd0421026513,
                    limb2: 0x21fb1f47c6ac55b3,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                y: u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            },
        ]
            .span();
        let scalars = array![
            u256 { low: 0x0, high: 0x0 },
            u256 {
                low: 0x12e0c8b2bad640fb19488dec4f65d4d9, high: 0x1521f387af19922ad9b8a714e61a441c
            },
            u256 {
                low: 0x5a92118719c78df48f4ff31e78de5857, high: 0x28fcb26f9c6316b950f244556f25e2a2
            },
        ]
            .span();

        let res = msm_g1(
            scalars_digits_decompositions, msm_hint, derive_point_from_x_hint, points, scalars, 5
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xf47b4ee8eecf8576c38173d8,
                    limb1: 0x755d90a26c30d7d6fb33afd3,
                    limb2: 0x5e835e05fdb55c5,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x990d5f4767a8d057f8695e4e,
                    limb1: 0x5f8dd4e272c268c0d2ce4a39,
                    limb2: 0x1704905427d31a82,
                    limb3: 0x0
                }
            }
        );
    }
}
