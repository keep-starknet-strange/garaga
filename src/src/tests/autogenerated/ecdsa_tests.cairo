use garaga::signatures::ecdsa::{ECDSASignature, ECDSASignatureWithHint, is_valid_ecdsa_signature};

#[test]
fn test_ecdsa_BN254() {
    let mut ecdsa_sig_with_hints_serialized = array![
        0x236ca9312dad3661a37f2d6f,
        0x98424c01caad7592315715d1,
        0x795b9fd941b23c4,
        0x0,
        0xbf6659a4013d8a0bc49c2bba0fe0b551,
        0x2667e798582a362fb041cb7c36d149a8,
        0x1,
        0x5c724369afbc772d02aed58e,
        0x2cd3bc838c66439a3d6160b,
        0x72f26b55fb56be1,
        0x0,
        0x772ca79c580e121ca148fe75,
        0xce2f55e418ca01b3d6d1014b,
        0x2884b1dc4e84e30f,
        0x0,
        0xb4862b21fb97d43588561712e8e5216b,
        0x967d0cae6f4590b9a164106cf6a659e,
        0x37d4504165021857f4c3a89b,
        0x3c01da04b48a9433c893e478,
        0xefa4ab54f1ba7ef,
        0x0,
        0x3f5c7fca52140de03d114625,
        0x7156771fb151bc7b27686aa8,
        0x265a70d67c0dc562,
        0x0,
        0xebf20118a12bfb0f45a43dad,
        0xb32abf79922d7607f51255c9,
        0x2e020750c2707582,
        0x0,
        0xdc07b95a37c9d593d0d7b9b3,
        0x4e19c245b1059830d5488407,
        0x303d78ac0b3137e5,
        0x0,
        0xea0075981c8644ad65a06aa3,
        0xff8aa5e0344353e01a2fdd8b,
        0x19e2eddec5396d9f,
        0x0,
        0x795ead26c3a388a15f78a8fb,
        0xce535094219e8ee49c1b4225,
        0x2b8c41d3465de52b,
        0x0,
        0x5,
        0x772c24a55eed211c2c170a0a,
        0x8354b5cd70ed804bd7b0b23b,
        0x20a9bc2d423af31d,
        0x0,
        0x4389fa85102ef310389c02e8,
        0x493740e2e791b27297da1b2e,
        0x27768f5b2e46cb5,
        0x0,
        0xcf9e1937412bd29cdd6c496f,
        0xca982064adac04ac0ab314bd,
        0x148f01ae791a8c0b,
        0x0,
        0x71f671b09c88d9267a188ab1,
        0xa9b69cdfb079e5d77496ad38,
        0x31690d88d644e3,
        0x0,
        0x7c1d9e3875490ac8da4a406,
        0x36302ddbfda3fc2dd854d9f,
        0x2cc3f4552dc3e122,
        0x0,
        0x6,
        0x449132dd29c9279836c3b2a5,
        0x47bda019ede78a2e8ca08082,
        0x165d9a707035d976,
        0x0,
        0x609468b601bba87365a29976,
        0x989c4dcbc904d1b78f3c55bf,
        0x1011ece8b99dbe7e,
        0x0,
        0xfd9d1772ed5274ff1cbfdd59,
        0x73bc16bcfe215aa2f519167c,
        0x12c438c423718619,
        0x0,
        0xc7765755b9998a36e990fd05,
        0x9d6e7683feb40bcc6ab6411a,
        0x24daa67ce935d8e4,
        0x0,
        0x66aa8abea5d048ec0e42d414,
        0x7f1c10464f40ee65b356a749,
        0x2ba364b8be84960,
        0x0,
        0x1,
        0x0,
        0x0,
        0x0,
        0x6,
        0x416e558f08a8486e196b81a2,
        0x15a23cebb32ac1d651a50c0b,
        0x155c6f737c41bb91,
        0x0,
        0xc61f69152e35cac96920813a,
        0xaef03d06aab32d4d24d44853,
        0x1d3948ca42cf915d,
        0x0,
        0x4e8f9501eca2830ee3cf81da,
        0xed9b953c2dc99f2e2af36d9d,
        0x102cd8207a878c7,
        0x0,
        0x6d4742e113a14fc2be18c7ad,
        0x65ec7b8d6d1856c3377de113,
        0x1584d42199616b9d,
        0x0,
        0x17eb01cba8dfb9a6da933db8,
        0xc0232716c39c6e90f2a65a3d,
        0x15cc4727107bbb4d,
        0x0,
        0x1116da1890a81c9f683fc74c,
        0xd13369a4ad8ab6893fabdef7,
        0x295412767fecbbe3,
        0x0,
        0x9,
        0x6541ce0a413aeab1cbce1aa8,
        0x1ee89a974835462e0e6016f5,
        0x12b480de6f6fec39,
        0x0,
        0x21bd3a220532f95a30e7cc62,
        0xc9d4e9635b0e7526adb5013e,
        0x3035c6ba2cd93b7b,
        0x0,
        0x90657bcb8bd6d2e67dc29ac4,
        0xa2e3fe8078e2b78b47c9d8e5,
        0x7e85bd98922f222,
        0x0,
        0xca10a3c3de54ae0f427caf26,
        0xaf687838e700fcd89dc06eaf,
        0x2424f101697423d0,
        0x0,
        0x949408f1f32c8337906b15b2,
        0x15f07e9eb6c79ce8a9404b9b,
        0x18408fcb5d569aa0,
        0x0,
        0xfd9d1772ed5274ff1cbfdd5c,
        0x73bc16bcfe215aa2f519167c,
        0x12c438c423718619,
        0x0,
        0xc7765755b9998a36e990fd05,
        0x9d6e7683feb40bcc6ab6411a,
        0x24daa67ce935d8e4,
        0x0,
        0x66aa8abea5d048ec0e42d414,
        0x7f1c10464f40ee65b356a749,
        0x2ba364b8be84960,
        0x0,
        0x1,
        0x0,
        0x0,
        0x0,
        0x8750cfd2ac6ab1f47fbb17dc,
        0x9c3e7311cc76f2d90ce9432c,
        0xef563f5f02cd74,
        0x0,
        0x0,
    ]
        .span();
    let ecdsa_with_hints = Serde::<
        ECDSASignatureWithHint,
    >::deserialize(ref ecdsa_sig_with_hints_serialized)
        .expect('FailToDeserialize');
    let is_valid = is_valid_ecdsa_signature(ecdsa_with_hints, 0);
    assert!(is_valid);
}


#[test]
fn test_ecdsa_BLS12_381() {
    let mut ecdsa_sig_with_hints_serialized = array![
        0x867620dc5a8fd7ecbe07be76,
        0x11d338240a4de8ca41217d43,
        0x2c7753c1707137bf,
        0x0,
        0x94796ffb457f39ac41d6612e5ce0a191,
        0x356631f83b3d990d4f60bada0d2ecc95,
        0x1,
        0xe4f817e54aede0613c17035c,
        0xdff1f15010392a6da1f95a6,
        0xbed78d3d341e911d49f15454,
        0x18154782ce0913b21588066d,
        0x3d77d61326ef5a9a5a681757,
        0xd3070afd4f0e121de7fcee60,
        0xdf9ef4088763fe611fb85858,
        0x11a612bdd0bc09562856a70,
        0xb4862b21fb97d43588561712e8e5216b,
        0x12cfa194e6f4590b9a164106cf6a659e,
        0xb139e99ead0eb70b9b96ee44,
        0xd9219af773fa71f5cbaacf55,
        0xeea3483d74f8a53f60e7ab1c,
        0x42c87d1ba3fa843b555ddaa,
        0x75d6895788a0d8c88a539658,
        0x8ec41778c542c2cf1ebc0230,
        0xdd7e065b03c30c3d691227d,
        0x1624555e89cb88b0aa17f368,
        0x4ac589c2a4629d983894cf1,
        0x3909bb15f27a0a5d65724fa5,
        0xad706a0aec0e2e3b16c5bdc0,
        0x17dc87b2b3d46d60b4e2ef4,
        0x1eb76b34f4d9453a90872836,
        0xfad8fcbc8bf4d5a867a4a4af,
        0x63c34591ee781e286edfd7af,
        0x164caba9fcea956485e576fe,
        0x15cce9a0da6adb5e75ab75e0,
        0xd6c398bfda18272a9cd2d1aa,
        0xe754eefc33aeae950d5fc6c8,
        0xa9029e72ee2f0c2c78e4cb8,
        0x70853e18c233395a4ccfdd02,
        0xc154a9a420d711c6d83b405f,
        0xc18165ce1de78cc934b641cd,
        0x14c33f774128c1ab5c46af7f,
        0x5,
        0xedcbef425ad889960598820f,
        0xa945ef06cb0b62d672180c05,
        0x5da721dc055508bc5f8f71bb,
        0x10fc26823ce25cfd7811aa48,
        0xc0ca474e62368e029a1d748b,
        0xd506332d39294489c724cae3,
        0xb953e9a463db6b8a2af07bd9,
        0x1299093b9f99bc32c0f02e01,
        0x9ee0cdf3e995ad09a87ee230,
        0xb17e0bf85f1623abbd2c48a1,
        0x392c29ab3907e709b18c984e,
        0x11d035b97f2d88984d8197b8,
        0x6fc5b162a20b30ca73cf62a4,
        0xe5135e52aa4e034c1e7cfaee,
        0x23a18027825b2db9f8e0a33,
        0x13002a6d3c9275c5784954d3,
        0x43a49e524bb31b8c663d61a0,
        0x7bb854975b35ca5407879ffa,
        0xbd1fbf73c167e3357ba3a017,
        0x9074658e303e0404355fc44,
        0x6,
        0xaff0fec78c5c9cfdfe1fb17f,
        0x78a6e7385abf6c6af718f7b8,
        0xe28451ae0fdcf9c443a5622a,
        0x80a48c2eafd61f755ab5c90,
        0x493954695f94e0176e2e4646,
        0x10988ebb1d6c10292ef62557,
        0xc70399a6ae2df54409b21ca1,
        0x47d0154e9f8e81d684c5a3f,
        0xa358bfc2695ad9919118f3ac,
        0xe85894d27264c1d03aa1b5b7,
        0xe4c0b3c8c637a86c84cb3857,
        0x18217dd33501e9a66a7ad392,
        0xaa492f3f13285af3862c8fdd,
        0xec9d0509f2e7870536abc96a,
        0xf799592a499475ba9796e3eb,
        0xb606e7fb183f7b5ebf3d693,
        0x69d6a14e3614735053f984d5,
        0x9d562fc18b66ffef479e9170,
        0x37f92bf4a1294312741bfb3e,
        0xdc1a060987ee8ac1d0333d0,
        0x1,
        0x0,
        0x0,
        0x0,
        0x6,
        0x46cd92ec2e593ac623041e1d,
        0x829bd753dcdcb87cdad1afc3,
        0xb5a9b28aadb16dfc1c2d40c3,
        0x2ccf8f3c293e51aa613e2cc,
        0x5d800dd1f882797e3fed4c03,
        0x5651267ea0a2883e77fe334,
        0x1bc1e1ff66f98fa4262d4eac,
        0x5c2b1ee2fd2d9e8e7fb023e,
        0xf0370cd3b793ddb495229c11,
        0x871282ad651cc9edcd6af88c,
        0xa11a5ecbe4833e4df6487d79,
        0x5cd75b1f2ca99529b5dd8ff,
        0xbf8563c8d9277f4381efe4b3,
        0x28be89e8ba75089c7304fd80,
        0xd9213f706f2b5e10a7265ca6,
        0x5d71c9ef032d9523b20922,
        0xc4063038e70fefc50e81e998,
        0x94af96d1adf4ef67043975c,
        0xad3c2837162246799e08fe75,
        0x12abf42fe423db5fc202d9ed,
        0xca22a2eb94e03188916a645c,
        0x10166c54e52cf77ab583fec5,
        0xe544a6b883b62b7afbfddb5,
        0x31b16172131391693b6764b,
        0x9,
        0xe6ffb1e777373f7f87f1b51,
        0x7b6aca40744cbb87bdb7dee4,
        0x46c599e0dafc9b8c1b1075ea,
        0x62811217275a1430b91ca8d,
        0x24e551a57e53805db8b91918,
        0x42623aec75b040a4bbd8955d,
        0x1c0e669ab8b7d51026c87284,
        0x11f40553a7e3a075a13168ff,
        0x7966ff0a776e66464464ceaf,
        0x6bcfdb66e58024d48e82d6e2,
        0xc91fc89ceb78bf23389da921,
        0x1282c18e2787f2cac8985728,
        0xf66dbbc4650008cc16d29b9d,
        0x5cb9561e38fb9c3794701d65,
        0x3a525ca86d4039a4baf6cc5b,
        0x189deed3e0d739a6f436774,
        0x8debd9a2c3e8ad58be150444,
        0xb78fa87f5da6239e10186b1b,
        0x2050efca69e46a83f317e41c,
        0x7815f02d8f4bd994621da14,
        0xa358bfc2695ad9919118f3b0,
        0xe85894d27264c1d03aa1b5b7,
        0xe4c0b3c8c637a86c84cb3857,
        0x18217dd33501e9a66a7ad392,
        0xaa492f3f13285af3862c8fdd,
        0xec9d0509f2e7870536abc96a,
        0xf799592a499475ba9796e3eb,
        0xb606e7fb183f7b5ebf3d693,
        0x69d6a14e3614735053f984d5,
        0x9d562fc18b66ffef479e9170,
        0x37f92bf4a1294312741bfb3e,
        0xdc1a060987ee8ac1d0333d0,
        0x1,
        0x0,
        0x0,
        0x0,
        0xec9c606c5f9d1f48a768011c,
        0xb533a11a85713d41b02a7d8d,
        0x8f63c5957e5268a0055d8199,
        0x3bfafefc4324fc26ebfc922,
        0x0,
    ]
        .span();
    let ecdsa_with_hints = Serde::<
        ECDSASignatureWithHint,
    >::deserialize(ref ecdsa_sig_with_hints_serialized)
        .expect('FailToDeserialize');
    let is_valid = is_valid_ecdsa_signature(ecdsa_with_hints, 1);
    assert!(is_valid);
}


#[test]
fn test_ecdsa_SECP256R1() {
    let mut ecdsa_sig_with_hints_serialized = array![
        0x46ae31f6fc294ad0814552b6,
        0x2d54cc811efaf988efb3de23,
        0x2a2cc02b8f0c419f,
        0x0,
        0x47e8f962616a171283a1176e90490f33,
        0xde5c72ea3ea08688ab2876686671cca8,
        0x1,
        0x113c8d620e3745e45e4389b8,
        0x85b8ff52d905fd02fe191c3f,
        0xf5d132d685201517,
        0x0,
        0x60c0ba1b358f375b2362662e,
        0x6abfc829d93e09aa5174ec04,
        0x7bc4637aca93cb5a,
        0x0,
        0xeb1167b367a9c3787c65c1e582e2e663,
        0xf7c1bd874da5e709d4713d60c8a70639,
        0xc62e8c245004fe0a2b14046,
        0xd7bb4b0bc0e5095a67fa1cc5,
        0x3e23f28591b4f67f,
        0x0,
        0xf342041f9fd88d1b57b8e140,
        0x5bef16a9525a8d987e8c175f,
        0x15ebf00640853b90,
        0x0,
        0x3f01c7b5ce9c3503f69371bb,
        0x12fee25cf79a78a2c1b48b71,
        0x47985ed18e645ea1,
        0x0,
        0xf40308fe7115ecf9d25fe06d,
        0x2ce4446a8e2885ab2acc3791,
        0x9515ce7a016b7a51,
        0x0,
        0x4e7ecaff1ee15a5b24ea08b9,
        0x51fedb9b0f00d314fc0d3d77,
        0xf7a44803c2b7b323,
        0x0,
        0xfd99bdfeae679cded447e39a,
        0xe0c88af139a515cbdf054bfa,
        0xbe6612586f3707fd,
        0x0,
        0x5,
        0xb2dc39fafd754eb19e425b9e,
        0x6a552b5b783579cf3f5a409,
        0xcbf02d210affb097,
        0x0,
        0xc10ca6caa90bf31f46df905,
        0x52ce2507e828556c7adc2f3a,
        0xfeaf4d0d213a6ee7,
        0x0,
        0x9feda9e9ff648e136587b9af,
        0x709ce5ad50d2b058cdbd8ad8,
        0x29f7256244ea816b,
        0x0,
        0x9bb5f5354b124d1080d97c64,
        0xe3cfa5b8be160c89e3d30349,
        0x282f9e6c3f19bc57,
        0x0,
        0xa29eeafd4bdfc604c02ee697,
        0xb6a214164f25f201398ac136,
        0xf80dad9f9b87f4f6,
        0x0,
        0x6,
        0x646e5618a74af0f32457a5cf,
        0x18c4cf58202eebab0eb2097f,
        0x321640dc8f45c472,
        0x0,
        0xa2df800402a1e45a03c8b41c,
        0x85a2808cd46dc65c8351b101,
        0x552cc199c5e64eee,
        0x0,
        0x553add1bd5ce5fe2dbe7bbcd,
        0x990da1c127825d9e7f7b5c2d,
        0x526847b5022cdb3c,
        0x0,
        0xe3c6539b8b126e37190f6631,
        0x879ad992f71fe3239d76fd5b,
        0xaf44cfbe111d3679,
        0x0,
        0x26f4c385caa9a1960af4f8f5,
        0x44d110c3fbd56cf865278095,
        0x21b661d8b6e2a05f,
        0x0,
        0x1,
        0x0,
        0x0,
        0x0,
        0x6,
        0xf3ee7898a245c3214e46a6b2,
        0x3a96398b6d19579527673569,
        0x1ad52e6c85f68fa5,
        0x0,
        0x316498ffcf5d6392ea3ebe60,
        0xe9eaeef3ed890de7ff19f8e0,
        0x9ec5ed52d89c3e31,
        0x0,
        0xf5110a4f31bdd71808fc0f2e,
        0x9a08b66ab1f103c79fa647e8,
        0x23a1bb67328d321f,
        0x0,
        0x5bf269a4201a21562b082854,
        0xdb7ba0f67430b7133eb6b3d,
        0x51a5285b2e03fc5c,
        0x0,
        0x821d5e4e46cba3eddf42cedc,
        0xaa654f70d06f45bbe32bb2e1,
        0xc62133fb7f875e3a,
        0x0,
        0x300d6f7eef63178371046a99,
        0x5fa550426e4dec6cc942e972,
        0xd045a1fb59151e0e,
        0x0,
        0x9,
        0xf2aa21f392b25cba211138db,
        0x15e6ac9ddb9705c7c10939bb,
        0x3e5bde4d9fb1bb31,
        0x0,
        0x6a6109586b8e1a8fbcde2092,
        0xb4dbe52df7dcf592f71526fd,
        0x9c83b5b659f0f3aa,
        0x0,
        0x95ff11a53da810562392e90e,
        0x29c3d864be24f849b8821fa6,
        0x3483243df96156c3,
        0x0,
        0xfcf5db54c9ffe55c20d5c118,
        0x19ebf4c1471a022529b18948,
        0x383cd0087b65a953,
        0x0,
        0x2cf0bf05f06f1cdea07bf9bf,
        0xd136e19f168098fdfbb9a573,
        0xdf167461b83191b7,
        0x0,
        0xacb04380b19fb75ee2db3139,
        0x7e862ccaaa9a9d71b521e11e,
        0x480b580387bf8e06,
        0x0,
        0xe3c6539b8b126e37190f662e,
        0x879ad992f71fe3239d76fd5b,
        0xaf44cfbe111d3679,
        0x0,
        0x26f4c385caa9a1960af4f8f5,
        0x44d110c3fbd56cf865278095,
        0x21b661d8b6e2a05f,
        0x0,
        0x1,
        0x0,
        0x0,
        0x0,
        0x1dd0430dbb258b46efea0a25,
        0x7306dcba394032edf2e12c00,
        0x84ccf6c2e927059,
        0x0,
        0x1,
        0x701af8d7579491e7087325ec,
        0x738bbe956dd312ad070a75ca,
        0x24008633f5a9a7ad,
        0x0,
    ]
        .span();
    let ecdsa_with_hints = Serde::<
        ECDSASignatureWithHint,
    >::deserialize(ref ecdsa_sig_with_hints_serialized)
        .expect('FailToDeserialize');
    let is_valid = is_valid_ecdsa_signature(ecdsa_with_hints, 3);
    assert!(is_valid);
}


#[test]
fn test_ecdsa_SECP256K1() {
    let mut ecdsa_sig_with_hints_serialized = array![
        0x2965eeb3ec1fe786a6abe874,
        0x33e2545f82bb6add02788b8e,
        0xf586bc0db335d7b8,
        0x0,
        0x6bb797837f385ccf8ea3b9b6e7074b68,
        0x123ea74e335845008c7f5f797313610f,
        0x0,
        0x393dead57bc85a6e9bb44a70,
        0x64d4b065b3ede27cf9fb9e5c,
        0xda670c8c69a8ce0a,
        0x0,
        0x789872895ad7121175bd78f8,
        0xc0deb0b56fb251e8fb5d0a8d,
        0x3f10d670dc3297c2,
        0x0,
        0xeb1167b367a9c3787c65c1e582e2e663,
        0xf7c1bd874da5e709d4713d60c8a70639,
        0xebf42df7ae5357808e7477ee,
        0xe5a44c7c9f00c699354923ba,
        0xd10951bc7d10a0ee,
        0x0,
        0x3cd5ba8a04ce29e03fd759f0,
        0x964fd499cb388154fafbf1b,
        0xf5234295876c4d11,
        0x0,
        0x7e83b247d09359a21bd9a936,
        0x30e2082bc69835406321e035,
        0xdcb953015b1a5eb2,
        0x0,
        0xb516c4566bee27d3b85f3495,
        0xdeabb6abcaa92464bf75873d,
        0xb205feded166bcdc,
        0x0,
        0x659cce1caf0a2a04821de995,
        0x2e164561a2e3662a5fc07cf2,
        0x836e7dca73fcd40a,
        0x0,
        0x4873aab75eca46aa1aba7c36,
        0xad11d8dcb839e85a00edfed9,
        0xf37fb656b161ef6a,
        0x0,
        0x5,
        0x5a5391c083e751796a599d6,
        0xf3bd1490d7f47056fcfdfe69,
        0x96a2c623edd7da7e,
        0x0,
        0xd0e1d52d5cf4aaf5696b63e0,
        0x451fb29e1eed44ffad5f63e1,
        0xda271bb8206fcae2,
        0x0,
        0x8a311b670cdac6f8bda6e4db,
        0x70dd0e8fd471c01f0b15cd9c,
        0xd5d21e69cf852f5e,
        0x0,
        0x4788ff60161bcad3ed5ad107,
        0xe2f2e8c583526350f107ce8c,
        0xb060348e2ab930db,
        0x0,
        0x595f6764048dfcaa595e7524,
        0xa3a751c09634962cb8124bf1,
        0x798d78ef9cb8c617,
        0x0,
        0x6,
        0x26a9657a6d7f323b629cb093,
        0x60a4a458ab028e12074ff968,
        0x6e0d69f766ffd219,
        0x0,
        0xb940d2f366f1764ebe828288,
        0x91b3df84e0d28db963a9283e,
        0x29dee44f9fc231f4,
        0x0,
        0xebb35cf2a73f3b7321cd0128,
        0xa3a0c99e82d7b011f9a3af06,
        0x61a86fe15ba7c8bb,
        0x0,
        0x3d5f1353712a64dbf36fc9ef,
        0x2381d926a1bb71b4fc5bf847,
        0xc3e9b6f6385e3e04,
        0x0,
        0xc8df3df4fc54490b20e783fb,
        0xee52fa750eb0780b3ce3e5,
        0x7aa96a6c5052a29e,
        0x0,
        0x1,
        0x0,
        0x0,
        0x0,
        0x6,
        0x25fc9112a37a3c6d7295efb8,
        0xb60ef1d73bf79e48ad264db5,
        0xfcb0a218ba3b108d,
        0x0,
        0xb70ac56aac07506ac073a880,
        0x4ee520f795a1d781d6e36394,
        0x1cd0feb1f5ebd6bf,
        0x0,
        0xc007bd29ce85d6dfe4d4f656,
        0x1f668465797429b6dff976d8,
        0x213e8cc4121a89a6,
        0x0,
        0x702aef4673784b7687a759ee,
        0x31c95763022d530c501d6fa5,
        0xaa9d342ca7787475,
        0x0,
        0x40527cf6aecb2f596f23b17a,
        0x2cb2d40502ac4f1b93a468e8,
        0x882e944bcce9b03c,
        0x0,
        0xc369d3ed5ea747b36ab0f64f,
        0x9f6fb265809a97dc5b459302,
        0x8176601ae0c5273c,
        0x0,
        0x9,
        0xea1c658fe7a5fa2b248df78,
        0xa4807e6cad11e27e332fd1d9,
        0x25de5c3d0febeb1,
        0x0,
        0x10c5c4a7d09a3c2835919589,
        0xfbeb1ca225c1e011b9a019b7,
        0x25183e2d5e4f5daf,
        0x0,
        0x71e78aa292baa027ec9b0fba,
        0x7965835593e5d07dd379c930,
        0xab9b0f2981967d21,
        0x0,
        0xd442ecc285a7f4440aab4931,
        0x593194671722aa04edd3c35a,
        0xc9716ab2f1938436,
        0x0,
        0x375b84a64d3f759fa4d729d8,
        0x9838245e14396101b2536387,
        0x8480cd45d204a446,
        0x0,
        0xebb35cf2a73f3b7321cd012f,
        0xa3a0c99e82d7b011f9a3af06,
        0x61a86fe15ba7c8bb,
        0x0,
        0x3d5f1353712a64dbf36fc9ef,
        0x2381d926a1bb71b4fc5bf847,
        0xc3e9b6f6385e3e04,
        0x0,
        0xc8df3df4fc54490b20e783fb,
        0xee52fa750eb0780b3ce3e5,
        0x7aa96a6c5052a29e,
        0x0,
        0x1,
        0x0,
        0x0,
        0x0,
        0x2054fa4912fb931a40934f75,
        0xe130842158d6150cb6bd6644,
        0x13b63f29a3375251,
        0x0,
        0x0,
    ]
        .span();
    let ecdsa_with_hints = Serde::<
        ECDSASignatureWithHint,
    >::deserialize(ref ecdsa_sig_with_hints_serialized)
        .expect('FailToDeserialize');
    let is_valid = is_valid_ecdsa_signature(ecdsa_with_hints, 2);
    assert!(is_valid);
}


#[test]
fn test_ecdsa_ED25519() {
    let mut ecdsa_sig_with_hints_serialized = array![
        0xd4b581f1ee29a4dfba0aa2d4,
        0xf18a70dbf1dc5a76494bff12,
        0xac1b7bfc409119f,
        0x0,
        0xd75af662c90a1cb06a531ce8992bfda2,
        0x9c65af0ba668f70fb54682dc51dddb4,
        0x1,
        0x7238f02b9f20e09c2181a557,
        0x2cedcc5b0be371c337fd7e9e,
        0x41f3bbeb280fe8a2,
        0x0,
        0xf046f8cd6e5a75fca71dd19b,
        0x892b4613ef5c58df4ef692a4,
        0x7527fa36f5738847,
        0x0,
        0xb4862b21fb97d43588561712e8e5216b,
        0x4b3e865e6f4590b9a164106cf6a659e,
        0x9b8fd04b8f1ad85fd2940ff,
        0xd09b73a87ddff11cbfd105f4,
        0x58c1010d0ef704df,
        0x0,
        0xa9cc2185b917095540be1aee,
        0xad7dd69e31c1cf7f992efae3,
        0x3379fa10668cd25b,
        0x0,
        0x481f55f147e1f6067a536d96,
        0xb7b19f28b55261ed684d9592,
        0x7ce5e3fcc810c694,
        0x0,
        0x24c748339926ecc32a80c636,
        0x1da38798bc2f22260a4a3853,
        0x6976a6f742b7ef7a,
        0x0,
        0xdb7bfa2a8c5b7e9b8ba69645,
        0x883b1341c05e20a3e557993a,
        0x3a0758885c18df2c,
        0x0,
        0x4f39b5e2a8f3fb41ece53982,
        0xdf190f18c8a606c7113202fb,
        0x26b6a5b75e8ca4a9,
        0x0,
        0x5,
        0xb6928f44b814686ac8f343b2,
        0x154c6a73ef69a3337c519202,
        0x2df06cce28602638,
        0x0,
        0xb7765ce18567c304a312add6,
        0x4cc49840ec8814ad799bd620,
        0x66f000cb027c7e1c,
        0x0,
        0x299ecfe351ec76c931d601b2,
        0x7fa45083433fc641a5ad3084,
        0x3bde7e0746f97cc9,
        0x0,
        0x18a3ffb9972232868e629ba1,
        0x1e994e975a5de0f28989f190,
        0x39798b0fcbc0b02c,
        0x0,
        0xb59059cbd729bee1abdea545,
        0x978c8f24856ce89466f5f597,
        0x7d19dc32a6276451,
        0x0,
        0x6,
        0x3ad18a770ef573a1a8d3ae53,
        0xf0f19b9ceb958c1c7446e482,
        0x4f429f664c4173e7,
        0x0,
        0x7ebd843b10350a8d2e9763a9,
        0x8ef7526bcd97420e9e3ee474,
        0x25cdf788577844bd,
        0x0,
        0x7ad7e6eabc7c7aa58db9b15e,
        0x923b4c53ef375133d64baefa,
        0x7c4104bb55066524,
        0x0,
        0xad5d701fae70e0d02e26d53b,
        0xb1be93466ed602cbc614e8c6,
        0x1db0f14c6e98c8e6,
        0x0,
        0x53114619095a34a0d9002661,
        0xd27e7e8f0eca147610cb0cc1,
        0x3e52972d4a36982,
        0x0,
        0x1,
        0x0,
        0x0,
        0x0,
        0x6,
        0xdc2d36eed9d01b8224a9d26b,
        0xfd5cd38138167953a0cbf08f,
        0x3218c5167a20ed83,
        0x0,
        0xf78387ef1068038e9672c681,
        0x87bdf3854a74aeb21613fa6c,
        0x751f2aee8eae940b,
        0x0,
        0x22dda6cd3f743bbc126cabc6,
        0xbdcc6954f273a4ece9d661c,
        0x384809ade4e8a4b6,
        0x0,
        0xb16eaf729000b0628fc63b29,
        0x7f4a15e8b87b403581e9d03c,
        0x5409fd7af874ab73,
        0x0,
        0x947032339595e982759feccc,
        0xaf52195a4e4ec272a9e83451,
        0x4533d797839aa3,
        0x0,
        0x13c81181dab6eaa35a6fab3,
        0xd14dc64a1a9946a3d76d4c3e,
        0x560f592ce9a158bb,
        0x0,
        0x9,
        0xdc8938a98acddb28e0941f05,
        0x2874948f83c5922b257dec5,
        0xd62b7af5bf7ac36,
        0x0,
        0x45f0622fc76b88fea9c99046,
        0x7e79fb579b5f87738d71730a,
        0x4e0da07846583232,
        0x0,
        0x70e21b51a618d2848eb47ca7,
        0xe6025cb755f8830aa17e7203,
        0x275dee807c725bed,
        0x0,
        0x5f33d952574952338a31af0c,
        0xcfed7359263a733083057325,
        0x73d4de171820ebc2,
        0x0,
        0xc43404a350511482cf070c8a,
        0xad5a35bbc2f161fe1968fa16,
        0x4f34cc8f13add4f8,
        0x0,
        0x991560f9ead9d77a65338c87,
        0x69d19dbf018f23ba17d383fd,
        0x4e8bfdd1ce51d153,
        0x0,
        0xba029b175ae2c25f26e2ec68,
        0xe3567453d05140a231cd9f23,
        0x7aff9e20145287cc,
        0x0,
        0x53114619095a34a0d9002661,
        0xd27e7e8f0eca147610cb0cc1,
        0x3e52972d4a36982,
        0x0,
        0x1,
        0x0,
        0x0,
        0x0,
        0xa275d9ba3f01a4729b5b1de,
        0x2e7c82d413acc83b1580dad6,
        0x2babd8f6004223e3,
        0x0,
        0x1,
        0xfd7d6395ca987ce4e26812b,
        0xa7d278cb0988efb62637d8a6,
        0x283b8b96c3282bfd,
        0x0,
    ]
        .span();
    let ecdsa_with_hints = Serde::<
        ECDSASignatureWithHint,
    >::deserialize(ref ecdsa_sig_with_hints_serialized)
        .expect('FailToDeserialize');
    let is_valid = is_valid_ecdsa_signature(ecdsa_with_hints, 4);
    assert!(is_valid);
}


#[test]
fn test_ecdsa_GRUMPKIN() {
    let mut ecdsa_sig_with_hints_serialized = array![
        0x3c26f4ff476ab777dc184776,
        0xbccb2cba46cf421f11eb4d14,
        0x27ec44064c727a3d,
        0x0,
        0x4be0b43c26c6f414a5ea9ea34cff6d0c,
        0x14d85887ecbe1e0c06e6a8310bf6d595,
        0x0,
        0x86b402ce02e7c7ca81f13d51,
        0x39493672733a9289a36020c1,
        0x7f40d91dc5413d3,
        0x0,
        0x371e7b6a5c01505bd4334e81,
        0x2f596ae4492a87c66f7bda1a,
        0x9dffb4dcdb94df9,
        0x0,
        0xb4862b21fb97d43588561712e8e5216b,
        0x967d0cae6f4590b9a164106cf6a659e,
        0x8f339095233858ba5166adb2,
        0xa84c34e63195cf427eabf341,
        0x1bdd5b101b30ca72,
        0x0,
        0x280839cc63fab5892b349f5e,
        0x67376a41c793b8e3e0f043ee,
        0x512671c5b3a11,
        0x0,
        0x327cbd5fd6b325ffc348c543,
        0x9454d5676cc511af23eb0535,
        0x15c0e77d31f24b0c,
        0x0,
        0x72d21fc26759bdb2394fa92c,
        0xebd62b932ae63922c51804ea,
        0x7560943cca3f13a,
        0x0,
        0xf40da38075133dbae6617cd2,
        0xe296412c712c5b20c43258c,
        0x7eb54abda8fe9d7,
        0x0,
        0x14b8e7d49dba48a6291e24c7,
        0x8f8c502d9b2381e3db697106,
        0x808620b4445ab1,
        0x0,
        0x5,
        0x789ed938c7f88cee9d192382,
        0x3b2e66ab057bf46026a88171,
        0x2fb85bf769eef701,
        0x0,
        0x579f8b6f106776c061fdc380,
        0xf8b3849729df240f842eab2d,
        0x12ef4ef4943d9492,
        0x0,
        0xf00e8ad47aae11ec45bff8ac,
        0x2682212f95980f28a6155ad,
        0x23da3b6b71a4b5ab,
        0x0,
        0xcaa1d57aba4c5fe720b70c45,
        0xae9a33847994a896d3ede29,
        0x214de98a60640b23,
        0x0,
        0xd85e62dac5ae71facd8bd327,
        0x1c88c4cd3c7622929dcf9e1c,
        0x7d8efc8ba742083,
        0x0,
        0x6,
        0xfee7bd47ff1e2c560adab716,
        0xea84e596c9c214456ed4eca2,
        0x467b3c8474e65a5,
        0x0,
        0xd3ae80c307eb6f928e88d61,
        0x85d7dd14ed23fb1dc3c81367,
        0x1bdbd6be9595caa0,
        0x0,
        0x1b1464cc89a846ebe9ec122d,
        0xb76c1c1f57adafcabe89fc55,
        0x2f4853c54774b0b2,
        0x0,
        0x8ef45ab3fc834f984f52d675,
        0x149b0bbe4b95d25c89472aae,
        0x225614f1c0dfd25a,
        0x0,
        0xb700ecdf15dd66e862fdd2e9,
        0xec8ce69a2a5a778cfe2d91cb,
        0x1f4af81abe5c2d29,
        0x0,
        0x1,
        0x0,
        0x0,
        0x0,
        0x6,
        0xe36496689ddcdf6592a37394,
        0xf23a5310cf2782e0d401e51f,
        0x2192b4a776f3b780,
        0x0,
        0x70265b5d26130c512ae468d,
        0x4bbf93c262d65a87752fcc72,
        0xd77e87bcea89c1f,
        0x0,
        0xa07baddd085e4d39f63ab81e,
        0x8b79facf104057ff72ffef6b,
        0x1bb11f5629a2fc93,
        0x0,
        0x86f8195c62243910b53e4460,
        0xbd9865ece31a53dc047ac15b,
        0x11b888ff921b57dc,
        0x0,
        0x74162fc92a4f38cf52c9c0ff,
        0x750c3a1771628731e858f348,
        0x1b98f9b9478fee70,
        0x0,
        0xbf92b35b7fc3e4f8c7b13e07,
        0x293fcfb3e6cc1d04bc97a0a3,
        0xded8517c5d2dcfa,
        0x0,
        0x9,
        0x60f4f5a96c2f9712779d78c,
        0xddcd4c699d1f581df44419be,
        0x15e5ac99062e804e,
        0x0,
        0xe054fcdd6e69713ba88e9c99,
        0x4fcd0abd4fa9c6a991bdc8fc,
        0xa51cdd4dcfdccf8,
        0x0,
        0x48f5c8105dd499286752cb14,
        0xf26c309c70e31b90448ab29,
        0x12dba587358be6e7,
        0x0,
        0x355efe2368fd6628065a795d,
        0x2ffc6281d6df407e3389fa71,
        0x163fd1d06c4ef9f,
        0x0,
        0x21230379a7806ee5e60d8bf3,
        0xbbef8bafadb0d6c19cfc5ffd,
        0x1c30bbe79e98aca2,
        0x0,
        0x1b1464cc89a846ebe9ec121c,
        0xb76c1c1f57adafcabe89fc55,
        0x2f4853c54774b0b2,
        0x0,
        0x8ef45ab3fc834f984f52d675,
        0x149b0bbe4b95d25c89472aae,
        0x225614f1c0dfd25a,
        0x0,
        0xb700ecdf15dd66e862fdd2e9,
        0xec8ce69a2a5a778cfe2d91cb,
        0x1f4af81abe5c2d29,
        0x0,
        0x1,
        0x0,
        0x0,
        0x0,
        0x99ebe98820731df563208fa0,
        0xb940392b292b1f66060a249d,
        0x5b1efb808797d94,
        0x0,
        0x2,
        0xd0474590fdcb7c778ee29f67,
        0x58c954ebf5068d6f71ead212,
        0x29f2196244a8174,
        0x0,
        0x1cb3ae54886a2af6ffccaf7c,
        0x86ffa5a30930082aa3eb3735,
        0x864aa87e9baa3a3,
        0x0,
    ]
        .span();
    let ecdsa_with_hints = Serde::<
        ECDSASignatureWithHint,
    >::deserialize(ref ecdsa_sig_with_hints_serialized)
        .expect('FailToDeserialize');
    let is_valid = is_valid_ecdsa_signature(ecdsa_with_hints, 5);
    assert!(is_valid);
}

