#[cfg(test)]
mod msm_tests {
    use garaga::ec_ops::{G1Point, FunctionFelt, u384, msm_g1};


    #[test]
    fn test_msm_BN254_1_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x5fa2a113936f25ec1b9772ad,
                    limb1: 0x421c7f9c91800828c8ff8ab5,
                    limb2: 0x24cddcfe669e1be1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x2e1e9c03d4e65651f87e7c5c,
                    limb1: 0x882d8c2d91d48234f2121e1f,
                    limb2: 0x2431f234c6b9f536,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x2a69acc70bf9c0efb5816b74a985ab61, high: 0x2ce5a415425cb200105ada6b720299e3
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x648ef013c5809854bcfab12,
                limb1: 0x5afc94eedd315eb2508708e5,
                limb2: 0x57b50f10ac2e44b,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xb0fa1710dc5ccb7bba0fb198,
                limb1: 0xb6e09d87fd44112edfbd6756,
                limb2: 0x10bfe9ab4758299,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xe769625e40e7e526af1bb0fb,
                limb1: 0x48b640b52927a5fc3ae05b79,
                limb2: 0x2668ed2337775b95,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xac011413571ba7116d8eb59f,
                limb1: 0xd360bab2105316deaecfbaae,
                limb2: 0x11b365e5221bb0ac,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x7cbde87ba05f9417d145b636,
                limb1: 0xed324c4d107b808f8657131f,
                limb2: 0x14f7022a840e2392,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xebba7e4e5b6e6c2e022ebf4d,
                limb1: 0x4fc32ebf90acf1ddc52c9869,
                limb2: 0x1b41fb5d512ad321,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x67dc88fc0315e6883858578c,
                    limb1: 0x148a659ea3865471d2391152,
                    limb2: 0xcd4b61acfe2a098,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfbc843bd2ca1cb41d0146176,
                    limb1: 0xb85045b68181585d83ac8b5f,
                    limb2: 0x30644e72e131a029,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x34dda820c3922bafc98cf4fa,
                    limb1: 0x1b3ce9f838993f5fbf0a79,
                    limb2: 0x17aafecd507ea4cf,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2863a786c595ca57115df88,
                    limb1: 0x1b37312b12cff1827dfad6f7,
                    limb2: 0x61b20836fd09ffd,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x3439165afa280f07a520f808,
                    limb1: 0xc991462f90c0d85dab9d7985,
                    limb2: 0x254a7269b717535b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7a5ccac0cb06cda17c2ebb3,
                    limb1: 0x449f64b263e22e1a9253698f,
                    limb2: 0x1eeae6c4ab53364b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x62454310c9672dc5adf9df87,
                    limb1: 0x95fd2c366540965c40ee4f2d,
                    limb2: 0x6b27267d39e007b,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x36272dd50e95f6f88429e1a7,
                    limb1: 0x480171076728736087bbb4da,
                    limb2: 0x169cadf5104a4e43,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x792af69450c15f053419e98,
                    limb1: 0x51a59381386fd48779f084e5,
                    limb2: 0x1251618a4f71dff7,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x34dda820c3922bafc98cf4fa,
                    limb1: 0x1b3ce9f838993f5fbf0a79,
                    limb2: 0x17aafecd507ea4cf,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2863a786c595ca57115df88,
                    limb1: 0x1b37312b12cff1827dfad6f7,
                    limb2: 0x61b20836fd09ffd,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x6b3e05976c5f5fe06b0e2f8a,
                    limb1: 0x2a94851e4cd88c8f624616fb,
                    limb2: 0x1ea5fcac72a4bebe,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x49207f85ca3436de0773284e,
                    limb1: 0xb85045b68181585d88d61d43,
                    limb2: 0x30644e72e131a029,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x3cb870ec81eb377da322d4be,
                    limb1: 0xede7ae8ff90e86b6e6537a42,
                    limb2: 0x1aac57da6d3d21f7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x89d791a8a3ea0d1ae646d6e6,
                    limb1: 0xe5cdcb1b485b02962b22eef3,
                    limb2: 0x1591d2c4244dc8dc,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x55b42927a86b3abca23c13b9,
                    limb1: 0xffa7aa5814c0b9dfeb86241f,
                    limb2: 0x2b8fcafee25ccb13,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x10af0142b4218df31b314c49,
                    limb1: 0x9ee541a1e96109705641081d,
                    limb2: 0x10c3a5f659ae1b13,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xaff8d69de4f26b29c8c624be,
                    limb1: 0xb96e87b4eb749bf7d01bed1f,
                    limb2: 0x27d7937fe5022f0f,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x4db7883849a11a6210eb80f3,
                    limb1: 0x1166c5f969aa3bc71b790435,
                    limb2: 0x1fa0b91c6685c5be,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3514ea6caf9d9b39da57876b,
                    limb1: 0xf9191b9b578faf64e9e76249,
                    limb2: 0x105129d98bb7ba6c,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x3cb870ec81eb377da322d4be,
                    limb1: 0xede7ae8ff90e86b6e6537a42,
                    limb2: 0x1aac57da6d3d21f7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x89d791a8a3ea0d1ae646d6e6,
                    limb1: 0xe5cdcb1b485b02962b22eef3,
                    limb2: 0x1591d2c4244dc8dc,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xe74f6c75a93c22cc10e174d,
                    limb1: 0x8fa01c40e82a2a6ed53e6186,
                    limb2: 0x286a4f12cf0c34c9,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8bbd8e60fc1a1859e888a509,
                    limb1: 0xdc2822db40c0ac2e47c7fadc,
                    limb2: 0x183227397098d014,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x66bc90c9f04092dbcb93b92f,
                    limb1: 0x21a639c801bb2bb0bda2fafa,
                    limb2: 0x20810bacb029e86,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6cbc4a4096f99eef3098935d,
                    limb1: 0x3ab7fe6ac95f8a2f6dcb6689,
                    limb2: 0x2568ad9806ddc12b,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xd1fba7355001aab17a5c802f,
                    limb1: 0x8bd7026a9ac1f46057143d55,
                    limb2: 0x2125788a4039e6cd,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5f062fd8cd2f1f1d80f1d8ed,
                    limb1: 0x180adcc663727d566dda5965,
                    limb2: 0x11c3de0a8cf7afc9,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x61db56037b8db7a4b492c9ad,
                    limb1: 0xad2d388e31c32b23f5de58d4,
                    limb2: 0x23246621d6cd6aca,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x3435b25dd0c1b89362bb2b8d,
                    limb1: 0x64f2ad580531831238e8f0ef,
                    limb2: 0x61832306107db92,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x755149a74cabc49fe0cfbf89,
                    limb1: 0x3f876fd3591bedd31a5f5e79,
                    limb2: 0xf716be25236032e,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x66bc90c9f04092dbcb93b92f,
                    limb1: 0x21a639c801bb2bb0bda2fafa,
                    limb2: 0x20810bacb029e86,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6cbc4a4096f99eef3098935d,
                    limb1: 0x3ab7fe6ac95f8a2f6dcb6689,
                    limb2: 0x2568ad9806ddc12b,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x509a53087c4addc418feb2fe,
            limb1: 0xf3351a888c6b0c2342ba0e00,
            limb2: 0x14fec5092821818f,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0xc6b120a09849d81556ffd1ea,
                limb1: 0x8637c9341e9dc623d4d619cb,
                limb2: 0xaa07f2453ccbf99,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            0
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x40a728f6865e51a50dc46048,
                    limb1: 0x5689842b59bb7847e1f51c1,
                    limb2: 0x21a528a45daa9977,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x6eb23298ec9cfacacf1a7eb9,
                    limb1: 0xb9b08621ad547810c3c4b87c,
                    limb2: 0x289070137c883537,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_BN254_2_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xcf93f59e0e594c01e2714c97,
                    limb1: 0x557e2a9da9764a2fa04bb3c5,
                    limb2: 0xbf4c7b223baf3bc,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x789295bbff84727229242dc,
                    limb1: 0x49e59a64d6a7a11831c93c56,
                    limb2: 0x1ec3706982a74d62,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xcf93f59e0e594c01e2714c97,
                    limb1: 0x557e2a9da9764a2fa04bb3c5,
                    limb2: 0xbf4c7b223baf3bc,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x789295bbff84727229242dc,
                    limb1: 0x49e59a64d6a7a11831c93c56,
                    limb2: 0x1ec3706982a74d62,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xd29dc5dfcf1da1100cc36d8c77863fe5, high: 0x1a919c86cffa6cddf963a7efe00111e5
            },
            u256 {
                low: 0x3c54c71fca055362169df82b9bdee2d, high: 0x1ab81354adb328cbf3158c0c66dd7794
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xc7df602ce431327424409110,
                limb1: 0x29185fcf32632cc7d634ec37,
                limb2: 0x14dc4b82945de6fe,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x6236e99f26262bd2dea57c73,
                limb1: 0x2602a200be8ee29bf4e435bc,
                limb2: 0x13e10ff29242e7be,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x3b35eae6c2062e4143517d67,
                limb1: 0xe6ea58fd05a8fdb4ceac8c56,
                limb2: 0x2536f580334a6225,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x58c06af2db24c383f3220131,
                limb1: 0xd642542ae07a43fe02e0e42b,
                limb2: 0x224779914f5fa76f,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0xca04e5e794333ecd4d1845c0,
                limb1: 0x494d57849b92c13bce95b2bc,
                limb2: 0x536a032f4bf08a5,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x5e27a99d67490532a229eacc,
                limb1: 0x54dfbd0babd645d049aa10d1,
                limb2: 0x2b395fc1d75920ca,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xb0b87a60ca1a2023750f9dd4,
                    limb1: 0xa152c66c5435d6e963d5ab93,
                    limb2: 0xcc07e7c47f3e82d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xab97b80fd5a988f0cf30e4b1,
                    limb1: 0xdc2822db40c0ac2e6052c017,
                    limb2: 0x183227397098d014,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x78160867f4a983f96733a9fe,
                    limb1: 0x5787a828a86a8b2c36c2143a,
                    limb2: 0x64e321642d934ae,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd0fe74c249960da0d1cb1fa0,
                    limb1: 0x39b9bb49a5a7e1662100ca93,
                    limb2: 0xf933b3e2918c56f,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xd3572f4c6c23579a70a34be7,
                    limb1: 0xc950e032eaf850044c85180,
                    limb2: 0x27c3e34289be59b5,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x50b8ac81d6a8e05ea12a6ba,
                    limb1: 0x87826b0d6d6833493d6584fe,
                    limb2: 0x27300a8bb74b348a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x203ba4c5a5cd486781dff174,
                    limb1: 0xa7d8903b70f14fd1910c2ce8,
                    limb2: 0x2c04c48f93e7dfce,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x68421937ddfc8bec359afdfa,
                    limb1: 0x696f879f93fa184a4463caf,
                    limb2: 0x12ea9642c88b9e0b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x72fb5e46dcc228e275615ee0,
                    limb1: 0xad2d31dcf0f7a43263025fbb,
                    limb2: 0x2eb9b1ba7b4a504d,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x78160867f4a983f96733a9fe,
                    limb1: 0x5787a828a86a8b2c36c2143a,
                    limb2: 0x64e321642d934ae,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd0fe74c249960da0d1cb1fa0,
                    limb1: 0x39b9bb49a5a7e1662100ca93,
                    limb2: 0xf933b3e2918c56f,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x3c3c677fec51c66ba90beb5f,
                    limb1: 0x56703a31ef3c95f28f80bfb8,
                    limb2: 0x1fcd76e61bb025ad,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xebb9e1f72c8d9cef3db0117a,
                    limb1: 0xb85045b68181585d7fc5b95c,
                    limb2: 0x30644e72e131a029,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xc583dfaeb36d4f83cb38fffa,
                    limb1: 0xa5c80ad7603c79bf9923d8,
                    limb2: 0x109262c15bb2330,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc619b495a7e19dea8b373090,
                    limb1: 0x343807d253e368d6c00a9506,
                    limb2: 0x2f9cdfb36b5dea71,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x2a611b595b89ee49b79b9d43,
                    limb1: 0x37e2f2c039d556dba4ed86b4,
                    limb2: 0x18b5eb5faaf0a72d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9977b6efd52192f2eae39685,
                    limb1: 0xdcac131d69aa8113b37ae901,
                    limb2: 0x12de0bfd0446986a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc60cadd84ffc703d8d791bbe,
                    limb1: 0x31da9e17c473bfe74ac8b7dd,
                    limb2: 0x50b97020903397f,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x508b9f0c1a47ee8b61aaffee,
                    limb1: 0x1f158208620b56d3ecb6b8a,
                    limb2: 0x31b728441316990,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x816988a67f63c191f0ab9722,
                    limb1: 0x2c078c09f8a789c9111ce9f1,
                    limb2: 0x2e0e02347fb67f00,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xc583dfaeb36d4f83cb38fffa,
                    limb1: 0xa5c80ad7603c79bf9923d8,
                    limb2: 0x109262c15bb2330,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc619b495a7e19dea8b373090,
                    limb1: 0x343807d253e368d6c00a9506,
                    limb2: 0x2f9cdfb36b5dea71,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xcb174e1cf58870919a74142b,
                    limb1: 0xd5d395b1da7ed93ba01e3527,
                    limb2: 0x43c31384bba1430,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8bbd8e60fc1a1859e888a509,
                    limb1: 0xdc2822db40c0ac2e47c7fadc,
                    limb2: 0x183227397098d014,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x88dfce58ac84f1cbb4512236,
                    limb1: 0xe77b9efb1c555fbecd27fb40,
                    limb2: 0x16b62be6c1fa887b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6336f9bee5e71f0848133a20,
                    limb1: 0x88189534e045996cfa3f2b7e,
                    limb2: 0x5f6b8bfb928355e,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x4065f1256372aa2a7935352e,
                    limb1: 0x7861d6466313f4da9be2cf63,
                    limb2: 0x162ed5ab0b72bb11,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe27fa22f3749ff663d7d0310,
                    limb1: 0x6511f9de977e4468bb8b0b87,
                    limb2: 0x322c324b453095c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc8ac404e9741798e59b90ded,
                    limb1: 0x8c25b95f6b2944340c32518a,
                    limb2: 0x22e90176c6a2feda,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x322da07cc96e494c4476695b,
                    limb1: 0xfe22973ad37ec6decff68730,
                    limb2: 0x13be354164bdf949,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x29a4ed3cb1b55d18d839ae60,
                    limb1: 0x9849bf9ea0d0cc46eebd827b,
                    limb2: 0x11e42a3f2b78a01b,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x88dfce58ac84f1cbb4512236,
                    limb1: 0xe77b9efb1c555fbecd27fb40,
                    limb2: 0x16b62be6c1fa887b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6336f9bee5e71f0848133a20,
                    limb1: 0x88189534e045996cfa3f2b7e,
                    limb2: 0x5f6b8bfb928355e,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xcd07879a322d1b411826c5b5,
            limb1: 0x6b727f6b830cd85ab96139e3,
            limb2: 0x14504de94dffc885,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0xa398e3f8fb6d2ff25814b9a4,
                limb1: 0xe77de39dee7f8b0614d9ce94,
                limb2: 0x7f1b7526345021d,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            0
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x6276df44cf6321355a2f4e21,
                    limb1: 0xd8f0cf8c94130589fe60b07b,
                    limb2: 0x2b0b88c0ec86f032,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x6b0bc51f16be6ab2223e844f,
                    limb1: 0x69ad4e1c2a2f6990573bc2cf,
                    limb2: 0x2fe4bf0c86835be,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_BN254_3_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x5cbc1b21102c5f60bca7d1bd,
                    limb1: 0xcead21da657601186d1498b7,
                    limb2: 0x20ab848f833fe79f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x3d1fad875373a38cee3edae2,
                    limb1: 0x280221e5e1e382dd4cd15e0e,
                    limb2: 0x2eb380d8e70a1643,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x5cbc1b21102c5f60bca7d1bd,
                    limb1: 0xcead21da657601186d1498b7,
                    limb2: 0x20ab848f833fe79f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x3d1fad875373a38cee3edae2,
                    limb1: 0x280221e5e1e382dd4cd15e0e,
                    limb2: 0x2eb380d8e70a1643,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x5cbc1b21102c5f60bca7d1bd,
                    limb1: 0xcead21da657601186d1498b7,
                    limb2: 0x20ab848f833fe79f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x3d1fad875373a38cee3edae2,
                    limb1: 0x280221e5e1e382dd4cd15e0e,
                    limb2: 0x2eb380d8e70a1643,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x4d6b234fdfa7c6ed32d1f81ba636425c, high: 0xba982e6fa7ff8bfb044284a47acf2f6
            },
            u256 {
                low: 0xec3aa314da9bb01779c147c719a5711b, high: 0x165eaad14d30dbca0acf4c9658de17e
            },
            u256 {
                low: 0xccc14d5173f660d8e9f41cc04653a560, high: 0x106a4fe4dc8215271da3b7e2cad6e514
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x6a6272fd1fa6d3fe9523384c,
                limb1: 0x72f2962e6d0cb1fba2db4e44,
                limb2: 0x39065251234f39f,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xc05d31a31c7ff88c19326111,
                limb1: 0xc3cbd4753821663eed362ffa,
                limb2: 0x23bc24252de7955a,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xd92519a618b11aa312f3650f,
                limb1: 0x35861f15acb0cccfa5d8838c,
                limb2: 0x9b2582a30597e2,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x4fe416ded3d2aa9aa147e51d,
                limb1: 0xdb8b48e36d3e87ae46856592,
                limb2: 0xe06e2e0480e8d0c,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x5a7012167c8ac5e81911b29,
                limb1: 0x4be5fdc7ec7d8eb2334ecd0,
                limb2: 0x2b09bbad3d88831b,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x7d00b4a14c49443f86d69f1,
                limb1: 0x3e2fb9e367e9fd989d8b4b13,
                limb2: 0x2b1c6b78163aa97a,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xf803d322e5bf4cf81538b546,
                    limb1: 0x898ba00bc3f9b40671d5aac5,
                    limb2: 0x193c4b66b5311ffa,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x51732d60df586f6ce00dfaee,
                    limb1: 0xb85045b68181585ce8676094,
                    limb2: 0x30644e72e131a029,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x306fd4fc5599c6b337f056cf,
                    limb1: 0xdf67834a1b46fbe13a9f0f48,
                    limb2: 0xd2b9bc86365cdd6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa1533c6f0c4d58b786b1f33e,
                    limb1: 0x76b08dadaefea54987918395,
                    limb2: 0xc2864be4bbcc4ea,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xb25df58f258de02edcf3ced1,
                    limb1: 0x8bc75ed0e344ecd5809684fc,
                    limb2: 0x2dcb037b102e0c37,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7691bbc29aeac01bb1f02cfc,
                    limb1: 0x9432cd1343011a30640e595b,
                    limb2: 0x27480f995d7076bb,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3a05e81971808e63aaef56e3,
                    limb1: 0x38efd60a44073a674cda8807,
                    limb2: 0x2cef0ce78caac70b,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x914f7ef500cd5419a7d1046d,
                    limb1: 0x9e3689de51d4f3a3afdd2dd8,
                    limb2: 0x2782d3592a316984,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe3f9b54d24e80a269415d9ba,
                    limb1: 0x6411a9090cfbefdc96b48ac0,
                    limb2: 0x24792e3ae3364ebf,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x306fd4fc5599c6b337f056cf,
                    limb1: 0xdf67834a1b46fbe13a9f0f48,
                    limb2: 0xd2b9bc86365cdd6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa1533c6f0c4d58b786b1f33e,
                    limb1: 0x76b08dadaefea54987918395,
                    limb2: 0xc2864be4bbcc4ea,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xdad9713de2d16645a7b1db3a,
                    limb1: 0xa88ec4f01c087325c9a610f9,
                    limb2: 0xadec1fecbaeb5d3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4d34c48a8186ea6b5da79800,
                    limb1: 0xdc2822db40c0ac2ed73b840b,
                    limb2: 0x183227397098d014,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xffa1d9e8fdcce2069bb5254,
                    limb1: 0xb63f7e90519b500c121d1cc7,
                    limb2: 0x7e7bfbd8cda1d8a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x329095c61343121308e1c67b,
                    limb1: 0xb41d04c66f5a8a7584944e4d,
                    limb2: 0xf1da460baec20a7,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xc30febc373f40542259a263e,
                    limb1: 0x61cd1a457e10b79557f403b6,
                    limb2: 0x2c1b86f201c53e70,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xbf2c61fd60005fbb3e771f14,
                    limb1: 0x3b833c0cd34b7950112d236d,
                    limb2: 0xaaef09745970f17,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xcdd38e274f909a52c32c63c4,
                    limb1: 0x694c51aef0a23c16c5dd8390,
                    limb2: 0x2e1b9fc2c38608f5,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x2fee58dbaf966a613d31f6fc,
                    limb1: 0x22be7bb0f4d1f02436575655,
                    limb2: 0x17b73f38a68e58a0,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x97b1c15239c936391aa55371,
                    limb1: 0x1c570e534e0f9f608dbceae7,
                    limb2: 0x2d58ed2230c461f7,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xffa1d9e8fdcce2069bb5254,
                    limb1: 0xb63f7e90519b500c121d1cc7,
                    limb2: 0x7e7bfbd8cda1d8a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x329095c61343121308e1c67b,
                    limb1: 0xb41d04c66f5a8a7584944e4d,
                    limb2: 0xf1da460baec20a7,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xc10df5f5f68ffd3035c370e8,
                    limb1: 0x40cf0fab003f77270b2e9ab9,
                    limb2: 0x2186c3e02a97a361,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8bbd8e60fc1a1859e888a509,
                    limb1: 0xdc2822db40c0ac2e47c7fadc,
                    limb2: 0x183227397098d014,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x78f0e778195b25f4a0758fa7,
                    limb1: 0xecae69b824c1791b3693ef88,
                    limb2: 0x11c2fda9c9616689,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x89a5afc5bba6c51543f87d0f,
                    limb1: 0x7e0bc6c45608b2a2ce73fa34,
                    limb2: 0x4bf6d4300a3852c,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x3275d37ca9a1d44d83e9954a,
                    limb1: 0xbddb2fd60fb227ec5722e997,
                    limb2: 0x15e6c6c7c324f036,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x467ebb46bb33b4bbd4def689,
                    limb1: 0xc89de2f092d669cbd15dc7f1,
                    limb2: 0x1158fda055e46aa4,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x89bdd7d9b9774f2a4896ee42,
                    limb1: 0xcd36ab7f61e723207c440559,
                    limb2: 0x92fb6afd4af1379,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x260ebdb0ff0e5c708e3b1ae,
                    limb1: 0xdbaf771ecc312f40c3a6408,
                    limb2: 0x4e4aa8a7af29374,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9cf10f5132f44f3fcbe9772d,
                    limb1: 0x7a23544d021a17e86b5bee9d,
                    limb2: 0xe3e47c901ea8f85,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x78f0e778195b25f4a0758fa7,
                    limb1: 0xecae69b824c1791b3693ef88,
                    limb2: 0x11c2fda9c9616689,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x89a5afc5bba6c51543f87d0f,
                    limb1: 0x7e0bc6c45608b2a2ce73fa34,
                    limb2: 0x4bf6d4300a3852c,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xbbd7519027e927956de436f,
            limb1: 0x85b19dfe0822259c92f07b47,
            limb2: 0x115d366524610f62,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            0
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x40572332e3cc2dd2883304ec,
                    limb1: 0xc27b295f8b326e7aec18dccc,
                    limb2: 0x24bd5e34fbbd3841,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xfb03279d6139c6a0f9e564b0,
                    limb1: 0x722534a40d40e14d91db8f86,
                    limb2: 0x17deaa119ef69fd8,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_BN254_4_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x931e6fd927ea6a4393400681,
                    limb1: 0xb8e31386e7870edc74eaeb7,
                    limb2: 0x24651f420a1afbb9,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x4003a0b51fc122266fb9166a,
                    limb1: 0x60d90837ebe9b50deb17ce6e,
                    limb2: 0x3a94da8cb2a9c85,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x931e6fd927ea6a4393400681,
                    limb1: 0xb8e31386e7870edc74eaeb7,
                    limb2: 0x24651f420a1afbb9,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x4003a0b51fc122266fb9166a,
                    limb1: 0x60d90837ebe9b50deb17ce6e,
                    limb2: 0x3a94da8cb2a9c85,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x931e6fd927ea6a4393400681,
                    limb1: 0xb8e31386e7870edc74eaeb7,
                    limb2: 0x24651f420a1afbb9,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x4003a0b51fc122266fb9166a,
                    limb1: 0x60d90837ebe9b50deb17ce6e,
                    limb2: 0x3a94da8cb2a9c85,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x931e6fd927ea6a4393400681,
                    limb1: 0xb8e31386e7870edc74eaeb7,
                    limb2: 0x24651f420a1afbb9,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x4003a0b51fc122266fb9166a,
                    limb1: 0x60d90837ebe9b50deb17ce6e,
                    limb2: 0x3a94da8cb2a9c85,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xd9ead9264745dd9e27896389df3277fd, high: 0xd2ac63f0a68e88e0ad4041504c14982
            },
            u256 {
                low: 0x50910bdc8ef066d44279b14dae55cdff, high: 0x2451646bf03d866a5decc06af24dfdd8
            },
            u256 {
                low: 0xd8ab0b300ac0cf0dd974c146e8ec01b3, high: 0x26e2dc68b38a05fbf61164cebfc74ca9
            },
            u256 {
                low: 0xa4e695c9b65d12267e969cf3a7c5cb87, high: 0x1bde4256a3e04b3b756b0715e7180322
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xbd36cd6fa7dd5290e2d647a8,
                limb1: 0x8234860512f2f932246a80f2,
                limb2: 0x29596a0cb2c43d2a,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x4211c3988698cb8a9b36350e,
                limb1: 0xad86501a8e7a0645a9f8be1f,
                limb2: 0x2b83609399b8fa8e,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xde9a10c5a6f031ef2b5719c9,
                limb1: 0x40993956c080a4b61cf96e7b,
                limb2: 0x2f81b44ed483e4a1,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x55da5197abedfcaac014a869,
                limb1: 0x5d8c571357c867e8f462869f,
                limb2: 0x1d891e623a81c1f3,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0xf767b938b7e89328e2734153,
                limb1: 0x503820440b4f4fbdffcc3d52,
                limb2: 0x1fc704f572a60d82,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x9566ad1e4f3e5db3d9386aa4,
                limb1: 0x8c108aeb419a86e4f1011081,
                limb2: 0x28d129cc24c5fc9b,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xe9b92cf6f05f13096017814,
                    limb1: 0xbd3fefa7cc170ca9517b3b14,
                    limb2: 0x1228727595352fff,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x14faaaa3f42cf0ea472051d6,
                    limb1: 0xdc2822db40c0ac2e3c766d94,
                    limb2: 0x183227397098d014,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xd3423ca843ee85578208bbf6,
                    limb1: 0x38b8ec8c0d115e4c9980b305,
                    limb2: 0x1ead167fc30e659,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x808e57d1a8795b593ae3ac65,
                    limb1: 0xe2ddd42f8197469b4349a578,
                    limb2: 0x130a13970584076f,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x864eadbd0e9007a44c8a3d9d,
                    limb1: 0x406c3dd90ca263c4dc6b6654,
                    limb2: 0x15cbf952e86d5ff4,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x827df24196b57d951fcd21f,
                    limb1: 0xd24f76d4e866a1c05916940e,
                    limb2: 0x227358be2aa7f43,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xceab82d8fe9e80533818ccc3,
                    limb1: 0x300ffa90cbfa3ad7728a5b3,
                    limb2: 0x1a0d7cb145f1629d,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x79c6b5f8cbcb9006861a33e2,
                    limb1: 0xaa2ac5a427341ae5cc821911,
                    limb2: 0x5c07437f492b30b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x19393ce7bd4b85f4d82e07e8,
                    limb1: 0xf04936d803447b74325b85d8,
                    limb2: 0x8b9ec522f5a7625,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xd3423ca843ee85578208bbf6,
                    limb1: 0x38b8ec8c0d115e4c9980b305,
                    limb2: 0x1ead167fc30e659,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x808e57d1a8795b593ae3ac65,
                    limb1: 0xe2ddd42f8197469b4349a578,
                    limb2: 0x130a13970584076f,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xd82539db2c784440a1fc013f,
                    limb1: 0xb745b33b06dbd20a8c49c93b,
                    limb2: 0x13a9884fd1efc960,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2636fb172a238d6cbcb8a33b,
                    limb1: 0xb85045b68181585d6c258ed2,
                    limb2: 0x30644e72e131a029,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xa4f684802bc950b442dc302a,
                    limb1: 0x35e772e1ec6695ca86bf0a55,
                    limb2: 0x18ffcc26e8cb45a9,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5f2b147ba9667bfaf262da44,
                    limb1: 0x247920ddd4099b174abab7ef,
                    limb2: 0xce1c954e3c45ff9,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x38b94bf59c77fa6b70bde34b,
                    limb1: 0xf334b89b7214da66bf415919,
                    limb2: 0x120d805751f8bac9,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3275cf0338c2865d65f4bda9,
                    limb1: 0xf4ca3f8c079279ee246944,
                    limb2: 0x2ecdb0778e168868,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc5d14da4605be735e4071143,
                    limb1: 0x843e37cdb1d9b7171f1e9d55,
                    limb2: 0x299c447fae1ee1cf,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x8671c2f3473b6605f0179337,
                    limb1: 0xe96612ef43b26901fcbbb46f,
                    limb2: 0x1a9b1601d93030d1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1d813d72fc3373f0d7288ecc,
                    limb1: 0x6d6b62997c1cd145e03027ce,
                    limb2: 0x26a55bfeab4d1feb,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xa4f684802bc950b442dc302a,
                    limb1: 0x35e772e1ec6695ca86bf0a55,
                    limb2: 0x18ffcc26e8cb45a9,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5f2b147ba9667bfaf262da44,
                    limb1: 0x247920ddd4099b174abab7ef,
                    limb2: 0xce1c954e3c45ff9,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xbf9d2a5a29c54926e50c3a6a,
                    limb1: 0xa6c0d477b5e8857ea8cf6c34,
                    limb2: 0x121f6fd505521942,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8bbd8e60fc1a1859e888a509,
                    limb1: 0xdc2822db40c0ac2e47c7fadc,
                    limb2: 0x183227397098d014,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x19576aa11b1f69a71a372e7d,
                    limb1: 0xc9c378c4312392d4b04cbcc6,
                    limb2: 0x25935bbc554ba882,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfae1cb1c19685315a32f9f72,
                    limb1: 0xdfcf31d23732bc47123d2953,
                    limb2: 0x117fe3a17b394e2f,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x33cb8acec4f4e8a70aafd5af,
                    limb1: 0x772ce1f001e029e07f22c99d,
                    limb2: 0x2945492ddd5d5135,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xedc732d4d3ed39c339fc90c5,
                    limb1: 0x1bcf4800f7990b25eba130c7,
                    limb2: 0xf1b8770e05b3757,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe024d52bc9a1b0d72bf7643d,
                    limb1: 0xe2a227e2a4501ba44f94a38f,
                    limb2: 0x36abc5267e9e910,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x7b22aac8d91d24c79dab90e9,
                    limb1: 0xeca9dedf906807c2e1e3612f,
                    limb2: 0xff1764f3d7fb934,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x883396c710186d2a1111e10f,
                    limb1: 0xe71d4fc02416dc779f36116a,
                    limb2: 0x41b5c71907a4a65,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x19576aa11b1f69a71a372e7d,
                    limb1: 0xc9c378c4312392d4b04cbcc6,
                    limb2: 0x25935bbc554ba882,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfae1cb1c19685315a32f9f72,
                    limb1: 0xdfcf31d23732bc47123d2953,
                    limb2: 0x117fe3a17b394e2f,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x851623b645e27559ac2cf29e,
            limb1: 0xb4f813792a702c8c409b956c,
            limb2: 0x6edfccc0b090ad0,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            0
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x47afbd94332e32a251c001b1,
                    limb1: 0xf2aa8cc2bf97371c11ed60ad,
                    limb2: 0x2ad029b19cc0811a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x1c4ef39d510e4943708d332a,
                    limb1: 0xda0a787e20ddc0c959f7b887,
                    limb2: 0x277dfc80bf15d34d,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_BN254_5_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x4c27e32a2ca05e0f0fe6f90c,
                    limb1: 0xa9727e05cff73bab0fd348cb,
                    limb2: 0x1b52abe53c3b7c0f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd90218fc81af546fe8664c08,
                    limb1: 0xd2e99a8877edb45785cb57a9,
                    limb2: 0x2794d3594b029779,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x4c27e32a2ca05e0f0fe6f90c,
                    limb1: 0xa9727e05cff73bab0fd348cb,
                    limb2: 0x1b52abe53c3b7c0f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd90218fc81af546fe8664c08,
                    limb1: 0xd2e99a8877edb45785cb57a9,
                    limb2: 0x2794d3594b029779,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x4c27e32a2ca05e0f0fe6f90c,
                    limb1: 0xa9727e05cff73bab0fd348cb,
                    limb2: 0x1b52abe53c3b7c0f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd90218fc81af546fe8664c08,
                    limb1: 0xd2e99a8877edb45785cb57a9,
                    limb2: 0x2794d3594b029779,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x4c27e32a2ca05e0f0fe6f90c,
                    limb1: 0xa9727e05cff73bab0fd348cb,
                    limb2: 0x1b52abe53c3b7c0f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd90218fc81af546fe8664c08,
                    limb1: 0xd2e99a8877edb45785cb57a9,
                    limb2: 0x2794d3594b029779,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x4c27e32a2ca05e0f0fe6f90c,
                    limb1: 0xa9727e05cff73bab0fd348cb,
                    limb2: 0x1b52abe53c3b7c0f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd90218fc81af546fe8664c08,
                    limb1: 0xd2e99a8877edb45785cb57a9,
                    limb2: 0x2794d3594b029779,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x4578bab326a974652371ea2c0247145f, high: 0x17803a9bca24be4d56672017555a4085
            },
            u256 {
                low: 0xc787ddfb5697f17c17fd3736b7ef941c, high: 0x11417d3d0a8c46c709215f4f9edb95f2
            },
            u256 {
                low: 0xdb66bfda2df967474ed135530c5a876f, high: 0x135ef4c1122411e6ba8982dd85e69ea9
            },
            u256 {
                low: 0x4c9a0ae15419eefcd5e73e3f673617d9, high: 0x23e4a37119724ce31bd094486a2b3200
            },
            u256 {
                low: 0x1db2b4527aa56a181fd3c01757f98d1e, high: 0x26bb6f46d316b4a7f6b8793b318ad4c
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x1069862fe861fd7fcb57e858,
                limb1: 0x5f56317f96502b35a038be2,
                limb2: 0x2242ad0717663b68,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x8a514a216e025e646929b470,
                limb1: 0x4985d06dc1e98e4b6fbdebaf,
                limb2: 0x3d3ae27a300dd74,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x67dcba596e93ecfb1c0b4b9e,
                limb1: 0xd3155e4909bff75d23936501,
                limb2: 0x24c56570b08ac19b,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xefb21ccf159b25e533beccba,
                limb1: 0xc88db2c609475e329d3336a4,
                limb2: 0x2f7ff8ef18699de2,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x5359d93eb6b08c1df32a5a82,
                limb1: 0x81862c0e96c5c3c2dec9f08c,
                limb2: 0x1e26a9344af28086,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x1c56a4040333d99ea03fe289,
                limb1: 0x997da03883005b8314ee1efe,
                limb2: 0x19ff79b068500cfd,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x2cd2ddf01215b609c0f30d5,
                    limb1: 0xb1820fe957b5d6040966a59b,
                    limb2: 0x209f54224d721d25,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x766a9a0f5dea323cb48b5b19,
                    limb1: 0xb85045b68181585ce4099e27,
                    limb2: 0x30644e72e131a029,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xbb68bef37d2f1e7885dfc0d5,
                    limb1: 0x17c8ae12679da6dbd2495016,
                    limb2: 0x17c890f9f94359e9,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x74522bc0633ebc9ed5bb192a,
                    limb1: 0xc138aa4f39a6725cc52c0075,
                    limb2: 0x233343f96ec188db,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x9f66dca1bfad45a57521f8f0,
                    limb1: 0x2124211e13f8f1d68a06f98e,
                    limb2: 0x2377c9f481c0ef43,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xcb230f8a67231db6cc920e8d,
                    limb1: 0x1dd1045d70aabbfab3e4af10,
                    limb2: 0x2faa74834cce4dd7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4f2a6458eed1cd9446d37f92,
                    limb1: 0xe8f693f38157011f4588b43a,
                    limb2: 0x24d878e395458573,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xc9c8724d3b6ccf52b9224538,
                    limb1: 0x8f09c480b5579c35df5a85b2,
                    limb2: 0x16f5647b0a986d91,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8c12ee26b17b1daed03750f0,
                    limb1: 0xd3097380a9f0a65b20812c3d,
                    limb2: 0x8d12f0689e15a3f,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xbb68bef37d2f1e7885dfc0d5,
                    limb1: 0x17c8ae12679da6dbd2495016,
                    limb2: 0x17c890f9f94359e9,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x74522bc0633ebc9ed5bb192a,
                    limb1: 0xc138aa4f39a6725cc52c0075,
                    limb2: 0x233343f96ec188db,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x16774412cead9de08ed9ed4f,
                    limb1: 0xa5c750aba6e7cf308eafcd64,
                    limb2: 0xa1d17dfcca5e428,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf3825e79a9d1296cb7f0e459,
                    limb1: 0xdc2822db40c0ac2ea3dc1426,
                    limb2: 0x183227397098d014,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x2d64e24810505a5fb7644a7c,
                    limb1: 0xdfb91d7210a1909231864b40,
                    limb2: 0x6b71ef3dc29dec5,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1cdef796dd0ccd238507b5e4,
                    limb1: 0xf418af1e294b7db2fb9c2756,
                    limb2: 0x20b08b8fd59d02a7,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x4af004461b14ba8a86134725,
                    limb1: 0x89a0e8e7ac253d2048ecee9f,
                    limb2: 0x1a95e304305195f1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2a89556b5b54ad1265c023e0,
                    limb1: 0xa1284624028f5a37d07b5493,
                    limb2: 0x8a2da92fdc60c52,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7889ad1fd5b81dc7632d78d5,
                    limb1: 0xc1dd87b143e4f9bb3db85815,
                    limb2: 0x2aa2d5628a05cf65,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x882ea6d830f10f1f262cdf74,
                    limb1: 0x9f2b585631e4b1b69492e1c0,
                    limb2: 0x14255cdb947d9c51,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x85b951aa1ee54f3cde1d271e,
                    limb1: 0x6ba981ed78dfc85dc3d1a0df,
                    limb2: 0x14905c9be73c7a4,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x2d64e24810505a5fb7644a7c,
                    limb1: 0xdfb91d7210a1909231864b40,
                    limb2: 0x6b71ef3dc29dec5,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1cdef796dd0ccd238507b5e4,
                    limb1: 0xf418af1e294b7db2fb9c2756,
                    limb2: 0x20b08b8fd59d02a7,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xab096e501d7e6fcd140f8c2f,
                    limb1: 0xe145bad29f96395caa04db1f,
                    limb2: 0x16a616e95ad50f42,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8bbd8e60fc1a1859e888a509,
                    limb1: 0xdc2822db40c0ac2e47c7fadc,
                    limb2: 0x183227397098d014,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xecdcf95a495d5bb8138473b9,
                    limb1: 0xe12b4eace389dad2b8a0eb61,
                    limb2: 0x2785aff2ddaa537f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x15ad018252fc9f14a1c4546e,
                    limb1: 0x1c050115627cf59b2ca57f95,
                    limb2: 0x1ddc8e40c6e5fe31,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xa0200346843e11d575238f0b,
                    limb1: 0x9d0cf1f7b331c5ef1fb39154,
                    limb2: 0x17ba799721c77c84,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x29b5ad34bd81405056d59d96,
                    limb1: 0xca31c8f63d7b812d938cf170,
                    limb2: 0x2a02f8ccbab9f4c1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb83bae6356b1474556a5f9a7,
                    limb1: 0xe1249ba51099669d8cc16c19,
                    limb2: 0xf817504ee5c130f,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xf5b356f463d6fafa8993609d,
                    limb1: 0x32e16099a79adfbcfadfed02,
                    limb2: 0x15c872f2d69bba2c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd89539f9bcd551270cd00003,
                    limb1: 0x9bbebd89a5f58873ee6f142d,
                    limb2: 0x29315c4f73805a69,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xecdcf95a495d5bb8138473b9,
                    limb1: 0xe12b4eace389dad2b8a0eb61,
                    limb2: 0x2785aff2ddaa537f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x15ad018252fc9f14a1c4546e,
                    limb1: 0x1c050115627cf59b2ca57f95,
                    limb2: 0x1ddc8e40c6e5fe31,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x87fec7285506d831ba552cf1,
            limb1: 0x299bdf50502a3144fe09f13e,
            limb2: 0x4106e3daf6e5375,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            0
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x19a8180340c9dc1e014350fb,
                    limb1: 0xd4e6b9493478b96f86fd6800,
                    limb2: 0x6ad67100b805ad0,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd3a90b02ea86d180eaf52e64,
                    limb1: 0xefde4f66e3208784d58fdb4c,
                    limb2: 0x18ffc9cf86ef5629,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_BN254_6_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x1afc5a6149b7fdf3d43333f5,
                    limb1: 0xd08e7fbeb73215a92505cb93,
                    limb2: 0x2d71861f8584a9b8,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xae5c8cb2815d5843bc6fca1c,
                    limb1: 0xc8724761c209919dc760cd38,
                    limb2: 0x1e3ff16b4e49d24a,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x1afc5a6149b7fdf3d43333f5,
                    limb1: 0xd08e7fbeb73215a92505cb93,
                    limb2: 0x2d71861f8584a9b8,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xae5c8cb2815d5843bc6fca1c,
                    limb1: 0xc8724761c209919dc760cd38,
                    limb2: 0x1e3ff16b4e49d24a,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x1afc5a6149b7fdf3d43333f5,
                    limb1: 0xd08e7fbeb73215a92505cb93,
                    limb2: 0x2d71861f8584a9b8,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xae5c8cb2815d5843bc6fca1c,
                    limb1: 0xc8724761c209919dc760cd38,
                    limb2: 0x1e3ff16b4e49d24a,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x1afc5a6149b7fdf3d43333f5,
                    limb1: 0xd08e7fbeb73215a92505cb93,
                    limb2: 0x2d71861f8584a9b8,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xae5c8cb2815d5843bc6fca1c,
                    limb1: 0xc8724761c209919dc760cd38,
                    limb2: 0x1e3ff16b4e49d24a,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x1afc5a6149b7fdf3d43333f5,
                    limb1: 0xd08e7fbeb73215a92505cb93,
                    limb2: 0x2d71861f8584a9b8,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xae5c8cb2815d5843bc6fca1c,
                    limb1: 0xc8724761c209919dc760cd38,
                    limb2: 0x1e3ff16b4e49d24a,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x1afc5a6149b7fdf3d43333f5,
                    limb1: 0xd08e7fbeb73215a92505cb93,
                    limb2: 0x2d71861f8584a9b8,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xae5c8cb2815d5843bc6fca1c,
                    limb1: 0xc8724761c209919dc760cd38,
                    limb2: 0x1e3ff16b4e49d24a,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xce5dc8076025719990823edaa0722aa0, high: 0x590205aa38d8afcfdd2ed7af97ccc57
            },
            u256 {
                low: 0x32b2c49215ace7a1ceca2ee310da8a95, high: 0x18a0c21a0fa7ee0538974df5bff773ce
            },
            u256 {
                low: 0xb6e355f695bb440dc9cd4af97d161f29, high: 0x55abd166c4c3935379deda1ade6c5e9
            },
            u256 {
                low: 0xffc573d5fd0ba70e385af4635e4af862, high: 0xaa943d3c6f0093395d1805142cb6d1d
            },
            u256 {
                low: 0x869bdbd2e72bb5b707120911b3b68b57, high: 0xce87470ad4ab155c09fcd8f739cd488
            },
            u256 {
                low: 0x9f9821883744da64cc249558f2ad985f, high: 0x1d568eb032ae2a201ac902ee25777cf0
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x3216f054a0460fb92fbc691,
                limb1: 0x7ad8b16e718441462f37e0bb,
                limb2: 0x1ba569354fa49859,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x19725170440b9918a90ba8be,
                limb1: 0x4cd72ef6df705215105ec0bf,
                limb2: 0xb51e54fdadef6fe,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xde85fc977b397ff58bd7c0f0,
                limb1: 0x82f0c645e242ca8a345f397a,
                limb2: 0x18b405ea49a8e925,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x23685b88aff2e18880760f28,
                limb1: 0x97bb905a0625a4d3408519ce,
                limb2: 0x1e248a9f32d57fca,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x41272b6ab972de8bfa58f12a,
                limb1: 0x8c32cb157fe5411b679ed7f4,
                limb2: 0xd010a21651487fe,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x782c15efda08e791b9289c1a,
                limb1: 0xf9a818c2874333abd4821f7e,
                limb2: 0x1e35ec9f890677d0,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x88202f3e20020f70ab5f0ce,
                    limb1: 0x69965340fb2837a13947a907,
                    limb2: 0x2baa6694988f9e6c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8e4804104e89eaea972b51ca,
                    limb1: 0xdc2822db40c0ac2da53501d7,
                    limb2: 0x183227397098d014,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x7bd3d993f15484403344dd65,
                    limb1: 0x27d355a7e370fa10fd75d778,
                    limb2: 0x3dd1f8311e0a9b2,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb2c5cbb3e484b93e49cb0008,
                    limb1: 0x25395a3fda4c59cbdac528d4,
                    limb2: 0x17b1ad90ed39fe41,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xcc586c7efb302d472b91eb86,
                    limb1: 0x4a3216c36f7afc01302abcd3,
                    limb2: 0x2c1c2ec16f203da5,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x54c576ca1ac4cdd3e25ee6c7,
                    limb1: 0xbbb6dbe600e9462e4e7dd60c,
                    limb2: 0x7c87e9bc536fa4b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe2d65f17938aaa72ab3ca72e,
                    limb1: 0x8be0d2fe17c4602117d001ea,
                    limb2: 0x25c2ece89861ae78,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x737b8cbbd3fd8cc099ce982f,
                    limb1: 0x777a00f7aa52ee32f8618669,
                    limb2: 0xb975e8935a1fd16,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xafdf988e716d9fa404e402d1,
                    limb1: 0xb75bc9090d63b505f8ce0fec,
                    limb2: 0x16b0ba3fe67c5a99,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x7bd3d993f15484403344dd65,
                    limb1: 0x27d355a7e370fa10fd75d778,
                    limb2: 0x3dd1f8311e0a9b2,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb2c5cbb3e484b93e49cb0008,
                    limb1: 0x25395a3fda4c59cbdac528d4,
                    limb2: 0x17b1ad90ed39fe41,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x555b3089f727e94a2c79079d,
                    limb1: 0xbef7993cf65f20a18ba03067,
                    limb2: 0x263115b8ba45c94e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x15aa2cc460ac736acc25e64,
                    limb1: 0xb85045b68181585d86947396,
                    limb2: 0x30644e72e131a029,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x7ef87f5d7f81765852c49946,
                    limb1: 0xccff9698b8648079d2fcc59a,
                    limb2: 0xd6cc238c7d88e29,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd7613e21b34f9a4450ef05a9,
                    limb1: 0x1d214568698dd087d59dd014,
                    limb2: 0x1aa310dbf335ad75,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x79ffa9bd79435db1687f683b,
                    limb1: 0x308e29c220574690ccfcf588,
                    limb2: 0xe86899f265aef0d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xeb98e16a5923e076be386945,
                    limb1: 0x98aa298d161468aaec537bbd,
                    limb2: 0x11ef6eeae4f84971,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x62d1408278b861c22945a374,
                    limb1: 0x49a4873abc9acb7e7371688b,
                    limb2: 0x10a17166e2fffaea,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x7ce97e187e846308f84dcbd2,
                    limb1: 0x66fec3ca292d816d78f650cf,
                    limb2: 0x284646aa5789aa7d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1db1efd7ddce42b61a5013b4,
                    limb1: 0x9f138a82bb281939e95805ad,
                    limb2: 0x1f84e420f86f6835,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x7ef87f5d7f81765852c49946,
                    limb1: 0xccff9698b8648079d2fcc59a,
                    limb2: 0xd6cc238c7d88e29,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd7613e21b34f9a4450ef05a9,
                    limb1: 0x1d214568698dd087d59dd014,
                    limb2: 0x1aa310dbf335ad75,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x7e4648c8bc2ea7d4c6387f7a,
                    limb1: 0x889e7eac87094e57ce82c11d,
                    limb2: 0x71ee39e15212c3e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8bbd8e60fc1a1859e888a509,
                    limb1: 0xdc2822db40c0ac2e47c7fadc,
                    limb2: 0x183227397098d014,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x9205f5d76b85ce5a56a7b83c,
                    limb1: 0x65578e902b970dec5630656a,
                    limb2: 0x265322ffb9a08f7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x48c4a28b07742d95524c4b2d,
                    limb1: 0xa92cb45b1f594cb7fb835922,
                    limb2: 0xaaf3e6732742f05,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xc0d8955622356598ddc3157c,
                    limb1: 0x9a4bb084fb492ae8b3da95f5,
                    limb2: 0x4f04e76255c9246,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9862288d3439598932ad9957,
                    limb1: 0xd766bd5cd0e9fcb156f92161,
                    limb2: 0x1d38786aea270637,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf10cdff327e9f25dc5ab4c68,
                    limb1: 0x68ffdd80c807ecdaacef3244,
                    limb2: 0x5c225c8943417c4,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xb611e18642916b0f03f728b4,
                    limb1: 0x3006abb082c529c50291303f,
                    limb2: 0x72f968ff2ce1ae6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xda4de7a1165c88bff6e4e187,
                    limb1: 0xfb861d115e0be627f28a0b66,
                    limb2: 0x200dbb35975c8d10,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x9205f5d76b85ce5a56a7b83c,
                    limb1: 0x65578e902b970dec5630656a,
                    limb2: 0x265322ffb9a08f7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x48c4a28b07742d95524c4b2d,
                    limb1: 0xa92cb45b1f594cb7fb835922,
                    limb2: 0xaaf3e6732742f05,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xbbb5e4432d0b29eccc1eb650,
            limb1: 0xfa20fa7cb14dd0b5fd63a9d4,
            limb2: 0x16fa9e8100fe2990,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            0
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x3f603af5fcc396a0cbf1cf8,
                    limb1: 0xcdd45dd8f9015a0b57272da7,
                    limb2: 0x1a495411047bd446,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xca89e03a6e61293879814ba3,
                    limb1: 0xdb664d80698c47c99225592f,
                    limb2: 0x2ed28ecf1077547,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_BN254_7_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x1ad7b356362056acb8a11e6b,
                    limb1: 0x8072e8936773ce5493235087,
                    limb2: 0x1a08339509cd28a3,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x3491d5f6282cdf967ab3d8e8,
                    limb1: 0xec83710ecebf4da7de431970,
                    limb2: 0xce4f5217cd66351,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x1ad7b356362056acb8a11e6b,
                    limb1: 0x8072e8936773ce5493235087,
                    limb2: 0x1a08339509cd28a3,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x3491d5f6282cdf967ab3d8e8,
                    limb1: 0xec83710ecebf4da7de431970,
                    limb2: 0xce4f5217cd66351,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x1ad7b356362056acb8a11e6b,
                    limb1: 0x8072e8936773ce5493235087,
                    limb2: 0x1a08339509cd28a3,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x3491d5f6282cdf967ab3d8e8,
                    limb1: 0xec83710ecebf4da7de431970,
                    limb2: 0xce4f5217cd66351,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x1ad7b356362056acb8a11e6b,
                    limb1: 0x8072e8936773ce5493235087,
                    limb2: 0x1a08339509cd28a3,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x3491d5f6282cdf967ab3d8e8,
                    limb1: 0xec83710ecebf4da7de431970,
                    limb2: 0xce4f5217cd66351,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x1ad7b356362056acb8a11e6b,
                    limb1: 0x8072e8936773ce5493235087,
                    limb2: 0x1a08339509cd28a3,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x3491d5f6282cdf967ab3d8e8,
                    limb1: 0xec83710ecebf4da7de431970,
                    limb2: 0xce4f5217cd66351,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x1ad7b356362056acb8a11e6b,
                    limb1: 0x8072e8936773ce5493235087,
                    limb2: 0x1a08339509cd28a3,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x3491d5f6282cdf967ab3d8e8,
                    limb1: 0xec83710ecebf4da7de431970,
                    limb2: 0xce4f5217cd66351,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x1ad7b356362056acb8a11e6b,
                    limb1: 0x8072e8936773ce5493235087,
                    limb2: 0x1a08339509cd28a3,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x3491d5f6282cdf967ab3d8e8,
                    limb1: 0xec83710ecebf4da7de431970,
                    limb2: 0xce4f5217cd66351,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x905c053b25fdacbe7ce71b48fba52e59, high: 0x1b165885ae0fdbc8a36bcb0167e98363
            },
            u256 {
                low: 0xa2939b3b7fa74d8aff88ec827f99d273, high: 0x22bd624033b5b3cedfec4623ab899605
            },
            u256 {
                low: 0x27c013f38018399ee6a8e2f9c19ed34, high: 0x2fcf7c2ef66ac168b4a1ca795718ada2
            },
            u256 {
                low: 0x27e969e2c8bf23fb9a431f7a41c30359, high: 0x12d7290d953c178e61067a8cd7a3283c
            },
            u256 {
                low: 0x786e30efce9b2e70b4d4dfccb7d779cc, high: 0x210eca9f15ab2c21ccc93ff710fce97d
            },
            u256 {
                low: 0x10fc9eee0a1727f7ea5f24b6de6fec4b, high: 0x133a8b7c0a66dc4e21681081399f8a8f
            },
            u256 {
                low: 0x75f2bc20a7f5195cde62d43f261908b9, high: 0x18767f8e8147a8f45f0ef320f7f60e7f
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xccbd1db559ef5f9331f9ac23,
                limb1: 0x68806bdc24f976ba49ae0d8b,
                limb2: 0x1e1487c1dc33908,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x413ed3d0191792d0d4281b94,
                limb1: 0x708e97daf8c6914f1db431bf,
                limb2: 0x166c965b9e0f34a6,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x5136d041161da925fba201e4,
                limb1: 0xbad448b35d808ea02b19f2cf,
                limb2: 0x1a877e41e574c6a6,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xbe294e7d0cd2773b4ea1c252,
                limb1: 0x99d40a1cc3e14608f52e7a66,
                limb2: 0x24227e16e93473aa,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0xd4143e7c279d21dc417bbdae,
                limb1: 0xb1072efbf6d35bb48754ff92,
                limb2: 0x16b7374561ed4f9f,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x3103acc003b2664c599eff82,
                limb1: 0x10aa3ba910c5e60a9cd38d3d,
                limb2: 0x15fd8a2c3ce68d6d,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x5ccac196d9bc7d0e47e2e6a,
                    limb1: 0x2e765327f6dd9880cbab37ac,
                    limb2: 0x2e50bb5d2d563839,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6b7733841f006226af9cd579, limb1: 0xb5f8f34c, limb2: 0x0, limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xe78442bd805bf210ded876d9,
                    limb1: 0x5a6d37ba1bcc63d5628d3433,
                    limb2: 0x280a837d32b18e36,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x80dcf981ac10d5d6ede232b9,
                    limb1: 0xcf5cf146f514134ebab00c7e,
                    limb2: 0x147ad261b9a13e7d,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xfa81e11f78af2a9473ad9d46,
                    limb1: 0xd754580f8deef0b14bd6c575,
                    limb2: 0x2e60f42178e6ce6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd4342aa8e637af151e912e69,
                    limb1: 0x6c7a060085be13981fe47dc3,
                    limb2: 0xaf5889d68f46f95,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xad1207434b3101e3a1ff3d4a,
                    limb1: 0xb91c37d6669d6afcb7e3c726,
                    limb2: 0x19ea77557e128931,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xe5a9331e08d2be04eb8f69fd,
                    limb1: 0x9ea71bc150627ac4f8a4c778,
                    limb2: 0x1756ed91d5b16a4f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1a2521f7c811f56df1299ae4,
                    limb1: 0xb5c68e1e5dbae18e988ebaea,
                    limb2: 0xd0c28b24bb21b4f,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xe78442bd805bf210ded876d9,
                    limb1: 0x5a6d37ba1bcc63d5628d3433,
                    limb2: 0x280a837d32b18e36,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x80dcf981ac10d5d6ede232b9,
                    limb1: 0xcf5cf146f514134ebab00c7e,
                    limb2: 0x147ad261b9a13e7d,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x233f360da3b4ea08d1c3c217,
                    limb1: 0x97bfa68e968295d4e631694e,
                    limb2: 0x2afa6d1a26d34772,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x581d20e02e86b2644eed1ae4,
                    limb1: 0xb85045b68181585d2ce94e39,
                    limb2: 0x30644e72e131a029,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x60003240ee98490719363aa0,
                    limb1: 0xd1d0f1e494f9be42e2eafa4a,
                    limb2: 0xd82495ad83436a4,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x64d511832c03185afcb6da3f,
                    limb1: 0x35595a263e0e53c670c591cc,
                    limb2: 0x2c38eb0ed3215109,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xfc7a45813447177e81041095,
                    limb1: 0x51c68f5b127e73e230dd82e9,
                    limb2: 0x140d11029c01fbe6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x748f3938d04093131b1dd5db,
                    limb1: 0x94afd09b3d98a84d3d17a1cb,
                    limb2: 0x217e10c48b972936,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4b0a87fc889ed9d6d759afaa,
                    limb1: 0x7b2e5dfb9bcb76238b329914,
                    limb2: 0x1bea4a69f4ff0a78,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x200096c2cbc8db154ba2afe0,
                    limb1: 0x7572d5adbeed3ac8a8c0eedf,
                    limb2: 0x2886dc10889ca3ee,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5d9b9f6f0bc830e3452a942f,
                    limb1: 0x2f6b8305b7284a98234de042,
                    limb2: 0x23e22446b700b2c8,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x60003240ee98490719363aa0,
                    limb1: 0xd1d0f1e494f9be42e2eafa4a,
                    limb2: 0xd82495ad83436a4,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x64d511832c03185afcb6da3f,
                    limb1: 0x35595a263e0e53c670c591cc,
                    limb2: 0x2c38eb0ed3215109,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x83162a95b36e64b744d8fdf4,
                    limb1: 0x9f641cdb1ffba389dcb93d9a,
                    limb2: 0x1a7bd19b76446cb,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8bbd8e60fc1a1859e888a509,
                    limb1: 0xdc2822db40c0ac2e47c7fadc,
                    limb2: 0x183227397098d014,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x145c0b40121186a578ab6fa1,
                    limb1: 0x9a968b9dd1566539a99ba4dc,
                    limb2: 0x196449b5ccd9a2c4,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xab98865d3a864d2b73dc3afc,
                    limb1: 0x4c513bdaeaec6667c93e2c0,
                    limb2: 0x2f89e75e7b012a0d,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xce1127d444355c88d945bcd8,
                    limb1: 0x6ca75543fd16698f29458b12,
                    limb2: 0x1c1c5c4869c9a883,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x76674254e760889d80d9d70f,
                    limb1: 0xa71da8b69dd773770ada539f,
                    limb2: 0x1325e94c48f11549,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3afd272617b9de3ecc904c37,
                    limb1: 0x8ea907bcbecccbeec0e11a1e,
                    limb2: 0x581f2617ff4f192,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xd4a25732fa1407d99185519c,
                    limb1: 0x17735d22f281d74f65518402,
                    limb2: 0x1bc88eae855b4824,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x31e5fdfd3751cf54aa9ab666,
                    limb1: 0x9daeafcc0909a27846b8d31f,
                    limb2: 0x2dd51935aea03dd3,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x145c0b40121186a578ab6fa1,
                    limb1: 0x9a968b9dd1566539a99ba4dc,
                    limb2: 0x196449b5ccd9a2c4,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xab98865d3a864d2b73dc3afc,
                    limb1: 0x4c513bdaeaec6667c93e2c0,
                    limb2: 0x2f89e75e7b012a0d,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x9262b26cc795fda121bc7159,
            limb1: 0x1fc5d7436295d71723e73212,
            limb2: 0x17da9638042b9bf1,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            0
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xa7e85dfe00f1cd829d69c3a9,
                    limb1: 0xef925264c860e5511d419374,
                    limb2: 0x7031b5b7d8fb57f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xe49adb8ae50402a22e40033,
                    limb1: 0xf1c07f3457441706cee47c2,
                    limb2: 0x1948095743cd1556,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_BN254_8_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xe3ff4aceb05150b8011364da,
                    limb1: 0xeae4aedbfbd055ff2b2e8dcc,
                    limb2: 0x2700cc9021bb24a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd6c421551c8ab1cd6f49302c,
                    limb1: 0x17776f9bcfd2b3587f1df38,
                    limb2: 0x1587cf974a3923,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xe3ff4aceb05150b8011364da,
                    limb1: 0xeae4aedbfbd055ff2b2e8dcc,
                    limb2: 0x2700cc9021bb24a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd6c421551c8ab1cd6f49302c,
                    limb1: 0x17776f9bcfd2b3587f1df38,
                    limb2: 0x1587cf974a3923,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xe3ff4aceb05150b8011364da,
                    limb1: 0xeae4aedbfbd055ff2b2e8dcc,
                    limb2: 0x2700cc9021bb24a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd6c421551c8ab1cd6f49302c,
                    limb1: 0x17776f9bcfd2b3587f1df38,
                    limb2: 0x1587cf974a3923,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xe3ff4aceb05150b8011364da,
                    limb1: 0xeae4aedbfbd055ff2b2e8dcc,
                    limb2: 0x2700cc9021bb24a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd6c421551c8ab1cd6f49302c,
                    limb1: 0x17776f9bcfd2b3587f1df38,
                    limb2: 0x1587cf974a3923,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xe3ff4aceb05150b8011364da,
                    limb1: 0xeae4aedbfbd055ff2b2e8dcc,
                    limb2: 0x2700cc9021bb24a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd6c421551c8ab1cd6f49302c,
                    limb1: 0x17776f9bcfd2b3587f1df38,
                    limb2: 0x1587cf974a3923,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xe3ff4aceb05150b8011364da,
                    limb1: 0xeae4aedbfbd055ff2b2e8dcc,
                    limb2: 0x2700cc9021bb24a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd6c421551c8ab1cd6f49302c,
                    limb1: 0x17776f9bcfd2b3587f1df38,
                    limb2: 0x1587cf974a3923,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xe3ff4aceb05150b8011364da,
                    limb1: 0xeae4aedbfbd055ff2b2e8dcc,
                    limb2: 0x2700cc9021bb24a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd6c421551c8ab1cd6f49302c,
                    limb1: 0x17776f9bcfd2b3587f1df38,
                    limb2: 0x1587cf974a3923,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xe3ff4aceb05150b8011364da,
                    limb1: 0xeae4aedbfbd055ff2b2e8dcc,
                    limb2: 0x2700cc9021bb24a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd6c421551c8ab1cd6f49302c,
                    limb1: 0x17776f9bcfd2b3587f1df38,
                    limb2: 0x1587cf974a3923,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x4a276dda34c3494ac12ea9b8e7e13ed8, high: 0x1abde6b4993ec8c6e6b106e289110af0
            },
            u256 {
                low: 0xd872298c7b72590bf8f8f071d360da69, high: 0x26e021b663794035f8e45086ca819c6f
            },
            u256 {
                low: 0x4d6cd7822e9583eabda17da2000fc63d, high: 0x154ab9724124405b91fcfe8881c16e98
            },
            u256 {
                low: 0x2412579d6af944e07b38785b0932f5b6, high: 0x26869f5bdd02e100e3d484087de8a234
            },
            u256 {
                low: 0xb2ddc481ac6d5df814e5064cb799ae8e, high: 0x1693d051fc98c279cf6f111c26c06e67
            },
            u256 {
                low: 0x775e0ec39c9d03f309018aee69407be7, high: 0x67ea81b0c0a59677579501a62fda854
            },
            u256 {
                low: 0x52daad326c00984c734bb05788c31f6, high: 0x87e30559e0df45b992a34a1084fa819
            },
            u256 {
                low: 0xb3386c3e1af4787f52ebdac5a1457899, high: 0xc7a72a058bf3b9ea6245b598c94af98
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xe63dd1d304eb5d404e95f9e7,
                limb1: 0x4e6529489dfed5c5832787e4,
                limb2: 0x1fea8e3e4a7a3ee8,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xffa1e79d071224fd83d99740,
                limb1: 0x73ffbc674404d838d1c78872,
                limb2: 0x287860579473b9c3,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xfa07cd4a05c0d5ed33f38032,
                limb1: 0xbeeaec10506dda00cd87e230,
                limb2: 0x208d872c88b4f441,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x10269c1c6ba887ce98da2083,
                limb1: 0xd3f2410bf3815f3e11a58eb7,
                limb2: 0x23027a3e42d5d1e8,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0xaedac12a5a71d85f2eaa83bf,
                limb1: 0x5294e0c2c1884978825233f5,
                limb2: 0x1d2bdaf892f0bab9,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x16c2b6cac2ba2325dfaa9331,
                limb1: 0xd162a0dd2c7dba10f0758f3f,
                limb2: 0x18561ff3ab9b584c,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xea3ee10001cf374c0265a43a,
                    limb1: 0xc6a84022e7276d09a05380ee,
                    limb2: 0x2d094701567ba169,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x43e19f0db0924b53085eca23,
                    limb1: 0xdc2822db40c0ac2dcb43799d,
                    limb2: 0x183227397098d014,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x54d84b0495301c7ed0dcb2c0,
                    limb1: 0x2236609c8b65f32714bb0a4d,
                    limb2: 0x8d55423a11d1395,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9e34adeb86e3de1e88d39e86,
                    limb1: 0x7f066d91e7b22c98e92b54df,
                    limb2: 0xe09b36b949baef6,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x2ae721e61f513fe005439622,
                    limb1: 0x40edeebc8f78f54a26fe862e,
                    limb2: 0x1a7b8550d3d83bb,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa40a5cd2efed1e092f3c1c3d,
                    limb1: 0x2389d1fe2aa2cc1efd55e3d7,
                    limb2: 0xade5d6026b5f3e8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb2b3e9243a8db6bf6b5ccf00,
                    limb1: 0xb12002c4fcf048fd08e8e84d,
                    limb2: 0x2f63be4aab5d844c,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xfe88e10dbf90557c72961840,
                    limb1: 0x66a321d5a231d9753e311ee7,
                    limb2: 0x1a7ffc6ae3573abf,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xda9e09c294ab9a5b9a7adb92,
                    limb1: 0x7d1348b5b71685cabb81fe9e,
                    limb2: 0x2a1d1a42bdd30ce3,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x54d84b0495301c7ed0dcb2c0,
                    limb1: 0x2236609c8b65f32714bb0a4d,
                    limb2: 0x8d55423a11d1395,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9e34adeb86e3de1e88d39e86,
                    limb1: 0x7f066d91e7b22c98e92b54df,
                    limb2: 0xe09b36b949baef6,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x9e2a9735aab1a2e288dbbcbf,
                    limb1: 0xb6e8ce34815949f1306168e0,
                    limb2: 0x16b952d9b56983,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb11553aa57a29bf07b981244,
                    limb1: 0xb85045b68181585d5ad4be52,
                    limb2: 0x30644e72e131a029,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xd9e5df550ced132d47335a5,
                    limb1: 0x789c8becf41f0a0668de4782,
                    limb2: 0x285b0be234ecebf7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8a6ab274860e6571a376183b,
                    limb1: 0xe80aaca3543285d9ecafa93,
                    limb2: 0xd66ba7d5660f99d,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x9dfe18b7adb8151e98bfacca,
                    limb1: 0xde33381a5603a7506f7aa188,
                    limb2: 0x169c21699e1f6c89,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9e659ae3120b624625695c40,
                    limb1: 0xb04c08b49c5731495e57b350,
                    limb2: 0x1558c0e233ea081f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe2bae5526efda9c5eccc7bc7,
                    limb1: 0xbd07b9a586a5ddc7f319421a,
                    limb2: 0x34dd65aaa18b99d,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x57f784c57a2b5b6acc5fa661,
                    limb1: 0xf9351859d95a6d580b980163,
                    limb2: 0x184886c0dc638392,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9f40175d922b3054ea6248b1,
                    limb1: 0x2b82005e9fc97918dc60efba,
                    limb2: 0x28342f780322ecd7,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xd9e5df550ced132d47335a5,
                    limb1: 0x789c8becf41f0a0668de4782,
                    limb2: 0x285b0be234ecebf7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8a6ab274860e6571a376183b,
                    limb1: 0xe80aaca3543285d9ecafa93,
                    limb2: 0xd66ba7d5660f99d,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x20d0fc8cecd5d9ec1cf66097,
                    limb1: 0x3e3c6fab057e5d13dcfa4d01,
                    limb2: 0x125ff3a0d30ca9f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8bbd8e60fc1a1859e888a509,
                    limb1: 0xdc2822db40c0ac2e47c7fadc,
                    limb2: 0x183227397098d014,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x28d513d417e5587df758cd9,
                    limb1: 0x3d6f74921629661f84be9b09,
                    limb2: 0x1f80922cd992e66e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x280106a6180e69e14e5bf69d,
                    limb1: 0x5f20be99f10c8d41df28befc,
                    limb2: 0x230f3ac0a6bd9158,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xb8226646e398a9a978bb7463,
                    limb1: 0x4e8d941872688784a8b13c89,
                    limb2: 0x8ce92d11577991a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4eb6c6ba9ca7d954d32d3714,
                    limb1: 0xbbfe2b9859cf21efa1b8fec9,
                    limb2: 0x21e1ae415c8f06a5,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x453b69646f0baad923be2d50,
                    limb1: 0x11f5baa1c93955afc41c47a3,
                    limb2: 0x236d33843409537a,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x9f36292a885a7480c5e3a944,
                    limb1: 0xfffe17ffc0fada00f6ba6689,
                    limb2: 0x2e1d6813ab871320,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa71f7ed7cfea25763a19e949,
                    limb1: 0xacc1b060d022f70a6e7767d1,
                    limb2: 0x865135c31d573b5,
                    limb3: 0x0
                },
                u384 { limb0: 0x3, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x28d513d417e5587df758cd9,
                    limb1: 0x3d6f74921629661f84be9b09,
                    limb2: 0x1f80922cd992e66e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x280106a6180e69e14e5bf69d,
                    limb1: 0x5f20be99f10c8d41df28befc,
                    limb2: 0x230f3ac0a6bd9158,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xbb7638ab70b24ec4bd29a8f2,
            limb1: 0x13b63a178604cd67fadd64ff,
            limb2: 0x9f400c51731e24a,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0xb333bc017aa281aa573ef5f4,
                limb1: 0x9fe64d180f51548aa0ef20a6,
                limb2: 0x57b2501f58f8389,
                limb3: 0x0
            },
            u384 {
                limb0: 0x5067b285d86d51e64002eea1,
                limb1: 0xf6e668af16435edcb5e0ead9,
                limb2: 0xd8ec984fb495655,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            0
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xefe9c6031c619987e1699cbf,
                    limb1: 0xa42eb52e8720806f3fcfe857,
                    limb2: 0x1e79f89ac5d9f597,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x4a4b7c2669af7cfafe437acc,
                    limb1: 0xb10305ddfc3a6df84a854be3,
                    limb2: 0x1ac23f8af06580d9,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_BLS12_381_1_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x3ee3dc6ab5ebe4704952b672,
                    limb1: 0xb2e0efb170768a1e5d1b9a4b,
                    limb2: 0x4d96140e59003fac260a802c,
                    limb3: 0x56c27def52fb6376ef9c332
                },
                y: u384 {
                    limb0: 0x449aebed45ebdafb77d9950d,
                    limb1: 0xf0d874a36c036d81a7771826,
                    limb2: 0x3893fb496b81770230b0146,
                    limb3: 0xe24043a8bc484ef2630d3fc
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x9d44c93e7799a8e2b368c5539c30ceaa, high: 0x5342ac2b567e5862ef151673a1df3da7
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xc53571076ced5977edb095ce,
                limb1: 0x195097ebe2bc010cd3bf2d2a,
                limb2: 0xa21d83724d1ff49bad8ff44a,
                limb3: 0x3256e0f59e495c07564822e
            },
            y: u384 {
                limb0: 0xe79bdadefde0c45f56d017bc,
                limb1: 0xecb52f36f72d4526758d7aed,
                limb2: 0xdda69fc9cbeaafbde6692459,
                limb3: 0x15fc8af3725a5a2d6fe55b75
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x1c753195c33ae7770d18bb6d,
                limb1: 0x2fb02d11c5ac92c1316b5829,
                limb2: 0xa27d24d48c5b279300433622,
                limb3: 0x151e57c06aa91c495520d223
            },
            y: u384 {
                limb0: 0x579a717b3b1ba597684d46ac,
                limb1: 0x15622cbbc3fe4b6ab5fec680,
                limb2: 0xf64e5302a37a31457c06c29e,
                limb3: 0x134d91b87f4af2ad386721b1
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x7b5f761e6185552b77379ffd,
                limb1: 0xcff7b7bb8cb2a2b4823eed81,
                limb2: 0xd2b9a41c60d1e85a5b3ae65a,
                limb3: 0x11ebfe48bc7e0a0fd8490e80
            },
            y: u384 {
                limb0: 0x20a22343cb25756f72c7804e,
                limb1: 0xa97ede9aefc29ad472c61a9f,
                limb2: 0x84aab3fb25fea3c5189841ff,
                limb3: 0x16738681d108a84d91185819
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xbe03e205fb4d3999fc0e7951,
                    limb1: 0x5736ee4f1d7fc7da46399b5,
                    limb2: 0x9216cb914439263b75743269,
                    limb3: 0x9a1d1b821c587d9fbcfb80b
                },
                u384 {
                    limb0: 0x790a1c8b77bb96d2187e725d,
                    limb1: 0xb39869507b587b12390d7f1e,
                    limb2: 0x21a5d66bb23ba5c279c2895f,
                    limb3: 0xd0088f51cbff34d258dd3db
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x946e46b62282976ab7ab2def,
                    limb1: 0x92b1dbf8b62c17d144dc7ded,
                    limb2: 0x2454186288ca5a61e51a6e75,
                    limb3: 0xac5e6b1ebedf9f0f265a72b
                },
                u384 {
                    limb0: 0xad3ab28d9725c217c8fc5e6b,
                    limb1: 0x9aff4b03a37e6af8edd13888,
                    limb2: 0x53981556be57173d1fea9e48,
                    limb3: 0x116f7bfbea6b9aa266bd6255
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x67b6aad3466805cb08ac9d88,
                    limb1: 0x71dbd79c1d41abf21410945e,
                    limb2: 0x6d625f0260e855e180953bef,
                    limb3: 0x156d3fd326f3d7e99692b527
                },
                u384 {
                    limb0: 0xfc8a4e4795a945238f403721,
                    limb1: 0x9ad410a9f0bd9bb809589b73,
                    limb2: 0xc157397a4837ecf4b3bdc540,
                    limb3: 0x12f69d92192a455ec1ec8114
                },
                u384 {
                    limb0: 0xfdcada793a89e2084f428814,
                    limb1: 0x9196e8ae5a822ae644a4a5d5,
                    limb2: 0x5b4502f12763391f475bcb0e,
                    limb3: 0x2d4c994606c7689cc44c80f
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xa0651ad8d00b5daadead0d11,
                    limb1: 0xe3969d41e1ff6920f4c5f7b7,
                    limb2: 0x4e04b4b2beb21e02a0e4a716,
                    limb3: 0x111688dd763801297e7af4f6
                },
                u384 {
                    limb0: 0x5242ca36e899085f23f22456,
                    limb1: 0x9d9b86cca097bf9b79ece225,
                    limb2: 0xc7c8fbac306dc5ea98a053a3,
                    limb3: 0x11bbcc1b36ae9d5504be39e8
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x946e46b62282976ab7ab2def,
                    limb1: 0x92b1dbf8b62c17d144dc7ded,
                    limb2: 0x2454186288ca5a61e51a6e75,
                    limb3: 0xac5e6b1ebedf9f0f265a72b
                },
                u384 {
                    limb0: 0xad3ab28d9725c217c8fc5e6b,
                    limb1: 0x9aff4b03a37e6af8edd13888,
                    limb2: 0x53981556be57173d1fea9e48,
                    limb3: 0x116f7bfbea6b9aa266bd6255
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x5fcccb77d2ead0101a809198,
                    limb1: 0x741fd94e7928b3aa9eab5afe,
                    limb2: 0xd1e8230605fd23a8d63945c6,
                    limb3: 0x2bbdaac042efdaf74b2a6ba
                },
                u384 {
                    limb0: 0xac65556bae225de3b5c59309, limb1: 0x29a623aa, limb2: 0x0, limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x700db6b50f2deb2485ddc21b,
                    limb1: 0xda237cc6f635728ab0726f79,
                    limb2: 0x810a8373b963fdc9e3dc3edd,
                    limb3: 0x102116ea7641f56b99420d64
                },
                u384 {
                    limb0: 0x74ef1fefad73418a993e377,
                    limb1: 0xebd0887eb73ecf68aed10d89,
                    limb2: 0x968420cbe3932fcac0bc6f2f,
                    limb3: 0x1977a4351326fab3d21cba16
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xb00d0a3e4f111119d4227f7,
                    limb1: 0x6ce39982760452d6a4dc3ef6,
                    limb2: 0x59bb6fd31ca090e1338be4bf,
                    limb3: 0xd8c6c2f2e110b259b1458ad
                },
                u384 {
                    limb0: 0x19ee35c02af2c7cc1eb571d5,
                    limb1: 0x176d564cde5af8dfcfe08f22,
                    limb2: 0x3e3dbfd41fb19eb6b50b1b2a,
                    limb3: 0x18f1e38e54295617e9b515c3
                },
                u384 {
                    limb0: 0x6026500dd7bd6c608ece7570,
                    limb1: 0x7cce3824469c7cea24acbafd,
                    limb2: 0x4601d83831dc429453fe44c9,
                    limb3: 0x4783d52beae481f270f5ffa
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x5d8edad4c8b9ac921777b316,
                    limb1: 0x9a2c4dd9eb73dde28471bde8,
                    limb2: 0x7d92b4201ca1601da866d5f8,
                    limb3: 0xc8237d566080879ced0e625
                },
                u384 {
                    limb0: 0x93fc7fcbd5fd062a6508ddb,
                    limb1: 0x79afaa17f8e85b365f403628,
                    limb2: 0x902d7ca960e6dc9c28628481,
                    limb3: 0x17db5b15a01c3700671ff137
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x700db6b50f2deb2485ddc21b,
                    limb1: 0xda237cc6f635728ab0726f79,
                    limb2: 0x810a8373b963fdc9e3dc3edd,
                    limb3: 0x102116ea7641f56b99420d64
                },
                u384 {
                    limb0: 0x74ef1fefad73418a993e377,
                    limb1: 0xebd0887eb73ecf68aed10d89,
                    limb2: 0x968420cbe3932fcac0bc6f2f,
                    limb3: 0x1977a4351326fab3d21cba16
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xd9df8c25d144adf9ecffe533,
                    limb1: 0xb7fd5b14fa3846e78f265965,
                    limb2: 0xc09a4edc3167f45a14ffdb02,
                    limb3: 0x12751e9fea32a6e31983b642
                },
                u384 {
                    limb0: 0x302ea91a3b09524e7c49fbbb,
                    limb1: 0xb39869507b587b118b5d4593,
                    limb2: 0x21a5d66bb23ba5c279c2895f,
                    limb3: 0xd0088f51cbff34d258dd3db
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x73421b93ddd60754e318c3a6,
                    limb1: 0xee744192bbf42eba3bbfe3c2,
                    limb2: 0x50c561ea2c5db99212bc9cee,
                    limb3: 0x1749d4458f6fafb6ab043f16
                },
                u384 {
                    limb0: 0xcad3584b4f3dc35d7baef9ec,
                    limb1: 0xceb9c0749b02b6d289adba52,
                    limb2: 0x116090bddbc1871c8b8c0901,
                    limb3: 0xcf7cdcb4bd8a6db68cd6ec8
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x116f77123ced317dd2f9f806,
                    limb1: 0x479bf61c04e3c143d72e695e,
                    limb2: 0x435da8f7401b73582abffdea,
                    limb3: 0xcc8c21f0f7a90f3bc5e4f09
                },
                u384 {
                    limb0: 0xed5221e52ccf9849db6790a4,
                    limb1: 0xa5afdf2b3e9e7204ff098f03,
                    limb2: 0xe21c79003ba77cb68f5828e9,
                    limb3: 0xc5f93c932215c9072863b3b
                },
                u384 {
                    limb0: 0xdbed2e5b52d25a45165753e4,
                    limb1: 0xb832999df1d9755f18047cb8,
                    limb2: 0xbdb83a73e3d1c223709d1e85,
                    limb3: 0xaba5aaf825d8675751e1ef6
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xb90c6e50495b1d538c640e97,
                    limb1: 0x843e8e680bbdd87c92fb8f0d,
                    limb2: 0x79328122841103b970633b7d,
                    limb3: 0xf241b57913f0b0bcabe0536
                },
                u384 {
                    limb0: 0x79f9612d82f80d75eebc3d05,
                    limb1: 0xd3b62f317559e526080ae94c,
                    limb2: 0x23696200a8ed0ed3aab1147,
                    limb3: 0x19de2542f5e2b4d3581a136a
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x73421b93ddd60754e318c3a6,
                    limb1: 0xee744192bbf42eba3bbfe3c2,
                    limb2: 0x50c561ea2c5db99212bc9cee,
                    limb3: 0x1749d4458f6fafb6ab043f16
                },
                u384 {
                    limb0: 0xcad3584b4f3dc35d7baef9ec,
                    limb1: 0xceb9c0749b02b6d289adba52,
                    limb2: 0x116090bddbc1871c8b8c0901,
                    limb3: 0xcf7cdcb4bd8a6db68cd6ec8
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x601eb3e1efd3f23cf1a06b58,
            limb1: 0x9e86728c2213e1c37dd16c2f,
            limb2: 0x41029c5d8dc937db381347c4,
            limb3: 0x7ec148dcf6dd08e397b902c
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            1
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x4e32c5d52d4123f74bd05a74,
                    limb1: 0xb542c7577dc8d33ea319c717,
                    limb2: 0x8704ffba65f1af891c1e6e10,
                    limb3: 0x1464b5c1aff5d5fb7f17be6f
                },
                y: u384 {
                    limb0: 0x980d02db4eb3469eed309976,
                    limb1: 0x472392a950c5211e19acad0b,
                    limb2: 0x5a09d43c10905a1858d55c94,
                    limb3: 0x561cfac77c75fbba7ad2343
                }
            }
        );
    }


    #[test]
    fn test_msm_BLS12_381_2_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xff84ba4ecdd05e6d64a9022d,
                    limb1: 0x3cd05582c66ef31fa123ebc0,
                    limb2: 0xe7a53d6f8f1ff98e109775e0,
                    limb3: 0x9e9798556a2e71cd64e669c
                },
                y: u384 {
                    limb0: 0xca8dd4608a557e3ab765cd4d,
                    limb1: 0x539b1de9dd4b8788149b42f9,
                    limb2: 0x4a86d2748ec27deee7a381fa,
                    limb3: 0x551868d5279e1a93f9e1f49
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xff84ba4ecdd05e6d64a9022d,
                    limb1: 0x3cd05582c66ef31fa123ebc0,
                    limb2: 0xe7a53d6f8f1ff98e109775e0,
                    limb3: 0x9e9798556a2e71cd64e669c
                },
                y: u384 {
                    limb0: 0xca8dd4608a557e3ab765cd4d,
                    limb1: 0x539b1de9dd4b8788149b42f9,
                    limb2: 0x4a86d2748ec27deee7a381fa,
                    limb3: 0x551868d5279e1a93f9e1f49
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x633cbf79e96aa1aff55e3aa2208a393e, high: 0x5f75da75eab9221b4b36b545cca1a034
            },
            u256 {
                low: 0xfbbff9e0ae56702af521ca9fdf5e6f78, high: 0x6e22a44684dda9b91f1e0ee9cf6c9992
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xb06f03c7e6f2c03dee226625,
                limb1: 0x8b87dee9d5cf6d3f55d4762d,
                limb2: 0x55d813630195b2c1774c0cd7,
                limb3: 0x15fd7659988f85a3b47ccba6
            },
            y: u384 {
                limb0: 0xae4dc1a6cf6556ac1797ee8e,
                limb1: 0xbe717c1f6e71404f7798f367,
                limb2: 0xa06ca3b75fee07153bd442dc,
                limb3: 0x1920fe655c49090cf91a7454
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xb6ca231c5f9dd09cf130f90a,
                limb1: 0xc760c0387ceab2ab4a0addb6,
                limb2: 0x476a54df310206ecfa041517,
                limb3: 0xf210a41884c3ae3b06f51ab
            },
            y: u384 {
                limb0: 0x98e0089ea3f505807c78518,
                limb1: 0x984505b4d84f66e75f1d769b,
                limb2: 0x1180da6de6c4fa93c9a87528,
                limb3: 0x10222626ffb64203cdffc3bf
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0xb16b267d4f9370d761180954,
                limb1: 0xf3766dfd89e0ba1493f1686,
                limb2: 0xa5371f0dc629a32b7f4a217e,
                limb3: 0x106eab0ae3477dfddcc662d4
            },
            y: u384 {
                limb0: 0x6332cafdb26588dbe7efcbf,
                limb1: 0xd44ab317ab97a2fb0cb2498b,
                limb2: 0x87c116f78f84aacf3c2a7a42,
                limb3: 0x1980639d527d0ebd95a8f380
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x11fa4d92d7bdffabc0bcfcb5,
                    limb1: 0xe8c7c30da71f03fc82801f7c,
                    limb2: 0x30dca54b5b7274ddc9cb184,
                    limb3: 0xeb654359ec5b25e27cbd511
                },
                u384 {
                    limb0: 0x3c016b6ba299835d7b064fb0,
                    limb1: 0xb39869507b587b11cf0108c5,
                    limb2: 0x21a5d66bb23ba5c279c2895f,
                    limb3: 0xd0088f51cbff34d258dd3db
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x813fd78f99d78e688279caef,
                    limb1: 0xf6a0d5087a3524206d22ad93,
                    limb2: 0x7ca7ec70b95c711e1f9a4424,
                    limb3: 0x83c529759f096b7c4759bf4
                },
                u384 {
                    limb0: 0xb2b441e8bf3ae154ad33ed04,
                    limb1: 0x60970d551238be9465f9e0e,
                    limb2: 0x491a08dc3838eaba5f26a2c7,
                    limb3: 0x141b33f583cd60740b6c1d29
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xca028596e3f259eb6c2f713b,
                    limb1: 0x2bb9e01efa4f8f4902302a51,
                    limb2: 0x2ecc73d63cd5693ced9432b5,
                    limb3: 0xa96a794d4ab94a17029c19d
                },
                u384 {
                    limb0: 0xa1a040727d16e9bf4324923,
                    limb1: 0x3b72c412f4eabad42fa2f677,
                    limb2: 0x685a01c76725ee79863cab4b,
                    limb3: 0xdd72416e0c8252f91ee79a9
                },
                u384 {
                    limb0: 0xe3cf6d7fa5dac99ee3023e78,
                    limb1: 0x43c99dbc740ae0b84d556f1f,
                    limb2: 0xedb8fda658bf4ca952f4909b,
                    limb3: 0x135d8ee9dc0bdca43f7d24e2
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x53ab5e3ead5f39a209e78111,
                    limb1: 0x73528180f2239a5d95deb64f,
                    limb2: 0xaf5404eb80fa78f38ae3fdd4,
                    limb3: 0x6f038732e427444c6bac81b
                },
                u384 {
                    limb0: 0xb6d507a3ceee8552b4d0b40f,
                    limb1: 0xe2934b72607b4d38bd7a783e,
                    limb2: 0x5a851ceab37dc85aa20b52dd,
                    limb3: 0x2699a1762b5ce014c5d7d82
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x813fd78f99d78e688279caef,
                    limb1: 0xf6a0d5087a3524206d22ad93,
                    limb2: 0x7ca7ec70b95c711e1f9a4424,
                    limb3: 0x83c529759f096b7c4759bf4
                },
                u384 {
                    limb0: 0xb2b441e8bf3ae154ad33ed04,
                    limb1: 0x60970d551238be9465f9e0e,
                    limb2: 0x491a08dc3838eaba5f26a2c7,
                    limb3: 0x141b33f583cd60740b6c1d29
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x6bb51e9c2992b6df2c21781,
                    limb1: 0x48892cc4a6302685d0db2fb7,
                    limb2: 0xd46a1ad266a207122120914d,
                    limb3: 0xe67233dbc455e2fc83e3b62
                },
                u384 {
                    limb0: 0x48091db5aa477810bc6f5dae,
                    limb1: 0xb39869507b587b1283b30bf0,
                    limb2: 0x21a5d66bb23ba5c279c2895f,
                    limb3: 0xd0088f51cbff34d258dd3db
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xe8c81850fd2ed897277f8c45,
                    limb1: 0x9bebedf40942d2b0711e88ee,
                    limb2: 0xeff34f9ad5659aa5b656142f,
                    limb3: 0x234a223008103eb2b810fcc
                },
                u384 {
                    limb0: 0xfb0522948c90d0f5aa25af74,
                    limb1: 0x62ffbce5b3575059337d3686,
                    limb2: 0x143c1a88a4554b09e8e987c7,
                    limb3: 0xf68e235a90c499c45def6e
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x688db6f57b795b260406d546,
                    limb1: 0x2df75ced969da06fe3575eec,
                    limb2: 0xfa59dc0b7e6e9d41797c4e3c,
                    limb3: 0x46c3a7cacadb33f1df233e3
                },
                u384 {
                    limb0: 0xded8bbd77a6b0c8416f5a004,
                    limb1: 0xf40a86b22d9d84d3a852c1e7,
                    limb2: 0xbeaffa842c14bd6bf9c70ce2,
                    limb3: 0xaf8df74820b783a1c2ae7ee
                },
                u384 {
                    limb0: 0x3558a73492dfbce642ef3aa4,
                    limb1: 0x4d880b35529df990f8ac1515,
                    limb2: 0xb59791bfe7a041d88f346258,
                    limb3: 0x77f70be14ae0ccf402ee060
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xa3206143f4bb625c9dfe3114,
                    limb1: 0x6fafb7d0250b4ac1c47a23bb,
                    limb2: 0xbfcd3e6b55966a96d95850be,
                    limb3: 0x8d2888c02040facae043f33
                },
                u384 {
                    limb0: 0xec148a52324343d6a896bdd0,
                    limb1: 0x8bfef396cd5d4164cdf4da1b,
                    limb2: 0x50f06a2291552c27a3a61f1d,
                    limb3: 0x3da388d6a4312671177bdb8
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xe8c81850fd2ed897277f8c45,
                    limb1: 0x9bebedf40942d2b0711e88ee,
                    limb2: 0xeff34f9ad5659aa5b656142f,
                    limb3: 0x234a223008103eb2b810fcc
                },
                u384 {
                    limb0: 0xfb0522948c90d0f5aa25af74,
                    limb1: 0x62ffbce5b3575059337d3686,
                    limb2: 0x143c1a88a4554b09e8e987c7,
                    limb3: 0xf68e235a90c499c45def6e
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x8f4808199720dc52772b95b5,
                    limb1: 0xa66a3f5a13b2cfb856d1125e,
                    limb2: 0xd1c169dcfceef6fd8bb15b3,
                    limb3: 0x139da01516dba673675275a
                },
                u384 {
                    limb0: 0x302ea91a3b09524e7c49fbbb,
                    limb1: 0xb39869507b587b118b5d4593,
                    limb2: 0x21a5d66bb23ba5c279c2895f,
                    limb3: 0xd0088f51cbff34d258dd3db
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xfc85b3ec9c95a8e5893a8742,
                    limb1: 0xbe2273161f3f831ff6e027f0,
                    limb2: 0x4fe3cd1acc14d489140bf031,
                    limb3: 0x15852e0a7c355548c2511656
                },
                u384 {
                    limb0: 0xfa72b665c4ccbe8badb652f8,
                    limb1: 0xf7c97e2997d92dfbaa0e0bbf,
                    limb2: 0x99f5e5c1d1c2ecf16dbbeee8,
                    limb3: 0x14726e88076c145309019aec
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xde92da0fc4e655cd32e66fea,
                    limb1: 0x56e939e6da5de1d6c2ccce,
                    limb2: 0x44b20a481b5e20985f9e70c1,
                    limb3: 0xaa802dd73817ae4e1c74ef9
                },
                u384 {
                    limb0: 0x322adffb797286ed055f411f,
                    limb1: 0x94e88f73a904c266a194dbf8,
                    limb2: 0xe1522f620cbaac43a93d8950,
                    limb3: 0xbefa44c2017f7185843b6da
                },
                u384 {
                    limb0: 0xe2b76f3a0dd9a1da47ee117d,
                    limb1: 0x800af930c1a680753546026f,
                    limb2: 0xe3e62594680d073c87a4b5bd,
                    limb3: 0x554b7c4e3b4ab111c2da0c1
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xde1acfb34459a39624eb1d07,
                    limb1: 0xc2f7547598eb2a137f7c9fc7,
                    limb2: 0x75ac2de502ed6f9575a08888,
                    limb3: 0x811826b4455a15427f16236
                },
                u384 {
                    limb0: 0xd5ced997e535fa2eb6da4bdf,
                    limb1: 0xa99380c37b51d5824c342f03,
                    limb2: 0x9df4908119a5d136dc608365,
                    limb3: 0x3c6846171309d7d42b3748f
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xfc85b3ec9c95a8e5893a8742,
                    limb1: 0xbe2273161f3f831ff6e027f0,
                    limb2: 0x4fe3cd1acc14d489140bf031,
                    limb3: 0x15852e0a7c355548c2511656
                },
                u384 {
                    limb0: 0xfa72b665c4ccbe8badb652f8,
                    limb1: 0xf7c97e2997d92dfbaa0e0bbf,
                    limb2: 0x99f5e5c1d1c2ecf16dbbeee8,
                    limb3: 0x14726e88076c145309019aec
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x9c3f815b10d5a9063543062a,
            limb1: 0xdcdd01ededae383d876d8631,
            limb2: 0x19b1ce1893d389ffbb04a0fb,
            limb3: 0xc22ed75eabd7be159093b71
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            1
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xae6cd14c50efb06f7411c3b6,
                    limb1: 0x8390f7e1f6c59aac89f14c93,
                    limb2: 0x16d1d41656914d87c426111,
                    limb3: 0x8090062ff8683389accda74
                },
                y: u384 {
                    limb0: 0xaa3f5bf1f590f22e78b94d75,
                    limb1: 0x11c449ebac1e91f203f6c361,
                    limb2: 0x1b3461ce568f0a9ff2475184,
                    limb3: 0x1a80f8fb4b8f8b632363d47
                }
            }
        );
    }


    #[test]
    fn test_msm_BLS12_381_3_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x31ca69c34cfb0e4d71b7374a,
                    limb1: 0x39fbb6c642d790042822e09d,
                    limb2: 0x9b9f48526654303d9371c6fe,
                    limb3: 0x4f81b1f3871eca8ede378ac
                },
                y: u384 {
                    limb0: 0x96541b2e92e994b549e315e1,
                    limb1: 0x50053dc36a1b302ae17fdce4,
                    limb2: 0xde39cd68f3ba00aa8b312e89,
                    limb3: 0x8f8685eb30a96f34a2e755d
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x31ca69c34cfb0e4d71b7374a,
                    limb1: 0x39fbb6c642d790042822e09d,
                    limb2: 0x9b9f48526654303d9371c6fe,
                    limb3: 0x4f81b1f3871eca8ede378ac
                },
                y: u384 {
                    limb0: 0x96541b2e92e994b549e315e1,
                    limb1: 0x50053dc36a1b302ae17fdce4,
                    limb2: 0xde39cd68f3ba00aa8b312e89,
                    limb3: 0x8f8685eb30a96f34a2e755d
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x31ca69c34cfb0e4d71b7374a,
                    limb1: 0x39fbb6c642d790042822e09d,
                    limb2: 0x9b9f48526654303d9371c6fe,
                    limb3: 0x4f81b1f3871eca8ede378ac
                },
                y: u384 {
                    limb0: 0x96541b2e92e994b549e315e1,
                    limb1: 0x50053dc36a1b302ae17fdce4,
                    limb2: 0xde39cd68f3ba00aa8b312e89,
                    limb3: 0x8f8685eb30a96f34a2e755d
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xa3c2c6fef2d9a38e6e4b8df0b6d9611, high: 0x36976bee6ac9d8a4160ff927c7550f2
            },
            u256 {
                low: 0x91bacf80aaa079968522dc4ef1dd50bf, high: 0x1d6557c1374a6cc9e0397e67926146de
            },
            u256 {
                low: 0xe27ac8e9d1c3d1bcc6be643217ee0eb0, high: 0x404f1084c7867a38a09f1aede38690e7
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x731a827b0617453987a0ece2,
                limb1: 0xc2362cba2cd89e492a03d429,
                limb2: 0x1deab6b3befaf2c360e364b6,
                limb3: 0x18e10d529c3f320858ebd970
            },
            y: u384 {
                limb0: 0xbdb3ff7ef1f589cefd30727,
                limb1: 0x7a688741faaafb30cf3c23ff,
                limb2: 0xeee07442839aa38e1373f295,
                limb3: 0x1662ef0ce3de5809dd2f160b
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x423e237b35fcb022762b47a0,
                limb1: 0x6fe4809e5ba4076bf18013b,
                limb2: 0xb4cceed53baecd494b5aa52f,
                limb3: 0x1568bf79befbe08831cfb713
            },
            y: u384 {
                limb0: 0xe7708ff2b9f1fbef3ad9b21d,
                limb1: 0x299e130bc40764c7e7699e7e,
                limb2: 0xf84e97d4336e612471f11a36,
                limb3: 0x930be600a07732184fcd1eb
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x2af6c0d92f0eb342762f34c8,
                limb1: 0xdb69b960e6bf2000afdebf74,
                limb2: 0x7b3975fd908747a52fa25ac0,
                limb3: 0x1682e31c3843a0517137bad3
            },
            y: u384 {
                limb0: 0xb5bf230b296130634094dec2,
                limb1: 0xee35f82c643608536174ec6f,
                limb2: 0xa2b10c5f03ba262df0e3e23d,
                limb3: 0x18464222fca7dce815029973
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x731f7ec6e89ed9a3edf9167c,
                    limb1: 0xfc659f1581d666e0d3938072,
                    limb2: 0x98f23eeb70f95f8bf5ec50b6,
                    limb3: 0x5e66ae35c7cdb38e68bdfaf
                },
                u384 {
                    limb0: 0xc2a43f5daab960242eeadf7f,
                    limb1: 0xb39869507b587b11c6766fd5,
                    limb2: 0x21a5d66bb23ba5c279c2895f,
                    limb3: 0xd0088f51cbff34d258dd3db
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x2015b5c19cdaecb37f867f16,
                    limb1: 0x91574c139ae207e8fd64e0b2,
                    limb2: 0xc1fcb8a2a4152c95dc24c5bd,
                    limb3: 0x47bb823c4d63dbd9c31bb95
                },
                u384 {
                    limb0: 0xbdc313c120ebac7906a7312a,
                    limb1: 0xd22fc1c17db1bdfaeb314b36,
                    limb2: 0xcd0d5aa8a39f7408f2b4f9c9,
                    limb3: 0x1628fb629e4eae834f67fd4f
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xdd325451d95d80796f2f3617,
                    limb1: 0xf371cadfcd820c5e4c046229,
                    limb2: 0xb57c7a81968ae8188096bf7,
                    limb3: 0x65ddd99834e60c248d1d033
                },
                u384 {
                    limb0: 0xfbea2d5559e8813f93a26118,
                    limb1: 0xd7ea4089eb57f1eee265a23f,
                    limb2: 0xa2afc994166c668b045514e,
                    limb3: 0xde022914cf4d14afe0443f8
                },
                u384 {
                    limb0: 0x4c38ee7d61243c1cc6d9b91a,
                    limb1: 0x84447bdac44e1c0c50952520,
                    limb2: 0xf2e09d02e4356123ae8fd8cf,
                    limb3: 0x12ac033d1469948b4dca656
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x8056d706736bb2cdfe19fc58,
                    limb1: 0x455d304e6b881fa3f59382c8,
                    limb2: 0x7f2e28a9054b257709316f6,
                    limb3: 0x11eee08f1358f6f670c6ee57
                },
                u384 {
                    limb0: 0xe3104f0555b1b1e41a9dc4a7,
                    limb1: 0x132c8f2312b4157f50c12cde,
                    limb2: 0x6a52641c6117ed94f044aee9,
                    limb3: 0xaa0b7cbccbb063e5c4cfe1c
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x2015b5c19cdaecb37f867f16,
                    limb1: 0x91574c139ae207e8fd64e0b2,
                    limb2: 0xc1fcb8a2a4152c95dc24c5bd,
                    limb3: 0x47bb823c4d63dbd9c31bb95
                },
                u384 {
                    limb0: 0xbdc313c120ebac7906a7312a,
                    limb1: 0xd22fc1c17db1bdfaeb314b36,
                    limb2: 0xcd0d5aa8a39f7408f2b4f9c9,
                    limb3: 0x1628fb629e4eae834f67fd4f
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xff436b3e0feb38129db555dc,
                    limb1: 0x5199e25bcf438b70b4b18229,
                    limb2: 0x79c102d6decab233546a68c3,
                    limb3: 0x1226b8b850266a3780030505
                },
                u384 {
                    limb0: 0x4ef4dd0b6a0d50a5a5a306ee, limb1: 0x19c7606c, limb2: 0x0, limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xc994fc5ef44ebffb6ad0c616,
                    limb1: 0x73b54fabafdf7925e15cdb6d,
                    limb2: 0x6a7a14f9c5ea311c62063314,
                    limb3: 0x12bf1d852c97c01ffdc1f408
                },
                u384 {
                    limb0: 0xee9f72c0f1064190181cd66c,
                    limb1: 0x8d67a671c4d01bcd561d1e24,
                    limb2: 0x362b228726eb9983083db951,
                    limb3: 0x19a1493b7b92000376841fac
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xb91bcabfea95e89f3608decc,
                    limb1: 0xaa3cf4b40f71c6e4bf65e598,
                    limb2: 0x589b1d21a3bc29ced1a0d9b3,
                    limb3: 0x1abb32e07751075495b962b
                },
                u384 {
                    limb0: 0xa6050415a364c6f7dad8ce3e,
                    limb1: 0x30727dcb7e99fa6ba5f6d6df,
                    limb2: 0x60dfe024279ea9d7e9b50130,
                    limb3: 0x957408cf9c462f323680653
                },
                u384 {
                    limb0: 0xa63739f6cc7e8f3c63a4930d,
                    limb1: 0x60d60c081d5d1c2e2443d2c7,
                    limb2: 0x8b72160b9d53fa37c59ae2e4,
                    limb3: 0x86e804ad395556add283aad
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xc3abf17c5d3cffedab43c302,
                    limb1: 0x73996cd21bf84f481b6db9,
                    limb2: 0x2350fa384eba2d67a10ea6d3,
                    limb3: 0x16fa52403f5f334b60d080b5
                },
                u384 {
                    limb0: 0xa681cb04961c0640607459af,
                    limb1: 0xc21e42f2d8cc8fc707897,
                    limb2: 0xec983966e48837d4667ad08,
                    limb3: 0x1881ef2f41c84c3ef8bd878e
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xc994fc5ef44ebffb6ad0c616,
                    limb1: 0x73b54fabafdf7925e15cdb6d,
                    limb2: 0x6a7a14f9c5ea311c62063314,
                    limb3: 0x12bf1d852c97c01ffdc1f408
                },
                u384 {
                    limb0: 0xee9f72c0f1064190181cd66c,
                    limb1: 0x8d67a671c4d01bcd561d1e24,
                    limb2: 0x362b228726eb9983083db951,
                    limb3: 0x19a1493b7b92000376841fac
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xa3b245ac9abf837ea5efa9b,
                    limb1: 0x91787d9eb358f199e2b84df8,
                    limb2: 0xf4078bdeb974f88782087c68,
                    limb3: 0x15c78bf1a03890ed28be05e
                },
                u384 {
                    limb0: 0x302ea91a3b09524e7c49fbbb,
                    limb1: 0xb39869507b587b118b5d4593,
                    limb2: 0x21a5d66bb23ba5c279c2895f,
                    limb3: 0xd0088f51cbff34d258dd3db
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xdcd45bb27fab0ecf3e1d0201,
                    limb1: 0x919d7a592b238e6c349c8556,
                    limb2: 0x7af511e849793187105e3f62,
                    limb3: 0xa66c30468e7de778fd1c3d6
                },
                u384 {
                    limb0: 0xf5731bab0ef29c9b13a4d8ee,
                    limb1: 0xebf9a3d720e88bd0ce613f4d,
                    limb2: 0x5690f4dbfcb8821b6c0d258e,
                    limb3: 0x816813e7bc04c5af32fdd85
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xaa59ca6773c9dcdc2e390cf8,
                    limb1: 0x4cd3cf3e23c2b0bf84a1396b,
                    limb2: 0x80d8bbbc1e62971b0ac01522,
                    limb3: 0x17b099982ee306f2772b9d27
                },
                u384 {
                    limb0: 0x15e88fdf21427388790bb0c1,
                    limb1: 0xe940a5ca85ee34ff7465e0da,
                    limb2: 0x5ccaf9aebec97b31dbc19033,
                    limb3: 0x155dc8feda28819fc7941d59
                },
                u384 {
                    limb0: 0x4307248176af2552195ed60f,
                    limb1: 0x2e97982c5b9b8db2795e7fc8,
                    limb2: 0x3416b07e76855721026639d5,
                    limb3: 0x10eb76aec19627a6886fc076
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xc1fd6eca44ad3b3cf8745d59,
                    limb1: 0xdf4516c3b5dd438cb3c6155c,
                    limb2: 0xa8889ac9c16d7a974df3eaca,
                    limb3: 0xf99fa276a1f9343f42b67a3
                },
                u384 {
                    limb0: 0x24786eac81cb726c4e93b90d,
                    limb1: 0x48b5bcbb8cf1391f1ad8fd39,
                    limb2: 0x16f826988e6abce8bcaf837c,
                    limb3: 0x658f30fb5814ad181a3ce5f
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xdcd45bb27fab0ecf3e1d0201,
                    limb1: 0x919d7a592b238e6c349c8556,
                    limb2: 0x7af511e849793187105e3f62,
                    limb3: 0xa66c30468e7de778fd1c3d6
                },
                u384 {
                    limb0: 0xf5731bab0ef29c9b13a4d8ee,
                    limb1: 0xebf9a3d720e88bd0ce613f4d,
                    limb2: 0x5690f4dbfcb8821b6c0d258e,
                    limb3: 0x816813e7bc04c5af32fdd85
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x6dc62f900fa4514f5e44691d,
            limb1: 0x2000685c49f57c49c2397e48,
            limb2: 0x6e6af4a3fc4a739ed222c4bb,
            limb3: 0x645493fdff4c29b36609584
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            1
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xa716629c25612e764625468d,
                    limb1: 0x4993513c9f2fc482ec0ddf41,
                    limb2: 0xda3022a7bd4bcd2701364587,
                    limb3: 0x126cd76ffd134f72d4e07ab4
                },
                y: u384 {
                    limb0: 0xd0c8893806b50369585cd473,
                    limb1: 0xc4b1695978b85b05ce237ee9,
                    limb2: 0x66fbdfa50ccf9ec925c0fa8e,
                    limb3: 0x8bbdd846e2ed45da41c1c9b
                }
            }
        );
    }


    #[test]
    fn test_msm_BLS12_381_4_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x86f767b5b64f6cd82072a8f,
                    limb1: 0xfc86cdcb2bf9c1bc0e0d594f,
                    limb2: 0xaeb7e9523a13d981cb522252,
                    limb3: 0x25fa399901da1deb7f7d66b
                },
                y: u384 {
                    limb0: 0xba7249efa16191924919a5af,
                    limb1: 0xca205f00a62a17c44a3b3a75,
                    limb2: 0xe9b99366d6af01a871915f20,
                    limb3: 0x1142fc8bec23201427edcf77
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x86f767b5b64f6cd82072a8f,
                    limb1: 0xfc86cdcb2bf9c1bc0e0d594f,
                    limb2: 0xaeb7e9523a13d981cb522252,
                    limb3: 0x25fa399901da1deb7f7d66b
                },
                y: u384 {
                    limb0: 0xba7249efa16191924919a5af,
                    limb1: 0xca205f00a62a17c44a3b3a75,
                    limb2: 0xe9b99366d6af01a871915f20,
                    limb3: 0x1142fc8bec23201427edcf77
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x86f767b5b64f6cd82072a8f,
                    limb1: 0xfc86cdcb2bf9c1bc0e0d594f,
                    limb2: 0xaeb7e9523a13d981cb522252,
                    limb3: 0x25fa399901da1deb7f7d66b
                },
                y: u384 {
                    limb0: 0xba7249efa16191924919a5af,
                    limb1: 0xca205f00a62a17c44a3b3a75,
                    limb2: 0xe9b99366d6af01a871915f20,
                    limb3: 0x1142fc8bec23201427edcf77
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x86f767b5b64f6cd82072a8f,
                    limb1: 0xfc86cdcb2bf9c1bc0e0d594f,
                    limb2: 0xaeb7e9523a13d981cb522252,
                    limb3: 0x25fa399901da1deb7f7d66b
                },
                y: u384 {
                    limb0: 0xba7249efa16191924919a5af,
                    limb1: 0xca205f00a62a17c44a3b3a75,
                    limb2: 0xe9b99366d6af01a871915f20,
                    limb3: 0x1142fc8bec23201427edcf77
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x6c0be55c90e639e1e44fc3a96d0c62c3, high: 0xd68ed55ef8d9ff015831feeec41e6f6
            },
            u256 {
                low: 0x6e5bac20725c2675ca9571e407dc02b1, high: 0x3f91668907b6e08e6ac1ca75afb918c8
            },
            u256 {
                low: 0x53125ffdf655860bdd32e231eb561699, high: 0x2d1ed1b3141b1a1b40a978bfb8f8903b
            },
            u256 {
                low: 0xb1182d235bf806761f12a0e912011caa, high: 0x16c5ada0590e83da586f1721078548d7
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xa766ed649c53b0106ea9cea6,
                limb1: 0xe67c948b7cf2d2aec8c6507c,
                limb2: 0x39f568c8a4119b4e80aa5b0,
                limb3: 0xd230d33ef579fcaa8ce599c
            },
            y: u384 {
                limb0: 0xd16cdeae357abdc4367fa698,
                limb1: 0x75e39406d8af8751fd950406,
                limb2: 0xf68cd2be8e4625296cda6280,
                limb3: 0x9c987088a44c8361a6807e7
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xd8ca28125ae1b861095b10d1,
                limb1: 0xe8962a59471e7f0f51a72759,
                limb2: 0x6d85d8765186a28c4dbb869a,
                limb3: 0x5fedf763c7bb2e15ed66d00
            },
            y: u384 {
                limb0: 0x8b2f6b0e8415ab88a3aa7a96,
                limb1: 0xaa39f2a7266ad238dddbc0d1,
                limb2: 0xb48315be7e9f93d8675ae516,
                limb3: 0x1ef4f307ee51349a59a19a2
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x4d30035ecbd30263003e624b,
                limb1: 0xacb71a40dac662086f5efde6,
                limb2: 0x385e5f22e7225772dfdad044,
                limb3: 0x9fef72e2d539cf3f75f6841
            },
            y: u384 {
                limb0: 0xb51da079ca49b5a4c4ad7837,
                limb1: 0x631814f8f36c3d38543d46bb,
                limb2: 0x19c2920f8f429b33c74741ba,
                limb3: 0x549f6786e61002dd4e7369b
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xca7fb9f22b4aaaed1948745b,
                    limb1: 0xbc063ac497a12a00442d82c4,
                    limb2: 0xfbeb0a8edb8b79788cd8df9,
                    limb3: 0x1abca50390c41c3ef0430c6
                },
                u384 {
                    limb0: 0xd335c9b3179fe1246184eb96, limb1: 0x1a1891f2, limb2: 0x0, limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x2b05d0cbf2eda4d9a5f85f21,
                    limb1: 0x99780eacc0e1521c92a4419e,
                    limb2: 0x51681b60b77f3f6b64e78758,
                    limb3: 0xa4c7bab3c3a50819506e44d
                },
                u384 {
                    limb0: 0x17d9c1fc24659220f4eb176,
                    limb1: 0x842d704a4dc461b947d85633,
                    limb2: 0x90f46cf8a022584e40284abb,
                    limb3: 0xa7e611cba0aa4f0ea5577ae
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xb2981d3a7d265951130ef73e,
                    limb1: 0x2b28dd5b02e3dcdb188942b9,
                    limb2: 0x9a57d9cba75d13e2c5cca1a1,
                    limb3: 0x50963bcce0e0a245bcf057d
                },
                u384 {
                    limb0: 0xb059737ffcac72be61e3a5b9,
                    limb1: 0xc75a479669de7be8f29e3905,
                    limb2: 0xa9328bf07c204b9f9ae012f5,
                    limb3: 0x94c7a52e6f9441f77e4c0e9
                },
                u384 {
                    limb0: 0xe138b5fc02f20567177a67b6,
                    limb1: 0xec3b9428d081e593c70fdd65,
                    limb2: 0xe9183dec1fe86b549f0cbdb6,
                    limb3: 0x15e8e2ff61e78600aeebb895
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xfac3433011b7936697e1d1d9,
                    limb1: 0xfeaf68120cd4524e2be50679,
                    limb2: 0x254c0ab7985b228a0190aa2,
                    limb3: 0xf30dcc2b7695b6c08ffe97f
                },
                u384 {
                    limb0: 0x54a2707f4f1a64883d3b1b2d,
                    limb1: 0xa984ee88406090c100b558cd,
                    limb2: 0x86070b1c1215b40d1c182e,
                    limb3: 0xff87288aeaaad295e3a3704
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x2b05d0cbf2eda4d9a5f85f21,
                    limb1: 0x99780eacc0e1521c92a4419e,
                    limb2: 0x51681b60b77f3f6b64e78758,
                    limb3: 0xa4c7bab3c3a50819506e44d
                },
                u384 {
                    limb0: 0x17d9c1fc24659220f4eb176,
                    limb1: 0x842d704a4dc461b947d85633,
                    limb2: 0x90f46cf8a022584e40284abb,
                    limb3: 0xa7e611cba0aa4f0ea5577ae
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x2ccd23a986d3f0ea02c9a043,
                    limb1: 0xfc4982730711fa858d2cbe,
                    limb2: 0x675d7ce6ed7649c61e386147,
                    limb3: 0x100d07090687396bc51b8184
                },
                u384 {
                    limb0: 0xaab0c03ab1807799b998ae13,
                    limb1: 0xb39869507b587b1227876ac1,
                    limb2: 0x21a5d66bb23ba5c279c2895f,
                    limb3: 0xd0088f51cbff34d258dd3db
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xe8abd149088230b3fe2880,
                    limb1: 0x4dcbb1d6c9bffc4fd11e6b94,
                    limb2: 0xe37f75e2be73c7ed22e73ac0,
                    limb3: 0x1409c6e596e60b6a9486e861
                },
                u384 {
                    limb0: 0xd01a617203b850d1749d6f4b,
                    limb1: 0x8213da7c8398b558bef77f55,
                    limb2: 0x270deb0ed8dccf76da7769d1,
                    limb3: 0x11a28eda6ce691da344d644a
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x48a2187cc9e6f0d91bd593d,
                    limb1: 0x5bb372f536c0ac23cf9e92c3,
                    limb2: 0x944d1c5e96cef15b9b0a5d26,
                    limb3: 0x128936e09b932199de6470d2
                },
                u384 {
                    limb0: 0x38229faa32d2f05eb36ac056,
                    limb1: 0x23f79b6e4fcfc0486a37e316,
                    limb2: 0xef4520948621ce8212e7882b,
                    limb3: 0xd59d0c2ae347071e7a99319
                },
                u384 {
                    limb0: 0x60258084b6a5ab62a83b3b2,
                    limb1: 0x8083d11a864c8f5b24dd2323,
                    limb2: 0x82dcf2e093fb4b4e29c3b758,
                    limb3: 0xe58778947a1da0d8e832efd
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xefa6af45f62508c2cff9a1ff,
                    limb1: 0x19c4f7842ed0ed2e875ae53,
                    limb2: 0xc41ad104cc693d25b10db2c3,
                    limb3: 0x223e5d7af1879db70c8aa64
                },
                u384 {
                    limb0: 0xddc185c89ae34345d27667d6,
                    limb1: 0x39edc4b02100e91abe85fd59,
                    limb2: 0x15a0528c9a84a6d182d381c7,
                    limb3: 0x12881795409a7a343afe41bc
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xe8abd149088230b3fe2880,
                    limb1: 0x4dcbb1d6c9bffc4fd11e6b94,
                    limb2: 0xe37f75e2be73c7ed22e73ac0,
                    limb3: 0x1409c6e596e60b6a9486e861
                },
                u384 {
                    limb0: 0xd01a617203b850d1749d6f4b,
                    limb1: 0x8213da7c8398b558bef77f55,
                    limb2: 0x270deb0ed8dccf76da7769d1,
                    limb3: 0x11a28eda6ce691da344d644a
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xc86e47917cfde3caaebe04c6,
                    limb1: 0x204f573b0e2b32ed70f2a66c,
                    limb2: 0x89e2f87a3040eacb6de2bc40,
                    limb3: 0x11bb522e42727a0f97a089b5
                },
                u384 {
                    limb0: 0x302ea91a3b09524e7c49fbbb,
                    limb1: 0xb39869507b587b118b5d4593,
                    limb2: 0x21a5d66bb23ba5c279c2895f,
                    limb3: 0xd0088f51cbff34d258dd3db
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xca869d99c1517e538ca299d8,
                    limb1: 0xe0193d92e5146dc3ded849c7,
                    limb2: 0xfdc362008b3fe8598ed16755,
                    limb3: 0xceb239a3a54c68f2b49b2e5
                },
                u384 {
                    limb0: 0x8b59d48e934a453bf666378f,
                    limb1: 0xd1e38e06d4cc150c5da5dabe,
                    limb2: 0x9d67753e2bce5185c5eebbdf,
                    limb3: 0xa033b45cfb096c4f4e5d274
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x116b2537d7fa4442cd62568b,
                    limb1: 0xfbe960eb580500abe373eb42,
                    limb2: 0x8b00782bf09c7c94a115d2f3,
                    limb3: 0xc564b524a28d6609458106
                },
                u384 {
                    limb0: 0xe46958189f8cd5a5df6497d1,
                    limb1: 0xc15b42822927034362032d14,
                    limb2: 0xd0e9e78e98d8d4e535060f2b,
                    limb3: 0xf2e5cb90d3bd7109ee18da5
                },
                u384 {
                    limb0: 0xc764ffc69a4019619de466f,
                    limb1: 0xa0b69237f2491368715eb722,
                    limb2: 0xb0d137320da10f5fd8692053,
                    limb3: 0xa03de13ac418891f767783b
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x78c676674b46f94e328abcb5,
                    limb1: 0x193423aa9da0c0eb5cb52720,
                    limb2: 0xb3c1db2ac88855e147c08a98,
                    limb3: 0x19ab7c7eafd333a2620b23e1
                },
                u384 {
                    limb0: 0x7c13523a932a14efd9993391,
                    limb1: 0xe05d657a5c7f5e0d57eb6afb,
                    limb2: 0x325228214ac1fa922435dcbf,
                    limb3: 0xe0bdb2d05427479887ba21c
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xca869d99c1517e538ca299d8,
                    limb1: 0xe0193d92e5146dc3ded849c7,
                    limb2: 0xfdc362008b3fe8598ed16755,
                    limb3: 0xceb239a3a54c68f2b49b2e5
                },
                u384 {
                    limb0: 0x8b59d48e934a453bf666378f,
                    limb1: 0xd1e38e06d4cc150c5da5dabe,
                    limb2: 0x9d67753e2bce5185c5eebbdf,
                    limb3: 0xa033b45cfb096c4f4e5d274
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xad222cafcbef1ed2a0a8af0e,
            limb1: 0x6e82a526420098f38a594c9f,
            limb2: 0x6d28d2dd46babb5fcfc918c1,
            limb3: 0xc58f99bd39fd1d9b314cdb1
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0xa21cb2d94c20920c29189d9f,
                limb1: 0x36ffad3a507e0f4d4ee3520c,
                limb2: 0xe67a3ef606f918c32c0f2285,
                limb3: 0x8ac1a38e6c558336d112470
            },
            u384 {
                limb0: 0x6c7998ee64f92287b4f2399d,
                limb1: 0xe0b14e1e05ac0db8663745d3,
                limb2: 0xbfdc014354213bf7f6b286b3,
                limb3: 0x543f65024c2ced56ed828c1
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            1
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xdb1ae71a46c3a7b67de3d2dd,
                    limb1: 0x2a6cc5d1ba52d9445788932a,
                    limb2: 0xc5feeb95a4954be16e61c308,
                    limb3: 0xcd3ed56504e008d8e1eb9aa
                },
                y: u384 {
                    limb0: 0xed6077b08f019a9f678811a5,
                    limb1: 0xf6761a63ae928167d904fda,
                    limb2: 0x8fbd5852ac4af006b4b6a344,
                    limb3: 0x15ff498caf3e6535fb9d478
                }
            }
        );
    }


    #[test]
    fn test_msm_BLS12_381_5_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xc5b2545bd6b44d997099a415,
                    limb1: 0x394c0f3664ed2224beb341ce,
                    limb2: 0x561eb9aa5c3a63f6eeff373c,
                    limb3: 0x10e9c9737205161c090ca02
                },
                y: u384 {
                    limb0: 0xd444135d0fe0c0c4d76418fd,
                    limb1: 0x5dfab007a662c93974599ed,
                    limb2: 0xbb5f5e7a234499c2d9bc8012,
                    limb3: 0xe37bb0d2457251447d76a7a
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xc5b2545bd6b44d997099a415,
                    limb1: 0x394c0f3664ed2224beb341ce,
                    limb2: 0x561eb9aa5c3a63f6eeff373c,
                    limb3: 0x10e9c9737205161c090ca02
                },
                y: u384 {
                    limb0: 0xd444135d0fe0c0c4d76418fd,
                    limb1: 0x5dfab007a662c93974599ed,
                    limb2: 0xbb5f5e7a234499c2d9bc8012,
                    limb3: 0xe37bb0d2457251447d76a7a
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xc5b2545bd6b44d997099a415,
                    limb1: 0x394c0f3664ed2224beb341ce,
                    limb2: 0x561eb9aa5c3a63f6eeff373c,
                    limb3: 0x10e9c9737205161c090ca02
                },
                y: u384 {
                    limb0: 0xd444135d0fe0c0c4d76418fd,
                    limb1: 0x5dfab007a662c93974599ed,
                    limb2: 0xbb5f5e7a234499c2d9bc8012,
                    limb3: 0xe37bb0d2457251447d76a7a
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xc5b2545bd6b44d997099a415,
                    limb1: 0x394c0f3664ed2224beb341ce,
                    limb2: 0x561eb9aa5c3a63f6eeff373c,
                    limb3: 0x10e9c9737205161c090ca02
                },
                y: u384 {
                    limb0: 0xd444135d0fe0c0c4d76418fd,
                    limb1: 0x5dfab007a662c93974599ed,
                    limb2: 0xbb5f5e7a234499c2d9bc8012,
                    limb3: 0xe37bb0d2457251447d76a7a
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xc5b2545bd6b44d997099a415,
                    limb1: 0x394c0f3664ed2224beb341ce,
                    limb2: 0x561eb9aa5c3a63f6eeff373c,
                    limb3: 0x10e9c9737205161c090ca02
                },
                y: u384 {
                    limb0: 0xd444135d0fe0c0c4d76418fd,
                    limb1: 0x5dfab007a662c93974599ed,
                    limb2: 0xbb5f5e7a234499c2d9bc8012,
                    limb3: 0xe37bb0d2457251447d76a7a
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xd3d1af353e0c8624aeba79e4b82987, high: 0x5db5804aac7b7ab2a8b56f85346d2b7e
            },
            u256 {
                low: 0xbf7b68ae1f8941b6e6a1a40bf031f4b9, high: 0x584070015e7f503c4b1347f601d6d903
            },
            u256 {
                low: 0x3b9cea959ad7558feecb325b064f768d, high: 0x3a1e3f4e2fdeb0352452bc39dbf2eed1
            },
            u256 {
                low: 0xb51d70d8582dd9727a089ca81cc5a8a0, high: 0x3936a25215203c7421aa15ef58c43ce
            },
            u256 {
                low: 0x55c36c3d5cbbc08035475c5ef76dce6e, high: 0x25eeafcc4ae9ee11f5fe0213792ecd75
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x48781920280c179da6dbca22,
                limb1: 0x73713417fc391f6de773e2db,
                limb2: 0x4e94b0e00416eefeef341252,
                limb3: 0x6c8386c58e0149f320bd65c
            },
            y: u384 {
                limb0: 0x3129a137448f4c75371c12d8,
                limb1: 0x5d4030c280a2548c00e3e0b4,
                limb2: 0x31eef8e760e471a3a3ef53f0,
                limb3: 0x15f464b6cc236248b74d8d37
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xf201be78600401213fce7638,
                limb1: 0x22914feb121c7cc449c631f9,
                limb2: 0xc616a4fb7ffbc4b9bf150b04,
                limb3: 0x6f8174471c781521b316804
            },
            y: u384 {
                limb0: 0x20987b64cde81595fc9cb06c,
                limb1: 0xb912a75f07579dd43a68920a,
                limb2: 0xb66e64b009e63266c59ad811,
                limb3: 0xfc9cf9c5391f37a42d22c7
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0xddd468f1def55fadd7d792bf,
                limb1: 0xf8eeacaa0ee4d80d71eb7c6b,
                limb2: 0x1cdcfff811c14cb54fb3c37a,
                limb3: 0x15040b089bc28e49748c9650
            },
            y: u384 {
                limb0: 0x6f196afc0ebf7c1ba5d53ed0,
                limb1: 0x1d71af3a9492c09132970054,
                limb2: 0xbcb963464e58ed03bdc52fea,
                limb3: 0xaa85485ae028d3678e7a13
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x6db568e47ecbf30db9a56208,
                    limb1: 0x62679eeff31e925ff33c61fe,
                    limb2: 0x2c8f2320c03f91131974ad7a,
                    limb3: 0x4ceb75be7927a4aa57676e4
                },
                u384 {
                    limb0: 0xe750d8f6cf1a7bc2dadc305,
                    limb1: 0x6730d2a0f6b0f6236d9ebb8d,
                    limb2: 0x434bacd764774b84f38512bf,
                    limb3: 0x1a0111ea397fe69a4b1ba7b6
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x7d78c286732e8291906be930,
                    limb1: 0x195fed6671649b99aea9eca5,
                    limb2: 0x99313712d3bbaafff61e4a6a,
                    limb3: 0x957019ec8104d06e04b76fa
                },
                u384 {
                    limb0: 0xa3299283bb3e9ac8e88a3c74,
                    limb1: 0xba738f52958ab4917884db54,
                    limb2: 0x9e98424d0425f88f1551c930,
                    limb3: 0x122a3ce6a97f8099587f0757
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xfade094911fc208be1fc68f8,
                    limb1: 0x6b55f84abc87042b5e5261a9,
                    limb2: 0x7733cc610407b4caf3aa1c3,
                    limb3: 0x13f70802cd1152fc1acb7f5a
                },
                u384 {
                    limb0: 0xe2009a4c6e5157b281c5a302,
                    limb1: 0x88adf29faabba22e264b2a26,
                    limb2: 0xa948cd1f14dcad74b3bfc5b6,
                    limb3: 0xfb5545f4129d03493c4b9c4
                },
                u384 {
                    limb0: 0xbd4dc397183ba5a23435e87a,
                    limb1: 0xdcda157f8a876877a0c345ad,
                    limb2: 0x766169743137e6e41b794dad,
                    limb3: 0xaac2b9ca191c03a958cd184
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x448f0a1a12bb0a4641affa15,
                    limb1: 0xfe4ee2f8cee178429bfbb297,
                    limb2: 0x21792f73ea77607ae4f416e8,
                    limb3: 0xb5af490e6c14d8136123434
                },
                u384 {
                    limb0: 0x29fe4a0f78fc6b23a2299c7a,
                    limb1: 0x1b6c980868c8e5fda4bb6d55,
                    limb2: 0xf3c9af8547a94b326e3cff44,
                    limb3: 0x14a6cfc632fe3530cbc4cdf1
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x7d78c286732e8291906be930,
                    limb1: 0x195fed6671649b99aea9eca5,
                    limb2: 0x99313712d3bbaafff61e4a6a,
                    limb3: 0x957019ec8104d06e04b76fa
                },
                u384 {
                    limb0: 0xa3299283bb3e9ac8e88a3c74,
                    limb1: 0xba738f52958ab4917884db54,
                    limb2: 0x9e98424d0425f88f1551c930,
                    limb3: 0x122a3ce6a97f8099587f0757
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xbd90187886b7864d53edd89f,
                    limb1: 0x5eb437782ae9fbf7dd1fa681,
                    limb2: 0x8bc9ccf63945574e30a642ef,
                    limb3: 0xe6ffdd91b2fb16c9c9ee87b
                },
                u384 {
                    limb0: 0x652ffc1c3f9af94774e1ee6f, limb1: 0x7c8a3dcc, limb2: 0x0, limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x85e0fef6d2323d639c04d7c0,
                    limb1: 0x9ea2c48f3c8c878298ddd3a3,
                    limb2: 0x428aa92e2f66698de1c64ba7,
                    limb3: 0x9e70137a39fe791f451ca17
                },
                u384 {
                    limb0: 0xf99fed2b8346b1454f97905e,
                    limb1: 0xb53737f7fa7573b16328c35,
                    limb2: 0x27164e31884122d44570d07f,
                    limb3: 0x11fa5e0e909813e66f5975af
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x8f4764a7694d9b254561b50a,
                    limb1: 0xd7db4b10132104835ac0e1d8,
                    limb2: 0xfbba5983ff6d9be3861a6f8f,
                    limb3: 0x119b241a60d9ec3aafbf1331
                },
                u384 {
                    limb0: 0x390d9932852cca20eb0f133b,
                    limb1: 0x8b6ed2365694170a88303a43,
                    limb2: 0x138995844a5c43d4025da4bb,
                    limb3: 0x1997737e9b113800eee4b10b
                },
                u384 {
                    limb0: 0x32388a739573c2e2e17f15fa,
                    limb1: 0x33197ab97970f092c7fa44b,
                    limb2: 0xc1a81ba0f4f0d8ba8ff34e4e,
                    limb3: 0x57023e7f261cf0b2d9134c7
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x662ffbdb8ec9f58e7013b455,
                    limb1: 0x135a3f9bfb8127e644cb4e8f,
                    limb2: 0xc6def7e159225ab293941bdf,
                    limb3: 0xd9af2f454ffb7ad862b80a6
                },
                u384 {
                    limb0: 0x83d7b4ae991cc5153e5eec22,
                    limb1: 0x5eec28bc113b70a41b7230da,
                    limb2: 0x15c1df175815f4472eb91c7d,
                    limb3: 0x13e75465cf608265272e8750
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x85e0fef6d2323d639c04d7c0,
                    limb1: 0x9ea2c48f3c8c878298ddd3a3,
                    limb2: 0x428aa92e2f66698de1c64ba7,
                    limb3: 0x9e70137a39fe791f451ca17
                },
                u384 {
                    limb0: 0xf99fed2b8346b1454f97905e,
                    limb1: 0xb53737f7fa7573b16328c35,
                    limb2: 0x27164e31884122d44570d07f,
                    limb3: 0x11fa5e0e909813e66f5975af
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xb010c9268f5d9e4e886fde5d,
                    limb1: 0x1f55ea8041c5d437078c1a8d,
                    limb2: 0x6e575444840acbcd0f180f95,
                    limb3: 0x44c9c19c938e2385eb6c5d8
                },
                u384 {
                    limb0: 0x302ea91a3b09524e7c49fbbb,
                    limb1: 0xb39869507b587b118b5d4593,
                    limb2: 0x21a5d66bb23ba5c279c2895f,
                    limb3: 0xd0088f51cbff34d258dd3db
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x2303cf9300c5957b53c84f23,
                    limb1: 0xcf5e3233e25efde262a34a0c,
                    limb2: 0x5f9ad93a06d112d2bf81b489,
                    limb3: 0x77113940791a026a20bd33f
                },
                u384 {
                    limb0: 0x92d1d89535049f30e8594c5f,
                    limb1: 0xb2e1a8accc60977681a65197,
                    limb2: 0xa3a3b4bb3731859ad84156ff,
                    limb3: 0x180601876575bd9906795117
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x3c9e4b94526fa74e5e434e80,
                    limb1: 0x309bb50e9af65df58209b610,
                    limb2: 0x25409965e5936417f526559e,
                    limb3: 0x17e7fabf1e0ba33fd561397f
                },
                u384 {
                    limb0: 0x9ba302bd5a253b1f82659cc6,
                    limb1: 0x7d9fe1de5b435d7e5647a23,
                    limb2: 0x23ba3fa7ed687e300f0f9b37,
                    limb3: 0xac6515cd53d74a020fe7317
                },
                u384 {
                    limb0: 0xfab312cf2a17829d2935aba7,
                    limb1: 0xdaa064d356e0984563e74555,
                    limb2: 0x540e948158b9e9d536f08273,
                    limb3: 0x1d4161b84a49dd2d909a6c7
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xdabb3e4c491755ed4f2191e1,
                    limb1: 0xd647f62e92cb01656be12831,
                    limb2: 0x3b1fb810b6ccffc60a81bf67,
                    limb3: 0x3c33c65e4c69a003d13a547
                },
                u384 {
                    limb0: 0x374b6255a6157cc3a166317b,
                    limb1: 0x95f42ad04d6f7b6daa954662,
                    limb2: 0xc4abcc66af6033dc867623c0,
                    limb3: 0x1214d05ee957429538924d3b
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x2303cf9300c5957b53c84f23,
                    limb1: 0xcf5e3233e25efde262a34a0c,
                    limb2: 0x5f9ad93a06d112d2bf81b489,
                    limb3: 0x77113940791a026a20bd33f
                },
                u384 {
                    limb0: 0x92d1d89535049f30e8594c5f,
                    limb1: 0xb2e1a8accc60977681a65197,
                    limb2: 0xa3a3b4bb3731859ad84156ff,
                    limb3: 0x180601876575bd9906795117
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x57b44fec79dc12644c893999,
            limb1: 0xf15ca20de17495a88661df1f,
            limb2: 0xbe088c4afe4ec65c666cbf1e,
            limb3: 0x17797c7a09abb35436651a4
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0xdb3b4f0d60e9ecd954e6fb50,
                limb1: 0xdbfa9c895c224fc2d45edcb,
                limb2: 0xb1c27cf9f10406a41fd5feac,
                limb3: 0x22c032cf3afb624b71a2588
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            1
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xe106d15015c2077653a4482d,
                    limb1: 0x1d91ffc43333e04f7ad2649d,
                    limb2: 0x45adcd6909dbbd5046c24710,
                    limb3: 0x15e0e307a7619de115ea3fae
                },
                y: u384 {
                    limb0: 0x684f787b9e5669a6c8db8247,
                    limb1: 0x18fad9aa14fdb0106778f5f1,
                    limb2: 0xdaedeae80fb587b4545adc35,
                    limb3: 0x11d6bacce3283eac218b3329
                }
            }
        );
    }


    #[test]
    fn test_msm_BLS12_381_6_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xdfa4a6944c755d8682c0f7c2,
                    limb1: 0xfbe3e0995a7541ff8e8b6896,
                    limb2: 0x42ece884e1308860dfe84f7b,
                    limb3: 0xcaf1cb6a142ac7e6ef5f3cb
                },
                y: u384 {
                    limb0: 0xebe4422a57eb683a057bdce0,
                    limb1: 0xacf07823e315137728634361,
                    limb2: 0xe6d304cdd7ebebc6c3713ac6,
                    limb3: 0x8d55425d2b59ee3adf85a5a
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xdfa4a6944c755d8682c0f7c2,
                    limb1: 0xfbe3e0995a7541ff8e8b6896,
                    limb2: 0x42ece884e1308860dfe84f7b,
                    limb3: 0xcaf1cb6a142ac7e6ef5f3cb
                },
                y: u384 {
                    limb0: 0xebe4422a57eb683a057bdce0,
                    limb1: 0xacf07823e315137728634361,
                    limb2: 0xe6d304cdd7ebebc6c3713ac6,
                    limb3: 0x8d55425d2b59ee3adf85a5a
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xdfa4a6944c755d8682c0f7c2,
                    limb1: 0xfbe3e0995a7541ff8e8b6896,
                    limb2: 0x42ece884e1308860dfe84f7b,
                    limb3: 0xcaf1cb6a142ac7e6ef5f3cb
                },
                y: u384 {
                    limb0: 0xebe4422a57eb683a057bdce0,
                    limb1: 0xacf07823e315137728634361,
                    limb2: 0xe6d304cdd7ebebc6c3713ac6,
                    limb3: 0x8d55425d2b59ee3adf85a5a
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xdfa4a6944c755d8682c0f7c2,
                    limb1: 0xfbe3e0995a7541ff8e8b6896,
                    limb2: 0x42ece884e1308860dfe84f7b,
                    limb3: 0xcaf1cb6a142ac7e6ef5f3cb
                },
                y: u384 {
                    limb0: 0xebe4422a57eb683a057bdce0,
                    limb1: 0xacf07823e315137728634361,
                    limb2: 0xe6d304cdd7ebebc6c3713ac6,
                    limb3: 0x8d55425d2b59ee3adf85a5a
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xdfa4a6944c755d8682c0f7c2,
                    limb1: 0xfbe3e0995a7541ff8e8b6896,
                    limb2: 0x42ece884e1308860dfe84f7b,
                    limb3: 0xcaf1cb6a142ac7e6ef5f3cb
                },
                y: u384 {
                    limb0: 0xebe4422a57eb683a057bdce0,
                    limb1: 0xacf07823e315137728634361,
                    limb2: 0xe6d304cdd7ebebc6c3713ac6,
                    limb3: 0x8d55425d2b59ee3adf85a5a
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xdfa4a6944c755d8682c0f7c2,
                    limb1: 0xfbe3e0995a7541ff8e8b6896,
                    limb2: 0x42ece884e1308860dfe84f7b,
                    limb3: 0xcaf1cb6a142ac7e6ef5f3cb
                },
                y: u384 {
                    limb0: 0xebe4422a57eb683a057bdce0,
                    limb1: 0xacf07823e315137728634361,
                    limb2: 0xe6d304cdd7ebebc6c3713ac6,
                    limb3: 0x8d55425d2b59ee3adf85a5a
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x88819f421a42b62914afe646fe3216bd, high: 0x303410eb280a07ee4ec985ff94b28b9d
            },
            u256 {
                low: 0x200f7753f217faac259cff81e5ce0ca6, high: 0x411109a250de4292390a9016cdec85da
            },
            u256 {
                low: 0x2f16fb50c13e66af3c9590d33e2aad3e, high: 0x54e3973d6b770df15f59aa2c4a82e06a
            },
            u256 {
                low: 0x99e8c82821da132cdc68d4fd0bd7696f, high: 0x59e0b0e113f2a37c64d027590542bd75
            },
            u256 {
                low: 0x4c4b91fe6c148fc69750ca7e246cb09c, high: 0x1fc0618f15a5712c5ac4b6c7a31034dd
            },
            u256 {
                low: 0xa31559405e87905aa1fdcdf171df24d9, high: 0x302eea6b0ecfb95b877a2133f2ed33e1
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x43a3eef0f3273970b995185e,
                limb1: 0xd1d63beb5dfd333b50c4609a,
                limb2: 0xa78758a30bbe02fa6e49521c,
                limb3: 0xbf6614fb3d4a60efc02657e
            },
            y: u384 {
                limb0: 0x205c51c81648ed936eed85fd,
                limb1: 0xce0048c756e746e0ba171bcd,
                limb2: 0x94bbe46ae89b2f7e558ce514,
                limb3: 0x172709910b94e8f58bbf9fd8
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xbee1b9fc58455b3e15fa8cc1,
                limb1: 0xb4daf417240320b7668e0095,
                limb2: 0x387ee037bc0ed9cf3c3dcd1f,
                limb3: 0x66469c14d308be204cecb70
            },
            y: u384 {
                limb0: 0x9c89ffebd63e3d43083eea52,
                limb1: 0xa1ffda0ba4b8e0349adee34f,
                limb2: 0x262d6e51a565b3a73273dab6,
                limb3: 0xf3ca639b08b891322a6488c
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x8437fd284db711113408508c,
                limb1: 0xdcc546c304887964d11fe808,
                limb2: 0x2befc6dfacec6d1c305efd87,
                limb3: 0x137be15d8fef3ef659faac56
            },
            y: u384 {
                limb0: 0xec84ef53e28ab336f8ca4cc9,
                limb1: 0xd0ec10197d1ea0aeea2bc910,
                limb2: 0xa8481d239b95c3de154ac3e6,
                limb3: 0x123a0148a1b19d4d3f79b99b
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x7128569fd062513ddc65e9d0,
                    limb1: 0xec45170439dd9b4b7e5367e8,
                    limb2: 0x5af9d238adab1400fe57594b,
                    limb3: 0x1eb0722dbab0048de5b675b
                },
                u384 {
                    limb0: 0xd9c0a15d5084d3c39632ca97, limb1: 0x79f95de2, limb2: 0x0, limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x39fc964e7516c0888299b712,
                    limb1: 0x4ef5e34c3a1fad7f8dd40f27,
                    limb2: 0x11d8e949dcf7f19e218a9dca,
                    limb3: 0x6a4499161f0d5f4a5b197f0
                },
                u384 {
                    limb0: 0x8e0b6a7a7a626908c3a99a8b,
                    limb1: 0x9976b61c3e3e80e93f5c36cd,
                    limb2: 0x58d76baf7788c029a5537126,
                    limb3: 0x15b93e3e468940ce0234e6c
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xa8283c0399fb563a8e32dcf4,
                    limb1: 0x2e1e6d32be40a79d08da7336,
                    limb2: 0x2ab7ad4b23e36f170a0d3a9,
                    limb3: 0xc0d5aec4810c2621b900209
                },
                u384 {
                    limb0: 0x9ae47635f61829790038be4a,
                    limb1: 0xe4abe3880d6321b1789dd80c,
                    limb2: 0xad20ec4ecc1875e41805e442,
                    limb3: 0x16e5cd5259f90742068a15a1
                },
                u384 {
                    limb0: 0x8caba92abe001815ffb53fe4,
                    limb1: 0x44c9016a72df45920933bc1d,
                    limb2: 0x988e9cf58c0a731e569f2e56,
                    limb3: 0xfd4d5400ea61e21c6e65a0e
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x369e593a1a5c02220a67319d,
                    limb1: 0xd4a6ba8ff1cdbfda18a43c9e,
                    limb2: 0x417f8500f687af392a56469,
                    limb3: 0x90145b4e4371384baab80a
                },
                u384 {
                    limb0: 0x382da9e9e989a4230ea66a2c,
                    limb1: 0x65dad870f8fa03a4fd70db36,
                    limb2: 0x635daebdde2300a6954dc49a,
                    limb3: 0x56e4f8f91a25033808d39b1
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x39fc964e7516c0888299b712,
                    limb1: 0x4ef5e34c3a1fad7f8dd40f27,
                    limb2: 0x11d8e949dcf7f19e218a9dca,
                    limb3: 0x6a4499161f0d5f4a5b197f0
                },
                u384 {
                    limb0: 0x8e0b6a7a7a626908c3a99a8b,
                    limb1: 0x9976b61c3e3e80e93f5c36cd,
                    limb2: 0x58d76baf7788c029a5537126,
                    limb3: 0x15b93e3e468940ce0234e6c
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x194460f9e14a99298593ab46,
                    limb1: 0x7278fb5a4413bacfe03a22de,
                    limb2: 0xb8ea82f5fab8d7bb64e40faf,
                    limb3: 0x258415212b18ab95b365f17
                },
                u384 {
                    limb0: 0x6de6260da3f2a8cbadcbda94,
                    limb1: 0xb39869507b587b1263ba6a12,
                    limb2: 0x21a5d66bb23ba5c279c2895f,
                    limb3: 0xd0088f51cbff34d258dd3db
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x4514626f4939521ab038be2e,
                    limb1: 0xaf09df05553024329c213b6a,
                    limb2: 0xc0919738f4e14eb1cfd2bd98,
                    limb3: 0x26dc22d6f1c0336a485293f
                },
                u384 {
                    limb0: 0x12cd9f6f1544473b67442628,
                    limb1: 0xb671fdf07838936d299296d2,
                    limb2: 0xc7dfe41ac737e954d75ef623,
                    limb3: 0x6ed8b724b0cae39d756e87a
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x9b918669741bb6a34520efb,
                    limb1: 0x5caa17926c315fddf8a2afeb,
                    limb2: 0x9feba8803030ec5c9773d8e0,
                    limb3: 0x162922a6fc5454c6dc3da35f
                },
                u384 {
                    limb0: 0x156331530a978ec0aaed70db,
                    limb1: 0x8d2ade268582814fc971af77,
                    limb2: 0x693fc4576b88422368bd54dd,
                    limb3: 0xea5059a7a3b1ab9d0b39044
                },
                u384 {
                    limb0: 0xf907d9b4e2a759c7a795b1f5,
                    limb1: 0x248c17ea3e3f0f02fbf62701,
                    limb2: 0xe705a07d56e02b87621c4f8,
                    limb3: 0xf0a3392b7d9b3b620a6fba2
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x145189bd24e5486ac0e2f8b8,
                    limb1: 0xbc277c1554c090ca7084eda9,
                    limb2: 0x2465ce3d3853ac73f4af662,
                    limb3: 0x9b708b5bc700cda9214a4ff
                },
                u384 {
                    limb0: 0x99e27dbc9b121ced9d10edf5,
                    limb1: 0x72972520ea315790879e5b49,
                    limb2: 0xdc33e393b86859ce69f6c5cf,
                    limb3: 0x1b51bdef2b2d24d123ffa34
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x4514626f4939521ab038be2e,
                    limb1: 0xaf09df05553024329c213b6a,
                    limb2: 0xc0919738f4e14eb1cfd2bd98,
                    limb3: 0x26dc22d6f1c0336a485293f
                },
                u384 {
                    limb0: 0x12cd9f6f1544473b67442628,
                    limb1: 0xb671fdf07838936d299296d2,
                    limb2: 0xc7dfe41ac737e954d75ef623,
                    limb3: 0x6ed8b724b0cae39d756e87a
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x4539606b3cc8f7c70b43306c,
                    limb1: 0x41e160704c2fe1fd5856397,
                    limb2: 0xd5285876a959db13357c2b37,
                    limb3: 0xcd14b5374beb4f747095546
                },
                u384 {
                    limb0: 0x302ea91a3b09524e7c49fbbb,
                    limb1: 0xb39869507b587b118b5d4593,
                    limb2: 0x21a5d66bb23ba5c279c2895f,
                    limb3: 0xd0088f51cbff34d258dd3db
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x5d9bb30790b655b11d47a247,
                    limb1: 0xe0d9165f63d12fbff1575713,
                    limb2: 0xb14078029ccdfb873d64a610,
                    limb3: 0x118e766f65a6dd20571fdd62
                },
                u384 {
                    limb0: 0x6e3a48db140293b0b5fccd5e,
                    limb1: 0xd59097c6ce255c07e6fe1760,
                    limb2: 0xdedd05bffb7c049986e84817,
                    limb3: 0x20c6cb5c601bc1ec522fef
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x3f0deff339048117b4d50616,
                    limb1: 0xde38cf7b2e6eaef98d8bd61,
                    limb2: 0x58ae5623398f24943d43fd38,
                    limb3: 0xa807970ed42400c3ce9113d
                },
                u384 {
                    limb0: 0x40bfb450b1f294b3d53451ec,
                    limb1: 0x93aaf4c51fe5877e9a9410ff,
                    limb2: 0x32a90861399620a79ef67301,
                    limb3: 0x1766bf43e4e0ba7d051091e1
                },
                u384 {
                    limb0: 0x695612e9b4aab69e03f4fa3b,
                    limb1: 0x576b8b6901563aa435e00370,
                    limb2: 0xe2b4ec67c91cd4d9416ffd3b,
                    limb3: 0x139da760bc3ed5347d879e96
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x13c6cc1ecedb56c4751f33c6,
                    limb1: 0xb502b43ba1e2d2b788055c50,
                    limb2: 0x3e6a865baa4957130e8872c4,
                    limb3: 0x1237b5e9239ba74cc648261e
                },
                u384 {
                    limb0: 0xb8e9236c500a4ec2d7f33578,
                    limb1: 0x56425f1b3895701f9bf85d81,
                    limb2: 0x7b7416ffedf012661ba1205f,
                    limb3: 0x831b2d71806f07b148bfbf
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x5d9bb30790b655b11d47a247,
                    limb1: 0xe0d9165f63d12fbff1575713,
                    limb2: 0xb14078029ccdfb873d64a610,
                    limb3: 0x118e766f65a6dd20571fdd62
                },
                u384 {
                    limb0: 0x6e3a48db140293b0b5fccd5e,
                    limb1: 0xd59097c6ce255c07e6fe1760,
                    limb2: 0xdedd05bffb7c049986e84817,
                    limb3: 0x20c6cb5c601bc1ec522fef
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xe1401846847cc078bff5f445,
            limb1: 0xc7c07e520f06cc056200e885,
            limb2: 0x49b6850a9a85a0cef2762881,
            limb3: 0x26115ad8727156812284526
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            1
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xcf89d7eaf0d4bc15ee97fc7,
                    limb1: 0x7bea4b8e29155cc12c687e14,
                    limb2: 0xc1bcb7af0554758e5a3f2296,
                    limb3: 0x16ab6d2d46dbc82e9ce81713
                },
                y: u384 {
                    limb0: 0xf8c29b5f2a7c0ab0d9e249a,
                    limb1: 0xfb2cae20cc8d2f35b400bd40,
                    limb2: 0xc87ebede667e369eeb5c2cb7,
                    limb3: 0xb6f007f30993c00da25181c
                }
            }
        );
    }


    #[test]
    fn test_msm_BLS12_381_7_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x82f824cf878e6b9ee6ec01d8,
                    limb1: 0xf0bbdbb081eceaa16f4ee081,
                    limb2: 0x3cd7fc758a42bafdc5e82d1,
                    limb3: 0xef7dba15485e6ac51455e14
                },
                y: u384 {
                    limb0: 0xc5fe5cb09072239e1d6e0535,
                    limb1: 0x45757a4b4426dac42e642383,
                    limb2: 0x815c10d8b4ad506ce8f4c4a4,
                    limb3: 0x193a6591094ed6c45ca1717d
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x82f824cf878e6b9ee6ec01d8,
                    limb1: 0xf0bbdbb081eceaa16f4ee081,
                    limb2: 0x3cd7fc758a42bafdc5e82d1,
                    limb3: 0xef7dba15485e6ac51455e14
                },
                y: u384 {
                    limb0: 0xc5fe5cb09072239e1d6e0535,
                    limb1: 0x45757a4b4426dac42e642383,
                    limb2: 0x815c10d8b4ad506ce8f4c4a4,
                    limb3: 0x193a6591094ed6c45ca1717d
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x82f824cf878e6b9ee6ec01d8,
                    limb1: 0xf0bbdbb081eceaa16f4ee081,
                    limb2: 0x3cd7fc758a42bafdc5e82d1,
                    limb3: 0xef7dba15485e6ac51455e14
                },
                y: u384 {
                    limb0: 0xc5fe5cb09072239e1d6e0535,
                    limb1: 0x45757a4b4426dac42e642383,
                    limb2: 0x815c10d8b4ad506ce8f4c4a4,
                    limb3: 0x193a6591094ed6c45ca1717d
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x82f824cf878e6b9ee6ec01d8,
                    limb1: 0xf0bbdbb081eceaa16f4ee081,
                    limb2: 0x3cd7fc758a42bafdc5e82d1,
                    limb3: 0xef7dba15485e6ac51455e14
                },
                y: u384 {
                    limb0: 0xc5fe5cb09072239e1d6e0535,
                    limb1: 0x45757a4b4426dac42e642383,
                    limb2: 0x815c10d8b4ad506ce8f4c4a4,
                    limb3: 0x193a6591094ed6c45ca1717d
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x82f824cf878e6b9ee6ec01d8,
                    limb1: 0xf0bbdbb081eceaa16f4ee081,
                    limb2: 0x3cd7fc758a42bafdc5e82d1,
                    limb3: 0xef7dba15485e6ac51455e14
                },
                y: u384 {
                    limb0: 0xc5fe5cb09072239e1d6e0535,
                    limb1: 0x45757a4b4426dac42e642383,
                    limb2: 0x815c10d8b4ad506ce8f4c4a4,
                    limb3: 0x193a6591094ed6c45ca1717d
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x82f824cf878e6b9ee6ec01d8,
                    limb1: 0xf0bbdbb081eceaa16f4ee081,
                    limb2: 0x3cd7fc758a42bafdc5e82d1,
                    limb3: 0xef7dba15485e6ac51455e14
                },
                y: u384 {
                    limb0: 0xc5fe5cb09072239e1d6e0535,
                    limb1: 0x45757a4b4426dac42e642383,
                    limb2: 0x815c10d8b4ad506ce8f4c4a4,
                    limb3: 0x193a6591094ed6c45ca1717d
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x82f824cf878e6b9ee6ec01d8,
                    limb1: 0xf0bbdbb081eceaa16f4ee081,
                    limb2: 0x3cd7fc758a42bafdc5e82d1,
                    limb3: 0xef7dba15485e6ac51455e14
                },
                y: u384 {
                    limb0: 0xc5fe5cb09072239e1d6e0535,
                    limb1: 0x45757a4b4426dac42e642383,
                    limb2: 0x815c10d8b4ad506ce8f4c4a4,
                    limb3: 0x193a6591094ed6c45ca1717d
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xf3cc9d8a4b1678e45f20f4063438b4e4, high: 0x17bd1827f344c911174f7a54788c161e
            },
            u256 {
                low: 0x1cb66f6746e785ad1bce35d8cbe88a3f, high: 0x13b24d31b02de52c9b050db28ee4fd02
            },
            u256 {
                low: 0xeda2fc4c7237d420b3dd77e1cbb02fe9, high: 0x35fa6823c4841a8d2f751bde66163e5b
            },
            u256 {
                low: 0xf5a3e8933f7a27482cbb93c26e84f8ea, high: 0x42fd16aeefe6171b5723a95974151acc
            },
            u256 {
                low: 0xa1ab17c0766229cc5af95c78247f4d97, high: 0x60a4fd477bb8c2f11624d318a32652e8
            },
            u256 {
                low: 0xd48644820078cb124b7350d13421beaf, high: 0x3b232be59e65736c72f774b1b2f11ef9
            },
            u256 {
                low: 0x1d4d11804c6e6fbb37fef6b501fda698, high: 0x268c6081a100ed14fa92cd28c4c536fb
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x5e658736cc61997520e0bab1,
                limb1: 0x543b8d59b48c575ed7570e31,
                limb2: 0x124ec564882656fa70764661,
                limb3: 0xcbf7ce7246cde6aea13b07a
            },
            y: u384 {
                limb0: 0xd2d350bf646adfa4b0551e5,
                limb1: 0xbba354250f43b912f08619b2,
                limb2: 0x62e88af22be574d79cb35651,
                limb3: 0x15004342ac552e6b7ed9b1e2
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x5ccdf7bbda2970f534a8ef62,
                limb1: 0x8369748f14ed8cf42990b0fb,
                limb2: 0x5f87781253fa5e0b1512537e,
                limb3: 0x175d561d822686dc634b3f8e
            },
            y: u384 {
                limb0: 0xdd385545bc0be00ab7e69c70,
                limb1: 0xfd78e075fc0b9610911c7e87,
                limb2: 0x62655eca3c1eb740fd34816d,
                limb3: 0x164740deb25e8967252c341f
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x2ae3eec188b71c3392be959d,
                limb1: 0xf68d5b5a86b32ab5ff346109,
                limb2: 0x85ca71744b1ed53395eb9b1,
                limb3: 0x1117ecd6c44f3108312f4038
            },
            y: u384 {
                limb0: 0xcb20244dbbdde573842bcaf6,
                limb1: 0xdb09526343c8f69dc3257e8c,
                limb2: 0x94ae3e39db3e9f7ceb4c1086,
                limb3: 0x1186b668da0de1c2be70638e
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xded5f7ea193b9303bac85293,
                    limb1: 0xdadd3ce5cf9867611ffd21be,
                    limb2: 0x85610461faabfc04ebd50ba1,
                    limb3: 0x174fa4d88d5a95faa3ed7faf
                },
                u384 {
                    limb0: 0xfb22f4f832c521696ad4c4a9,
                    limb1: 0xb39869507b587b105153d4fb,
                    limb2: 0x21a5d66bb23ba5c279c2895f,
                    limb3: 0xd0088f51cbff34d258dd3db
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xb10a86446e38974b442fbaf,
                    limb1: 0x36be4bb8d93237dc88c3f8d4,
                    limb2: 0xbdb72b5af91b573a07016878,
                    limb3: 0x5b7b906bf47e6616b716af7
                },
                u384 {
                    limb0: 0x814a53f9200dfaebf83298cd,
                    limb1: 0x896a3c37b6e8aa47f6b2114a,
                    limb2: 0x707b1482e824145f9a355c4b,
                    limb3: 0x184acb4bfa0d081d5ade40de
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xc67918495992f2a72be37d8f,
                    limb1: 0xd327744c7913e81dd62cb17,
                    limb2: 0x4e881055821a92446ab0a588,
                    limb3: 0x119f3f6e4470817e6308789c
                },
                u384 {
                    limb0: 0xf79e36d37a3b88a5c3373d42,
                    limb1: 0x486ce8765aa02f39aee9fc39,
                    limb2: 0x8739b3681a9099d03de18664,
                    limb3: 0x196508582493883da0814287
                },
                u384 {
                    limb0: 0x5834839dc03964c6af046ba0,
                    limb1: 0x134ecc5327978c764652cd05,
                    limb2: 0x96052d285209d4225168cd9,
                    limb3: 0xb41531daf91442b898ae518
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x2c42a1911b8e25d2d10beebc,
                    limb1: 0xdaf92ee364c8df72230fe350,
                    limb2: 0xf6dcad6be46d5ce81c05a1e0,
                    limb3: 0x16dee41afd1f9985adc5abde
                },
                u384 {
                    limb0: 0xf12d4fe5523aebafe0cb6333,
                    limb1: 0xf01678fbf78fc6b37ec4452d,
                    limb2: 0xf8094b85732a6eef8e4638ef,
                    limb3: 0x1327f7713bb46ca68a260c56
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xb10a86446e38974b442fbaf,
                    limb1: 0x36be4bb8d93237dc88c3f8d4,
                    limb2: 0xbdb72b5af91b573a07016878,
                    limb3: 0x5b7b906bf47e6616b716af7
                },
                u384 {
                    limb0: 0x814a53f9200dfaebf83298cd,
                    limb1: 0x896a3c37b6e8aa47f6b2114a,
                    limb2: 0x707b1482e824145f9a355c4b,
                    limb3: 0x184acb4bfa0d081d5ade40de
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xe3e4fa706f5b0078dadef9b9,
                    limb1: 0xfce4816433ac9ace3d84badf,
                    limb2: 0x3fbbd893e7d72398d836da72,
                    limb3: 0x54913d55b67b9889ff3b132
                },
                u384 {
                    limb0: 0xbe5a73ddbda4e9cf617e540e, limb1: 0x55923df8, limb2: 0x0, limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xd6b22d021a3ac5beb089d376,
                    limb1: 0xbd93e32fa2b62ff995b6d00b,
                    limb2: 0x50bd6473fc1a44856a671b8e,
                    limb3: 0x147dcd861655770217f7f012
                },
                u384 {
                    limb0: 0x82e1e3741246236be46a641c,
                    limb1: 0x5a3c5502568774b2a4786e80,
                    limb2: 0x234261d51c500d4ef5994f2e,
                    limb3: 0xdacf2159c535fabe1a6b1ca
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xda8dd29a210d42ac6968f93f,
                    limb1: 0x13b796e093061016de2d69e9,
                    limb2: 0x38c1393275aae773f31c5ac8,
                    limb3: 0x11d60148c797563508412f72
                },
                u384 {
                    limb0: 0x804b9e75e1102818eef86c6e,
                    limb1: 0xea6f702680f9cf205ea20777,
                    limb2: 0xe54f82c73d15f7dfc89c7258,
                    limb3: 0x37fece27368ce638bb5ac7e
                },
                u384 {
                    limb0: 0x1a1142a85444d9dfba81570,
                    limb1: 0xf62074c9411269c11a1c71bb,
                    limb2: 0x497a94f8e76cdce85cc6e5e7,
                    limb3: 0xef578e1f168f024e94a53b7
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x46ccb4093aee16fac2284dd7,
                    limb1: 0xc0bd14dba6c5dd79fad74033,
                    limb2: 0x79128b49c3032f86cf0d35fc,
                    limb3: 0x3f40059acd628397e8cc926
                },
                u384 {
                    limb0: 0xa8df8dd0d51a8daf91aa3b1a,
                    limb1: 0x9a8faec76cbbe6825489ba04,
                    limb2: 0x6722da5a8519e31ef5b173a,
                    limb3: 0x2b1a481fe4db17af06377bc
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xd6b22d021a3ac5beb089d376,
                    limb1: 0xbd93e32fa2b62ff995b6d00b,
                    limb2: 0x50bd6473fc1a44856a671b8e,
                    limb3: 0x147dcd861655770217f7f012
                },
                u384 {
                    limb0: 0x82e1e3741246236be46a641c,
                    limb1: 0x5a3c5502568774b2a4786e80,
                    limb2: 0x234261d51c500d4ef5994f2e,
                    limb3: 0xdacf2159c535fabe1a6b1ca
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x7dbfbd7b6f6011aaf5fdfb27,
                    limb1: 0xab75c0ee6ced271f6d2f768,
                    limb2: 0x97b69701427dffca7f10610b,
                    limb3: 0x19a42190ace012a2622b0b4f
                },
                u384 {
                    limb0: 0x302ea91a3b09524e7c49fbbb,
                    limb1: 0xb39869507b587b118b5d4593,
                    limb2: 0x21a5d66bb23ba5c279c2895f,
                    limb3: 0xd0088f51cbff34d258dd3db
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xeac9249f5d26066bd374a85b,
                    limb1: 0x765ca36ddc0669332cfe6cd,
                    limb2: 0xfb9dc7bb93a15b29cf9dc9e8,
                    limb3: 0x6db5289a3d0c4a6a83b98b2
                },
                u384 {
                    limb0: 0xdaf61982111d72d73897d057,
                    limb1: 0x546ad55851c1349e1492edf8,
                    limb2: 0x1eb33a8530424bab9899184e,
                    limb3: 0xb8ce0e02c8a155001bccfa6
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x4c5635e45522e0f310dbdc74,
                    limb1: 0x3db913a96b58cbbc7017dcaf,
                    limb2: 0xde6b240876f9157997cd00a9,
                    limb3: 0x541621d083b9ad696e7a59e
                },
                u384 {
                    limb0: 0x7fd3cb1ea0b1f222f6795a96,
                    limb1: 0x216ab346eb7d740664680a39,
                    limb2: 0xecb30d194fa771fbcf31ad8,
                    limb3: 0x121473bca8bddec216dca44f
                },
                u384 {
                    limb0: 0xc00345d36fb5bd1aa66cbf03,
                    limb1: 0xfefb5caa11ddb0831e88c08b,
                    limb2: 0xeedd140b99591a195aebad60,
                    limb3: 0x153431af66efcb9b2cd564ff
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xf9d0927dba9919af4dd2f6c1,
                    limb1: 0xb666563a8050a428ac939b38,
                    limb2: 0xab2b7216ea0e21224af214e0,
                    limb3: 0x16c383c55c32c0055d2bb15
                },
                u384 {
                    limb0: 0xba8466088a76cb5ce25f96b1,
                    limb1: 0xea7a82c05053dc54339fb7e4,
                    limb2: 0x37813d3d5c91e3296edf4e79,
                    limb3: 0x1432719678a86ea5bbd796e2
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xeac9249f5d26066bd374a85b,
                    limb1: 0x765ca36ddc0669332cfe6cd,
                    limb2: 0xfb9dc7bb93a15b29cf9dc9e8,
                    limb3: 0x6db5289a3d0c4a6a83b98b2
                },
                u384 {
                    limb0: 0xdaf61982111d72d73897d057,
                    limb1: 0x546ad55851c1349e1492edf8,
                    limb2: 0x1eb33a8530424bab9899184e,
                    limb3: 0xb8ce0e02c8a155001bccfa6
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x3ff863289fff0b1e460b3132,
            limb1: 0xe01be9422d1f8224f816067c,
            limb2: 0xd97b9072683b656a33864237,
            limb3: 0xa769251efc9feed7c66da19
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            1
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x79bc248d3c5c06ff72d61f68,
                    limb1: 0x26cbca70f292ea2fde1ec08c,
                    limb2: 0xfb3c50a03f07dd5e4ad9008f,
                    limb3: 0xf6ee2e53a72716d5dbce302
                },
                y: u384 {
                    limb0: 0x364f6f50b83e9e9b90a51275,
                    limb1: 0x94ccec7986df7ff770e6057e,
                    limb2: 0x74027558f14269b83afc2e52,
                    limb3: 0x10a6a1cdab8f8768d10c47db
                }
            }
        );
    }


    #[test]
    fn test_msm_BLS12_381_8_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xa418ef657e6c48db80b06c4,
                    limb1: 0xd9b03708e353764bcbe27f58,
                    limb2: 0x28127454a928c3740ce8bc0,
                    limb3: 0x1117758414fb13ec35bc3406
                },
                y: u384 {
                    limb0: 0x6bd2deb2c636df805699bebf,
                    limb1: 0xa9cdd8b087b4bb2713522ede,
                    limb2: 0x9c2fb41920d01e0cfff79514,
                    limb3: 0xec972615d7dc56a730c16c0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xa418ef657e6c48db80b06c4,
                    limb1: 0xd9b03708e353764bcbe27f58,
                    limb2: 0x28127454a928c3740ce8bc0,
                    limb3: 0x1117758414fb13ec35bc3406
                },
                y: u384 {
                    limb0: 0x6bd2deb2c636df805699bebf,
                    limb1: 0xa9cdd8b087b4bb2713522ede,
                    limb2: 0x9c2fb41920d01e0cfff79514,
                    limb3: 0xec972615d7dc56a730c16c0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xa418ef657e6c48db80b06c4,
                    limb1: 0xd9b03708e353764bcbe27f58,
                    limb2: 0x28127454a928c3740ce8bc0,
                    limb3: 0x1117758414fb13ec35bc3406
                },
                y: u384 {
                    limb0: 0x6bd2deb2c636df805699bebf,
                    limb1: 0xa9cdd8b087b4bb2713522ede,
                    limb2: 0x9c2fb41920d01e0cfff79514,
                    limb3: 0xec972615d7dc56a730c16c0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xa418ef657e6c48db80b06c4,
                    limb1: 0xd9b03708e353764bcbe27f58,
                    limb2: 0x28127454a928c3740ce8bc0,
                    limb3: 0x1117758414fb13ec35bc3406
                },
                y: u384 {
                    limb0: 0x6bd2deb2c636df805699bebf,
                    limb1: 0xa9cdd8b087b4bb2713522ede,
                    limb2: 0x9c2fb41920d01e0cfff79514,
                    limb3: 0xec972615d7dc56a730c16c0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xa418ef657e6c48db80b06c4,
                    limb1: 0xd9b03708e353764bcbe27f58,
                    limb2: 0x28127454a928c3740ce8bc0,
                    limb3: 0x1117758414fb13ec35bc3406
                },
                y: u384 {
                    limb0: 0x6bd2deb2c636df805699bebf,
                    limb1: 0xa9cdd8b087b4bb2713522ede,
                    limb2: 0x9c2fb41920d01e0cfff79514,
                    limb3: 0xec972615d7dc56a730c16c0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xa418ef657e6c48db80b06c4,
                    limb1: 0xd9b03708e353764bcbe27f58,
                    limb2: 0x28127454a928c3740ce8bc0,
                    limb3: 0x1117758414fb13ec35bc3406
                },
                y: u384 {
                    limb0: 0x6bd2deb2c636df805699bebf,
                    limb1: 0xa9cdd8b087b4bb2713522ede,
                    limb2: 0x9c2fb41920d01e0cfff79514,
                    limb3: 0xec972615d7dc56a730c16c0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xa418ef657e6c48db80b06c4,
                    limb1: 0xd9b03708e353764bcbe27f58,
                    limb2: 0x28127454a928c3740ce8bc0,
                    limb3: 0x1117758414fb13ec35bc3406
                },
                y: u384 {
                    limb0: 0x6bd2deb2c636df805699bebf,
                    limb1: 0xa9cdd8b087b4bb2713522ede,
                    limb2: 0x9c2fb41920d01e0cfff79514,
                    limb3: 0xec972615d7dc56a730c16c0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xa418ef657e6c48db80b06c4,
                    limb1: 0xd9b03708e353764bcbe27f58,
                    limb2: 0x28127454a928c3740ce8bc0,
                    limb3: 0x1117758414fb13ec35bc3406
                },
                y: u384 {
                    limb0: 0x6bd2deb2c636df805699bebf,
                    limb1: 0xa9cdd8b087b4bb2713522ede,
                    limb2: 0x9c2fb41920d01e0cfff79514,
                    limb3: 0xec972615d7dc56a730c16c0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xf5feba5ec2953f517f67ee1aad9d1f42, high: 0x33e109aac3121af68b32992a3b7c1f9a
            },
            u256 {
                low: 0x588d91dfbe86a8ea1cf0d1d47b3df41, high: 0x55910964e23b580e4523dbbb1eeed219
            },
            u256 {
                low: 0x65ff6adc41aef3f7001098240a614be3, high: 0x5ae01fb794e4cc44e3fbdbda86ae9d5c
            },
            u256 {
                low: 0xbf1df6871a1ec04271d04b0f656fa7e6, high: 0x6f86b180488cac4e5a9414b840aaec7a
            },
            u256 {
                low: 0x322f1499e8a56f31ac2c10d0c15648ff, high: 0x904b0f50913508715d38ca9986cc8d5
            },
            u256 {
                low: 0x889c8ae24e3c0f2d4332559dcad00273, high: 0x6e02905287ba3b901e415c4e57030ede
            },
            u256 {
                low: 0xc31277fdeb83af16e404d8083fc18c00, high: 0x6e33513d6a325333116e8a6429deb984
            },
            u256 {
                low: 0x226962278513d91e48622a674a294067, high: 0x1aea669aa08c3a0085e7425092f078b8
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x3a5e5580ff57a27993ea64ab,
                limb1: 0x1f5631dc3a35399af8dcb6bd,
                limb2: 0xd435bb2b76cd631a99575f3d,
                limb3: 0x153879942332004546dc056c
            },
            y: u384 {
                limb0: 0xa53880c1df524498429475d5,
                limb1: 0xd71d7f66a199da81cedd33fc,
                limb2: 0x6fa9a2a82d814949d8e5dbe5,
                limb3: 0x7b004e2f4a238bd34528584
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x305c71914baec12ddf2dc924,
                limb1: 0x1ecddeea84bc5f487c1bee5c,
                limb2: 0xe1e238443a39beccd4dcf43e,
                limb3: 0x6442381d3c2c08034bafb18
            },
            y: u384 {
                limb0: 0x9374fcdcdc74a032fea0f1ca,
                limb1: 0xa69f0891d4b48e3fd77f1cac,
                limb2: 0xe4b0b9f3253ca48c4e091e70,
                limb3: 0x3b2fcaf33b444cb7928afff
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x80a398c0434efcea435b6581,
                limb1: 0xdbd3c86efc1f0d7b24a22cc5,
                limb2: 0x8cf1e6bf7cec17fbc215584e,
                limb3: 0xf15fa936fea541812cac1c7
            },
            y: u384 {
                limb0: 0x6812dc54c18955c37ea7c7df,
                limb1: 0x337ad64777082fb3d4fb8a37,
                limb2: 0x21bf13cfaab4c14a9977cbf1,
                limb3: 0xa7d3b581caad935dda44e44
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x7dc93b64ad6a4ff941d1fa68,
                    limb1: 0xe70c108bdaa6bf26d4c57d69,
                    limb2: 0x8d1f4c8a30d020a42140f082,
                    limb3: 0x5b188e968745a8eb59946a5
                },
                u384 {
                    limb0: 0x4eeac0ec61efaf169ce6691d,
                    limb1: 0x6730d2a0f6b0f622ea5d11f0,
                    limb2: 0x434bacd764774b84f38512bf,
                    limb3: 0x1a0111ea397fe69a4b1ba7b6
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xe9a747c4df542a1449190be2,
                    limb1: 0x30fd324a4b50f825d0baa716,
                    limb2: 0x7e8d3796cedcf3974ab5589b,
                    limb3: 0x643bdf1ab34e3c008dd3976
                },
                u384 {
                    limb0: 0x1e081b881cbf98f8b409e9e7,
                    limb1: 0xd55b3c5ccfd93c617898c9e8,
                    limb2: 0xafe0773e078ea7b80ce43a80,
                    limb3: 0xdb234bc3ad2b903199f15f9
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xfc060affb09262a8ab41a8f5,
                    limb1: 0xf9ff90bbe1b9c9f8aa78124d,
                    limb2: 0xe69371994bd8a1a30c07f31d,
                    limb3: 0xd9a5b4aa3dc2b68a56a4a44
                },
                u384 {
                    limb0: 0xa8aaa88d86b68ed46b4d52e1,
                    limb1: 0x2b5b5c1ce98be980018e877d,
                    limb2: 0xa56dc19dd6ce9aca30d6a9,
                    limb3: 0xa7661903201a11a6033ae01
                },
                u384 {
                    limb0: 0x68546874750b4d96af089e2b,
                    limb1: 0x175abd9992ad3aa6fcf008bb,
                    limb2: 0xc43f2e6d5862f958ef05a31b,
                    limb3: 0x198ae7c233326090db5f597c
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xa69d1f137d50a85124642f88,
                    limb1: 0xc3f4c9292d43e09742ea9c5b,
                    limb2: 0xfa34de5b3b73ce5d2ad5626c,
                    limb3: 0x190ef7c6acd38f002374e5d9
                },
                u384 {
                    limb0: 0x15786e20ff0063e2d0285246,
                    limb1: 0x870b4c315203053da50b27a3,
                    limb2: 0x38ea8349554c07d64c86c484,
                    limb3: 0x2c6af1c784b16d7d045087a
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xe9a747c4df542a1449190be2,
                    limb1: 0x30fd324a4b50f825d0baa716,
                    limb2: 0x7e8d3796cedcf3974ab5589b,
                    limb3: 0x643bdf1ab34e3c008dd3976
                },
                u384 {
                    limb0: 0x1e081b881cbf98f8b409e9e7,
                    limb1: 0xd55b3c5ccfd93c617898c9e8,
                    limb2: 0xafe0773e078ea7b80ce43a80,
                    limb3: 0xdb234bc3ad2b903199f15f9
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xbedc7d951b1b21d5a51618b1,
                    limb1: 0xca8cf122517d33d8bc554ed4,
                    limb2: 0xc0784fa48c2afc51809e473e,
                    limb3: 0x1452a75eb5340aac510f6268
                },
                u384 {
                    limb0: 0xab38cedd309c061c791f5ffc,
                    limb1: 0xb39869507b587b12f4dbbc17,
                    limb2: 0x21a5d66bb23ba5c279c2895f,
                    limb3: 0xd0088f51cbff34d258dd3db
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xf7172021b50a81cc12b2884c,
                    limb1: 0x685dc9d0e2929933853b933c,
                    limb2: 0x25efdc387a30057c183024bb,
                    limb3: 0x1275757e9b5b124cf440d162
                },
                u384 {
                    limb0: 0x76b5ff7816697a4468c6dac3,
                    limb1: 0x6eb2bcad8ea1208fd6ad924a,
                    limb2: 0x5ee84d4ddfab0080ddd992c0,
                    limb3: 0x2a578e450c2122de0a47897
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x176c50f36f68a617db1c9d0a,
                    limb1: 0x25ec4102390935cf4434b198,
                    limb2: 0xba0886a636896caa23566ef0,
                    limb3: 0x187765e38c9126b4dc5c83d
                },
                u384 {
                    limb0: 0x966ce4811d95585d45ae26cb,
                    limb1: 0x1d40707ceba639b3036b8eaf,
                    limb2: 0x17d76d35d80f18dd2b273a2b,
                    limb3: 0x10a69bfbf5072cbcd3df7637
                },
                u384 {
                    limb0: 0x599282884ca59711ddf5f83d,
                    limb1: 0x2009537a8f2ef06b009dd650,
                    limb2: 0xd0a4292acff1c427f7afc4cb,
                    limb3: 0xf7bca1eef8242e26cd4c4d
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x79b48087602c07304acacbda,
                    limb1: 0xd31582019ce87885d7964cf6,
                    limb2: 0x112817331fd17ee679b66d6e,
                    limb3: 0x15d3b225fa6c7bff3acbf61c
                },
                u384 {
                    limb0: 0xdad7fde059a5e911a31b6b0c,
                    limb1: 0xbacaf2b63a84823f5ab64929,
                    limb2: 0x7ba135377eac020377664b01,
                    limb3: 0xa95e391430848b78291e25d
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xf7172021b50a81cc12b2884c,
                    limb1: 0x685dc9d0e2929933853b933c,
                    limb2: 0x25efdc387a30057c183024bb,
                    limb3: 0x1275757e9b5b124cf440d162
                },
                u384 {
                    limb0: 0x76b5ff7816697a4468c6dac3,
                    limb1: 0x6eb2bcad8ea1208fd6ad924a,
                    limb2: 0x5ee84d4ddfab0080ddd992c0,
                    limb3: 0x2a578e450c2122de0a47897
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x9c25aef51e75c705cbbd9542,
                    limb1: 0xb7cd7ff2286cbf98ced438b9,
                    limb2: 0x14920191e185f1a73fe4a680,
                    limb3: 0xf3f4c6f8933647ae5ee6c64
                },
                u384 {
                    limb0: 0x302ea91a3b09524e7c49fbbb,
                    limb1: 0xb39869507b587b118b5d4593,
                    limb2: 0x21a5d66bb23ba5c279c2895f,
                    limb3: 0xd0088f51cbff34d258dd3db
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x48bdb557d7e4f23be099da43,
                    limb1: 0xdb7aef52280f3f0e10994f83,
                    limb2: 0x6204df3b2f174e5e44a551a6,
                    limb3: 0xfcc325c4142a5b0638565f0
                },
                u384 {
                    limb0: 0x53f5ae2b0141e7dd767c06,
                    limb1: 0x6c8f2b4775d589607dede4dd,
                    limb2: 0xd4778dd3ad5174bc5c92c632,
                    limb3: 0x4a6f3d4f5d2d2020395ead5
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xbc79a8d3563f888c9ed66066,
                    limb1: 0x9c044808db3a3f6d0b2d0430,
                    limb2: 0x6a8c9e123de3d3900535fb9e,
                    limb3: 0x1150f96bc9db41c1e9cd2263
                },
                u384 {
                    limb0: 0xedab279615b6c10fcf2d861c,
                    limb1: 0x5807a7b9f57fc57b4b24a7d5,
                    limb2: 0x2adfba91a0039ca771d44749,
                    limb3: 0xbe445dbf87181baa0166013
                },
                u384 {
                    limb0: 0x23c5b6b736d90f0ffc07622d,
                    limb1: 0x53e21c2b756dcb11cc16de51,
                    limb2: 0x9366ddb46d1bf201265fa5b4,
                    limb3: 0x8d04febad7e991ac0b6e067
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xc04ed55feb95c8ef826813b6,
                    limb1: 0x9f8a1806b2db0ff0050d3e0f,
                    limb2: 0x17c233df36ea26f2b8b211c,
                    limb3: 0xb2ea59c920ac98cf7de4855
                },
                u384 {
                    limb0: 0x14fd6b8ac05079f75d9f018,
                    limb1: 0xb23cad1dd7562581f7b79374,
                    limb2: 0x51de374eb545d2f1724b18c9,
                    limb3: 0x129bcf53d74b48080e57ab57
                },
                u384 { limb0: 0x4, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x48bdb557d7e4f23be099da43,
                    limb1: 0xdb7aef52280f3f0e10994f83,
                    limb2: 0x6204df3b2f174e5e44a551a6,
                    limb3: 0xfcc325c4142a5b0638565f0
                },
                u384 {
                    limb0: 0x53f5ae2b0141e7dd767c06,
                    limb1: 0x6c8f2b4775d589607dede4dd,
                    limb2: 0xd4778dd3ad5174bc5c92c632,
                    limb3: 0x4a6f3d4f5d2d2020395ead5
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xd8736d837299657db533c5e8,
            limb1: 0x7270f5d32b14be8c4627a81e,
            limb2: 0xc70aaae900444bed6e905817,
            limb3: 0x99f04582f9438bcca70da4f
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            1
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x15ce6f6dd94f1e5fce72f8a4,
                    limb1: 0x911f6bf8015ff2aef34b2e37,
                    limb2: 0x747c1fd87d056e48810f6043,
                    limb3: 0xb7658a7eb5209fbae835a2d
                },
                y: u384 {
                    limb0: 0xc03f8fbc653d67dac15de9ff,
                    limb1: 0xc180355f206389143bf56594,
                    limb2: 0xba730de30707caee4091203c,
                    limb3: 0x1c69593c3781caaac4a9337
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256R1_1_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x3ae203be8b0ede62a3c8c8e7,
                    limb1: 0x5e561c62eea6ddacd6cb2adb,
                    limb2: 0x300c956e70c6e800,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xa7d52201e65ac4266579121e,
                    limb1: 0x3c256344aedfa1d4e5c3a124,
                    limb2: 0xd7eb7f86857fa878,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x47534952c9c5fef1e76f8a76c74f11cd, high: 0x9177b6d45f2e9167713eceb14ad12b4c
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xbf9266c25f2f18e1cdd97a14,
                limb1: 0x7c9c5e8cc851143b89dda88b,
                limb2: 0xa22a2609f7b7125d,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xb7a341d6c9dce5dfb2eb9b9c,
                limb1: 0xe8f0600582977d38270079c3,
                limb2: 0x9b0739b823b0101e,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x73159f891bfb0dfc3de342dd,
                limb1: 0x200040b7e8bcb1d0185f37ef,
                limb2: 0x1435d9fd668b0146,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xa53bd8a9deca0f5d4024be58,
                limb1: 0x47874a8e782021dafac55a38,
                limb2: 0xc15409d6a0f3e4c0,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x7806b2286944862a32b49c88,
                limb1: 0x3b9b78c89fb000bf76f7dd6e,
                limb2: 0xc41b975fdb59fe6d,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x751cb5c3852b76b4730b54bf,
                limb1: 0x38b690bc9baaf87c88625ec9,
                limb2: 0x247585f57ed96ebe,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xf7e38bcacb75fb6a6a8e91b4,
                    limb1: 0x244b4d73999cb86aa60fde83,
                    limb2: 0x6256d53e46b68f13,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe83444f51d09a101397e73cd, limb1: 0x23ac6aad, limb2: 0x0, limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xa1c5a70a34121a28c565f623,
                    limb1: 0xa9cf1edc38184aec1a978848,
                    limb2: 0xa6f01e9f142cae61,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x58b957f15c208bb8e5dbd04,
                    limb1: 0x250d851049080e179f572c9a,
                    limb2: 0x2dc94486978205a3,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x5aeae261b3595f78e4826562,
                    limb1: 0xefc69a1787e33517dca026ac,
                    limb2: 0x9290b76e8fa96deb,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x74f924711d056ad3bac61784,
                    limb1: 0x8eef8e380905b32bda68c020,
                    limb2: 0x66f8a882eede2e0c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xbb521d70b15a24697add1aca,
                    limb1: 0x8ffb559dc6cd7e3645054dad,
                    limb2: 0xf3f0154f3e9143f0,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x6424f13f7c54fb5dcced689a,
                    limb1: 0x425ca065b8fd07fb797611d1,
                    limb2: 0x5f80e6952f1de1b2,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x48e4820aafd7ac615a6470,
                    limb1: 0x33afad5e22f7f321ffa77935,
                    limb2: 0x1f519dc1a27c0b1b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xbbb0f078fa88220b7cb9293e,
                    limb1: 0x44c32e249b805c75871780e3,
                    limb2: 0xd16a6843e3b482ff,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa1c5a70a34121a28c565f620,
                    limb1: 0xa9cf1edc38184aec1a978848,
                    limb2: 0xa6f01e9f142cae61,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x58b957f15c208bb8e5dbd04,
                    limb1: 0x250d851049080e179f572c9a,
                    limb2: 0x2dc94486978205a3,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xf50c5f7d05c2ae1aea4dd41f,
                    limb1: 0xf3bed66282bf89e9c4330c73,
                    limb2: 0x20de8dc8c15e845a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x22c8d89061842a68e13d5e0f,
                    limb1: 0x800000000000000023ab2f47,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x26624a04128c5bb8f3e47218,
                    limb1: 0x632e84acd6cb631f61c4f39,
                    limb2: 0xd1e88a0ecb0e2d58,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x52085cb858f613a11e53f43b,
                    limb1: 0x81a9a2e5289c708310d59d36,
                    limb2: 0xbbbd909328ae16ba,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x53f61bc7b7ed1019c300ce05,
                    limb1: 0x533331979bfbfe700f4c6e5a,
                    limb2: 0x7062b83bb8791fe3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x33a55401e6e517008cda94cd,
                    limb1: 0x43e09351af34fc91ec4c349e,
                    limb2: 0x282d58b62f220314,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4d187e111dedfed2ba557a04,
                    limb1: 0x4f838fa6030c5982370bc5db,
                    limb2: 0x7ed805da6cf94b04,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x8fb921c811e39668068fdfd7,
                    limb1: 0xf2d7fba766bc5988873c41dd,
                    limb2: 0x452326058e6a5e6f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2307a983eb37ea37ef4bfced,
                    limb1: 0x622c78e7c38f89650c4d5995,
                    limb2: 0xbab7dbe318422036,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd63a9acd30ec015accd68398,
                    limb1: 0x2eeed4a5fcc33533329c2f0f,
                    limb2: 0x278d841d30304fba,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x26624a04128c5bb8f3e47215,
                    limb1: 0x632e84acd6cb631f61c4f39,
                    limb2: 0xd1e88a0ecb0e2d58,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x52085cb858f613a11e53f43b,
                    limb1: 0x81a9a2e5289c708310d59d36,
                    limb2: 0xbbbd909328ae16ba,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x89b2837140e7bbfcda10cab6,
                    limb1: 0xf9175f21051d98de879dd5d2,
                    limb2: 0x5579fbc5b8cefdba,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5784a91a5e09d24e7c4a2665,
                    limb1: 0x7fffffffffffffff7c074594,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xfcfc0a2d09289014da21f360,
                    limb1: 0x7fc9f69323ffcdcdff6c7e94,
                    limb2: 0xc20f1c36014cbba,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x14e3ae4e7ac06bd98f68209a,
                    limb1: 0xa464467f77934d7070a8eaa3,
                    limb2: 0x27ae8ea1be1b004d,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xea5545d8241b2b8d106d45f5,
                    limb1: 0x7dda395e518d0f979f15fed8,
                    limb2: 0x7e12e0ec0492d61c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb270c973bcf027b735bf840e,
                    limb1: 0xf7fe0ed7477bcdacd6762a7c,
                    limb2: 0x2d4a298726090689,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7ac2450ea2b8255dc642db00,
                    limb1: 0x8e78a8d3ef73bf34ea3c9cd1,
                    limb2: 0x651c0c2242798dbc,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x406a1db5fb2306937a72158,
                    limb1: 0xa7ca4c006b6a5514f636dc5c,
                    limb2: 0xe16bd5d0a214a953,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x82ab4b3040445b32cb02de59,
                    limb1: 0x890e355bd962b57e09d4baf,
                    limb2: 0x4575b529cfa89e3d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8da8a60acb8cf8b17999fe7c,
                    limb1: 0xc6bee9d70fde9e6b132246c8,
                    limb2: 0xe3ba89f26fe992ff,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfcfc0a2d09289014da21f35d,
                    limb1: 0x7fc9f69323ffcdcdff6c7e94,
                    limb2: 0xc20f1c36014cbba,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x14e3ae4e7ac06bd98f68209a,
                    limb1: 0xa464467f77934d7070a8eaa3,
                    limb2: 0x27ae8ea1be1b004d,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x2230f2a92d29c81bb3239f21,
            limb1: 0xa2b206b942dd632432f20047,
            limb2: 0x59e3d47e002f7601,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            3
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x4befe6327c48495731a21bef,
                    limb1: 0x448be6f45f604f60e6dd2cf6,
                    limb2: 0x759c7b09943a9425,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb00f9989a945074c13a7cfd6,
                    limb1: 0xf37ada7e0a799d52778c6745,
                    limb2: 0xf3ee2c3b28911bf2,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256R1_2_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x279e23877221ce9257e9fabe,
                    limb1: 0x6ff5a03272ca08084fb1494b,
                    limb2: 0xb23e585da3b97bd0,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x2dcd9f216f64a795ea3afa9b,
                    limb1: 0x723915d6fa920bdc543a28a4,
                    limb2: 0x685821e39bdaa634,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x279e23877221ce9257e9fabe,
                    limb1: 0x6ff5a03272ca08084fb1494b,
                    limb2: 0xb23e585da3b97bd0,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x2dcd9f216f64a795ea3afa9b,
                    limb1: 0x723915d6fa920bdc543a28a4,
                    limb2: 0x685821e39bdaa634,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x8f42cebe23b870f377cb1a27974fdedc, high: 0xa1d20ebc5aa3892a4c88b9d8ab12fb53
            },
            u256 {
                low: 0x37cf80256a447a90be0a5a5679009c61, high: 0x8066b49bb1d792a07d25cefb7a0a02ba
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x32455ba0c31fd46e434f8383,
                limb1: 0xb07b7440f834f98bc0176029,
                limb2: 0xa85e1bf85fe24471,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xe439e1d9bfc3f28ea3509d20,
                limb1: 0xc6409b5496ddb27ac05b1b16,
                limb2: 0xbfd390561e900d16,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xabaa4f513524442d43eb0bd5,
                limb1: 0x5c4e1cf4fc63e988b0f72e5e,
                limb2: 0xf8f1fc877e93d024,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xcab80c20a346b41e7356771,
                limb1: 0xe063b9e1a4ea31aca4d347d7,
                limb2: 0x5e41259c3b252254,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x2395cac4ce9c646692fe6d91,
                limb1: 0xf8041bafb0fa7f80f9db935d,
                limb2: 0x24a262b107c94a59,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xb1e0bcfaf8b8209f8ddbb72e,
                limb1: 0x62677d35b0149588ac2609ee,
                limb2: 0xb233ec90d80dc71a,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x7b18cb1449e5fcf91182a24d,
                    limb1: 0x9c4f137746e46398a88425d3,
                    limb2: 0xb002528a1e01494d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb00d703c07cac13d34fb00f2, limb1: 0x4d18abb0, limb2: 0x0, limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x798f02eb37aefe44aa0803db,
                    limb1: 0xb2b806f1f55680d3e7299ef6,
                    limb2: 0x64871149ebff722,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa61c80d7cabe5cff64c681bd,
                    limb1: 0xdf8eeb8c9500fe6bf037568d,
                    limb2: 0xa5638ba7fc643fbf,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x58444eb67563aa2d75d8001a,
                    limb1: 0xadd41a0a27d7719344fb52b4,
                    limb2: 0xa57450b9f971cb0f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe5a4175846efd6de9eb527dd,
                    limb1: 0x59133d2578897003f3837808,
                    limb2: 0xe3aba3dfcdf21c78,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb8dcb3a0f17ec74bd7a146be,
                    limb1: 0x48517d5bbd1ddd3aa6f9430,
                    limb2: 0xcc93a397b0b2e0cd,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x245ea28999f26107a1458437,
                    limb1: 0x9a93a93e180504a5ff985386,
                    limb2: 0x20f932272812f948,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9526d40ed16b83a488ac24d2,
                    limb1: 0x33c885bdf0800bf9d8bee397,
                    limb2: 0xee0bc88b0786a032,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd9fe2e6edb93253ff97edb12,
                    limb1: 0x153efaafb7958b7894770309,
                    limb2: 0x6a9b92deb50dd4aa,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x798f02eb37aefe44aa0803d8,
                    limb1: 0xb2b806f1f55680d3e7299ef6,
                    limb2: 0x64871149ebff722,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa61c80d7cabe5cff64c681bd,
                    limb1: 0xdf8eeb8c9500fe6bf037568d,
                    limb2: 0xa5638ba7fc643fbf,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x15f64ff56ec1d0e437e46266,
                    limb1: 0x4b76ca5c0172532edc447721,
                    limb2: 0xbe4d4f7d7a41caee,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb908875b40f889ea86433696, limb1: 0x683f84c4, limb2: 0x0, limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x4e619bdf9bf3141e41e9c57,
                    limb1: 0xaef0d062aa8bf26470a9d741,
                    limb2: 0x94e15883e2569543,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2cb78d2758b9ed40642af96b,
                    limb1: 0x33bc42d890d20e6eff578858,
                    limb2: 0x54cfab18ddb2b40d,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x9d553fd2e59a20de7d4443ff,
                    limb1: 0x7c24f465484988300ceaf862,
                    limb2: 0x7e46aa75eb6885dc,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7efd5ac5fb959692296437a0,
                    limb1: 0x6b19489908444ab871a28276,
                    limb2: 0x99612e052763e729,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9d5f2d4bb2b474f649675fc7,
                    limb1: 0x11d2ccb979da42ba9041949c,
                    limb2: 0x4aacf016c1c4b62c,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x7acf078bb10d6d8143fdfccf,
                    limb1: 0xfa91feabeea7002a8961b87e,
                    limb2: 0x23007b455fb45a25,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x42c3b0d6f01b7005d6eaa196,
                    limb1: 0xa22278d8988425e03ccab9de,
                    limb2: 0xf06d53f2203ab2db,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x462d098031a0747cfb517409,
                    limb1: 0x18b6f4cbc4225b6f67166da9,
                    limb2: 0x5c57348d112277c1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4e619bdf9bf3141e41e9c54,
                    limb1: 0xaef0d062aa8bf26470a9d741,
                    limb2: 0x94e15883e2569543,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2cb78d2758b9ed40642af96b,
                    limb1: 0x33bc42d890d20e6eff578858,
                    limb2: 0x54cfab18ddb2b40d,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x14d980351ed734598c967dc5,
                    limb1: 0x5d07c73bcd4db34587c73b21,
                    limb2: 0x473bde62520bb6a9,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5784a91a5e09d24e7c4a2665,
                    limb1: 0x7fffffffffffffff7c074594,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xcdbed8d32ab9d4cc4dcb89dd,
                    limb1: 0x157a35e88a1c80ffc99a925d,
                    limb2: 0xf324399613c99aca,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x30bfe5e9fc3f576c29168698,
                    limb1: 0xabadc75b52a196f6552d3e46,
                    limb2: 0xe26ba0c579a2e583,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x7e5f32c87b1d469bf699485e,
                    limb1: 0x5b8473200f947cc2d154776f,
                    limb2: 0x307e1e520e1edab7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe7401f2a59ad11cbcde7b46b,
                    limb1: 0xa251b4bb358a7f5e8508cd8d,
                    limb2: 0x9612b1e8457afbbb,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd4c8eeb96347111d771b8a72,
                    limb1: 0xa47ab723ba767b3cfd03155c,
                    limb2: 0xbbbadb569546ba6a,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xb5928fa47768e7efb79a57d2,
                    limb1: 0x3eaf10fd74e9d894dc5842a8,
                    limb2: 0xbfa95ba9c8944a3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x68bfcf890b9f0b4d5ea60758,
                    limb1: 0x442af6a6d837277fc1a66139,
                    limb2: 0x7e1974e573101654,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3a13ff38471035f9ac8ecc80,
                    limb1: 0xb0e267437eb3c1d965954be1,
                    limb2: 0xb38353853d51e35f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xcdbed8d32ab9d4cc4dcb89da,
                    limb1: 0x157a35e88a1c80ffc99a925d,
                    limb2: 0xf324399613c99aca,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x30bfe5e9fc3f576c29168698,
                    limb1: 0xabadc75b52a196f6552d3e46,
                    limb2: 0xe26ba0c579a2e583,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x3fd6b1c32ea251dc34ba0862,
            limb1: 0xc67b9ea66ee52e83b67384b8,
            limb2: 0x313294c51480a2b5,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0xa5d29f52da276c62ce901b35,
                limb1: 0x3288d23e07c272e6f8f73ece,
                limb2: 0x62f022312eae34a5,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            3
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x44bd8fafca5d14fb02b5956d,
                    limb1: 0x8fdc71f10d4bd2ff57ce9f44,
                    limb2: 0x2fd6d87e0c7e985b,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x96f5b700f4110d38888150ea,
                    limb1: 0xc09f196373e884ae78a84985,
                    limb2: 0xb3d272be1f62f81a,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256R1_3_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x2fbb0b0444724720abf5b61a,
                    limb1: 0x953a5806409ed2ac3ac6e13a,
                    limb2: 0x6c61b3dd9a2a4c88,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x13fd1ba33eb1a7f57e872072,
                    limb1: 0x413d7f76e4e5b29b77f0b29d,
                    limb2: 0x5bd7b3c2cd3a3af,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x2fbb0b0444724720abf5b61a,
                    limb1: 0x953a5806409ed2ac3ac6e13a,
                    limb2: 0x6c61b3dd9a2a4c88,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x13fd1ba33eb1a7f57e872072,
                    limb1: 0x413d7f76e4e5b29b77f0b29d,
                    limb2: 0x5bd7b3c2cd3a3af,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x2fbb0b0444724720abf5b61a,
                    limb1: 0x953a5806409ed2ac3ac6e13a,
                    limb2: 0x6c61b3dd9a2a4c88,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x13fd1ba33eb1a7f57e872072,
                    limb1: 0x413d7f76e4e5b29b77f0b29d,
                    limb2: 0x5bd7b3c2cd3a3af,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xe32866d30d6a78b07eda9ab9bec60ffe, high: 0x5afb9565068a3c383739076a9f032cdc
            },
            u256 {
                low: 0xfe2d9d1de377b008641659c078b61daf, high: 0xfa999f9b86de3365d8a230de02969326
            },
            u256 {
                low: 0x14d4dad6ddfae808afd8643211035083, high: 0xecb3d561bdf0b015f305ee95afb120f4
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x44843976f0dc6af346e5a455,
                limb1: 0x75b360aa5611a56a04d58bb3,
                limb2: 0xc6fd3c60f8968bd2,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xae7f3e0a0559d80ebe6753b3,
                limb1: 0x6046ab5f37bd673710e91348,
                limb2: 0x778db3d8761c85ec,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xff1c275d4dfdd21295382bff,
                limb1: 0xb90aa5ad9146ad73c2b796b2,
                limb2: 0xa4f33366b244dba9,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x20c7ed0f86c88537422dd7a0,
                limb1: 0xd61d4e6637da8d0894e67346,
                limb2: 0x73d8a0f314f86e18,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0xa1fedf9e40d0c8dca7f6beee,
                limb1: 0xe3e718070fbb96a497476d41,
                limb2: 0x7858189db2ac69f7,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x4ba93f3456bd795282cf3041,
                limb1: 0xa93a22547482a0ee7862bfff,
                limb2: 0xe42faaef910ec5f8,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x5b23d38d9d709e3bd598d988,
                    limb1: 0xf6257b981a5d6e4da34a76d9,
                    limb2: 0xde6c54d9903b096,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5252326933644e61e1a4f851,
                    limb1: 0x7ffffffffffffffefcefcc88,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x284f84d6b21376113bbd4a0d,
                    limb1: 0x9dedf34d40ac9d727981af6,
                    limb2: 0x1800f1c66c8ab181,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8bc0bb84cab14dec0d24a58f,
                    limb1: 0xf512474f694f87e9c0639314,
                    limb2: 0xcca10fbf6d3f27a6,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x78925a70cc38184153552af1,
                    limb1: 0x99c190979a68bfe3b8a32376,
                    limb2: 0xfe8d83c25b034a1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x97a381639f85f2c890c75a2b,
                    limb1: 0xde5129e6972a1e836145957a,
                    limb2: 0x3d9b202cfdf0b270,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1a0b64351ed8a5e6d974b43d,
                    limb1: 0xc04c7014c4c3ae1a8d89bf5c,
                    limb2: 0xd4e6bac2d9cce75b,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x9085b2fca0b4f4f2523350a9,
                    limb1: 0x5b1191d1bc1ae13dece2627b,
                    limb2: 0xac6ef2cb3b6c8964,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf109407f4d96cc5385e1129,
                    limb1: 0x34991c687921345224a32cd9,
                    limb2: 0x40651098d443815f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x29117e67dbba527a00646f9b,
                    limb1: 0xd4b4e7673aa9eeff23f24d76,
                    limb2: 0xf4e30697627d1cf5,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x284f84d6b21376113bbd4a0a,
                    limb1: 0x9dedf34d40ac9d727981af6,
                    limb2: 0x1800f1c66c8ab181,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8bc0bb84cab14dec0d24a58f,
                    limb1: 0xf512474f694f87e9c0639314,
                    limb2: 0xcca10fbf6d3f27a6,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x168e4b94e22448d64a3d8525,
                    limb1: 0x2896bf4a51c75f5badda554,
                    limb2: 0xd352c6a988d5384c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe2f3569d0a6d9a1bc766047e,
                    limb1: 0x7fffffffffffffff42c04d61,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x2f6fbec8901d7d54e727a86d,
                    limb1: 0xb7044ece5d4d3cb2043a0c32,
                    limb2: 0x266b81f7d73bb823,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd128cd9e6d8fe6ccbed21de5,
                    limb1: 0xb1bb024c2e1a7fe002818814,
                    limb2: 0xeeab18b9b390d7cf,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x135154e9ff08cbe81c0f1105,
                    limb1: 0x45fdb3d7ea0e32f2dd292561,
                    limb2: 0x8cfaeee522f5fc75,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x43c4a644c77eaba368a1dd4d,
                    limb1: 0xa16cc048e3ba59cc899f5b38,
                    limb2: 0x3f9a2d2fbd9def3f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6dc700b63f063e40168aa515,
                    limb1: 0xf2e1252cf3bf82d7d83a587e,
                    limb2: 0xc64e4e6ccc9fee75,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xaef740a2ea001727ad2eb345,
                    limb1: 0x9e3b9dbf8baa686916e25e32,
                    limb2: 0xdc87404dcd60b144,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x76af1522bc996d9fcf6a5b7e,
                    limb1: 0x629902ed28e3c272cb9ccf09,
                    limb2: 0x4b8adc037855b3d3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x58d9481af31e87d7eb5c0699,
                    limb1: 0x9ebab670ec49071c5d986e75,
                    limb2: 0x8ec4eba88f880c7b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2f6fbec8901d7d54e727a86a,
                    limb1: 0xb7044ece5d4d3cb2043a0c32,
                    limb2: 0x266b81f7d73bb823,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd128cd9e6d8fe6ccbed21de5,
                    limb1: 0xb1bb024c2e1a7fe002818814,
                    limb2: 0xeeab18b9b390d7cf,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x383d26d8b72e66b55eb3a038,
                    limb1: 0xcde30f76944a24d2844a232a,
                    limb2: 0x183f43c70aefd940,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5784a91a5e09d24e7c4a2665,
                    limb1: 0x7fffffffffffffff7c074594,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xf19c4808e105f7f26058b97b,
                    limb1: 0x98f1998a11fe87f869683848,
                    limb2: 0xfeed4ce3b3e90489,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5ee4f90471316510c2d11511,
                    limb1: 0x630e424b5efdbbe7a600fc0d,
                    limb2: 0xe2b4b3f99b0eba60,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x97272c4fe9d6bd17f2c466cb,
                    limb1: 0x4ce000a785acde2092193b7c,
                    limb2: 0xa2ea15527ccd9d1b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa51d831346865f5b33f97f63,
                    limb1: 0xa10f40f85965b8c53ebf512b,
                    limb2: 0x9f3f4f9a1dc8b6a5,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb4ea927af3c4aeb8ca96feb9,
                    limb1: 0xde1c7fb9dde07fe176038f73,
                    limb2: 0x6e6f6f6bddd72b90,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x8eb8b29ba117d4a039c4291d,
                    limb1: 0x232924498f84f647b0c35a6e,
                    limb2: 0x16232a1c9bb8c1d8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa80b7bec2b25c8a2603a151c,
                    limb1: 0xe5dff53d889a56b7b6776d91,
                    limb2: 0x851ae7c8838e8a51,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xafa4c5e8e83a0d0bdf5f2115,
                    limb1: 0x8ac0f673599f5305731a128b,
                    limb2: 0xb2a819e8d90e64c9,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf19c4808e105f7f26058b978,
                    limb1: 0x98f1998a11fe87f869683848,
                    limb2: 0xfeed4ce3b3e90489,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5ee4f90471316510c2d11511,
                    limb1: 0x630e424b5efdbbe7a600fc0d,
                    limb2: 0xe2b4b3f99b0eba60,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xba72d22676d9da66024efd2f,
            limb1: 0xc7d49bbc44f66a5cbe542c2e,
            limb2: 0xc8df5f95f5ceeae,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0x96b9750e4ff8fcb6b86fca5,
                limb1: 0x6127a6220941960d02f12f14,
                limb2: 0x46797ba578c66dbe,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            3
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x37c0c93e04828395c15d7209,
                    limb1: 0x415d5a32606f06ca4c692723,
                    limb2: 0x1c44057b23f69789,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf8c5979b99400ef809d33bec,
                    limb1: 0x707908c42240397d33f6c895,
                    limb2: 0xd33e07782b449cd5,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256R1_4_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x7e90651ea970e91846b52506,
                    limb1: 0xf4a437cbd265dc7cdfce5d9e,
                    limb2: 0xfd78fc343fe6bf57,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xe598ce52bef082e226b55abc,
                    limb1: 0xa8f6f85a5e4bd43248b0b729,
                    limb2: 0x96fc18189a6dd486,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x7e90651ea970e91846b52506,
                    limb1: 0xf4a437cbd265dc7cdfce5d9e,
                    limb2: 0xfd78fc343fe6bf57,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xe598ce52bef082e226b55abc,
                    limb1: 0xa8f6f85a5e4bd43248b0b729,
                    limb2: 0x96fc18189a6dd486,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x7e90651ea970e91846b52506,
                    limb1: 0xf4a437cbd265dc7cdfce5d9e,
                    limb2: 0xfd78fc343fe6bf57,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xe598ce52bef082e226b55abc,
                    limb1: 0xa8f6f85a5e4bd43248b0b729,
                    limb2: 0x96fc18189a6dd486,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x7e90651ea970e91846b52506,
                    limb1: 0xf4a437cbd265dc7cdfce5d9e,
                    limb2: 0xfd78fc343fe6bf57,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xe598ce52bef082e226b55abc,
                    limb1: 0xa8f6f85a5e4bd43248b0b729,
                    limb2: 0x96fc18189a6dd486,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xa3ef802edf8693ce453432cdffeb5d5f, high: 0xe695f8baba2338fe4ae302f3b31e9be8
            },
            u256 {
                low: 0x92a651d7c069c542240397213a082921, high: 0x6f1bdd071aff71ae30f2c48549b564fb
            },
            u256 {
                low: 0x62565a955487b5c3b7626f4975fd3537, high: 0xa5e3a7196bf52dfd54a8762b2b12c92c
            },
            u256 {
                low: 0x25e4979d6f6ddf79affe2554e5aef699, high: 0x25c29b6ab575bc6eeee84bcb7281b8a9
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x3e714f7b073c4ae600604141,
                limb1: 0xbe7c1b11eae7a84889c3b1,
                limb2: 0xbd5f405cf3d633bb,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x85d58d6a6d611a945d444a21,
                limb1: 0x86954415c02052f981096b43,
                limb2: 0x2fba134600e00f81,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xc0ab28302a920504c0cb6629,
                limb1: 0xa3001fcf65ba8e1c486f3a73,
                limb2: 0x63370ee867395e29,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xe7ed0efc2ec94349acb2e7d1,
                limb1: 0x38f17e38a42006411fec0267,
                limb2: 0x3a8402c5b09baed,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x1a1e6d83e5195f84ca54535b,
                limb1: 0xf9fb0e9194081243803b2a3b,
                limb2: 0xf1525ea74f3b0974,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xdad5350916a1474264d99ac,
                limb1: 0x4203973c450f443792824c94,
                limb2: 0xab549548ad5685b7,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x5cdc3aa3f66c813aa76e5e29,
                    limb1: 0x5734759d752211942bc65a0,
                    limb2: 0xf25185aa30913230,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3e18562b4e105ed098d421ca,
                    limb1: 0x80000000000000007ac9261b,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x9911848ecd3f360aa01e3acc,
                    limb1: 0x91df21d9a1bae46680e9fa77,
                    limb2: 0x2311db64be1dc565,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x42fe4b664f52cc01b8ea99b7,
                    limb1: 0xa9d4c191baf3bdad7a7deb2,
                    limb2: 0x4527c36ccc430cef,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xdb2e4244bcce0317599083a0,
                    limb1: 0xf359edbb5a2cf431c9e2a57a,
                    limb2: 0xfed93c18c0863d14,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe401a8810771fa857afd7e48,
                    limb1: 0x155086a470a5f4aab2943d4d,
                    limb2: 0xb76a2515ece76ac6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4308821e095dc132ed829afd,
                    limb1: 0xc891ccf38489014add1a57de,
                    limb2: 0xf4ef3bf6436c2d3d,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x70888636416535e82662fe84,
                    limb1: 0x1acdde61841cc730e9c5fe24,
                    limb2: 0x656e1ef92afd1c10,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc9f2127b5670bfc2c8d7ac01,
                    limb1: 0xd25415e671e03ba28a80b7a,
                    limb2: 0xfd2893206ce6c23e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x358cec34dd5d838fd129325,
                    limb1: 0x9413d90a238ad32bde256a9b,
                    limb2: 0x8b4eeb9145716d1b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9911848ecd3f360aa01e3ac9,
                    limb1: 0x91df21d9a1bae46680e9fa77,
                    limb2: 0x2311db64be1dc565,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x42fe4b664f52cc01b8ea99b7,
                    limb1: 0xa9d4c191baf3bdad7a7deb2,
                    limb2: 0x4527c36ccc430cef,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xe5a13de79df5c0c07209b3df,
                    limb1: 0xc3269a870dacb21d8e6f02c7,
                    limb2: 0x1b74c3304b9e7fcb,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5fb981e52f1f355fe9085e58,
                    limb1: 0x7fffffffffffffffe47786fe,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x2c45eeee88be0690dd38b574,
                    limb1: 0xe2327bcacc695915a64ed81c,
                    limb2: 0xd76813956f29d982,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc0c472b12bfd11e2f87f74cf,
                    limb1: 0x685ba864c7df9566d7c267ef,
                    limb2: 0x9f4ff4e158dfe280,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x8847887f1b30c74d1da9420e,
                    limb1: 0xe91fddf80238245754b89894,
                    limb2: 0x8978df88556674d7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x27670dff10be1d23828cbf71,
                    limb1: 0x90ffed6ac649da5c2bcc1027,
                    limb2: 0x577e5128ba834651,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xbe8df7d986fac07c4c2bd784,
                    limb1: 0x42c254d4d5d12ce1071c0e1b,
                    limb2: 0xfe4bfd9b8b36cfba,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x46314d3a3596d7123bf7aeb0,
                    limb1: 0xe9f4a10ae08a69014a67985c,
                    limb2: 0x6c51c073780ebbb2,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc2f09e7f1e478fab1ce67e7a,
                    limb1: 0x9d6c33d7b199e02e7856ad2b,
                    limb2: 0xe6a1ffc4be0086e8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8a0658e2b7d706953e5401dc,
                    limb1: 0x7ad8c4271ef9c687ddd5cee3,
                    limb2: 0x7cd657329f9aec68,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2c45eeee88be0690dd38b571,
                    limb1: 0xe2327bcacc695915a64ed81c,
                    limb2: 0xd76813956f29d982,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc0c472b12bfd11e2f87f74cf,
                    limb1: 0x685ba864c7df9566d7c267ef,
                    limb2: 0x9f4ff4e158dfe280,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x8075af70e11d7791b8122e4f,
                    limb1: 0xa2208de6359bc1fa44272b88,
                    limb2: 0x3dd6a262fa2d022c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5784a91a5e09d24e7c4a2665,
                    limb1: 0x7fffffffffffffff7c074594,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x921dd767567b3e852cd7d54d,
                    limb1: 0x27956934a4361221ffb96b21,
                    limb2: 0xd4410fe4646d08e8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x25366a4bf0549b7674e0467a,
                    limb1: 0x6304d19f063d5fa037559b53,
                    limb2: 0xab76926e498b9863,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xa374ae9c8c0f834c0befd37a,
                    limb1: 0xf604fe8e5f54dc604999e032,
                    limb2: 0x5d4b6d1cd34ce7f0,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2f254e32518450a2f6b4ba93,
                    limb1: 0x4296d92203d4f8514fbd90f3,
                    limb2: 0x5baeab6b860e0e1a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x20cdb2bb18d865a9464c883d,
                    limb1: 0x1bb0d3f02995de27b48b43e5,
                    limb2: 0xb5d44b8a900bca5,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xc449ba059c20d30fa7f0b836,
                    limb1: 0xfca09dd34da9d053e8d2e908,
                    limb2: 0x51c6da7357d94607,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc45ed539df4c0c61e3a9732d,
                    limb1: 0x9d75650811797af387a79e36,
                    limb2: 0x5e531d99776e6479,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5cb072126ad069dac9318cdb,
                    limb1: 0x8add487863e067dbbf1c34b9,
                    limb2: 0x58627e8bcd97cabf,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x921dd767567b3e852cd7d54a,
                    limb1: 0x27956934a4361221ffb96b21,
                    limb2: 0xd4410fe4646d08e8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x25366a4bf0549b7674e0467a,
                    limb1: 0x6304d19f063d5fa037559b53,
                    limb2: 0xab76926e498b9863,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xf81a801246e89693b8fb2c5b,
            limb1: 0x4e3ff9021669ad505cbdff8,
            limb2: 0x2844f7974e8bd993,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            3
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xf8b13734b07b28eec89d5e0b,
                    limb1: 0x84f1b4fb583f3f8fa2fd8491,
                    limb2: 0x41afd7e2b56dce4a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x442a0682b4282fc16bce0194,
                    limb1: 0x10766b9fec5f1a7a6c6bf760,
                    limb2: 0xecf46479fbc19dde,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256R1_5_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x43a76cf2022d4e20c88bc08e,
                    limb1: 0xd656f9b77e52d1a50656b964,
                    limb2: 0x6f61331491dc7d73,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xdf3b6f66acef86616ccb1fc2,
                    limb1: 0xaa5de9ac56524d12f81d1827,
                    limb2: 0x85a0aaafc9673d61,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x43a76cf2022d4e20c88bc08e,
                    limb1: 0xd656f9b77e52d1a50656b964,
                    limb2: 0x6f61331491dc7d73,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xdf3b6f66acef86616ccb1fc2,
                    limb1: 0xaa5de9ac56524d12f81d1827,
                    limb2: 0x85a0aaafc9673d61,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x43a76cf2022d4e20c88bc08e,
                    limb1: 0xd656f9b77e52d1a50656b964,
                    limb2: 0x6f61331491dc7d73,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xdf3b6f66acef86616ccb1fc2,
                    limb1: 0xaa5de9ac56524d12f81d1827,
                    limb2: 0x85a0aaafc9673d61,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x43a76cf2022d4e20c88bc08e,
                    limb1: 0xd656f9b77e52d1a50656b964,
                    limb2: 0x6f61331491dc7d73,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xdf3b6f66acef86616ccb1fc2,
                    limb1: 0xaa5de9ac56524d12f81d1827,
                    limb2: 0x85a0aaafc9673d61,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x43a76cf2022d4e20c88bc08e,
                    limb1: 0xd656f9b77e52d1a50656b964,
                    limb2: 0x6f61331491dc7d73,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xdf3b6f66acef86616ccb1fc2,
                    limb1: 0xaa5de9ac56524d12f81d1827,
                    limb2: 0x85a0aaafc9673d61,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x6d62e40c638d521afbc59e92ca1209ad, high: 0xbad3116b63b8a8977df0fe6bce8d75f2
            },
            u256 {
                low: 0x707421d43239d04bcbab5b51385c5fdc, high: 0xb5c25d429626d8c4344af454f0a61c5e
            },
            u256 {
                low: 0x884fd16636abf8ce7e3f52c0cbf404d, high: 0xdefa786415ac15c3a217cf253be95767
            },
            u256 {
                low: 0xbe3feafd0e96ed9b5d158e442fcf3b87, high: 0x3baa17f92c623ac3ad7027cfa358cb1d
            },
            u256 {
                low: 0x162d5c729ccd3e1f4c2abdaa9c5c11eb, high: 0xc061c99b831a352ade6c8762b475e15e
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xf1f7feb9559f2b9d269cc726,
                limb1: 0x82058ab446abe23fd5075771,
                limb2: 0x79df951d59e8def1,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x3c19e1670d4c7232648f66f1,
                limb1: 0xfafb2f6ca3a89219d5f3cedb,
                limb2: 0x55df5ab256854850,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xce97be0ed8aca94d86031881,
                limb1: 0x53500d22985616c48190327e,
                limb2: 0x9b02a04c970d840a,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xe71fa085b9d850e0c84a8013,
                limb1: 0x95a8030854bf453df6c72c1e,
                limb2: 0x65e5c84e1852577e,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x4398ff8bd433350dcd63f934,
                limb1: 0x4ce8f4982c79aa08a6135e3c,
                limb2: 0x70ab34d5c7b9761,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xa7022a03718bd6eeb59d90af,
                limb1: 0xd64a3a09cf7f2740075b332e,
                limb2: 0x70a0e9c769b903d1,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xd77af8b16e868579db3a2708,
                    limb1: 0xaa3a722728f50f40fc03e955,
                    limb2: 0x7e3687281ad42427,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x83c0ae7aef189dd200a6ed18,
                    limb1: 0x7fffffffffffffffe36f3017,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xddfa049efa130a0490e7e5f6,
                    limb1: 0x67359812d1fa3746e5b6356c,
                    limb2: 0x69d7b7c16e7d5b47,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xca609454a833864210d7784b,
                    limb1: 0xa7a37b943b014c1b24a1ef2a,
                    limb2: 0x16bf37cd143aa39b,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xafdcad139c6a256d8b9eded3,
                    limb1: 0x5c493e750b783b9190d5c06a,
                    limb2: 0xcf3db972c2fb88a6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xac86c84509524dff94cf006b,
                    limb1: 0x522007224c8decc3d07bff64,
                    limb2: 0x3e059be4b66b6106,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xaed7aad3abd3096228bae8a1,
                    limb1: 0xc2dfc6344d2ad24903648051,
                    limb2: 0x1748aa1316887ea4,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x3a0d3fadebc9bc7cc1870cf0,
                    limb1: 0x20ad050e1cd71c28b57fcc60,
                    limb2: 0xdb5a2c6320a2973e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x67514df4be4a086727cbb978,
                    limb1: 0x3fa0e255e15d44ad3688f69b,
                    limb2: 0x7dd494ba73433db1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6d31f3f84333a977f54bf76a,
                    limb1: 0xbd014a98c594a26af7373930,
                    limb2: 0x16888e716d8aa914,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xddfa049efa130a0490e7e5f3,
                    limb1: 0x67359812d1fa3746e5b6356c,
                    limb2: 0x69d7b7c16e7d5b47,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xca609454a833864210d7784b,
                    limb1: 0xa7a37b943b014c1b24a1ef2a,
                    limb2: 0x16bf37cd143aa39b,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xde71ae6655038a36850d6a23,
                    limb1: 0xa3aed79814685b0b888fbb06,
                    limb2: 0xfffd4a56c1d26e48,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xcf0a1d7cb4de5c8407954483,
                    limb1: 0x7ffffffffffffffe38898b84,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xd089f7abe0c060b98b411fa7,
                    limb1: 0xc0d48757d32eb9e694fc5067,
                    limb2: 0x448128c7529fc0ec,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xedc0d4ff25260891b17126ef,
                    limb1: 0xd658f925e95717967819141e,
                    limb2: 0xf59c2c9cd715fe83,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xd6e9ab90a585d7b553848b30,
                    limb1: 0xaa32e72c2ea10abb9be5bc2,
                    limb2: 0x7cfa663169249466,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4583258143cc065259a5b03b,
                    limb1: 0xb89ba7bcb917269a3681893c,
                    limb2: 0xe6d4aa2696c66980,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1f17e813748fb894a51d40ea,
                    limb1: 0xb3328fe0bfce59b79838f060,
                    limb2: 0x651b196c8dbc37fa,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xf60a5a4be7f8d78c95e9883,
                    limb1: 0xae30173de5badf59bdc6a33e,
                    limb2: 0x184cd339dd8afaf1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x96aaba916d29ba41ff90ae7a,
                    limb1: 0x92b9e376b3cf1026207236bd,
                    limb2: 0x845d0142414588a3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x31131f8cc5c2289137eeb7b,
                    limb1: 0x30e0d1e3ba933ff8fcd1ca57,
                    limb2: 0x79f1afff24f8985f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd089f7abe0c060b98b411fa4,
                    limb1: 0xc0d48757d32eb9e694fc5067,
                    limb2: 0x448128c7529fc0ec,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xedc0d4ff25260891b17126ef,
                    limb1: 0xd658f925e95717967819141e,
                    limb2: 0xf59c2c9cd715fe83,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x8c806ca23a30f5e9f3e930c8,
                    limb1: 0xa5cca58255fae89080c35cfc,
                    limb2: 0x4058df64cbb1211e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5784a91a5e09d24e7c4a2665,
                    limb1: 0x7fffffffffffffff7c074594,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x8a4e5b23b54af984684965fc,
                    limb1: 0xd3415bc73040f8e03cd50eac,
                    limb2: 0x2848e81fd7855a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xedcf4265532021a4ac98ee4a,
                    limb1: 0x5fc6fe453b303f32d85c6f45,
                    limb2: 0x5df2ac650c76e495,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x76fbe370bdcaa45550bf112a,
                    limb1: 0xd40de248ee43c4b813c55893,
                    limb2: 0x93b765359ca72d6c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xce8c2e40f490adf916e442d7,
                    limb1: 0x7eed32f6ed07bfd2b02e67b7,
                    limb2: 0x94a98602692faeb,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x868d971ee831b58b966584f3,
                    limb1: 0xa9a67f474ef8f24e837504c3,
                    limb2: 0xc0a8090420bf60b1,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xeb75fb47ded65b73009b3fc3,
                    limb1: 0x17d6bdbe981e5ad7526bc3d8,
                    limb2: 0x87f695170b607da0,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x194d4b093fa7a24ec9668468,
                    limb1: 0x2e55ab6f7d876100da5415bc,
                    limb2: 0x50c8215cee544717,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2e5e9c6426dd7502207956c,
                    limb1: 0x9496c285c507c923dc07b8e0,
                    limb2: 0x40ee30a884d5e628,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8a4e5b23b54af984684965f9,
                    limb1: 0xd3415bc73040f8e03cd50eac,
                    limb2: 0x2848e81fd7855a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xedcf4265532021a4ac98ee4a,
                    limb1: 0x5fc6fe453b303f32d85c6f45,
                    limb2: 0x5df2ac650c76e495,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x964ac669f96e0b52e2a15217,
            limb1: 0x9ff01fdc233febf8d9b85b21,
            limb2: 0x4b35305597181c0f,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            3
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xdc2374764766aaa5f9d3715d,
                    limb1: 0xc8670d797138c42555d9fb65,
                    limb2: 0x33e39330879154d2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x9cde6298f5857bc7d59cd146,
                    limb1: 0x5051874efc30713877e00fee,
                    limb2: 0xa116d9c9296cef10,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256R1_6_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xf8446348ba9262253c5072b,
                    limb1: 0xb0a56a7065ea13eba7f9eb2b,
                    limb2: 0x52c683ea17506235,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x1cad3e72524ecb1386c2f725,
                    limb1: 0x412b0c0dd2f9af973b788bdc,
                    limb2: 0x3a1cb223c9566325,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xf8446348ba9262253c5072b,
                    limb1: 0xb0a56a7065ea13eba7f9eb2b,
                    limb2: 0x52c683ea17506235,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x1cad3e72524ecb1386c2f725,
                    limb1: 0x412b0c0dd2f9af973b788bdc,
                    limb2: 0x3a1cb223c9566325,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xf8446348ba9262253c5072b,
                    limb1: 0xb0a56a7065ea13eba7f9eb2b,
                    limb2: 0x52c683ea17506235,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x1cad3e72524ecb1386c2f725,
                    limb1: 0x412b0c0dd2f9af973b788bdc,
                    limb2: 0x3a1cb223c9566325,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xf8446348ba9262253c5072b,
                    limb1: 0xb0a56a7065ea13eba7f9eb2b,
                    limb2: 0x52c683ea17506235,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x1cad3e72524ecb1386c2f725,
                    limb1: 0x412b0c0dd2f9af973b788bdc,
                    limb2: 0x3a1cb223c9566325,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xf8446348ba9262253c5072b,
                    limb1: 0xb0a56a7065ea13eba7f9eb2b,
                    limb2: 0x52c683ea17506235,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x1cad3e72524ecb1386c2f725,
                    limb1: 0x412b0c0dd2f9af973b788bdc,
                    limb2: 0x3a1cb223c9566325,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xf8446348ba9262253c5072b,
                    limb1: 0xb0a56a7065ea13eba7f9eb2b,
                    limb2: 0x52c683ea17506235,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x1cad3e72524ecb1386c2f725,
                    limb1: 0x412b0c0dd2f9af973b788bdc,
                    limb2: 0x3a1cb223c9566325,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xaa66b4648420b8d9b261d0d2a1c2d9bf, high: 0x8c141838f46860a2a604e5aff4db1c1e
            },
            u256 {
                low: 0x6e3c18c9ef1fa0a3bc02ba67ee04bdde, high: 0x413770e27d7de1f57460d20d94b9cdb5
            },
            u256 {
                low: 0x56525ce03725bd0c79c45c38b440ffe0, high: 0xd7422560b36f3cd0acfeba4441030ae
            },
            u256 {
                low: 0x4a30f7cd00fdec23598ca3b429b10823, high: 0x104dff6623f1b67e01d34690a795ac54
            },
            u256 {
                low: 0x38dfe76bae3582906d80ab08c963d148, high: 0x8ec9ea986581f9349bcfb1c4f87e3560
            },
            u256 {
                low: 0x315e80807425f4e93891aef5ebe0572c, high: 0x9b3a0c891a32e1489bbac83856e9b78d
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xf7ea98bea0ae73bf19b2fda9,
                limb1: 0x3e142cd3e9931c0c6733f2d1,
                limb2: 0xe19a294aceea8497,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xc20c02a752312abb3b35e6bc,
                limb1: 0x6ea35a1065dbf28ae2404f1,
                limb2: 0xa46c0115332c875d,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xa38482e16fc6dbbc22dd5cac,
                limb1: 0x305130bc691315e9f9d645c5,
                limb2: 0x13e1003cefab65e1,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x957dc413f04e368d946ac525,
                limb1: 0x66aa581fe9a089c3c8f4ea65,
                limb2: 0x20fc11504443f9d7,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x8201680f28ae5d912f1d3eb4,
                limb1: 0xcffd16f9a1140c6050b467d7,
                limb2: 0x746d0ba78c0d4d76,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x7e09ea2d9f63ff5c451be760,
                limb1: 0x4117114c1ffd8828137aa3cb,
                limb2: 0x917b1135c4eb4112,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x3b4bedadc44b50e4bfaba6ac,
                    limb1: 0xc6a9de735bd37092986c3922,
                    limb2: 0x443d4ec40781018c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6c764dc15e3f0b2c0d35acd0,
                    limb1: 0x800000000000000028e6c776,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xfe672a9809feff513305c1e5,
                    limb1: 0x69335d61beff2e61ed66432d,
                    limb2: 0xe9a663bdd48ac783,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf891210cd3a8661e9287fb2a,
                    limb1: 0x114668bbb082d007f0d22204,
                    limb2: 0xcb9f52c919c51935,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x1467606ec140cd163747d155,
                    limb1: 0x1d9aa240585b98cc2cbf24be,
                    limb2: 0x9f2831e059fffdff,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfc2262f965e0d603e249e51f,
                    limb1: 0xd0d9495f788c0619aa54becb,
                    limb2: 0x26a707205e0441ef,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfafa57b466aef66e834368a6,
                    limb1: 0xd2849af09453ee93389a7439,
                    limb2: 0x2f386592c909c52a,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x1c42bcfe7b4f8f0803c26375,
                    limb1: 0xe45663877238774457c6553a,
                    limb2: 0xc9bbfd0e09c6b596,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1a21ffd461d474f2de4c45fe,
                    limb1: 0xd49ff3d1e3d9a7295fe5ef11,
                    limb2: 0x74345418c37694ea,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe2a04dcfc0d509e2703a6eca,
                    limb1: 0x80188322651016a492a6a0a4,
                    limb2: 0xf7e83d7a5ceb484b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfe672a9809feff513305c1e2,
                    limb1: 0x69335d61beff2e61ed66432d,
                    limb2: 0xe9a663bdd48ac783,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf891210cd3a8661e9287fb2a,
                    limb1: 0x114668bbb082d007f0d22204,
                    limb2: 0xcb9f52c919c51935,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xd336f82edb589d82d389a22,
                    limb1: 0xd3c669433f97bf6df81ac0c8,
                    limb2: 0xafbc3fa65d9693c2,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xaf78321a382e720f6a8f0bfe,
                    limb1: 0x8000000000000000aab183dd,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x55e8479144e052c76f2a55ee,
                    limb1: 0x1bf93383cc1ad53f9ca9bf0a,
                    limb2: 0xf2918ee8c905a19,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4cf736ea048ffe21895d9c28,
                    limb1: 0x1f0964d33102d62a5e2fcf10,
                    limb2: 0x99587bd7f90437ea,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x94c723185733e491f134a0da,
                    limb1: 0xe58e1c9f1127497b710f46e7,
                    limb2: 0x1734ca7fdd4f4790,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4b964791655c614cedc5f56d,
                    limb1: 0xc0bd1d01f625a2bc597354c2,
                    limb2: 0x321561ae2dc5eed7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb4abcd86beba0658ee943942,
                    limb1: 0x5b67f5f29218275e4dda4409,
                    limb2: 0x38c01c88e1fe58bc,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xd480050c538cef4fa6f5344f,
                    limb1: 0x450e8da073e9c4c7370e41d0,
                    limb2: 0x207a92adcbf6f60b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe9c7583e7a466aa51e57ac0b,
                    limb1: 0x1120ea4c474f1f7e4bcc2b34,
                    limb2: 0xc49fb3dad91d02c3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe56e0c382e1e41d98bb98bd1,
                    limb1: 0x56cf8edbe390043d4a8d9981,
                    limb2: 0x8ebcc24ebf2dec2b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x55e8479144e052c76f2a55eb,
                    limb1: 0x1bf93383cc1ad53f9ca9bf0a,
                    limb2: 0xf2918ee8c905a19,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4cf736ea048ffe21895d9c28,
                    limb1: 0x1f0964d33102d62a5e2fcf10,
                    limb2: 0x99587bd7f90437ea,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x509235af37c1726286409431,
                    limb1: 0x54c3e55138b11b7024e68766,
                    limb2: 0xfee59f349c77230,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5784a91a5e09d24e7c4a2665,
                    limb1: 0x7fffffffffffffff7c074594,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x826dc83705ae10bc487cd911,
                    limb1: 0xec0e2795467fab3fc7f1e081,
                    limb2: 0x1c537af836aba40a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xda7a150f678ac6b2ae05649f,
                    limb1: 0xffb1b849f5d8ddb5b5755263,
                    limb2: 0x77b1f41a84474ca8,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xe9a7498e479e0c8fffb05b73,
                    limb1: 0xf0062560c7572371c4b538bf,
                    limb2: 0x5d472ff5e1b951c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7adf1d4f6df5e378736c1dc0,
                    limb1: 0xa8173563a1cc55eb857a0c1,
                    limb2: 0x40c8bf2b6d8d7e8c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x20a33f777aa611e4a165bcd2,
                    limb1: 0xf92abd45f5fc8eead69591f8,
                    limb2: 0x5eed172bce41a51c,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x9599338345c521ceb80ee153,
                    limb1: 0xc049d18f7f8298545d848f04,
                    limb2: 0x62d3f0928e4d7618,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xffd5da84ba115b4bb8244553,
                    limb1: 0xa25c7d6cff4277c4c343be6b,
                    limb2: 0xfad146cb9784d421,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3ce571c8052de8261dc2326c,
                    limb1: 0xb4d69477950ded9b44bd0f87,
                    limb2: 0xf3b059871d64adee,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x826dc83705ae10bc487cd90e,
                    limb1: 0xec0e2795467fab3fc7f1e081,
                    limb2: 0x1c537af836aba40a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xda7a150f678ac6b2ae05649f,
                    limb1: 0xffb1b849f5d8ddb5b5755263,
                    limb2: 0x77b1f41a84474ca8,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x321ae6aca219a1bfc4773f72,
            limb1: 0x3d189ce157f8b0f9b30cd8fc,
            limb2: 0xaba24d5fab8ae12,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0x1f6957f96dbd00e0d59c504,
                limb1: 0x1737b532b01742cc35e2725e,
                limb2: 0x76dac5bc181caba3,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            3
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xbef3dcd84656ebc86e94a0b,
                    limb1: 0xec518959e12b70569a8c4494,
                    limb2: 0x6b7cb7da87ee8468,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc4efdca45ccf8daecce9eeaf,
                    limb1: 0x86618ac4e0454fa7f54fc8cc,
                    limb2: 0xb4899757979d9729,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256R1_7_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xd21d033c5e982bf5163f984c,
                    limb1: 0xee252986afa9ddf1f1509b2f,
                    limb2: 0xfd33d706c1d0cf38,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x1e30b6ec448761ea8c5af7f2,
                    limb1: 0xe6a397894d5163ca6e5f1b00,
                    limb2: 0xff589f6f5f458d00,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xd21d033c5e982bf5163f984c,
                    limb1: 0xee252986afa9ddf1f1509b2f,
                    limb2: 0xfd33d706c1d0cf38,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x1e30b6ec448761ea8c5af7f2,
                    limb1: 0xe6a397894d5163ca6e5f1b00,
                    limb2: 0xff589f6f5f458d00,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xd21d033c5e982bf5163f984c,
                    limb1: 0xee252986afa9ddf1f1509b2f,
                    limb2: 0xfd33d706c1d0cf38,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x1e30b6ec448761ea8c5af7f2,
                    limb1: 0xe6a397894d5163ca6e5f1b00,
                    limb2: 0xff589f6f5f458d00,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xd21d033c5e982bf5163f984c,
                    limb1: 0xee252986afa9ddf1f1509b2f,
                    limb2: 0xfd33d706c1d0cf38,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x1e30b6ec448761ea8c5af7f2,
                    limb1: 0xe6a397894d5163ca6e5f1b00,
                    limb2: 0xff589f6f5f458d00,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xd21d033c5e982bf5163f984c,
                    limb1: 0xee252986afa9ddf1f1509b2f,
                    limb2: 0xfd33d706c1d0cf38,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x1e30b6ec448761ea8c5af7f2,
                    limb1: 0xe6a397894d5163ca6e5f1b00,
                    limb2: 0xff589f6f5f458d00,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xd21d033c5e982bf5163f984c,
                    limb1: 0xee252986afa9ddf1f1509b2f,
                    limb2: 0xfd33d706c1d0cf38,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x1e30b6ec448761ea8c5af7f2,
                    limb1: 0xe6a397894d5163ca6e5f1b00,
                    limb2: 0xff589f6f5f458d00,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xd21d033c5e982bf5163f984c,
                    limb1: 0xee252986afa9ddf1f1509b2f,
                    limb2: 0xfd33d706c1d0cf38,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x1e30b6ec448761ea8c5af7f2,
                    limb1: 0xe6a397894d5163ca6e5f1b00,
                    limb2: 0xff589f6f5f458d00,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x85a1282a0761585b4168705a533c9a31, high: 0x14827a895e6364c630ac79dd0b5aafef
            },
            u256 {
                low: 0x5882e3bb864696c1deb4e6c435a7c6ed, high: 0x4053b188339d78f5d658b1b33012ae1c
            },
            u256 {
                low: 0x4d236555bc5074acbaa172acac33f644, high: 0x6279d944dc2897c6845398134fee7144
            },
            u256 {
                low: 0xdf39ccaa580c79fc7b69e69041300879, high: 0x4e49df560b648acd3d6e2667b6651d6e
            },
            u256 {
                low: 0x25b7c5f1284b9d78d4e2753ef26a5b7, high: 0x702dc88ab97fb3bb7ecc040c75ff93f0
            },
            u256 {
                low: 0x6980b561cf1accc1eaca38110c26e5d9, high: 0x70aaf52575e417dd7e5b637dfa98c115
            },
            u256 {
                low: 0x3dbba3af14dbad2215eae9d21e3d59d0, high: 0x275f275cc3f3f74dd3861b58194665d3
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xd579c2218778b5aa00a57947,
                limb1: 0xf12203079b762e9bb318480e,
                limb2: 0xc58c4486e813a59f,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x268ad1d7d25c8344c41331ae,
                limb1: 0x2f8cd91cb150e0f34bd05760,
                limb2: 0xbae196e5f69f027c,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x53c422cfaed29fd13b0504dd,
                limb1: 0x81245172ab7a0d99992e33eb,
                limb2: 0x8325b4cb48383ccb,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x2761481907ec36e12815a227,
                limb1: 0x9315d6c26d484d0659a20c61,
                limb2: 0xac6c6f9e44cb512c,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x665e563926d635764388b052,
                limb1: 0xf1b433335a9b6340ffa8b932,
                limb2: 0xcb2cfd943220c2d5,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xf2ea4ab8d825dd1f4c6081ca,
                limb1: 0x29580dc457e25b52885e01d1,
                limb2: 0x53d72bff1edfa1c5,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xafc07425a59d1673194c3845,
                    limb1: 0x4e9373e781ab4df57e640ab3,
                    limb2: 0x214dad2159b4adce,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe00c1ab502b495cf7dd5f9e6, limb1: 0x6a1b10cc, limb2: 0x0, limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x15ed3d98c107a3920a28750a,
                    limb1: 0xe795b61072e04f33a482a745,
                    limb2: 0x2e4efe94bb25739e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x58693aa219ef1e60e91aee6b,
                    limb1: 0x20b8d371b4dff3725b971cc3,
                    limb2: 0x3d3fe470561b8b29,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xce31fec789cf2e3075b855cf,
                    limb1: 0xb7798b3a433e749145911ebe,
                    limb2: 0x60c53103660b7fd8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7232144320dd53e6e282819b,
                    limb1: 0x323d4917dbc444eb89620ff5,
                    limb2: 0x875c34d202bbfb22,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2ac6672ebd81ae33ebbc06c1,
                    limb1: 0xc9d701410cc0dfd6f788931,
                    limb2: 0x1329a8c9a7920ebc,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xa4efdb46eaa28dbb74ac0fd1,
                    limb1: 0x116213ffc0a62d93f10af266,
                    limb2: 0x6543f8d639625e26,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x48293abcd9c4a0a7cd3bf721,
                    limb1: 0x15aeca82d7a43b4894cee64e,
                    limb2: 0xecca9170c150acbd,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc318010fee00e11b6c819509,
                    limb1: 0x51c1430057f8ac655257b067,
                    limb2: 0xa3068886a7e7f26d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x15ed3d98c107a3920a287507,
                    limb1: 0xe795b61072e04f33a482a745,
                    limb2: 0x2e4efe94bb25739e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x58693aa219ef1e60e91aee6b,
                    limb1: 0x20b8d371b4dff3725b971cc3,
                    limb2: 0x3d3fe470561b8b29,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x552a15c2b299258b6391986,
                    limb1: 0x9517efb5358ddd2ea79d199a,
                    limb2: 0xf3eb43b3781bfb11,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x46fc66a73698461f63e681bd, limb1: 0xd8677403, limb2: 0x0, limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x6052c67de82bb7b7df07bd52,
                    limb1: 0x15db88e3faae63740c00d2d3,
                    limb2: 0x3d93435ab382ce6b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xda1ed9f3f2953439aebb62d5,
                    limb1: 0x90b68506a4dc1474758130e6,
                    limb2: 0x7fa6742bf5f6f3fd,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x1722763d5308319c8b544558,
                    limb1: 0x427b4f17c2c3e82db6cdcfb6,
                    limb2: 0xe2235b20c7dd6ad0,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5dc01924b4d29a23e12b9252,
                    limb1: 0x6b63d778f4ed5a58cc4b7c20,
                    limb2: 0xcb0c1cdca934bada,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x62a656b807d3e7e4aacee584,
                    limb1: 0x16c06b573838c12804fd54d7,
                    limb2: 0x58ff51e01124815a,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xe61c5a8c2e956b50a7f6f6f9,
                    limb1: 0x11df9fe2bc9f3bd962584439,
                    limb2: 0xbb2cf50651500bc,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x662fd8aa1ccaec86867e8df8,
                    limb1: 0xf33134d6d554d887380eb2f9,
                    limb2: 0x21edb5960f36f245,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3df7231a640e9f911ba037ca,
                    limb1: 0x1c82e418804495f049973fe,
                    limb2: 0xdbd2d952c855b7f1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6052c67de82bb7b7df07bd4f,
                    limb1: 0x15db88e3faae63740c00d2d3,
                    limb2: 0x3d93435ab382ce6b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xda1ed9f3f2953439aebb62d5,
                    limb1: 0x90b68506a4dc1474758130e6,
                    limb2: 0x7fa6742bf5f6f3fd,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x886edd0ad6f9b84b3814f9a8,
                    limb1: 0xd7781de62899c74f4ccca11d,
                    limb2: 0x86b9360b6114e33d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5784a91a5e09d24e7c4a2665,
                    limb1: 0x7fffffffffffffff7c074594,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xdf358663856af445efec4dd2,
                    limb1: 0x51ba2bc4f30bd6b95c03e2ef,
                    limb2: 0x4f4128fe8412a8e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x45dd86f72a572ab881724acf,
                    limb1: 0x8d277b59f9ea8f25672912e4,
                    limb2: 0xb1ad4d9e85a70060,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x2541bbb0a87ae75074eabf4,
                    limb1: 0x9a9eaab7496e065c3495a897,
                    limb2: 0xe151fbf2f868327f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfe1a3aa3e27ed43c833cf602,
                    limb1: 0xfe4f45bbf20969537b022563,
                    limb2: 0x8ae883277f4e0f18,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x58ab431d3080d2cfe43be056,
                    limb1: 0x70dfb02666dba38a8ee551a5,
                    limb2: 0xeb2ebbdae01f3a3b,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xe004ea63504ab7c15fad4892,
                    limb1: 0x92d005ea23254efd37f0ceb0,
                    limb2: 0xabf54321e315d978,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa433ca609e0455039ada1b9c,
                    limb1: 0xec59eab08421536d15d3695e,
                    limb2: 0xf9f314954b1ef833,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfabb1c10bcc8bc14a37b7fdc,
                    limb1: 0xc754b4788d8d94c2fa1ce05,
                    limb2: 0x45be4cfb194592c8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xdf358663856af445efec4dcf,
                    limb1: 0x51ba2bc4f30bd6b95c03e2ef,
                    limb2: 0x4f4128fe8412a8e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x45dd86f72a572ab881724acf,
                    limb1: 0x8d277b59f9ea8f25672912e4,
                    limb2: 0xb1ad4d9e85a70060,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x71e484a7c6f832b6fae92c38,
            limb1: 0x3411dc4e9cee3cc84475b1f4,
            limb2: 0x6174319b8adfb615,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            3
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x767fc8c62c33601fb56b12b8,
                    limb1: 0xd24255edeab9702f0c32ce3f,
                    limb2: 0x16e9f484902ad032,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd2d076432203b90458ce00cc,
                    limb1: 0x24174382cd01bfa961d7821e,
                    limb2: 0x5a691d3dc492c67d,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256R1_8_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xff9ebc9816228c1e5e96bedc,
                    limb1: 0x99251f521b916a4e59855848,
                    limb2: 0x4f6df8880a09ea68,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xe43c7743c5064e926c679eca,
                    limb1: 0xaf4d73e05d035d4415284af8,
                    limb2: 0xfe91883fd2ea0b4e,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xff9ebc9816228c1e5e96bedc,
                    limb1: 0x99251f521b916a4e59855848,
                    limb2: 0x4f6df8880a09ea68,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xe43c7743c5064e926c679eca,
                    limb1: 0xaf4d73e05d035d4415284af8,
                    limb2: 0xfe91883fd2ea0b4e,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xff9ebc9816228c1e5e96bedc,
                    limb1: 0x99251f521b916a4e59855848,
                    limb2: 0x4f6df8880a09ea68,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xe43c7743c5064e926c679eca,
                    limb1: 0xaf4d73e05d035d4415284af8,
                    limb2: 0xfe91883fd2ea0b4e,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xff9ebc9816228c1e5e96bedc,
                    limb1: 0x99251f521b916a4e59855848,
                    limb2: 0x4f6df8880a09ea68,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xe43c7743c5064e926c679eca,
                    limb1: 0xaf4d73e05d035d4415284af8,
                    limb2: 0xfe91883fd2ea0b4e,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xff9ebc9816228c1e5e96bedc,
                    limb1: 0x99251f521b916a4e59855848,
                    limb2: 0x4f6df8880a09ea68,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xe43c7743c5064e926c679eca,
                    limb1: 0xaf4d73e05d035d4415284af8,
                    limb2: 0xfe91883fd2ea0b4e,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xff9ebc9816228c1e5e96bedc,
                    limb1: 0x99251f521b916a4e59855848,
                    limb2: 0x4f6df8880a09ea68,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xe43c7743c5064e926c679eca,
                    limb1: 0xaf4d73e05d035d4415284af8,
                    limb2: 0xfe91883fd2ea0b4e,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xff9ebc9816228c1e5e96bedc,
                    limb1: 0x99251f521b916a4e59855848,
                    limb2: 0x4f6df8880a09ea68,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xe43c7743c5064e926c679eca,
                    limb1: 0xaf4d73e05d035d4415284af8,
                    limb2: 0xfe91883fd2ea0b4e,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xff9ebc9816228c1e5e96bedc,
                    limb1: 0x99251f521b916a4e59855848,
                    limb2: 0x4f6df8880a09ea68,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xe43c7743c5064e926c679eca,
                    limb1: 0xaf4d73e05d035d4415284af8,
                    limb2: 0xfe91883fd2ea0b4e,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xe2f88051c13c66888f1b5be16d4ba69c, high: 0xf57b8a920a12f3b364fc0dbad44f85e7
            },
            u256 {
                low: 0x38553ac87d7185913fee2fc72e2dffdf, high: 0x476c4878deffed7ad728525620ca35ab
            },
            u256 {
                low: 0xfea2a33a51d11bcd5a23754bef38d426, high: 0xe64ddd918e9b185e1b770deb6f51ea78
            },
            u256 {
                low: 0xc9fe60368a83efc89c2e55624916e844, high: 0xc707e77b4bf0ae53b6088c973380dcfc
            },
            u256 {
                low: 0x764ab5109acba5888397d4127118bb71, high: 0x45c596d442d01ba3a2652c9e89421c6d
            },
            u256 {
                low: 0x9d683a9e1e651ac1043d2c473b56735e, high: 0x2c2df3c219518f87b63f83c6c89309e9
            },
            u256 {
                low: 0x37d316a43fafa2176a27241fbb9e5a02, high: 0xff4533febc6ff6ace139d15d48d8b9ef
            },
            u256 {
                low: 0x89181ba3bdee923101a6009ea8dce886, high: 0xcbdc014dbedb42e6da313e783e9973b
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x27186af2a49d6cec686ed642,
                limb1: 0x4c29626a12b0cf41142c7f1,
                limb2: 0x830625af4fa9dbf1,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xd492b86abb42f971e47f3ab9,
                limb1: 0x2b675382c6204bb9695d01a5,
                limb2: 0xa8044db1179a3f88,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x240c915621ddf5e574a077e4,
                limb1: 0x288e3d99e9b7b6ba23d31aa3,
                limb2: 0x4893bf3703cf47dd,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x73667ca2f1bddbd714c72f79,
                limb1: 0x3ade6efecd4d218465aa7c3c,
                limb2: 0x3f2790aede4aa904,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0xe48ea13f6a84805d36f45bff,
                limb1: 0x9886db500730147360d7c955,
                limb2: 0x256d275eef678649,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x8136369008e5a6e0b7fdae44,
                limb1: 0xf74ca8a47efd6cd2bba0fe41,
                limb2: 0xbff84a44f7825120,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x2c3e1a3b527b2b288c375470,
                    limb1: 0xd7f23e5b3c7123ab586f0629,
                    limb2: 0x62c60e945d7026b3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xcccd69d966ec2e088d9033e2,
                    limb1: 0x7fffffffffffffff73428ab3,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xc5d7c21804314a6113b5c7d9,
                    limb1: 0x7834b6ae2a61980e7fc1035c,
                    limb2: 0xd066187e9f73d668,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd948d875454006f538fa6ae1,
                    limb1: 0x62184a87434388bd9537dfc6,
                    limb2: 0x2d8be1c7a64c39a7,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x418361488fcdf280724d50a9,
                    limb1: 0x1e6afef34411f24b550a00aa,
                    limb2: 0xa519cc218b11a9b8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x530864ce7f61e75bc88085bd,
                    limb1: 0x3cdef02fe7e19bce7e12b286,
                    limb2: 0x54f6f6c4bd9a7f66,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x411b671624175b556f5705e4,
                    limb1: 0xba46e1aaa8b2a4220b2b5dc5,
                    limb2: 0x9e74e318fc7b78f3,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x508a85019e69fa45df4a0bfd,
                    limb1: 0xbcd92323c1da84eed40ea524,
                    limb2: 0xcb464a2b84d6764a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x66c941d034f23dea71466c6,
                    limb1: 0x6fb08730bcba213f5494dc1f,
                    limb2: 0x62cf32bdb42a89e8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x407927966c0e275e7ce31fa7,
                    limb1: 0x8da2ddbfaccdec83a575675d,
                    limb2: 0xd2229080b755e6f2,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc5d7c21804314a6113b5c7d6,
                    limb1: 0x7834b6ae2a61980e7fc1035c,
                    limb2: 0xd066187e9f73d668,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd948d875454006f538fa6ae1,
                    limb1: 0x62184a87434388bd9537dfc6,
                    limb2: 0x2d8be1c7a64c39a7,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xc809605662b9ec2a368e1a6c,
                    limb1: 0x6065ed6bcda486b84af2d88b,
                    limb2: 0x2ba8edfa0986531c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd727d0bbebb59f7e32633d09,
                    limb1: 0x7ffffffffffffffe59894ffc,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xe360567d5c43337bbc4c6113,
                    limb1: 0xdc6eef70130c8da4776d35a9,
                    limb2: 0x745f2c5d2c48835c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xdc54b211c7ff7dfc2cc8c93f,
                    limb1: 0x3e4ca313fab6def782a78d14,
                    limb2: 0x67fe483ff226cdbb,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xa024f9de0863b99229e86003,
                    limb1: 0x6219e0edb6b4067977e5f948,
                    limb2: 0x16cc4e1506a5b705,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7d7b4da326e4cec36441f2cc,
                    limb1: 0xb96c422fc39a371fd6765b69,
                    limb2: 0xf4953a43ff93b856,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5ed0bdd4998aebf2343e6aae,
                    limb1: 0x27381e44dbf8e31b09a9c825,
                    limb2: 0xc40d56a9b4776b64,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xfec677344798c1bdd7bd6179,
                    limb1: 0x1776eaee52f2a48c5260dbbc,
                    limb2: 0x28fe41168d23dd8d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb3608f7a77df8d67813988c6,
                    limb1: 0xec881d1d32361f852b3afea7,
                    limb2: 0x946369df417a6d4b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x37559ac0e3cfc249a178048d,
                    limb1: 0xf905d4198673e9d5dd265f73,
                    limb2: 0x22cb5d17d3c62ab6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe360567d5c43337bbc4c6110,
                    limb1: 0xdc6eef70130c8da4776d35a9,
                    limb2: 0x745f2c5d2c48835c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xdc54b211c7ff7dfc2cc8c93f,
                    limb1: 0x3e4ca313fab6def782a78d14,
                    limb2: 0x67fe483ff226cdbb,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x4b0696b7b87e7faa76903165,
                    limb1: 0xcdb8bd113dd6060de79a84cf,
                    limb2: 0x676ebad7c8e3ffec,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5784a91a5e09d24e7c4a2665,
                    limb1: 0x7fffffffffffffff7c074594,
                    limb2: 0x7fffffff80000000,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xdbd84738cb47185c5716fd32,
                    limb1: 0x21e46a067c1ddaa966f22f73,
                    limb2: 0xfa51b47e64697c3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf764cd6a739d89bd546b2c1c,
                    limb1: 0x3eeae7160f1834d27b551c07,
                    limb2: 0x91ff19690cc931da,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xd70e0d7a95b62f5abac6e7bb,
                    limb1: 0xb4be9fee8a81c357b08f5a5c,
                    limb2: 0xd313e86637d9ad6b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4c842c7d123a3f6b3acffe6b,
                    limb1: 0x223fe5308f7d591668dd2e7b,
                    limb2: 0x2eae5f4250e3d6ae,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa60935bdd30fd85484b25424,
                    limb1: 0x74ed27691f0b52bb305cfa56,
                    limb2: 0x804d4b3a513d3f1,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xb1edbd4bfa6a8584f230507,
                    limb1: 0x8eb23cb08355fd2de04f4ec3,
                    limb2: 0xf5194432f4823d89,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6b54d15aa9431b8524d99d9e,
                    limb1: 0xdb0ac36d09f0f2ba3aff0398,
                    limb2: 0x84ae6d6daab960d3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe62548b6e0f59f062a90dbf5,
                    limb1: 0xf72b0813494fe844f31db29a,
                    limb2: 0xa4c8e99b83defe5a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xdbd84738cb47185c5716fd2f,
                    limb1: 0x21e46a067c1ddaa966f22f73,
                    limb2: 0xfa51b47e64697c3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf764cd6a739d89bd546b2c1c,
                    limb1: 0x3eeae7160f1834d27b551c07,
                    limb2: 0x91ff19690cc931da,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xa5436367e56ea9d0afa35e0e,
            limb1: 0x1e9c21a9f91b197d795c8aaf,
            limb2: 0x3c37f1c8cecc73bb,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0x9614df828c2dedb20e38988e,
                limb1: 0x602517d515f02669cea3f5a3,
                limb2: 0x4d7a78e07c61514,
                limb3: 0x0
            },
            u384 {
                limb0: 0x7fa13caa1365d3c209c9ab88,
                limb1: 0xc0c9a915891bb8d06f753d62,
                limb2: 0x36dc02b3790cff08,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            3
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xac10769f6d8bda96ce73d807,
                    limb1: 0x8e1636b62c685891c37aef42,
                    limb2: 0x151a4a8df534be00,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x4513687ab1e83eeb45592721,
                    limb1: 0x630b5b54acc2b74ccf88f79b,
                    limb2: 0xbf5e3d6bc12e60e5,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256K1_1_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x37385010c3d6b2b7404c06ea,
                    limb1: 0xfe760aec4d18233d8cae1cc9,
                    limb2: 0x13b92ca14766ea27,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x640dfaa50b7d9512767eb437,
                    limb1: 0x82f96db4a29398bf982b39ad,
                    limb2: 0x7ed1bda956281b3,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xb76fc5b2acc512df3ac49efa5be12d09, high: 0x483c1a4ea91da2cd8bf06f64b4178592
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xb01182cc360da95d2d8a12d3,
                limb1: 0xc13080b968f448f9df600059,
                limb2: 0x94ee70dad9d7a0d3,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xa15f412899910b4153192c46,
                limb1: 0x6c2ace7c16abaaf273bfaedb,
                limb2: 0xd0a321e1b39beb5b,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xdafbd4b3f547a905c8b1ff72,
                limb1: 0x711c041c8a0abda52cb5d0e2,
                limb2: 0x3df47e7884e5fe0b,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xaaf3f455b62f4a44d57cc662,
                limb1: 0xe3f8cf07b1edf2a06c7dfa67,
                limb2: 0xb854110d6f3b9240,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x3a458d2ad89e9d43302d5e4e,
                limb1: 0x4172a846fc44ecd24ac99133,
                limb2: 0xd959e91c36514a93,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x2b0729ed04cbffe392dde520,
                limb1: 0xc8d8a877db6ab0d10b46edeb,
                limb2: 0x619ea93ed7ef00bd,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x6dc4596d9ce0b7b46524af85,
                    limb1: 0xc96baab0e053e934396eaac3,
                    limb2: 0xb571562f083016fa,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x170eaf7e2d34943f64ef6547,
                    limb1: 0xffffffffffffffff7eb4d026,
                    limb2: 0xffffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xf6b0ddecd749121b8273c5a2,
                    limb1: 0xd08c823e1aa0de38864d0aea,
                    limb2: 0x446c39528f5ebc7b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x18b62d23061ba3ea9229e272,
                    limb1: 0x4059745a49f393c893f1e2dd,
                    limb2: 0x57586283dec17504,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x5341fa5658aa3fc0e2154477,
                    limb1: 0x4ece8ce8a6a11b2e1b3ce14b,
                    limb2: 0xaff4b93205cbe289,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x210e190b30e882e931e0b1a9,
                    limb1: 0x7f1c180f8070c343f37d4ae4,
                    limb2: 0xa54d3d6225e05db1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x48458ca29df5f9485cec275f,
                    limb1: 0x4b26b1301ef96b0234d8637,
                    limb2: 0xbbb49ee4838a6e56,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xbed61179e2ff7ec1912a6b3f,
                    limb1: 0xb3d78fb2ba66138bac1b4c6c,
                    limb2: 0xdef59141eb972762,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xacfb3bf52ac17b6bff2538c0,
                    limb1: 0xc2722e7805a90a7c0b9d340b,
                    limb2: 0x636ab19b174a331d,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xf6b0ddecd749121b8273c5a2,
                    limb1: 0xd08c823e1aa0de38864d0aea,
                    limb2: 0x446c39528f5ebc7b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x18b62d23061ba3ea9229e272,
                    limb1: 0x4059745a49f393c893f1e2dd,
                    limb2: 0x57586283dec17504,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xe2932724dabca6bd909b6ce4,
                    limb1: 0xf1fb324b5684324e420522cd,
                    limb2: 0xc9dfc2a1bcc74cfe,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6063efb3c582345d82b78344,
                    limb1: 0x2581ba41,
                    limb2: 0x8000000000000000,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xbd8113b9f06aaeb94eba825c,
                    limb1: 0xbe81dcfbc06d499333a1672,
                    limb2: 0x9db1acda8b11e385,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xedcbdb3b46e1a441f701f5d3,
                    limb1: 0x906df0f728dd1f1d469c1253,
                    limb2: 0xae5254e633b317cc,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xdd03f983636c4034af4e79d6,
                    limb1: 0xd1eb30ed1934aa5f42820f31,
                    limb2: 0x7dcc71d77de093d4,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb92deecde21cacc47fc6eee8,
                    limb1: 0x5352ab1e7119f4d0d844c1a,
                    limb2: 0xff179d6c30cf81f6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xaac4165797063585772ca32b,
                    limb1: 0xf1402f6ed89f4119e50714a4,
                    limb2: 0xa6a730ed7a467813,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x2e878a1592eac71527199fc8,
                    limb1: 0x5358d0ae242fd03066969d23,
                    limb2: 0x4fdbb9f9cd7d38a3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8092fe9ef02b7dd1c10dc809,
                    limb1: 0xf30196c21e0bd9ccee44804b,
                    limb2: 0xc440524b69e5a697,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xbd8113b9f06aaeb94eba825c,
                    limb1: 0xbe81dcfbc06d499333a1672,
                    limb2: 0x9db1acda8b11e385,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xedcbdb3b46e1a441f701f5d3,
                    limb1: 0x906df0f728dd1f1d469c1253,
                    limb2: 0xae5254e633b317cc,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x2422dfeebfd6ea37da2de428,
                    limb1: 0xf040aeb4a43534c34129f231,
                    limb2: 0x9a87e7d7b539f2b8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24dfc4a247d,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x481b48d1fbaa18078f1e2372,
                    limb1: 0x43aac592cb1a8538de605e94,
                    limb2: 0x13fc103fb1a0a7f0,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xeabe9e213219b9b507209a9e,
                    limb1: 0x4d71539c79b0558888809de9,
                    limb2: 0xe8b1986b44c8b761,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x1585993d5d6d599acbc21d01,
                    limb1: 0x5092f24854d78a037ab519c7,
                    limb2: 0x4d655df325433a65,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x69e20f4bd4d4ddbbc57e42a1,
                    limb1: 0x2a675933975ada3ac24785b2,
                    limb2: 0xac120aec9b165847,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7e7fa5c8b58b5a69dc2097b9,
                    limb1: 0x3812b99494da46346fc910e7,
                    limb2: 0x5b8a57984ceda5bd,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xf8befdbde1a6a834e9d2f81e,
                    limb1: 0xd9ab67038db9a48e14a2960d,
                    limb2: 0x8be471bddb649791,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6b3652e85eb413f931e45138,
                    limb1: 0x1e19494753d256bbbb845165,
                    limb2: 0x5cdb2aeee17d03a9,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x481b48d1fbaa18078f1e2372,
                    limb1: 0x43aac592cb1a8538de605e94,
                    limb2: 0x13fc103fb1a0a7f0,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xeabe9e213219b9b507209a9e,
                    limb1: 0x4d71539c79b0558888809de9,
                    limb2: 0xe8b1986b44c8b761,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x4ac6511d0d7957e63c4d56f9,
            limb1: 0x342727eb54e2b780f869b446,
            limb2: 0x5dcfa1e16291729b,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0x7edcbbdb1654bbfcea6361ce,
                limb1: 0xcc6fe08e6a42a82576dd15de,
                limb2: 0x99a07d367214c26,
                limb3: 0x0
            },
            u384 {
                limb0: 0x6cab48cfa5a020b752ca0a69,
                limb1: 0xc30070ec5068576555b2bfac,
                limb2: 0x5680b2f17136d4f9,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            2
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x9bbbb91fcbf509cb942aaaa2,
                    limb1: 0xa800727442859baf37a23695,
                    limb2: 0xbea5926710806a15,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xafc98b8bac51df7f6e8a25c0,
                    limb1: 0x47a507c7e1e20aec8838fbd4,
                    limb2: 0x2aaaa2abb0dcb0e9,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256K1_2_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xc51efad362700b32022698d2,
                    limb1: 0xb32a98ca18c722539b5f068a,
                    limb2: 0xd0af8af1463d534f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x9f7543b2ed9d7e90ac2b194,
                    limb1: 0xc5c6f66c43b6706ae5b0341b,
                    limb2: 0x8b130b3aa293db8,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xc51efad362700b32022698d2,
                    limb1: 0xb32a98ca18c722539b5f068a,
                    limb2: 0xd0af8af1463d534f,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x9f7543b2ed9d7e90ac2b194,
                    limb1: 0xc5c6f66c43b6706ae5b0341b,
                    limb2: 0x8b130b3aa293db8,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x5f89d54d3bcd6aec53ca8c05acb5959f, high: 0x9501e917496dc27b7af2f402a0e624f1
            },
            u256 {
                low: 0x3f7ba05cf4bb31523254d812bdfb727, high: 0x5df2e07353f04099813dd49a8d99743c
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x19cc4a93555a9126582e50ed,
                limb1: 0xb160a359f6fc31efeda37225,
                limb2: 0x2645f327a46ea4ac,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x53773a89800076a850dde4e5,
                limb1: 0xeb9df3e4aaa713a7cb8c029c,
                limb2: 0x2cb8885e7d8fbdf2,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xab386bc4b796099914dbab60,
                limb1: 0x26ef09d9b06d92dc2bdbd32a,
                limb2: 0x420e7db193dc4acd,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x197d8eebe97ab6d9ae76a9c6,
                limb1: 0xc6d23773c1f4ed01639cbd41,
                limb2: 0xa0b843aae76b8032,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x4c14d9c0c80dbc8b8af11c18,
                limb1: 0x7f98a44624014327745bf981,
                limb2: 0xf08185459674c171,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xd2f17db13cd2374fa13ad48b,
                limb1: 0xd6811164d48270b034d954ce,
                limb2: 0xcdc64f7a0e6e33d4,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x17658746d82927ff2888dedc,
                    limb1: 0x65a835b47657af1cffb8f903,
                    limb2: 0x3f7bf28974e1fdac,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x67f4774066876b5f0778dd5e,
                    limb1: 0x3a3e9d20,
                    limb2: 0x8000000000000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xc0a8498a15afb417cc592b8c,
                    limb1: 0x1e1f6369bba4617c86e46c99,
                    limb2: 0xf02f13e4f898c295,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2114ba99483563a6a5ab1270,
                    limb1: 0x9b74c3dbf03cabbc76fd8750,
                    limb2: 0x90a81e715540803,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x847f7cab7b0c7130dcc3818b,
                    limb1: 0x661f5307b4d96cb95916b685,
                    limb2: 0xff0369b99881d9ff,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2fbdb3d13d9644835f612c7,
                    limb1: 0x2508b6aa34e08901d1c7befc,
                    limb2: 0x30ecdd7364969263,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x13029db3027a85f4ea74528,
                    limb1: 0x734184ef0e422c6ef01a71c7,
                    limb2: 0xd78604251377f96f,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x449a02c697cdecac967047ba,
                    limb1: 0xd2dbb7e4217eaa67b03ef834,
                    limb2: 0x91498b42cc2d5213,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe7911a30f975b98e87ad8110,
                    limb1: 0x40315b0391a8b22740eeb330,
                    limb2: 0x3f498d51954c3819,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xc0a8498a15afb417cc592b8c,
                    limb1: 0x1e1f6369bba4617c86e46c99,
                    limb2: 0xf02f13e4f898c295,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2114ba99483563a6a5ab1270,
                    limb1: 0x9b74c3dbf03cabbc76fd8750,
                    limb2: 0x90a81e715540803,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xfa42c3ad6857e46fd3ec2da,
                    limb1: 0x45ed07190bba57fcd33a26db,
                    limb2: 0x78917f00e04c8afa,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2d8dcdbc15efd2e94489d6fa, limb1: 0x61dd7712, limb2: 0x0, limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xe5ceabf211a21d6e17835da2,
                    limb1: 0xb22a85a491be48ac199a6828,
                    limb2: 0xf12cd556c4c6fedc,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8fa89967e5f9eb32e8fdb42c,
                    limb1: 0x25e65d5c36cb4ad038c5264a,
                    limb2: 0xed41f75d25e661e3,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xb5ab65d8c2680d24c2a97a5b,
                    limb1: 0xdec62e0b6f0013cbc28bc1e6,
                    limb2: 0x9b5068ced64846fd,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xde5d4c134be0a01cc80328ec,
                    limb1: 0xcbb783f135530538a98c4d24,
                    limb2: 0xbda56a0bc01112a5,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5a1c8839694958b0713e228c,
                    limb1: 0xa19c3ad7ed1f1c384bb2b5b5,
                    limb2: 0x26b76ce1f6ea8780,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x48a6b39e7b6ece08a497a654,
                    limb1: 0xdf29a77ffc33fcb4b338d91e,
                    limb2: 0x9839d55f6170f808,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xed9c31d749d56e6a5ef0041a,
                    limb1: 0x94c8d857f8f0bb18d640c09,
                    limb2: 0x7ccdc38c094cad36,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xe5ceabf211a21d6e17835da2,
                    limb1: 0xb22a85a491be48ac199a6828,
                    limb2: 0xf12cd556c4c6fedc,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8fa89967e5f9eb32e8fdb42c,
                    limb1: 0x25e65d5c36cb4ad038c5264a,
                    limb2: 0xed41f75d25e661e3,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x6bbb9e4394cf0b29ca10af23,
                    limb1: 0x7a39ba151e31cbb18595ab91,
                    limb2: 0x96bca827fed4fdbe,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24dfc4a247d,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x6e1e8c4dc8aa55f9c391e5f,
                    limb1: 0xd6ee116f7e0b9dab44abb8f0,
                    limb2: 0xa7fc181e175eafdd,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8b2ba7a805c39d9603330e6,
                    limb1: 0x597851e02b9129fc5fc83354,
                    limb2: 0xcd6ffd08d5aef3c1,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x362349123c62129c968430e7,
                    limb1: 0x14b119d15f9f859111ce7a1f,
                    limb2: 0x15c8a7c8e354e7be,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfc21c8037c67fa86c5205c2e,
                    limb1: 0x860c56169b4594f386ffe4d9,
                    limb2: 0xc10586d93bfb10ca,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x15c973217a994d1377777af9,
                    limb1: 0x6677f632efb78f1a21c09582,
                    limb2: 0xf2da6462e08d442e,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x302d5d6207ca85a1458fe3dd,
                    limb1: 0xe0827a0c72514faee0b20e90,
                    limb2: 0x97e4a8d2a396cf10,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3ce31959828594f6a166695f,
                    limb1: 0x724a3d2130f825e69e79674c,
                    limb2: 0x9e0feb3dd7c8aa49,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x6e1e8c4dc8aa55f9c391e5f,
                    limb1: 0xd6ee116f7e0b9dab44abb8f0,
                    limb2: 0xa7fc181e175eafdd,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8b2ba7a805c39d9603330e6,
                    limb1: 0x597851e02b9129fc5fc83354,
                    limb2: 0xcd6ffd08d5aef3c1,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x7748f3862bf3c741df23f383,
            limb1: 0x1fb8335da0d9bea71a2f6102,
            limb2: 0x4d432aee06026ad9,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            2
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x159025148867d330a651787,
                    limb1: 0xad3881fb18145580a84d7b53,
                    limb2: 0xd65efbeaa3542e88,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd7a100aa86840f0bc970e2b5,
                    limb1: 0xa1106a18c8c7b5b8ade36a74,
                    limb2: 0x2cfdfc4ad14f1f90,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256K1_3_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x56723c39cff93b0635a31f95,
                    limb1: 0xe43622265879c1bd074447c3,
                    limb2: 0xd9f9c5995764ca39,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x25e9395474e3e2a3c4113f4d,
                    limb1: 0x4cad3564df8ac05d04f70716,
                    limb2: 0x955fae52dc3ae9e5,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x56723c39cff93b0635a31f95,
                    limb1: 0xe43622265879c1bd074447c3,
                    limb2: 0xd9f9c5995764ca39,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x25e9395474e3e2a3c4113f4d,
                    limb1: 0x4cad3564df8ac05d04f70716,
                    limb2: 0x955fae52dc3ae9e5,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x56723c39cff93b0635a31f95,
                    limb1: 0xe43622265879c1bd074447c3,
                    limb2: 0xd9f9c5995764ca39,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x25e9395474e3e2a3c4113f4d,
                    limb1: 0x4cad3564df8ac05d04f70716,
                    limb2: 0x955fae52dc3ae9e5,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xfdc1293082ae752f2d4076bcf9cb2ee8, high: 0x34dd7624c3d9b3b022b56be11392a255
            },
            u256 {
                low: 0x7f2a2e65c6596f7fea455fc7c80cb483, high: 0xf8247e70b2194ff3c46ac0d691ca9f9e
            },
            u256 {
                low: 0x21d32e24bb8917463c3da91136a52df9, high: 0x62759469c28d2ad53bd3147dd0f0c75d
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x77be5124c0ce4e34b6818816,
                limb1: 0xe2153fc364b8126fbf8ddd5a,
                limb2: 0x96f8b52090492fe,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xd79e7d0a0d142a4ea94c4b38,
                limb1: 0x9275bad12248ecd279198f9e,
                limb2: 0x5fb3349926701131,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xf959f5c4fb58ba7f3ead2b68,
                limb1: 0xda8f9d357e849771ed5280,
                limb2: 0xf74064c34e2ad133,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xd08eec715cbbd37dd3e8a85b,
                limb1: 0x308b95f3f67134a1a0f21d0a,
                limb2: 0xd05799a95f60e142,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x742eb0a8424fd35580876cfc,
                limb1: 0x440e3dfeb405dddc9cb3f762,
                limb2: 0x2a77b456dcb65485,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x8ef9a67e74fc8dea8afdc2c8,
                limb1: 0xc88f0ce0f8ada10e8f5e73a0,
                limb2: 0x71bc4a4b4350fdcb,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xee700095ca97e83e7a46ed94,
                    limb1: 0xf1130dd835ef64fc66131237,
                    limb2: 0xe7106f5d396da7ab,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xed813b66539b49165e7fdeb7,
                    limb1: 0xffffffffffffffffa443e3ec,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xbc942e78ec2cc39b76272bc2,
                    limb1: 0x31b50af968fad1ff8a1154cd,
                    limb2: 0x402796224f8138ec,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x31cf72a16f3876c413db5484,
                    limb1: 0x39b49e1642ce2bd3392ddae2,
                    limb2: 0x1c96af149f96a2c7,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x94af65aa55b46d6375857ef2,
                    limb1: 0xe5dd707151914a5e06945aa5,
                    limb2: 0xbb58cc0dd11f7b7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfa6c6a89a765c42c9d6f9b23,
                    limb1: 0x2586ef21e0e28bc988dbca9c,
                    limb2: 0xc3a17f0961ebc510,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8f09bdc1a0cd5e305f7056f1,
                    limb1: 0x1a4951e78cc2993025ac01a7,
                    limb2: 0x1c6212213aeecf84,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x280d454e753959413b12361f,
                    limb1: 0x5bf34cd1dedbbdfcc67951a0,
                    limb2: 0xc1151af02c888e75,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5cac226a0a8b3f5c8aff4f9c,
                    limb1: 0x93f0529bd3a332c69040fc2f,
                    limb2: 0xc81ec9905d1e7372,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xbc942e78ec2cc39b76272bc2,
                    limb1: 0x31b50af968fad1ff8a1154cd,
                    limb2: 0x402796224f8138ec,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x31cf72a16f3876c413db5484,
                    limb1: 0x39b49e1642ce2bd3392ddae2,
                    limb2: 0x1c96af149f96a2c7,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xb427d8335db7675a065af05c,
                    limb1: 0xe266960f3f85b2ed41b06302,
                    limb2: 0xd3c9c487dae10e9e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3e92f30221f96e30928c9705,
                    limb1: 0xffffffffffffffffb3e86177,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xcfc00ffc135fd907a79c59c,
                    limb1: 0x4c1d68f61f71f44efe3c5208,
                    limb2: 0x872afdff09aa21d4,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb033ce0134ae0a788bafad61,
                    limb1: 0x1aef4e3c7207b9ab86ce65bb,
                    limb2: 0x2ec5d5a35a706493,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xf009bf245cb9a8e1b53b72bb,
                    limb1: 0xfcae2d314a57bb7b614f64fd,
                    limb2: 0xf7a0a1f94c5e0048,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1b02dedd95bec2cbd66c857a,
                    limb1: 0x3854defc017ad89e3ae46093,
                    limb2: 0xb7c6e7aab148658c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4b227fff66888d56d141aa89,
                    limb1: 0x538a26ef1cbc754d8acec75d,
                    limb2: 0xb1e7317642dfe964,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x5ae406fe4879eef6595472b7,
                    limb1: 0x14cddebadc1dae28f3a63e38,
                    limb2: 0xb22cf1f943a6ecce,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd16aa20870c2494cd1cdc178,
                    limb1: 0xbc8b23a71e3613b0afa4c821,
                    limb2: 0x4768d7777912c005,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xcfc00ffc135fd907a79c59c,
                    limb1: 0x4c1d68f61f71f44efe3c5208,
                    limb2: 0x872afdff09aa21d4,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb033ce0134ae0a788bafad61,
                    limb1: 0x1aef4e3c7207b9ab86ce65bb,
                    limb2: 0x2ec5d5a35a706493,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xb79bf05c93b63d83742ef0ec,
                    limb1: 0x7015bb0e10a8cf7be8efe81b,
                    limb2: 0x9c8168e6c779c72c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24dfc4a247d,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x4dab4d588e778357c112df9f,
                    limb1: 0xd800ee73fac4353b4f674be2,
                    limb2: 0xa92518b1d00b7fbc,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x92775992c257722940cb5ffa,
                    limb1: 0xbb173264167b9d8bf15eb61c,
                    limb2: 0xde47e6e5d51eda47,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xb927baff660e3d071d32d9f1,
                    limb1: 0xa818313213b0b70ac00c86cd,
                    limb2: 0xd90f43de13b37827,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6173c5dcbb653cc2f2a1e873,
                    limb1: 0x929aa5489969cab482f8ff1c,
                    limb2: 0x3a8087006691cd10,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x338acabd593f36939e2fc610,
                    limb1: 0x8c59428b67777e62719c6d8,
                    limb2: 0xa2726d5ef7d0a562,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x1faf1d6be544976a47842c9d,
                    limb1: 0xe806852bdb5d749f2bd31330,
                    limb2: 0xa003acdcb0507e29,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x143730350641f26c58fb6bc,
                    limb1: 0x1da260bc9d614ed39996fac8,
                    limb2: 0x13f75048d3d7f7f6,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x4dab4d588e778357c112df9f,
                    limb1: 0xd800ee73fac4353b4f674be2,
                    limb2: 0xa92518b1d00b7fbc,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x92775992c257722940cb5ffa,
                    limb1: 0xbb173264167b9d8bf15eb61c,
                    limb2: 0xde47e6e5d51eda47,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xa54b957adde2f34ca286f0cc,
            limb1: 0xcb1b4ed2be909e2b16a2e608,
            limb2: 0x11859c4b4a5bb41d,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0xf18c7a09c705d953cab5d13b,
                limb1: 0xbda90ce1226da3bf71410781,
                limb2: 0x82f59dda5d28d8a,
                limb3: 0x0
            },
            u384 {
                limb0: 0xaafcffb4a2036957dc1f025f,
                limb1: 0xc1ed7a8924eb55d430387b9d,
                limb2: 0x591f24762e7a0500,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            2
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xdad09989e72d5677a4627c50,
                    limb1: 0xe801077e022766ce92d7e827,
                    limb2: 0x6da0279e548ed143,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xca0a9a6d4df073ce2b260c4,
                    limb1: 0x3ab0983a4f036d19ecce8777,
                    limb2: 0x9b9ce3f02ab9785e,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256K1_4_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x8253548517200c67574e4c8c,
                    limb1: 0xc5e62a543b097940089c263a,
                    limb2: 0x9fbe9e866683b114,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xcefbc469ab1f5f5c89e69f87,
                    limb1: 0x9f62550f673e374586a8e4f5,
                    limb2: 0x34417af9911e00ce,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x8253548517200c67574e4c8c,
                    limb1: 0xc5e62a543b097940089c263a,
                    limb2: 0x9fbe9e866683b114,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xcefbc469ab1f5f5c89e69f87,
                    limb1: 0x9f62550f673e374586a8e4f5,
                    limb2: 0x34417af9911e00ce,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x8253548517200c67574e4c8c,
                    limb1: 0xc5e62a543b097940089c263a,
                    limb2: 0x9fbe9e866683b114,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xcefbc469ab1f5f5c89e69f87,
                    limb1: 0x9f62550f673e374586a8e4f5,
                    limb2: 0x34417af9911e00ce,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x8253548517200c67574e4c8c,
                    limb1: 0xc5e62a543b097940089c263a,
                    limb2: 0x9fbe9e866683b114,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xcefbc469ab1f5f5c89e69f87,
                    limb1: 0x9f62550f673e374586a8e4f5,
                    limb2: 0x34417af9911e00ce,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x6a8e22fd57caf0d9db3466d1ba6cc61, high: 0x7d3c279b5bce228b989bb03086c47b06
            },
            u256 {
                low: 0xf568c9c6033c14694f06ea1874a26444, high: 0x29bccee9a71b80ef8e36b82f3856be31
            },
            u256 {
                low: 0xcf2a21987ea496f5e10b4aada92d6b05, high: 0x8bc88bcf7b1d4049bcc4616df40d2a37
            },
            u256 {
                low: 0x142a6c95d9082a42b4480761505e9c9b, high: 0x66dfeb1e9ab3cc27232f8c5b425832c0
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xf7bd3aba7892bca294032bce,
                limb1: 0x2e83efe983c5aee29fd8cadf,
                limb2: 0x2ad4d684e5d386ff,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xbb3272e5004fe06c3c1c5439,
                limb1: 0x761d480c366543bea0d90db9,
                limb2: 0xd06dfc8b6037424a,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xf5ae672438744a80daa994b5,
                limb1: 0xf69afbae81d2f800a71e762c,
                limb2: 0x6b7929ad36b2949d,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x21f433fcafa6de7354e4d0ec,
                limb1: 0x9fe44d0477706b0b776cd491,
                limb2: 0xcbd498368b72b076,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x73dd38891a1cdc0e4f95e271,
                limb1: 0x55147d989ea89e3ea6a0c39b,
                limb2: 0x4dc3811bc43b375b,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x3151ad2f7436a6a85bf5d228,
                limb1: 0xc96d3f0ccefc1a2ed6c10cbe,
                limb2: 0x474929ec4c4a37bc,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x27bb65ea024145cc6dfdd830,
                    limb1: 0x7dac78354fc4457a3816f576,
                    limb2: 0x786465cb169c8ea1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd90826fe8aaf3a04d752bdef,
                    limb1: 0xffffffffffffffff10de05e7,
                    limb2: 0xffffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x6aafd78838184ce5626ff18b,
                    limb1: 0x4d7ed75aa346ed956a30c8fc,
                    limb2: 0x712dade320d41989,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x85ef70c0704d36f514ae83d5,
                    limb1: 0xb95e5c24130d7dd578b0ee5,
                    limb2: 0x356c8af4b3a8c7ec,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x3aae689f16451e4dad5bb873,
                    limb1: 0x257644fbd052564e6cf70dfe,
                    limb2: 0x6702d9338fe44f1e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x114bceea729ad5fb0af7683c,
                    limb1: 0x2ebc15080383a8a5de2e94c7,
                    limb2: 0x276ca24e859fe932,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7a9a7e0295c88f207d11e75d,
                    limb1: 0xae8b6b866e109534f58fd96d,
                    limb2: 0x677d3e45dd7c5a9,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xeacee4b988aa1a48b10fa640,
                    limb1: 0x1e77e37a76f07f15e7557ee6,
                    limb2: 0x183fc135e5ccb2c1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa98c1543121c80b490c59ea4,
                    limb1: 0x5119484fc855e70d64cd6846,
                    limb2: 0x75f7ccb0e99d7774,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x6aafd78838184ce5626ff18b,
                    limb1: 0x4d7ed75aa346ed956a30c8fc,
                    limb2: 0x712dade320d41989,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x85ef70c0704d36f514ae83d5,
                    limb1: 0xb95e5c24130d7dd578b0ee5,
                    limb2: 0x356c8af4b3a8c7ec,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x64399e3606fcb3900e3a1d62,
                    limb1: 0x6b67df78a5c3086a85633068,
                    limb2: 0xd8ace5fdde3e4877,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfec8f043648ae81bc65aa5f4,
                    limb1: 0x8e547807,
                    limb2: 0x8000000000000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x28bb7bf1f0230cce4d00f2a8,
                    limb1: 0x2211ad16975584454053e875,
                    limb2: 0xd3bc851b01dc1490,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x87fe4456b06ba915ce08171d,
                    limb1: 0x437ed9fd43238ebf50456398,
                    limb2: 0xf4c837cc62c9ba4d,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x3039f2897516d42870ff37e8,
                    limb1: 0x3e90dc5156e9febf3917160c,
                    limb2: 0x7bfcad98079fd8ea,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3241015f60d88a3457ec9417,
                    limb1: 0xf6ecd32b66d7512c4d26e216,
                    limb2: 0xc769f02c5e0ffbd3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd10be90bb16e421bb11b1c87,
                    limb1: 0xc63e0dce8d83f41397297214,
                    limb2: 0x947ef2b7eb6e6dc3,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x1d20639d90f559a91b06b5ad,
                    limb1: 0xee7bbb9e23569de4c24b5b34,
                    limb2: 0xca27a3bd0d048ff0,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb7f3de5ed2f19f9ea238b8b1,
                    limb1: 0xd877f5ecd5f8e73b31e5b92b,
                    limb2: 0xb1798696b384181c,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x28bb7bf1f0230cce4d00f2a8,
                    limb1: 0x2211ad16975584454053e875,
                    limb2: 0xd3bc851b01dc1490,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x87fe4456b06ba915ce08171d,
                    limb1: 0x437ed9fd43238ebf50456398,
                    limb2: 0xf4c837cc62c9ba4d,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xda0c6267a16acd40b03889a3,
                    limb1: 0x78f4fed7123cdd351742c8a9,
                    limb2: 0x4ac74e2ee92f26a8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24dfc4a247d,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x4bad384c3c87f06cd46a9cab,
                    limb1: 0xc70ce8bc4125e5d021cff887,
                    limb2: 0x157c431c98c9dddd,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x96746052ad6ed96fd5c08509,
                    limb1: 0xb45086b8df8469c0b240c637,
                    limb2: 0x46c3553705123406,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x5a9f519c70142a3edee2fe4,
                    limb1: 0xf1e8a71dac8f928a99062e1a,
                    limb2: 0x80fe6d0a9ee0d57c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x83aabf55fc61ec8ca8b1e7c4,
                    limb1: 0x2e5a1168f16dffe9648cfd45,
                    limb2: 0x1274d7a8c66f9ff2,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xeef60f16b3837e6e43e2dacd,
                    limb1: 0x33422c5f5b7b898db0df387f,
                    limb2: 0x282c06ce47400e98,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x11bc8a15a7b792f9ceea48ad,
                    limb1: 0x715a5d25c80948b0ecafcbb3,
                    limb2: 0x9665d5c82d851110,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1d2ea242be07f20fd843a710,
                    limb1: 0xee33af0e1c9ee444dfc56b85,
                    limb2: 0xef575481237f6c2e,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x4bad384c3c87f06cd46a9cab,
                    limb1: 0xc70ce8bc4125e5d021cff887,
                    limb2: 0x157c431c98c9dddd,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x96746052ad6ed96fd5c08509,
                    limb1: 0xb45086b8df8469c0b240c637,
                    limb2: 0x46c3553705123406,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x8dbd0fc7a21f8ddbaf3dd2f4,
            limb1: 0x39f5ca25fc10bd79c5c32136,
            limb2: 0x49e9b695b5c4aa70,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0xbf1360244de9b7ed16a21dcc,
                limb1: 0x330dcd51021689a783f1d5e0,
                limb2: 0x3746a0436b70abb8,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            2
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x606b5174d9277cb5ed3ede69,
                    limb1: 0xb9796004dfadaa545cf42803,
                    limb2: 0xf810574c0232dfab,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x9b7ae95a5c057f7ba1bdced9,
                    limb1: 0xa012af7fa9a9dc6ac6154292,
                    limb2: 0x3177057cfad673da,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256K1_5_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x8926d55892e09defedc51d5d,
                    limb1: 0x3babb62783d68ca0ae92639f,
                    limb2: 0x329e8cb99efec787,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x975a5a0cb36b5c6bf707356f,
                    limb1: 0x9851d374e546d6c6cca372eb,
                    limb2: 0xff16a147829014ed,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x8926d55892e09defedc51d5d,
                    limb1: 0x3babb62783d68ca0ae92639f,
                    limb2: 0x329e8cb99efec787,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x975a5a0cb36b5c6bf707356f,
                    limb1: 0x9851d374e546d6c6cca372eb,
                    limb2: 0xff16a147829014ed,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x8926d55892e09defedc51d5d,
                    limb1: 0x3babb62783d68ca0ae92639f,
                    limb2: 0x329e8cb99efec787,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x975a5a0cb36b5c6bf707356f,
                    limb1: 0x9851d374e546d6c6cca372eb,
                    limb2: 0xff16a147829014ed,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x8926d55892e09defedc51d5d,
                    limb1: 0x3babb62783d68ca0ae92639f,
                    limb2: 0x329e8cb99efec787,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x975a5a0cb36b5c6bf707356f,
                    limb1: 0x9851d374e546d6c6cca372eb,
                    limb2: 0xff16a147829014ed,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x8926d55892e09defedc51d5d,
                    limb1: 0x3babb62783d68ca0ae92639f,
                    limb2: 0x329e8cb99efec787,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x975a5a0cb36b5c6bf707356f,
                    limb1: 0x9851d374e546d6c6cca372eb,
                    limb2: 0xff16a147829014ed,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x50ae265209cd3bdf356af7370f2670d2, high: 0x3fe65f90f631681ebf401e04b9f94ec6
            },
            u256 {
                low: 0xab1e679470f2297adceb201357d9af8d, high: 0x39d5b552a867a0f0a8e6a772b9cde60c
            },
            u256 {
                low: 0x298e9a79abecfc0b581ba30742965873, high: 0x92d6ff735b3a4595045892c14e0e15d3
            },
            u256 {
                low: 0xa1645f58bb78eb2d0ee5144d8a1d8b42, high: 0x7db931ce05a0f4215a79b46a26b61b06
            },
            u256 {
                low: 0x3dd0c8660649def50fb2de1ea0b976c2, high: 0xf20e8bda39cc6d88032f594d0b82b61c
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x85ddb83313dec3ae8a3010a2,
                limb1: 0xc6b5550deb816291da7c4fb2,
                limb2: 0x8e800bf75f924874,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x2e7c671cbe0ec5e576e4db4b,
                limb1: 0x5c245fef8bd6fd27346e47a9,
                limb2: 0x5d0790f226fee37f,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x52888c3b76624cdec72a1b5b,
                limb1: 0xac024b79c6fde5fd585540e6,
                limb2: 0x3a5a718d6b96188b,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xf91439a24ceae27a19db78da,
                limb1: 0x87cfe9188197f637ffbc6b95,
                limb2: 0xc32c13fb5a85206a,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x9bb852397bdde2a01056dee9,
                limb1: 0x1b60541b0773892dd5aed2be,
                limb2: 0x5397b15c35d6f919,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xff574d72b69b65468e853c05,
                limb1: 0xfbf8b91654142b813e38534e,
                limb2: 0x67eb1ffade584bf6,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x9d69105a2ad4e2551700f741,
                    limb1: 0x3e0c248af813506c6794a448,
                    limb2: 0x8809c7fd472bd067,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5638e985cf3192b189738dee,
                    limb1: 0xfffffffffffffffff0dafc61,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x775c832338fb7bc786cd54d7,
                    limb1: 0x2c7c60f13c386c98d7006674,
                    limb2: 0xd89061357653b813,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf0fb727459409e60880ace30,
                    limb1: 0xfd9ef4ca90a810cd76f14cad,
                    limb2: 0x3ee1674f016ef003,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xc1da98464af237c6afc0fea6,
                    limb1: 0x4d9fc1f0c0f62af5e8189bef,
                    limb2: 0xe702f9700f30efef,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2a5c26d31234ca429fd6bc2,
                    limb1: 0x318db52012c33483e0a85c4d,
                    limb2: 0x5bab471bd5636ab0,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x61036f7f422836ea3e3471e5,
                    limb1: 0xe5347ebb824198552b53e97d,
                    limb2: 0x4c37bd5b51e486c3,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x438795f68ee06279af9d64f6,
                    limb1: 0x3766a698a58af82de102cd2f,
                    limb2: 0xebf2a8763c4a0886,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x96e0212e70c454a4b84ba721,
                    limb1: 0xef58b189f498759e409918c1,
                    limb2: 0xb829d3290a08901b,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x775c832338fb7bc786cd54d7,
                    limb1: 0x2c7c60f13c386c98d7006674,
                    limb2: 0xd89061357653b813,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf0fb727459409e60880ace30,
                    limb1: 0xfd9ef4ca90a810cd76f14cad,
                    limb2: 0x3ee1674f016ef003,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x57c93d158ec5d5e9c6bfa070,
                    limb1: 0x13eb99c1686fa612e6a99d8e,
                    limb2: 0x7e8b9fdcbf4e4ef4,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfc7bea9764676746a8224428, limb1: 0x37cebe72, limb2: 0x0, limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x9cd41613c22c207df81ec827,
                    limb1: 0x8681cc1c46d8e67470e2e86b,
                    limb2: 0xa1064f950c210945,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x24509e6bf6bd15304b10c377,
                    limb1: 0x1851fe5eb52b8d61f9185b7a,
                    limb2: 0x930701b8f56b1fed,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x7042aa7615fd9444a7b22fe,
                    limb1: 0x85b68105a19bb227fadb406e,
                    limb2: 0xd25d213c474d7cce,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x18548dca86647bccb0f937f0,
                    limb1: 0x8250f55f87936a4867cd85d8,
                    limb2: 0x49333b3f19a75843,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc480c3304acd35671b7129fb,
                    limb1: 0x264c7fc15c9a8d59f466c20e,
                    limb2: 0xc260e6836f49fd6c,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x49cc9a8a4f34e375c8d78855,
                    limb1: 0xad8c94c5efee4d2f16345af1,
                    limb2: 0x672c2d1354e740e6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfe3454f3bf2b94560d756785,
                    limb1: 0xaa3df496f430ddadcfaa8056,
                    limb2: 0x5310c0eb5eddf7b,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x9cd41613c22c207df81ec827,
                    limb1: 0x8681cc1c46d8e67470e2e86b,
                    limb2: 0xa1064f950c210945,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x24509e6bf6bd15304b10c377,
                    limb1: 0x1851fe5eb52b8d61f9185b7a,
                    limb2: 0x930701b8f56b1fed,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x9eb0f40480ed0afd464a9a27,
                    limb1: 0x65a16d01a7c35a3a1627748c,
                    limb2: 0x414084342c601779,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24dfc4a247d,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x3a16bcd00608cbd5f00631c2,
                    limb1: 0x854c240d42962043fbbbd1c6,
                    limb2: 0x9e09f5abb92f9c9d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x11bf218b0dbfd080287f01eb,
                    limb1: 0x389d606b318e90d4d1fbec5b,
                    limb2: 0x720ddd165e92ee5b,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x1c63fed2eaa642c98b9e46cf,
                    limb1: 0x236c52207da99297666dfcea,
                    limb2: 0x638250c7ff131739,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x19b1e775537977d0b00341c,
                    limb1: 0xca94fab20b528cd2472fe836,
                    limb2: 0xec627e03309453b3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5a090a70b7f64783bc977b83,
                    limb1: 0x5a7705e7f69fe1627a9fa27,
                    limb2: 0x6952be7881556f40,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x969f29b02a3d92dd902b6b92,
                    limb1: 0xa514fc5cd21ae1dbe222bc6b,
                    limb2: 0x5245b7b2104d484e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7c39eacd603eb3841b7918e0,
                    limb1: 0x8c4da2ee5ae5f5d1bde3767d,
                    limb2: 0x1e610b9c9604847e,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x3a16bcd00608cbd5f00631c2,
                    limb1: 0x854c240d42962043fbbbd1c6,
                    limb2: 0x9e09f5abb92f9c9d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x11bf218b0dbfd080287f01eb,
                    limb1: 0x389d606b318e90d4d1fbec5b,
                    limb2: 0x720ddd165e92ee5b,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x1c7d226ca25696605ed5e817,
            limb1: 0xeb58896d40650b4eb2971175,
            limb2: 0x7322bdf8fa056abc,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            2
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x2caa370ddc304cbe9653e918,
                    limb1: 0xb6c4eaef2fa99ab8e75cb84c,
                    limb2: 0x9d90e0bf6f130008,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x56f5bb7063cefc032983192f,
                    limb1: 0x4ea869054338d2ce9c2f3fc4,
                    limb2: 0xec9715ebc1ef8bbe,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256K1_6_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xb9c63cd07ae6eae1b601f07f,
                    limb1: 0xcdb91e6c274932800007cc66,
                    limb2: 0xda0b23c6016765c0,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf49aedae790e5721691402ff,
                    limb1: 0x12bdfb4a5b4af76acef422a4,
                    limb2: 0xcc72a1f6cf39f5e,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xb9c63cd07ae6eae1b601f07f,
                    limb1: 0xcdb91e6c274932800007cc66,
                    limb2: 0xda0b23c6016765c0,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf49aedae790e5721691402ff,
                    limb1: 0x12bdfb4a5b4af76acef422a4,
                    limb2: 0xcc72a1f6cf39f5e,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xb9c63cd07ae6eae1b601f07f,
                    limb1: 0xcdb91e6c274932800007cc66,
                    limb2: 0xda0b23c6016765c0,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf49aedae790e5721691402ff,
                    limb1: 0x12bdfb4a5b4af76acef422a4,
                    limb2: 0xcc72a1f6cf39f5e,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xb9c63cd07ae6eae1b601f07f,
                    limb1: 0xcdb91e6c274932800007cc66,
                    limb2: 0xda0b23c6016765c0,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf49aedae790e5721691402ff,
                    limb1: 0x12bdfb4a5b4af76acef422a4,
                    limb2: 0xcc72a1f6cf39f5e,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xb9c63cd07ae6eae1b601f07f,
                    limb1: 0xcdb91e6c274932800007cc66,
                    limb2: 0xda0b23c6016765c0,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf49aedae790e5721691402ff,
                    limb1: 0x12bdfb4a5b4af76acef422a4,
                    limb2: 0xcc72a1f6cf39f5e,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xb9c63cd07ae6eae1b601f07f,
                    limb1: 0xcdb91e6c274932800007cc66,
                    limb2: 0xda0b23c6016765c0,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xf49aedae790e5721691402ff,
                    limb1: 0x12bdfb4a5b4af76acef422a4,
                    limb2: 0xcc72a1f6cf39f5e,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xec071cf1e47638ec22c71d046c32faff, high: 0x245db6ca6f6a219672ef7dce376e22a6
            },
            u256 {
                low: 0xa629d3322d4ba5a44fdc13515ba830dc, high: 0xc90853fdfc9ea692ba626aee542d19c0
            },
            u256 {
                low: 0x27752fe61f68c6e689c0559bf4fa4a3, high: 0x88a0edce4384860ce413961f68c6dd5e
            },
            u256 {
                low: 0xfb0a6a90bc52b34ecdfa4cc88805ae31, high: 0xc253763876703835b476998dafc8128a
            },
            u256 {
                low: 0x1f626a97ebe7ef9190920b690abc847e, high: 0x2bdb572063eaa07ff436498e68afe2b8
            },
            u256 {
                low: 0x9f312acb2362dbc18024532000cbd313, high: 0xd70da545839137a6a9774b71de6d2d7e
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xac8537bc38faa7b582046530,
                limb1: 0xa3d3767ccac988d9aede3f82,
                limb2: 0x9707247216e07e51,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x343ce49e4690b31eb7c76ee2,
                limb1: 0x5488b0ab187bdbffe6e0eca3,
                limb2: 0x61b9fc1312a4bda9,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xbc98d10fc3acdc0303f16405,
                limb1: 0xde4a97a8884c5717fdf7b66f,
                limb2: 0x8a8d8796a8d14f5a,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x23423128c7f86ef2b48d3970,
                limb1: 0x89accfff6bd1a9c706a8882f,
                limb2: 0x3da245137cfb8f85,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x678b1b23b69e81c545abca27,
                limb1: 0x52d725babac3ab941415b5db,
                limb2: 0xef82f56369bbaa06,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x36f998e65d0b9a1f5e179c1c,
                limb1: 0x880c3e762c734e936e1278ae,
                limb2: 0x23c007c9e3c049f5,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xa24bc953b1d624282ca7c1a6,
                    limb1: 0x987a856a110b381913d158b6,
                    limb2: 0x5fa7629b3e65a49b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x92c0fb733335fa2d4eb079d2,
                    limb1: 0xffffffffffffffff5a838a3c,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x8da81ee9aeaf49174d72c9a6,
                    limb1: 0xb41b7ec4f375e0b45537ecc8,
                    limb2: 0x187be8ed0cf59f49,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x99b48b734c1e6d66c7f9a2af,
                    limb1: 0x8e736b170ded44a65119f416,
                    limb2: 0x8eedb7c7e7b81bed,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xbcbc24dad26546c3ae1798d5,
                    limb1: 0x3ed56aaa607a0d9c903fdeea,
                    limb2: 0x355dca8a7ab71d86,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x10fac37f1dd1bd5c0ec59e93,
                    limb1: 0x199b2bbecf8026133e243c2a,
                    limb2: 0x848dfd48309cdc4b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x899aa7bbf143a31b3c2737d6,
                    limb1: 0xbe7f73bbc35c100bab77ea99,
                    limb2: 0x743d6072969ee713,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xdf98d863c6caffa31e23838a,
                    limb1: 0xecc07762a83924ee5487797b,
                    limb2: 0xab635e7b5ab75b03,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x33efd02714d4fdd277d37e3c,
                    limb1: 0xe527eda1617ce08c37b5ac9e,
                    limb2: 0xe88006775608c37e,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x8da81ee9aeaf49174d72c9a6,
                    limb1: 0xb41b7ec4f375e0b45537ecc8,
                    limb2: 0x187be8ed0cf59f49,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x99b48b734c1e6d66c7f9a2af,
                    limb1: 0x8e736b170ded44a65119f416,
                    limb2: 0x8eedb7c7e7b81bed,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xd798d8a29aa3dd98b3fab16,
                    limb1: 0xce1ff4a485742edf9d7dcf9a,
                    limb2: 0xe7f32b3d33cc0714,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe9250d7c53f1c4e16c008d77,
                    limb1: 0xfffffffffffffffea7356651,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x8a9efd2fe42d53d3736bd0c1,
                    limb1: 0x9bef2ffc555a8ff208882054,
                    limb2: 0xc09c15e81d52329a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x89a0f21fc16c3919460ca3da,
                    limb1: 0x53fc49eb506a766802007d29,
                    limb2: 0x9b6754a355c74ae4,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x6062a56e9f8bf597f2c48d99,
                    limb1: 0x4ab78436ea7b9f72c53a3cf2,
                    limb2: 0x508a0ee55f3bdae3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf9457389ed81bf64bb74355c,
                    limb1: 0x71d50220f9b9c3c37478a6a4,
                    limb2: 0xa8a32404149dac34,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb688f4d561be7a86c77e56a2,
                    limb1: 0x2fb8d860df6f311f51cf8507,
                    limb2: 0xeff1b79d208d247e,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xca58ec4f3d3d4acd27f2c85c,
                    limb1: 0x438a4fe65579ef9e3bb8e24f,
                    limb2: 0x44449958cd3f623a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc3669ede49f58fb4ea588a3a,
                    limb1: 0x4be6056f32e93cd80e036c22,
                    limb2: 0x3fd3507758730c3e,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x8a9efd2fe42d53d3736bd0c1,
                    limb1: 0x9bef2ffc555a8ff208882054,
                    limb2: 0xc09c15e81d52329a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x89a0f21fc16c3919460ca3da,
                    limb1: 0x53fc49eb506a766802007d29,
                    limb2: 0x9b6754a355c74ae4,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xf9e36b67480c2a582e033ebc,
                    limb1: 0x16a0e8ab874cd350ef46aaa7,
                    limb2: 0xb532c5df1142a528,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24dfc4a247d,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x7beed948ced15846bb00f114,
                    limb1: 0xcb65d2c0dd05ddbcf9a231a5,
                    limb2: 0xe95ce3c7e9f30de0,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xdbdc13cc85b4a235b662ca32,
                    limb1: 0xcede429cbceffd53edf293b4,
                    limb2: 0x85ef8305ed73069e,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x285e0ece4f200a67520c902b,
                    limb1: 0x9f53be57518c7ed0f069b703,
                    limb2: 0x8bec264482a28166,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe3dee5b0a52943c371249f8a,
                    limb1: 0x658223908b41bb9f3b95299e,
                    limb2: 0x9648d5f872cbc135,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa54acbb953f2cbb60d6dabac,
                    limb1: 0x65003fbded08a9f318c3ebaa,
                    limb2: 0x5d6c25ffa36c34af,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x6387f0fda7b969f51d06ae72,
                    limb1: 0x8fc8c3460b29102ad36f5b86,
                    limb2: 0x618a3a7765a56125,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3048a97a7f06f7afcb392d1,
                    limb1: 0xa813d2492a8fed4b81a209f2,
                    limb2: 0xa98c95297e252e57,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x7beed948ced15846bb00f114,
                    limb1: 0xcb65d2c0dd05ddbcf9a231a5,
                    limb2: 0xe95ce3c7e9f30de0,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xdbdc13cc85b4a235b662ca32,
                    limb1: 0xcede429cbceffd53edf293b4,
                    limb2: 0x85ef8305ed73069e,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xd9679223afb6d92d5ac6162c,
            limb1: 0x18b6710d9f5b01645a877c9b,
            limb2: 0x4245c31fbbf2c095,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            2
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x775a2096a70a8b2c2641ea2f,
                    limb1: 0xc63cf05cb6ea73349bbf8026,
                    limb2: 0xee14d79aa8492e11,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x27585b585abbd920c85e91ad,
                    limb1: 0x86c16cb97cca123e15311794,
                    limb2: 0xf7ab19d6b4c40cfe,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256K1_7_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x406179f41f5410ec1e09a2b5,
                    limb1: 0xc42e024b429bdefc0e2d94b5,
                    limb2: 0xef5d380c0fc89a2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x2eb23b4143506796966dd2a8,
                    limb1: 0xeabcbe8ddc3dd1d54d635a38,
                    limb2: 0x962c71200be116ad,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x406179f41f5410ec1e09a2b5,
                    limb1: 0xc42e024b429bdefc0e2d94b5,
                    limb2: 0xef5d380c0fc89a2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x2eb23b4143506796966dd2a8,
                    limb1: 0xeabcbe8ddc3dd1d54d635a38,
                    limb2: 0x962c71200be116ad,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x406179f41f5410ec1e09a2b5,
                    limb1: 0xc42e024b429bdefc0e2d94b5,
                    limb2: 0xef5d380c0fc89a2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x2eb23b4143506796966dd2a8,
                    limb1: 0xeabcbe8ddc3dd1d54d635a38,
                    limb2: 0x962c71200be116ad,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x406179f41f5410ec1e09a2b5,
                    limb1: 0xc42e024b429bdefc0e2d94b5,
                    limb2: 0xef5d380c0fc89a2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x2eb23b4143506796966dd2a8,
                    limb1: 0xeabcbe8ddc3dd1d54d635a38,
                    limb2: 0x962c71200be116ad,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x406179f41f5410ec1e09a2b5,
                    limb1: 0xc42e024b429bdefc0e2d94b5,
                    limb2: 0xef5d380c0fc89a2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x2eb23b4143506796966dd2a8,
                    limb1: 0xeabcbe8ddc3dd1d54d635a38,
                    limb2: 0x962c71200be116ad,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x406179f41f5410ec1e09a2b5,
                    limb1: 0xc42e024b429bdefc0e2d94b5,
                    limb2: 0xef5d380c0fc89a2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x2eb23b4143506796966dd2a8,
                    limb1: 0xeabcbe8ddc3dd1d54d635a38,
                    limb2: 0x962c71200be116ad,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x406179f41f5410ec1e09a2b5,
                    limb1: 0xc42e024b429bdefc0e2d94b5,
                    limb2: 0xef5d380c0fc89a2,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x2eb23b4143506796966dd2a8,
                    limb1: 0xeabcbe8ddc3dd1d54d635a38,
                    limb2: 0x962c71200be116ad,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xf22a4fc63f2de8a82d20481ad216ad53, high: 0xe575ae93ce749e8af4e1680b05a02c72
            },
            u256 {
                low: 0xd69db137c9a57cd1be28e8c52b395c4e, high: 0xb7c144fb2b16ad048fb87c76af044a8d
            },
            u256 {
                low: 0xdd5aacc7ed7a6edf6d5b7d501417d4f9, high: 0xa0e774869ed9c1241a895c62990e8f01
            },
            u256 {
                low: 0x9d6c84af266b0d37b5c99b49751f7e54, high: 0x571aa4f640a210150a40a3799a1ab357
            },
            u256 {
                low: 0x606375b8bb937826bcee9d29ce4f1ca0, high: 0xe3b4df81eeb3462ca032149d06fafb60
            },
            u256 {
                low: 0x5bbdd1f416f14aad7f107645094c0230, high: 0x754724dd269b6c3babf0f4bd4af0a6fe
            },
            u256 {
                low: 0x298b7e5d5b1654ad81e774de3c740119, high: 0x566ff3ec679b29e8c0c32da9bc49b58e
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xdd28c93a3b8196a34814909c,
                limb1: 0x160c698cd827b25d07359ca,
                limb2: 0x925dc96ba79a6ef1,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xe812a9ea0adee1939f2d9352,
                limb1: 0x9d698356a9784b7fdf425fa5,
                limb2: 0x17b3bf83123149c1,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x77805f5fc0a4bf5bb20eeb8c,
                limb1: 0x49f803a9707d35d8a1e12b5b,
                limb2: 0xa187e74b3ba0f7c3,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xdd396b02e8f2696016729218,
                limb1: 0x4401585f7372f8795888a3a0,
                limb2: 0x9e6aee429d9af237,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x7319ab39a9112384d46a3509,
                limb1: 0x600a470bb78714f38ae7948c,
                limb2: 0xc8c2bbd1a28851e4,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xf1fe959ef108d34b6258b58,
                limb1: 0xd85648641fef8a43d531f6fe,
                limb2: 0x4625de8a8dc9fbf3,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x85b8772aeb671d4883229613,
                    limb1: 0x961e5acab395a6393f452e3b,
                    limb2: 0xd706b20e8344363a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5ec4057d6d12b02340adb5af,
                    limb1: 0xffffffffffffffff23c32119,
                    limb2: 0xffffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xa842b055459828177ef07eab,
                    limb1: 0x2bc8609660c8e86bcafaad0b,
                    limb2: 0xdcc0d84f2878eac9,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe275bcd1a52a586f99e1c8de,
                    limb1: 0x3a71371befe1a5de215f117f,
                    limb2: 0x5eac63139769076c,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x9775c1ee235e4dca343ef579,
                    limb1: 0x22ad0d27ca84afa5b2946563,
                    limb2: 0xa9e45ec8d73c62a8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2a21c937df473c6b0a76eef6,
                    limb1: 0x5bfdab91023c45e2883a10e0,
                    limb2: 0x5d2c0a7e0bd3c628,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x47ad7497135a2c8eaf04aa88,
                    limb1: 0x9b20f4ebe2b604b440fcb813,
                    limb2: 0xb9acdeb130e0cb21,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x99d2d254e72918aa78938d93,
                    limb1: 0x327aa41ca57e5af28cdabb51,
                    limb2: 0x945ea2a1b4e6b80,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x313829bb84286b0f352c85b4,
                    limb1: 0x991881c38f2b8912e9997a7f,
                    limb2: 0x96b6b58923df33f5,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xa842b055459828177ef07eab,
                    limb1: 0x2bc8609660c8e86bcafaad0b,
                    limb2: 0xdcc0d84f2878eac9,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe275bcd1a52a586f99e1c8de,
                    limb1: 0x3a71371befe1a5de215f117f,
                    limb2: 0x5eac63139769076c,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x752762dc0fabcd53016f2d5b,
                    limb1: 0x43f843d6ecc77deac69049df,
                    limb2: 0x93e8db0f94bfd8c8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa9d98ef17d061e190ebd8110,
                    limb1: 0xffffffffffffffff5ba0f1ab,
                    limb2: 0xffffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x6478a8e4f0fa378a0fb14b3e,
                    limb1: 0xab9a4b3d379f4093398bcd55,
                    limb2: 0x1eb63333b20d3463,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x481e26ac20072fb72fe76dee,
                    limb1: 0xf1d9fa0b4ce6eb2b4ff13fef,
                    limb2: 0x4f82453403627e99,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xd980619bbd20c84a703689d1,
                    limb1: 0x4dfea0276b932ef3a8b6b39e,
                    limb2: 0x5c0fde1c5d0ad4ae,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf1b2aa8684567aa445035e06,
                    limb1: 0x5b98c1e035ee44612a705de7,
                    limb2: 0xa1f70eb315351aeb,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x99903feaee9cdc8d434c8da,
                    limb1: 0x6eca02b6c4a03fb3c2988d2d,
                    limb2: 0x7d43868fc7e0ee03,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xbf4c9e4296d784c66dd90eb2,
                    limb1: 0xb1380eac855ac40692d29d55,
                    limb2: 0xd6fb6669de5c6eb9,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf8d30eb4e0324e044f540924,
                    limb1: 0x9cf5d64f1a506e2f2f98bf8a,
                    limb2: 0x2c8fe46c17b17635,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x6478a8e4f0fa378a0fb14b3e,
                    limb1: 0xab9a4b3d379f4093398bcd55,
                    limb2: 0x1eb63333b20d3463,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x481e26ac20072fb72fe76dee,
                    limb1: 0xf1d9fa0b4ce6eb2b4ff13fef,
                    limb2: 0x4f82453403627e99,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x502868b1d75038480ce762e6,
                    limb1: 0x56424d2796aa27c5f67d2927,
                    limb2: 0xdad3490443352c21,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24dfc4a247d,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x166184bd1b17b258353aa979,
                    limb1: 0x10af797f24d6b0da2886edd5,
                    limb2: 0x572a8b577606d36c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1565f566964a1d1d7986d7c9,
                    limb1: 0x55fdb54ad7fbb533d3374018,
                    limb2: 0x95b55ce321d6b658,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xdb7563dbf420863eca76a541,
                    limb1: 0x33df52ad6c9f8d25037b3030,
                    limb2: 0x76dd19272a0ce305,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x30450f7eb967ae4164164376,
                    limb1: 0xcc55b9755c1bbbbc453ec773,
                    limb2: 0x7c332c25f13681a3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x634dd3766262377044f136aa,
                    limb1: 0x512f1fddc0e543e21eca40f1,
                    limb2: 0x6195e5da310bcfde,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x9caaa12bbda5e06b749aa9f1,
                    limb1: 0x74cc527a01ded5f71bb080d3,
                    limb2: 0x6229cf643a2fc7f4,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x95c9b5ce1c06cbd252aff5c3,
                    limb1: 0x59eff50be7e1f46ac682c0a8,
                    limb2: 0x17f58a35ecdefc6a,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x166184bd1b17b258353aa979,
                    limb1: 0x10af797f24d6b0da2886edd5,
                    limb2: 0x572a8b577606d36c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1565f566964a1d1d7986d7c9,
                    limb1: 0x55fdb54ad7fbb533d3374018,
                    limb2: 0x95b55ce321d6b658,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xfaa2366fcc404e925853ac55,
            limb1: 0xde8d8d1670b821679151d385,
            limb2: 0x756c2366744019b,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            2
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x7ef7f99a4460d502df988cd7,
                    limb1: 0x8a770809cda2bdd766514926,
                    limb2: 0xac1305789f39395a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x10a52c8de5e4b3cc91676797,
                    limb1: 0xe3ef5f879c39094b6cf01765,
                    limb2: 0x12b2362dc29a2b56,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_SECP256K1_8_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xac4c1696c2e8de804ce103ed,
                    limb1: 0xb2fa12afbdd5e985bca145eb,
                    limb2: 0x6f06eba2ce356fe1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc53a60e0c3bec8391aa3c35c,
                    limb1: 0x89325e76716604a27963b9af,
                    limb2: 0x12c38239cd80693f,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xac4c1696c2e8de804ce103ed,
                    limb1: 0xb2fa12afbdd5e985bca145eb,
                    limb2: 0x6f06eba2ce356fe1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc53a60e0c3bec8391aa3c35c,
                    limb1: 0x89325e76716604a27963b9af,
                    limb2: 0x12c38239cd80693f,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xac4c1696c2e8de804ce103ed,
                    limb1: 0xb2fa12afbdd5e985bca145eb,
                    limb2: 0x6f06eba2ce356fe1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc53a60e0c3bec8391aa3c35c,
                    limb1: 0x89325e76716604a27963b9af,
                    limb2: 0x12c38239cd80693f,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xac4c1696c2e8de804ce103ed,
                    limb1: 0xb2fa12afbdd5e985bca145eb,
                    limb2: 0x6f06eba2ce356fe1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc53a60e0c3bec8391aa3c35c,
                    limb1: 0x89325e76716604a27963b9af,
                    limb2: 0x12c38239cd80693f,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xac4c1696c2e8de804ce103ed,
                    limb1: 0xb2fa12afbdd5e985bca145eb,
                    limb2: 0x6f06eba2ce356fe1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc53a60e0c3bec8391aa3c35c,
                    limb1: 0x89325e76716604a27963b9af,
                    limb2: 0x12c38239cd80693f,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xac4c1696c2e8de804ce103ed,
                    limb1: 0xb2fa12afbdd5e985bca145eb,
                    limb2: 0x6f06eba2ce356fe1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc53a60e0c3bec8391aa3c35c,
                    limb1: 0x89325e76716604a27963b9af,
                    limb2: 0x12c38239cd80693f,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xac4c1696c2e8de804ce103ed,
                    limb1: 0xb2fa12afbdd5e985bca145eb,
                    limb2: 0x6f06eba2ce356fe1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc53a60e0c3bec8391aa3c35c,
                    limb1: 0x89325e76716604a27963b9af,
                    limb2: 0x12c38239cd80693f,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xac4c1696c2e8de804ce103ed,
                    limb1: 0xb2fa12afbdd5e985bca145eb,
                    limb2: 0x6f06eba2ce356fe1,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xc53a60e0c3bec8391aa3c35c,
                    limb1: 0x89325e76716604a27963b9af,
                    limb2: 0x12c38239cd80693f,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x780afabf8cea309b49c94aa5e689e5e8, high: 0x88239867c5dd967b08f1100bfa3222c4
            },
            u256 {
                low: 0xef208346432fb3088d56206d920c3de9, high: 0x6522ff4674b7061c09ce15a8afd4fc7b
            },
            u256 {
                low: 0x58ba0bf3675e0c521eb95739b8acdd81, high: 0x45e695b1054b88160d18533e7efa2faf
            },
            u256 {
                low: 0x4100e66508c626a9fee4e6bcbd6deb92, high: 0xb3e4bd3a94fe31a0ae2e45a4ae4404d7
            },
            u256 {
                low: 0xfeb46b244a2edd41eddb0263c6a2894d, high: 0xc33993f235045f77c317c3d4afa4f554
            },
            u256 {
                low: 0x62d59938571c9d788429aeae877e5ea1, high: 0x402988fdf8cc3f3bd59b148ffa7bff5f
            },
            u256 {
                low: 0xfb52451d90e7e1a11db1dfdc357f0a64, high: 0xf16f1487f7f21e5cce0755e354565b12
            },
            u256 {
                low: 0xac825818960da7883e1e165decadbb86, high: 0xe02a35e9ae6b4c8e88644581b8577478
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x88bbbe2b9504f6c4c74e23a,
                limb1: 0x43c6a437bf912aaecd1ba6aa,
                limb2: 0xc8de42445a2a845a,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xfb3a17d8dc8a7815d0cae7ed,
                limb1: 0x9d28ca77bf0bcb05cc136285,
                limb2: 0xcd69a17f32ec5ae7,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x3fea64e8c5399b384b5c358,
                limb1: 0xbfc0f136c1cab18c900c4f7c,
                limb2: 0x22714e135411d96b,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x48ed299b01c90ef9189a46a7,
                limb1: 0x11dea067efb6b8cef4801331,
                limb2: 0x933871ec647c33d,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x93f9477918401653ac4b4b3b,
                limb1: 0xef38c2cbcd8fecf97621dc9a,
                limb2: 0x8c59a7714ebf7c48,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x62404e7a04bcfb5bcba425ad,
                limb1: 0x18b5ec0455df55cf7538a87c,
                limb2: 0xe4e7cb2ef2090882,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x79f0227a4bb2a0a4020c4c03,
                    limb1: 0x5366281e44086fa5d628127b,
                    limb2: 0x34b1261d01dfe8a3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5baecd9560aa3466f29ee916,
                    limb1: 0xfffffffffffffffee40cbb71,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xc9737228dbd49c6de8228806,
                    limb1: 0x83029a8f33cae149d72e7bb7,
                    limb2: 0x272a061dbc447b44,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4b282d8683c6d21166aa1237,
                    limb1: 0x93f49188298ebcb7643136a,
                    limb2: 0xc81ad218d7a00bc4,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x28446e576ac5a614fc598b8e,
                    limb1: 0x7da4ea36b911a9c99445f922,
                    limb2: 0x36735f31ebbc6a64,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x34c8d05c097923f729f9a622,
                    limb1: 0xf842bce3a4904a95b6666d2e,
                    limb2: 0x78bddfff4516c4f7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6881eb388f110cb2ed92e165,
                    limb1: 0x8f8bc95b32efd30b56724bff,
                    limb2: 0xb0075985c0d459be,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x82281f1e02d0470258f1bbfb,
                    limb1: 0x951239ea6a8c2904e2456206,
                    limb2: 0x12262ad025df5edf,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe193ead9a6fbe7ecea69296,
                    limb1: 0x40baffab922e72903bd587e8,
                    limb2: 0x78bbbeade560525c,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0xc9737228dbd49c6de8228806,
                    limb1: 0x83029a8f33cae149d72e7bb7,
                    limb2: 0x272a061dbc447b44,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4b282d8683c6d21166aa1237,
                    limb1: 0x93f49188298ebcb7643136a,
                    limb2: 0xc81ad218d7a00bc4,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xa3da0189d2c0bd0fb5277cb8,
                    limb1: 0x9bd62606be6d6aded729be3d,
                    limb2: 0xeeae74b422db64c1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x79dcf01f1337776ae914412e,
                    limb1: 0xfffffffffffffffec82ae38d,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x8c3352f1ffa07b00ed1fc045,
                    limb1: 0x8efef889356d6f114a50b7e8,
                    limb2: 0x7c1f4eb89881a824,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4fb5431ab0c387cb2e6934ea,
                    limb1: 0x8d44fc19805f64edb3526a98,
                    limb2: 0x6e87c649ddb8b6b2,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x3a932f54b52d64cd605402a7,
                    limb1: 0xebd972e55cb26a6b4d53e3a4,
                    limb2: 0xfd4f578f1d8c35a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe92835269e959ad50137293a,
                    limb1: 0x1227c8dba33cab09d4645257,
                    limb2: 0xb419a2c5336d38f6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2e9ea12a654d3cbaabe31b98,
                    limb1: 0xa48de97c07302c9858d846b8,
                    limb2: 0xe24148dcf64d7068,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xd567449dfd635d097bde4d56,
                    limb1: 0xe8f8cbc075fe09790835075b,
                    limb2: 0x64db270c2b8b98ff,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2df4d5bad558b69144e07dd9,
                    limb1: 0xdce2e4b2829bc27fe740ea2a,
                    limb2: 0x5b66c05100cfee1,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x8c3352f1ffa07b00ed1fc045,
                    limb1: 0x8efef889356d6f114a50b7e8,
                    limb2: 0x7c1f4eb89881a824,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4fb5431ab0c387cb2e6934ea,
                    limb1: 0x8d44fc19805f64edb3526a98,
                    limb2: 0x6e87c649ddb8b6b2,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xf5731d1fb7805513d7070f1d,
                    limb1: 0x12ad75b9028b49193aafa9f5,
                    limb2: 0xb171ba23948d02c9,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24dfc4a247d,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x2b8b15ec1204f3aa235a8b2f,
                    limb1: 0xffcc32aabea1b4a6242baf69,
                    limb2: 0x5f7cb9e00434200b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x680812385b6c4ff7cefeed9c,
                    limb1: 0x51064bfd70a56179f9d1d3e9,
                    limb2: 0x51350a7b5d2eaa4b,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x304a61eea5840dea0303a726,
                    limb1: 0x64247753ff6a2413c0c39e32,
                    limb2: 0xa743952fb7ca60cf,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfe1512af11351e9c76420952,
                    limb1: 0xa8e219cfb85a42cb4ecc38c,
                    limb2: 0x3195b8b519a7a72c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa781eb2ba5a3f11d61646d22,
                    limb1: 0xe47c09f8be4f86e918aff942,
                    limb2: 0x3a7b1922d3c6f3a6,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x30cd99747e22a9a8f779d5eb,
                    limb1: 0xfe9562ab366bf08afd31cbe0,
                    limb2: 0x9c6915201d6ce053,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd8387f8a7ff62fc8a8f886e6,
                    limb1: 0x372c13ee1485aa55d4bccb61,
                    limb2: 0x3873495f8c46a80f,
                    limb3: 0x0
                },
                u384 { limb0: 0x7, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 {
                    limb0: 0x2b8b15ec1204f3aa235a8b2f,
                    limb1: 0xffcc32aabea1b4a6242baf69,
                    limb2: 0x5f7cb9e00434200b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x680812385b6c4ff7cefeed9c,
                    limb1: 0x51064bfd70a56179f9d1d3e9,
                    limb2: 0x51350a7b5d2eaa4b,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xb5ae630680cd830ae29d6fb6,
            limb1: 0xf7590c4ef51afe9587e79bb9,
            limb2: 0x21455faecbdb80f1,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0x4c149160c2b78c7776a59c8a,
                limb1: 0x4dbd07a5d649fb112bcef022,
                limb2: 0x4cbe7bb8e2eeb662,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            2
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x74b9d9795a5b96e423e97509,
                    limb1: 0x97e20275368f6700babfb753,
                    limb2: 0x9b4b65608a81629d,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x58bc62af3313e8efe0bcab1d,
                    limb1: 0x4a001e8ad3c7d79bb27c2380,
                    limb2: 0xe1080333105432da,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_ED25519_1_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x68bb5e66bb89b8fd2e18a41,
                    limb1: 0x9e818601d3e45d355766aff8,
                    limb2: 0xcd2c3d6670b5f71,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x7cb33b595b6fd513d1e26a58,
                    limb1: 0xffb53d7366a95712cd3973eb,
                    limb2: 0x790eb2310798743d,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x4a8b77da5cfa38b1583678eef3ca5f64, high: 0xfd5e2cf52b049944b1dd9fda02ebb76
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xe5cbb0da5b0c4cfd6267785a,
                limb1: 0x727ef2be2a36491ab42b0c8f,
                limb2: 0x7847c8e8ce770483,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x6f7a53992c3de5a6967b18a5,
                limb1: 0xdd8f5daa77b634e5f60bda9d,
                limb2: 0x364247a1a86b4dbf,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x76b1e42156938941e3e0c84c,
                limb1: 0xc09b0a44c60c1204bb1e34ba,
                limb2: 0x43b8e71df399f76a,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x1324f78a951619cfbd0e2c1f,
                limb1: 0xf0b0b0df54c119adf0731bd9,
                limb2: 0xee8add39422cfd2,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0xa40ed40f159b1d79322daaed,
                limb1: 0x6d14baa870a7a3a4e9017c43,
                limb2: 0xb771d00cdd8263f,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x2676b41d719198359295e8b,
                limb1: 0xfd13d007570385c9c455390d,
                limb2: 0x7fc23cf8d8b67fa3,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x9429d687ab5a80cca3fd037,
                    limb1: 0x4414966c9039d707762c988f,
                    limb2: 0x3109536340c29d83,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa1073d53250069d40ba5ebb1,
                    limb1: 0x24cf3186,
                    limb2: 0x4000000000000000,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x2c532b35026fee6511632ed7,
                    limb1: 0x1beb7c4395b2afa3a761e60e,
                    limb2: 0x27818b11b5675c1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x13a8993f393b1772cab6fd3f,
                    limb1: 0xeeff874001e559aff46e4378,
                    limb2: 0x7ae57340ca7d9c0a,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x3c802fb06df9112aa8c8e4a7,
                    limb1: 0x4e034bccbc2ce283ba2cd68f,
                    limb2: 0x56f04ce6a4f48bdc,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x118e97d5c5e92e39172b72fc,
                    limb1: 0xa72bfed25658ca1aa7d6f1c1,
                    limb2: 0x660378e0698cefb4,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4237e33b83a777983a1087fe,
                    limb1: 0x9e54bfe8e8e87f0a3fd8612b,
                    limb2: 0x1606f66bd887c9f5,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x5a324b629283b0a68a082251,
                    limb1: 0xfe18a2f75d6f6b402c42ec6e,
                    limb2: 0x341b39bb2cba6b7f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5237c0fff3f91f2e40bdccec,
                    limb1: 0xdc83010b4e48ea6fa943d609,
                    limb2: 0x3bf8ee4593890c5a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x83bd9d8e0975f2dda8ada699,
                    limb1: 0xeba0db2167aa62ea1d065721,
                    limb2: 0x3dd427017444990d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x38f8562caee1cff40a1f4604,
                    limb1: 0x4d835d50f72ded7a131a9c6b,
                    limb2: 0x5fc6c584c11034a7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x13a8993f393b1772cab6fd3f,
                    limb1: 0xeeff874001e559aff46e4378,
                    limb2: 0x7ae57340ca7d9c0a,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x5d57f91a1119535ff3c2727d,
                    limb1: 0xb89404e8722f864543492eba,
                    limb2: 0x1ca092417fa25f28,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2f6c4c593af0703bf82a22f9,
                    limb1: 0x3f236a5,
                    limb2: 0x4000000000000000,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x54d87e8ab27542058388fd11,
                    limb1: 0xc6e0ccb6ef2d5313af9c518d,
                    limb2: 0x7db32ca49d5b99fd,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x82c265f83db3db2e493dad60,
                    limb1: 0xa0e36fb9660f90c5ed7b1b4d,
                    limb2: 0x2f74550ba55aa923,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xe2ead99b403403adb3874cb4,
                    limb1: 0xce9133a32325789e6195ab6a,
                    limb2: 0x2715b24b67378d4,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb0c85a59ce96c7a5ec5cf0fd,
                    limb1: 0x1f8d54ed7201469a3e2c0959,
                    limb2: 0x4ea05fb8790e395c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf4fff6bc674ee3e8c5cacd50,
                    limb1: 0x21532c76e61e7fadae309e19,
                    limb2: 0x5cced6963584576a,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xb90ff9915f593c3347d6f6d3,
                    limb1: 0x82066105aff46c1f78cf39e7,
                    limb2: 0x25a1fb10827acdb7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x80ba5fe167caf27b14717fa3,
                    limb1: 0x2498627784d2469b0badfbb9,
                    limb2: 0x78c59eb902439487,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xbf22a020a419591037d5ff7,
                    limb1: 0xe7e245127905146acdbb316c,
                    limb2: 0x97e843a5d77760d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x617da9825ee723947c451451,
                    limb1: 0xf878adc450a890ea1b5507ea,
                    limb2: 0x5b01d978431558e3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x82c265f83db3db2e493dad60,
                    limb1: 0xa0e36fb9660f90c5ed7b1b4d,
                    limb2: 0x2f74550ba55aa923,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x7b310fd77927d30a56c17901,
                    limb1: 0x12186e74b121f7635d6fc47a,
                    limb2: 0x70db9aac97f91323,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24e7c4a265c,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x3fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x7789dda3c63b33d1f9ebb261,
                    limb1: 0xd5e1f4552d2e84744fd0a59e,
                    limb2: 0x42a67be1e837cf2c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe53f47cf93d15944e9f18cb4,
                    limb1: 0xd2503b12c94c4a565be04f01,
                    limb2: 0x30cffbe13e8de255,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xa729583adf4da669317427d9,
                    limb1: 0x4f82eefae938c5010e0fc58d,
                    limb2: 0x451a3e44578ddea1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6fed2930843619db4037c23b,
                    limb1: 0xd9d8664454f71bf8ffea3de9,
                    limb2: 0x5d9fa2ced788abbd,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3b578fc073cd6737c9efc050,
                    limb1: 0xae3709c574788df66f184751,
                    limb2: 0x437a9192e7594776,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x5098b776b8dc0b7b24fe8332,
                    limb1: 0xf54b2e8cd521be5ae270346c,
                    limb2: 0x6b2b833969758ba5,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x36b506d3205f51b988fc083f,
                    limb1: 0x4d6142fd642423fb05b9dadf,
                    limb2: 0x615625e08ddbf90d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5bc7e9c26e6cc43e9b3f989f,
                    limb1: 0x100ea93962280d560bea0c10,
                    limb2: 0x5b6612ff9a614bf4,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x842f089b72ad1560f2a7c9a1,
                    limb1: 0x779d5628ea9c24abb895bfb,
                    limb2: 0x1ff528b58df18e13,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe53f47cf93d15944e9f18cb4,
                    limb1: 0xd2503b12c94c4a565be04f01,
                    limb2: 0x30cffbe13e8de255,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x96f14259224038d741156235,
            limb1: 0x409ae6872d20611ba3d9899d,
            limb2: 0x2a305eae633e1435,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0x6ace56f7d310b6b3eb641d45,
                limb1: 0xbee8826afd69c780dbb2d4df,
                limb2: 0x29e875e52a50685,
                limb3: 0x0
            },
            u384 {
                limb0: 0x733781fb47e05a22c336a8cd,
                limb1: 0x36a755b5610e104ca83bb474,
                limb2: 0x37d4b02fe497876f,
                limb3: 0x0
            },
            u384 {
                limb0: 0x382bae19c35b1938047dffe2,
                limb1: 0x5fbf76166fb7be759ae8f512,
                limb2: 0x24b213d039363904,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            4
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xd26680c18d7ee7ccd3080659,
                    limb1: 0x8c751c21d2f7d126fb490ced,
                    limb2: 0x2735566de20e42a8,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x35b1ca733d0983e2904ff0be,
                    limb1: 0xc1ea481c94330ab0154c6b03,
                    limb2: 0x4a0104240cae80be,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_ED25519_2_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x73a477044148e2e20f8e6b94,
                    limb1: 0xaffb6ad5647343386bfc09c1,
                    limb2: 0x4a1177b94b4b564c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x294e5c6a2dbe6da2e7828741,
                    limb1: 0x9ef2e2698aaf40285e97c76c,
                    limb2: 0x46f8d85aae4829d1,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x73a477044148e2e20f8e6b94,
                    limb1: 0xaffb6ad5647343386bfc09c1,
                    limb2: 0x4a1177b94b4b564c,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x294e5c6a2dbe6da2e7828741,
                    limb1: 0x9ef2e2698aaf40285e97c76c,
                    limb2: 0x46f8d85aae4829d1,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xd48457dff3254f2d47595b016c835975, high: 0x20672622b7bde99878f40ed2c805ac7
            },
            u256 {
                low: 0x627b9de79ae445e08b1dc2f8cbf1f93c, high: 0x9f6f8774408c04c6f446806c1378e75
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xd1170c5f65e004a05341693e,
                limb1: 0x506becba8e63637a1523e231,
                limb2: 0x50ddd5788eebe794,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x7df8a44bee438dcf4b413bba,
                limb1: 0xf14bf965123669b6b77f2069,
                limb2: 0x5c074b0f25fde117,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xdbe615b09089abfefaa963f9,
                limb1: 0x73f1c8a5eb115e1a0bb360ac,
                limb2: 0x14c610c996e6dca1,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xd2baf9e383031f5b1d5e703a,
                limb1: 0xecc6983fb3966eb4e5032231,
                limb2: 0x1bce868a5d7b1022,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x129630bca95bc7dce90bfe04,
                limb1: 0x3dad4112d4a673c8dba2551d,
                limb2: 0x214d9a86067e8693,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xb5a79b813f84bbfda0046912,
                limb1: 0xdcb601ce2c7d507ebd9cccc1,
                limb2: 0x173cb7009da57152,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xd526a88a7780e77a91fde1f,
                    limb1: 0x18aedc6aafab53dbefe242ea,
                    limb2: 0x4cd17b8afa49d2eb,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc7922610477054260c78042f,
                    limb1: 0xffffffffffffffffd3085702,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xe149ec7ddbb8ab361f9be7a3,
                    limb1: 0xf79ab42c2eac37250e4fdf24,
                    limb2: 0x1096fca3d4b79975,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xbb447c9c58d7187d9d302b08,
                    limb1: 0xff98a8700d29594d7ee0140c,
                    limb2: 0x6510b2ce25c8c21e,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x72dd0258c8ba6acb26db86bd,
                    limb1: 0x3b3f456bfcc1eef3a818d0b9,
                    limb2: 0x6f96b9ab0e53b518,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1c30005038a69a846b58386e,
                    limb1: 0x3c438ccd94c5fef5cb847aec,
                    limb2: 0x4239afcb8aa7bc92,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xea6a1a35664d387b9078456e,
                    limb1: 0x8dd05c45bcde93d093445ece,
                    limb2: 0x7ca695c0da16906d,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xc0c2acbb756d7b2416f99f69,
                    limb1: 0x562707c08992a4f27a536f13,
                    limb2: 0x2c2ea43d66f795,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfdd66f6bf105600dbb2d88f2,
                    limb1: 0x9bcc28230687d6a7a33ae668,
                    limb2: 0xc7a296534e6726a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xce96d84a2fb806d4ee9e2984,
                    limb1: 0xbf9a832b65fc48632b9945cd,
                    limb2: 0x1b30700e2f870aa0,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xedef1775882a8cc51857fed0,
                    limb1: 0x29329539902774fb7a089581,
                    limb2: 0x6de5a9777a71585c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xbb447c9c58d7187d9d302b08,
                    limb1: 0xff98a8700d29594d7ee0140c,
                    limb2: 0x6510b2ce25c8c21e,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x5711fe6ef484472f92efeeda,
                    limb1: 0xcb959f6397431a0de1a4d185,
                    limb2: 0x551885df628232c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x88def24128ac8149a6841a7d,
                    limb1: 0x5247741,
                    limb2: 0x4000000000000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x17359890119c1f19c4f33565,
                    limb1: 0xc76ed6be93a63db181d119b3,
                    limb2: 0x6883cc61b8620377,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb075734b2e2d711ef5c83060,
                    limb1: 0xdc12cc84b07b5ead88509591,
                    limb2: 0x2128777d1dcdcd11,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x4d42a3dbbf7738a17487b0ee,
                    limb1: 0xca19c2a0cfc9398a8c8d4400,
                    limb2: 0x2a7de712ff4676da,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x220b63ba5653124627a1efcf,
                    limb1: 0xe16ee290c3ba0ae8400e7b7d,
                    limb2: 0x5146569fd2502354,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5b8181176386654bf9614ecb,
                    limb1: 0x9654276e5c1183c36c956d30,
                    limb2: 0x1bd9f5bcafde9616,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xcf62f74426799366fb5d63a,
                    limb1: 0x4daebafe72eb7ab1bcacb2c,
                    limb2: 0x5e00247c241d952f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x467414786a46ac4f7cbcd857,
                    limb1: 0x99fcf0cabae5295391622fbd,
                    limb2: 0x3a80fbc896f42177,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1bac710ba32dbf0ac3fe059b,
                    limb1: 0x7d502d4b3edad3b26df64e92,
                    limb2: 0x80adb1e683c37ab,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x23dac387be0e00a8bdaf4ca5,
                    limb1: 0xf906b7cbf5217b87ed89d010,
                    limb2: 0x45d279355e1bc25d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb075734b2e2d711ef5c83060,
                    limb1: 0xdc12cc84b07b5ead88509591,
                    limb2: 0x2128777d1dcdcd11,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x575c9f11ba33aa79f32e6cd9,
                    limb1: 0x26ad791fc4a5b885ed8b5166,
                    limb2: 0x5283f71d71924909,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24e7c4a265c,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x3fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xe647cb1173b2bd4c8be255dd,
                    limb1: 0x440384b834e143e8eaaee4d5,
                    limb2: 0x2a46befc8c3c87a2,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1183b992c61a8c241c4a9df0,
                    limb1: 0x4e60f64740482e1d18aa4a36,
                    limb2: 0x49ec54b0629a9ccb,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xa78445d5a7be9260c5e45a2e,
                    limb1: 0x1d983e2dc299b2b1ca9d2142,
                    limb2: 0x28c2fa6a1b01cc83,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe040808689d5eb07e138c15,
                    limb1: 0xc63887be18f5631e3cc917d,
                    limb2: 0x6af6b94d0db74397,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x748810312e1d73c3482829dd,
                    limb1: 0xed92e6c95cb83e72c8aedb65,
                    limb2: 0x30f2f689fc049a94,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x4e2b51cd88d2831de6bfb394,
                    limb1: 0xca654a1d5806b2e0c88aa3b3,
                    limb2: 0x1814bdb4dbd1c553,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2fc5fc91b192c76d8c03aab0,
                    limb1: 0x223fa37fe6cf3cb97a8c8604,
                    limb2: 0x1252b0e8f12f9748,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3ee16b6888be83826d322103,
                    limb1: 0x324d68bfd5c13b236e8ecfd9,
                    limb2: 0x6d178a206b09c9ac,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf2ecf60920249edb849e6d1d,
                    limb1: 0x759b65c5965c81bf56679b32,
                    limb2: 0x7956bd031f64688,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1183b992c61a8c241c4a9df0,
                    limb1: 0x4e60f64740482e1d18aa4a36,
                    limb2: 0x49ec54b0629a9ccb,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xb378e031d00d924820acae5a,
            limb1: 0xabaa0d130247baabfcd4ff00,
            limb2: 0x203a81a69f695f5d,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            4
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x5597d8c451b4e441728bf613,
                    limb1: 0x769bccc980b539bcd7803260,
                    limb2: 0x4f32acabfcc08159,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xb695fbad069535e59f9f753f,
                    limb1: 0x828918db61107bfbd1b107b7,
                    limb2: 0x7a5617e925b72f9d,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_ED25519_3_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x659626548cb00eaac2fe25db,
                    limb1: 0xb2d46d40a742377f92922ac8,
                    limb2: 0x7c36447197750ea8,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x3085839f8a8f5d91aa52f9e3,
                    limb1: 0xbaaca86438b78db331ba6062,
                    limb2: 0xf59582180a9779d,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x659626548cb00eaac2fe25db,
                    limb1: 0xb2d46d40a742377f92922ac8,
                    limb2: 0x7c36447197750ea8,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x3085839f8a8f5d91aa52f9e3,
                    limb1: 0xbaaca86438b78db331ba6062,
                    limb2: 0xf59582180a9779d,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x659626548cb00eaac2fe25db,
                    limb1: 0xb2d46d40a742377f92922ac8,
                    limb2: 0x7c36447197750ea8,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x3085839f8a8f5d91aa52f9e3,
                    limb1: 0xbaaca86438b78db331ba6062,
                    limb2: 0xf59582180a9779d,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x86fadb0e89b1e0d44218ca25f23db306, high: 0xaf3d348fd768f635163de1d8df7a267
            },
            u256 {
                low: 0x6e83a7b2c857d8c3b4a0697630a31251, high: 0x308f00d840fccb2446eceecaa0a679
            },
            u256 {
                low: 0xfb46ed398772c3475cba9be3040464c0, high: 0x6396bd1ae2562ca28948b4cf0fcccc6
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xc913c4b796f5aef42bc73156,
                limb1: 0x33bcb8991ffe03e1e7bd766c,
                limb2: 0x18edd55d10229070,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xd056666ca5782b86afefeed9,
                limb1: 0x1792d73d746c45baadb00e20,
                limb2: 0x3122eb71c2adda30,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x1b06dbd795fa8db25309b199,
                limb1: 0xf97b102c57d92bd78715f924,
                limb2: 0xb3457fb134f8ee2,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xb9167b3cb6b9271f07f51046,
                limb1: 0x60194b9450cb7abe63640549,
                limb2: 0x727070d5ad7971f4,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x7c22430dd9b5bd718d2210e,
                limb1: 0x8c0d452c59ca137d1106c836,
                limb2: 0x44716c79eeb43764,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x385477c56887649c1450da7e,
                limb1: 0xc45d35ce66004c3f9b48e7ed,
                limb2: 0x12e4a4757b3c21dd,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x81815f7743c92bea7758e90c,
                    limb1: 0xfd1acc2a5f0a89f2466fd03d,
                    limb2: 0x53fff02fe0186107,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf91b174d461dc8df297be881,
                    limb1: 0xffffffffffffffffe5802424,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xd760e02d1f6d6ed5dcd54ee0,
                    limb1: 0xb3eb02806ebf701e64f5ebf8,
                    limb2: 0x764559ab50871c69,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd15614f3dc5a4261113aa8a9,
                    limb1: 0x196eda2638bfc49e85b05eca,
                    limb2: 0x6adbe631586860e7,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xdde95b20b66d99fd32ce2c40,
                    limb1: 0x5d5cf9da9b05fdfe0fa5c975,
                    limb2: 0x24cdf3b9d2ac44f6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x16b00090bc346496f0d960d7,
                    limb1: 0x3c0f2085e52b5721106f1d6d,
                    limb2: 0x63ba77c6126a4685,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8627fc0e1d9637927d953223,
                    limb1: 0x13ce63a1f5728d2ab91d447b,
                    limb2: 0x1d4def71cc4587f2,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xad3c93ed4a9bc2b5cb772a6c,
                    limb1: 0x137b6a2632cc27c7cc79b1b8,
                    limb2: 0x7175fbb10aca1beb,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xbfd34c156c97de75122f30a4,
                    limb1: 0xd23b21caa1d2b398b3fcea30,
                    limb2: 0x1050ec0611538e88,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7c101e9e7a707d5a03914e4f,
                    limb1: 0xd3f65b67eb266c01a1dc82f1,
                    limb2: 0x2524f00a61e727a0,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe4060b24cbdf5064d5916620,
                    limb1: 0xe582e38dd03aadf4d0aea255,
                    limb2: 0x5394067ef640db4f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd15614f3dc5a4261113aa8a9,
                    limb1: 0x196eda2638bfc49e85b05eca,
                    limb2: 0x6adbe631586860e7,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x6dac2cc96a01066f3390bc56,
                    limb1: 0x7d647b987ccb1f11c635a200,
                    limb2: 0x5a7821922fe89c2a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x47484386212d67e785442cb8,
                    limb1: 0xb892b08,
                    limb2: 0x4000000000000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xbd5b9eb501881e7107f90e57,
                    limb1: 0xdf5b271e2fbabb8f1490eded,
                    limb2: 0x5c1275aa26d69e87,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7f62fdd3dd5563a2e9f82866,
                    limb1: 0x53b0829300e49ca8e657dc13,
                    limb2: 0x78956393553b6274,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x2aeb7b2f7bf8be1eeb116fe2,
                    limb1: 0x5ecb0fb1b363aa35624b6bde,
                    limb2: 0x7123d65a48bcdf82,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf7b8e54dd3a3e147b271e5df,
                    limb1: 0xe248a231a571079e5aa8c87f,
                    limb2: 0x313f6b032b504309,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x772b32a3c7fb30ecfda25b6,
                    limb1: 0x63344823c6032b240591f097,
                    limb2: 0x7c3d59de77b53787,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x25c59540e0e0ec2bfef6f40d,
                    limb1: 0x27560cc26b497f48fb545744,
                    limb2: 0x528e62af97626ffc,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2b4f2318b0a599e1e3664f19,
                    limb1: 0x57da1867eb35116f2a21e3,
                    limb2: 0x19ed1c09f4525103,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc9cb57ae9d2a32f70b096d5d,
                    limb1: 0x80d175f19ad53d12ba5ae577,
                    limb2: 0x7bfb313dba254b8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xca00c9acadfa000000b52597,
                    limb1: 0x10f3082b9135f9658049a44a,
                    limb2: 0x3961227dcc905d6e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7f62fdd3dd5563a2e9f82866,
                    limb1: 0x53b0829300e49ca8e657dc13,
                    limb2: 0x78956393553b6274,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x6a3255fcd6b6a66a200f774f,
                    limb1: 0xafb32e9e300a59f33968f0cd,
                    limb2: 0x12264d75b84b0ffa,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24e7c4a265c,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x3fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xcb7da836a8249d0150fdae60,
                    limb1: 0xc277c9395aa20d0a54f6dd9a,
                    limb2: 0xc189784eb06c0b6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xdd36fff78c6a167694242d46,
                    limb1: 0x7a77aaa74e5cc0ab67e33ea5,
                    limb2: 0x305a3b8afdfc39b8,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xbc83c6df7a3b141f80f3d4d0,
                    limb1: 0x26c31335f368c967d4494220,
                    limb2: 0x3f47efc2a1dea356,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x248194df5edf604074a3f0f4,
                    limb1: 0x83f1c1a0508651a7c59ea149,
                    limb2: 0x4072192a6c807d7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe8a201bb06971ea33d008692,
                    limb1: 0xed3bef0bba3b86a87a4ccd02,
                    limb2: 0x6e5c56a4ffce9566,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xe49557bdad093961974c9737,
                    limb1: 0x97a633e99f0153d56f049ef9,
                    limb2: 0x5818d31af1ee2cc1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x14c2abbb6037225fdd7acd66,
                    limb1: 0x1b138263427155dcbf6e7807,
                    limb2: 0x4bec964cdf069fcf,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x32e69467ecdfb4d2ab030de7,
                    limb1: 0x6c3b4c0bce6ac0e0607adcc6,
                    limb2: 0x6b7b86739d015ebe,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd822d32e54967e9049b9c58d,
                    limb1: 0xf40faa46bc1d4ae0c0af93f7,
                    limb2: 0x6967445890c07f9c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xdd36fff78c6a167694242d46,
                    limb1: 0x7a77aaa74e5cc0ab67e33ea5,
                    limb2: 0x305a3b8afdfc39b8,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x782e3f300f862fe8e1645c13,
            limb1: 0x30cb0c26667849aff350620b,
            limb2: 0x234d420cd10fc570,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0xbc465c4bd38dbf7a97fdd5dc,
                limb1: 0x1d276c4c3d0210e4454a50fe,
                limb2: 0x3bb975474b354701,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            4
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x417f4fd9cb3163b629cbf8a7,
                    limb1: 0x79c3e24507cb87b83108f7c8,
                    limb2: 0x1320d4545d644582,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x7a0a2e9c12c2486fd15f878e,
                    limb1: 0x21eb31f02446ce68b43df165,
                    limb2: 0xd77f4b82df60c80,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_ED25519_4_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x4c75c47a191e576b0e79f84d,
                    limb1: 0xb48876d50b5ab6c4209090d0,
                    limb2: 0x71dedbc0f8ea820d,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x757ce19faa909feb9eb48860,
                    limb1: 0x1bc4fc758aab74e665426e51,
                    limb2: 0x561d6ce1c4d80369,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x4c75c47a191e576b0e79f84d,
                    limb1: 0xb48876d50b5ab6c4209090d0,
                    limb2: 0x71dedbc0f8ea820d,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x757ce19faa909feb9eb48860,
                    limb1: 0x1bc4fc758aab74e665426e51,
                    limb2: 0x561d6ce1c4d80369,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x4c75c47a191e576b0e79f84d,
                    limb1: 0xb48876d50b5ab6c4209090d0,
                    limb2: 0x71dedbc0f8ea820d,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x757ce19faa909feb9eb48860,
                    limb1: 0x1bc4fc758aab74e665426e51,
                    limb2: 0x561d6ce1c4d80369,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x4c75c47a191e576b0e79f84d,
                    limb1: 0xb48876d50b5ab6c4209090d0,
                    limb2: 0x71dedbc0f8ea820d,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x757ce19faa909feb9eb48860,
                    limb1: 0x1bc4fc758aab74e665426e51,
                    limb2: 0x561d6ce1c4d80369,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x70c455a92a1bc11230331476f53fc3dd, high: 0xda7e966ed9081c110b2e6e5ec6e61bd
            },
            u256 {
                low: 0x53e836639c14940d5b2d81ccc602bd20, high: 0xfc2b54507b6e28f4e98ce2517337a7c
            },
            u256 {
                low: 0x33e9e55e402492a3c334f55802cee581, high: 0xdf0887262f9dbb265dcac6cc329870a
            },
            u256 {
                low: 0x14dc01bc0aa5658322a5a421858da7da, high: 0xb8d7cb258f16c91dd6d47e490e0172f
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x2f9aa6ba35c7d0c066c1e527,
                limb1: 0xe6e0ab5531989440c7d4dd6b,
                limb2: 0x955f87204ec7100,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xfc8a577aeb126336c9f784bf,
                limb1: 0x93ab1a421590bd1411c0ac3b,
                limb2: 0x4833269ec4e48f2d,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xd2ec1196bcc2a64ee00937dc,
                limb1: 0xfe23ff1f6a81acd865a69ecc,
                limb2: 0xce5bb85df547f92,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xf081dce157fc6c87c9b434ec,
                limb1: 0x19d5cfaa7069c5ee9cbd3bf0,
                limb2: 0x12dafa741df8d55f,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0xd2e4c05f0d97a60e4cc8475c,
                limb1: 0x93923d150e51badc8f297f02,
                limb2: 0xae1d3882c80b5bc,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xd03f661aeaf0e32e701b4800,
                limb1: 0xc156adaf0cf29f2245484a28,
                limb2: 0x29bd510216335680,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x58127b7e54b61ff258577d0d,
                    limb1: 0xa7a74d470a2cd2221132e065,
                    limb2: 0xf36b62346afb224,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xba62923c33309801f862eeaf,
                    limb1: 0x45cb7bfa,
                    limb2: 0x4000000000000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x581230ba235bdaa60931bd90,
                    limb1: 0x3b3fc16a5f1ac80f458bc577,
                    limb2: 0x4f4a9a005f670d47,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x83ef94cbb119d7d48ac42279,
                    limb1: 0x6496ddd5c30cb4fb179a91c4,
                    limb2: 0x4cb2bcd02290cf1,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x9b52c84b7e42a265b311f081,
                    limb1: 0xc58138d90704d9abb9fad808,
                    limb2: 0x7eea959970ec507a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa0f109e72064da497884dba0,
                    limb1: 0xe50bbbbc48ffea2d8c0a4de8,
                    limb2: 0x6aaeafa43fe8d6fb,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x862cdf5dd7af636595d278bc,
                    limb1: 0x969d95b9add6b105fd362ff3,
                    limb2: 0x14666f524927d168,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xca10b9873077785f25b8024d,
                    limb1: 0xd235d61f8b45e01a87dc9c3c,
                    limb2: 0x3ec1be31b99840b2,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe5bd13955853650bb9170cd4,
                    limb1: 0xc6d0848f036bebe726dbdb3d,
                    limb2: 0x5571f2e37b730f33,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa47bc8ee62b93e621a3a7d87,
                    limb1: 0x3906c936a801fd3f5ed65ee0,
                    limb2: 0x17011dc623f3d6c6,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x64b75bb1cfcdbc3501edd4d0,
                    limb1: 0x6cd7a277c09605e5b1447bd4,
                    limb2: 0x2c9946d40520cc2d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x83ef94cbb119d7d48ac42279,
                    limb1: 0x6496ddd5c30cb4fb179a91c4,
                    limb2: 0x4cb2bcd02290cf1,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x445d14cdd754b23852e83bd8,
                    limb1: 0xda7b8f0adfa8a980c24a275,
                    limb2: 0x9a156647c95837a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe63b8d0023eb1f8b1726e19b,
                    limb1: 0x1913bf5d,
                    limb2: 0x4000000000000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xd30571b7bb794164a43d6471,
                    limb1: 0xfdfbcd0dce4245f807989b63,
                    limb2: 0x5441f0429f6bdbf5,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe09e29ef2a1f0246117ccfc4,
                    limb1: 0x4d538a0b8a239c6379c8d062,
                    limb2: 0x13b68b927c0fe5f,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x7883d193100e47c69dac1395,
                    limb1: 0x1db951aab2409b04a75782b7,
                    limb2: 0x719941976a09076,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6f926042beecf3d144d72128,
                    limb1: 0xf195c7d3ad6507054fd93a4,
                    limb2: 0x4e7686619b8dbd2c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfd844fbd3b0f8e721f162411,
                    limb1: 0x31b038646de856667cedfd73,
                    limb2: 0x7d7c553d4f046675,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x4498856ea9928944aab80ee8,
                    limb1: 0xc7a9d8b28fb583dab8efd8cf,
                    limb2: 0x60e633481556a9d8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8736bce514dde62e962352cf,
                    limb1: 0x83119ad532757d247666159f,
                    limb2: 0xfb059ef243dd313,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x721c0ab547440ee772614837,
                    limb1: 0xbaa96f7e82c08ac83a773c7d,
                    limb2: 0x6b971a392889c6bb,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xdfaa9caf67eb22f39cf97bb1,
                    limb1: 0x2f93ae1b2fbd83ce735151c0,
                    limb2: 0x31909d1645259adc,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe09e29ef2a1f0246117ccfc4,
                    limb1: 0x4d538a0b8a239c6379c8d062,
                    limb2: 0x13b68b927c0fe5f,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xabdef6b56255c13609755ecb,
                    limb1: 0xf535095834011963a1afd0f5,
                    limb2: 0x7074ea0b51e968e5,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24e7c4a265c,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x3fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xdafe82a125477936c99a35e1,
                    limb1: 0x99283b4bc9f10207ee6d0171,
                    limb2: 0x2e16327fe9f080cf,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5a2f2e0a35a5b3a2d32e80b5,
                    limb1: 0x6e49c3cb872c984b0b2fe230,
                    limb2: 0x683870f1f42acab0,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xbb668aed71b252bb9ba79685,
                    limb1: 0x992ba1db10775fb191e5f8b9,
                    limb2: 0x418e33623b3cd281,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x86ee3f4b2748196ff4a55b7c,
                    limb1: 0xbea3a58c801673425427c0c6,
                    limb2: 0x773df26c411127a0,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe35039d12e89f3f0a5939e62,
                    limb1: 0x208be5e5de94cab1161c5ce1,
                    limb2: 0x32abd388ed1da3ef,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x5e31f40c83a2e2bba681a7a2,
                    limb1: 0x3a7a417c62e01faa9ee28766,
                    limb2: 0x66afb796fe239588,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x321acee3c9567b334374d7fc,
                    limb1: 0x90a94139ba39a3c00e85fd37,
                    limb2: 0x8a136881ab8a967,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe7e0a78d60eac8b466ed516,
                    limb1: 0xbfd2ae80148d0ebbac37a761,
                    limb2: 0xd014f45e1e62b5f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe7a3ad98d1b95ac5c2564d21,
                    limb1: 0xcac01c592b6c3fde5a25b7ce,
                    limb2: 0xb64df538faa3fb5,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5a2f2e0a35a5b3a2d32e80b5,
                    limb1: 0x6e49c3cb872c984b0b2fe230,
                    limb2: 0x683870f1f42acab0,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xf4b11094a400e6c1616424a5,
            limb1: 0x4e7d629890f5c1c7d29b93c7,
            limb2: 0x5b9372c082fcd63,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0x2ddba824c6120e2c398b6ca6,
                limb1: 0xc0e362d309d934647bbdc92d,
                limb2: 0x1be5d6c7e9d4cb48,
                limb3: 0x0
            },
            u384 {
                limb0: 0x3724deed2fb326e12faa932d,
                limb1: 0x9b485c3830931f966396ea1f,
                limb2: 0x3e54e7935458a182,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            4
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x29c5ca763cfbfbb5c99de85,
                    limb1: 0x290f51b73db7b7403c0e87cf,
                    limb2: 0x57eb0851d615f06d,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x4ee5e1d00059e0964a071a80,
                    limb1: 0xddf0e712fa447a439f0c6775,
                    limb2: 0x8318ab616fac9d3,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_ED25519_5_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xac0e78abc7a930a046e598eb,
                    limb1: 0xe1701e441e2f0b59640037e3,
                    limb2: 0x4a7798c90d8ef633,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd0ebc2e21c0d5bb3df518aae,
                    limb1: 0xbc37d3b636d00b80df996438,
                    limb2: 0x6979bdb671fcf988,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xac0e78abc7a930a046e598eb,
                    limb1: 0xe1701e441e2f0b59640037e3,
                    limb2: 0x4a7798c90d8ef633,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd0ebc2e21c0d5bb3df518aae,
                    limb1: 0xbc37d3b636d00b80df996438,
                    limb2: 0x6979bdb671fcf988,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xac0e78abc7a930a046e598eb,
                    limb1: 0xe1701e441e2f0b59640037e3,
                    limb2: 0x4a7798c90d8ef633,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd0ebc2e21c0d5bb3df518aae,
                    limb1: 0xbc37d3b636d00b80df996438,
                    limb2: 0x6979bdb671fcf988,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xac0e78abc7a930a046e598eb,
                    limb1: 0xe1701e441e2f0b59640037e3,
                    limb2: 0x4a7798c90d8ef633,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd0ebc2e21c0d5bb3df518aae,
                    limb1: 0xbc37d3b636d00b80df996438,
                    limb2: 0x6979bdb671fcf988,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xac0e78abc7a930a046e598eb,
                    limb1: 0xe1701e441e2f0b59640037e3,
                    limb2: 0x4a7798c90d8ef633,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0xd0ebc2e21c0d5bb3df518aae,
                    limb1: 0xbc37d3b636d00b80df996438,
                    limb2: 0x6979bdb671fcf988,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xd763b159ed9a189a50852f4f0b09ec41, high: 0xcffd9cf1ff06dcf45aa79bd855fb35
            },
            u256 {
                low: 0xe8f58c5dffa0841974dbcc40ef7dee1a, high: 0xe5cc62de6710ad2c1b5468a27bb1580
            },
            u256 {
                low: 0x50eaa1d2c1f8190be55e44b808a6d5b4, high: 0x62c21671257363cf25dcb50d15b5985
            },
            u256 {
                low: 0x1519401c8b1f11370ea255e08e50c79a, high: 0x14280557e7ef7b848610cfd21276c2
            },
            u256 {
                low: 0x22d801701e6cbd83a2f62516dc88b09c, high: 0x5d7da6f05d156b6eceec38d511fcda9
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x73d6c4a658bd07f8d09dd1f3,
                limb1: 0xb731c57d22244b8d2c303147,
                limb2: 0x64b2bf2891b49114,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x4fc76bcda11cc2ab684da961,
                limb1: 0xef8bc850c908566d6ad6b55e,
                limb2: 0x50ea415e91eb6715,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xcf24f485ee851e2ce5b19644,
                limb1: 0xa26c8d9b50b1cfc62ea70632,
                limb2: 0x1f5b871edbe7530b,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xfdf7c3f0cd9e75c74a54bce9,
                limb1: 0xd139c74c8b2739bfdf732e37,
                limb2: 0x4c28edde1e98c68a,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x35eef799908d7bee308e9415,
                limb1: 0x58d0ebadcac6b9ba73b30fcb,
                limb2: 0x3777df395b6d42dc,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xed719f59ebaab5539260db29,
                limb1: 0x3f9e2fc5c4efaae8c69b356e,
                limb2: 0x1de672dbd825c58,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x933e317d952b6707b2670a58,
                    limb1: 0xcf77e0dd7cbb76a02cb17048,
                    limb2: 0x271380d588204a79,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa6b2cb14b5544ea973711213,
                    limb1: 0xffffffffffffffff34358751,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xb437d0738081df3f703c46cb,
                    limb1: 0x906b76fe944429b613b40c26,
                    limb2: 0x591a636296ae41e7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe01ac2addf99c766e87c94fc,
                    limb1: 0x675e1c3ebfaca9196fcf96d4,
                    limb2: 0x50d5a80e60bc78b7,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xd96924b8c7adc793a85ed117,
                    limb1: 0x877940e45d1dd7386634dfcf,
                    limb2: 0x48b9c5c95c211021,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb894d4beebb7383ebf4fa6e9,
                    limb1: 0xf5d5b38196196da8b88ad68,
                    limb2: 0x6749d428071317a3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x727caebf4304c2ae8a948b78,
                    limb1: 0x5d37edf2beaf94f22140faa8,
                    limb2: 0x6bed0e8813293e39,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xd4b7ca053e1f70a57ece4b7e,
                    limb1: 0xcd25e248373ea17bc934e6d0,
                    limb2: 0x7b2a5fa50e86e16d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x665e9490a2728882347842c,
                    limb1: 0xe38fb856ee956cb0f7487abd,
                    limb2: 0x3ede1ef5769a54cf,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xda2af0b0c0ef95282409d877,
                    limb1: 0x6e2a772fb909fcabab4ac767,
                    limb2: 0x36de0edadf2edc96,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc0dcfb6b2cf3c0ce68f85e0b,
                    limb1: 0xc203580bf5bf678c7f6cc283,
                    limb2: 0x366910363c6800cd,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe01ac2addf99c766e87c94fc,
                    limb1: 0x675e1c3ebfaca9196fcf96d4,
                    limb2: 0x50d5a80e60bc78b7,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x2c10365e754620c44872efe5,
                    limb1: 0xdf9cd90497cbf5fae8e2041,
                    limb2: 0x7d153a8215da970c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x277e4db0f397fe7b9b9fd637, limb1: 0x42fafc2, limb2: 0x0, limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x2381e084ca1a95383e0bbf2,
                    limb1: 0xa63e64b871103b89677d1a49,
                    limb2: 0x65ce09ad52d2ed2c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x84cc92ce49d1b132d368d0be,
                    limb1: 0x7c235420911f24e06d58c1e9,
                    limb2: 0x162ce0181689b6c0,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x738d341a535bfe728488fa62,
                    limb1: 0x8d80b13b47a34f53dc4c492e,
                    limb2: 0x71448b3cb1a9b4cd,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x414314aedded0b0da90c8875,
                    limb1: 0x67f37e8c7e6d8426808409a8,
                    limb2: 0x48cf526306bda964,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb07ba3309869fd0284730e05,
                    limb1: 0x7a5a9cf8256451cc740f1e0d,
                    limb2: 0x18f1adf2f3141cdd,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xfe90c6d76ddb621af52e9f08,
                    limb1: 0xec945d64d58abcc2b7461881,
                    limb2: 0xe1d03474f64b4be,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1c95b17367de43ce7ad0386,
                    limb1: 0xc25be13c6f664773fc86bf3b,
                    limb2: 0x2e9d94cc3d900c86,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xbcc1479f687329de0b6fd9c0,
                    limb1: 0x97d0c33e55f57cd1192fd2f4,
                    limb2: 0xeec5e5e458e4312,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xedd48fff9138ae27c9cd332,
                    limb1: 0xd7d645c5d28b795fd335d0a6,
                    limb2: 0x431cb680f88cac12,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x84cc92ce49d1b132d368d0be,
                    limb1: 0x7c235420911f24e06d58c1e9,
                    limb2: 0x162ce0181689b6c0,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xcd504c5b8e8b1085721eb828,
                    limb1: 0x4babe3cbf2d9c20bd1e1e00c,
                    limb2: 0x59347b6d30d2d256,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24e7c4a265c,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x3fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x5b818507e8674c38fbdc97fb,
                    limb1: 0x82a8bb1123c4709d7eaf9d1,
                    limb2: 0x700499528aa5e366,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfaec13e080ed65e4e9bfd594,
                    limb1: 0x4c286b6e487767f5da5ea01,
                    limb2: 0x292c99a7c8ab6a18,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xc37232d4fa032fcace0b7f09,
                    limb1: 0x4d596f2d9c0c3eb70f18a618,
                    limb2: 0x1d98901eaa552e20,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x99f3b10c75af78794ac61513,
                    limb1: 0xc4682cb7ffccb2f2ee01641f,
                    limb2: 0x6f0cdc1bafc4ea77,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xec2d163910ec8fc8114ce88,
                    limb1: 0xd2c2c1e8a432782c3944aae4,
                    limb2: 0x52b7bde472b1bd96,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xbad711975bbc92e7511f6483,
                    limb1: 0xf5a36b81f039653887093bd3,
                    limb2: 0x16097f59a4d8f2a2,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x8f2077eac400e2892331bc8,
                    limb1: 0x41eeaedb2ff40cda2fde0726,
                    limb2: 0xfaae9cfcc100813,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa83783b33e7c93a34faefbb0,
                    limb1: 0xf41dd493ad28bb0c35540c48,
                    limb2: 0xffec64f0873e17b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6826afff94d92dc7f498af3b,
                    limb1: 0x39c26cbe73b784e043a3b02e,
                    limb2: 0x4d534626305fa24c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xfaec13e080ed65e4e9bfd594,
                    limb1: 0x4c286b6e487767f5da5ea01,
                    limb2: 0x292c99a7c8ab6a18,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xac4da7e6ed2150bb3c93d258,
            limb1: 0xbb2b603b4a1f642669565df4,
            limb2: 0x2f90181d34d79394,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0xe9f9aae59a1a75c3ce48feff,
                limb1: 0x836f9810276e4683402c24fa,
                limb2: 0x3220ee14e7b1917e,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            4
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x4ebc01a3031acb33e416875c,
                    limb1: 0x5a32353f724004dc34edbf20,
                    limb2: 0x51509a1fdecbd24a,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x46c687d8fae646e6508969da,
                    limb1: 0x8510c27b6fd49bd6502335ce,
                    limb2: 0x24c6e25e90f4eb53,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_ED25519_6_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x2947c58af21cfefb16f6ec9,
                    limb1: 0xaac4a2e4db9619c71fade545,
                    limb2: 0x41cee4e716487633,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x282c88a77eed2e3488f8ad5,
                    limb1: 0x3472744a5cd220eb5deefc41,
                    limb2: 0x7ff87052dd66b575,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x2947c58af21cfefb16f6ec9,
                    limb1: 0xaac4a2e4db9619c71fade545,
                    limb2: 0x41cee4e716487633,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x282c88a77eed2e3488f8ad5,
                    limb1: 0x3472744a5cd220eb5deefc41,
                    limb2: 0x7ff87052dd66b575,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x2947c58af21cfefb16f6ec9,
                    limb1: 0xaac4a2e4db9619c71fade545,
                    limb2: 0x41cee4e716487633,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x282c88a77eed2e3488f8ad5,
                    limb1: 0x3472744a5cd220eb5deefc41,
                    limb2: 0x7ff87052dd66b575,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x2947c58af21cfefb16f6ec9,
                    limb1: 0xaac4a2e4db9619c71fade545,
                    limb2: 0x41cee4e716487633,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x282c88a77eed2e3488f8ad5,
                    limb1: 0x3472744a5cd220eb5deefc41,
                    limb2: 0x7ff87052dd66b575,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x2947c58af21cfefb16f6ec9,
                    limb1: 0xaac4a2e4db9619c71fade545,
                    limb2: 0x41cee4e716487633,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x282c88a77eed2e3488f8ad5,
                    limb1: 0x3472744a5cd220eb5deefc41,
                    limb2: 0x7ff87052dd66b575,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x2947c58af21cfefb16f6ec9,
                    limb1: 0xaac4a2e4db9619c71fade545,
                    limb2: 0x41cee4e716487633,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x282c88a77eed2e3488f8ad5,
                    limb1: 0x3472744a5cd220eb5deefc41,
                    limb2: 0x7ff87052dd66b575,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x2e4025346987b05274219d3ecdc39412, high: 0x873e970cd6a5e0c7427965607db34e0
            },
            u256 {
                low: 0x106861d3633d9c54f30459cc30c42d61, high: 0xd6856d1f94e3c818a775945b8c4949
            },
            u256 {
                low: 0xdba45b5e1498665b79fe0a1b7efbe877, high: 0xcdca2ecdcb32e4a891dfa7b0d3dc6aa
            },
            u256 {
                low: 0x1480f037d39a4bb0d62b68d41880fa4b, high: 0x326cbecf484878d5bc9e8895567a84c
            },
            u256 {
                low: 0x291a58af259a2b28b22b89748c5c192f, high: 0x5165337ebbe1a41c781e11f2cb38568
            },
            u256 {
                low: 0xf172840f3e19d0baae09ccfba3dee81f, high: 0xa81311c9fed6060ef23d4afe0ff58a5
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x19dd6c57d118303666453572,
                limb1: 0xb6ce75075cd2706969c41ad,
                limb2: 0x70db2a6cd43a55d0,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xfc87c789241e3df2c5570613,
                limb1: 0xe1848ae81a06b8027b31c65d,
                limb2: 0x5ce487cc40f84448,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x31a68a3e628c5979ca298e6c,
                limb1: 0x8f444b7e9db88838ab7bb397,
                limb2: 0xa3e9895d0cb3040,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xcfc81d51a50ef6bfafca8473,
                limb1: 0x5464a7b4186aeca82c73b315,
                limb2: 0x2b916e5502721a9c,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0xfe6e4ceb79793ee084ece7ea,
                limb1: 0xf0caa2895fa12f5cdaee4b60,
                limb2: 0x7dfa49b30bd498a5,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x5ded841772ee9174301183bc,
                limb1: 0x9da63c5a6dd8eac5312c030b,
                limb2: 0x552eb54813de02f2,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xd3d81966b96054a1a681aa1,
                    limb1: 0x8e3e8e79dd673b7b7a38c643,
                    limb2: 0x6f1f5ac3696ab782,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xbfb894850e020123c9e5bb64,
                    limb1: 0xfffffffffffffffee5d42e88,
                    limb2: 0x7fffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0xa888718a7823acdc8780887c,
                    limb1: 0xcb4810621a5786e79a975fd1,
                    limb2: 0x52466a86276e3f2,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe38e174f7fc5ffd9e84b5b9f,
                    limb1: 0x49ce75caae9cbf3249b5d90d,
                    limb2: 0x4d55f0ac157d33fc,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xc898fb0b36401e6f16ae4785,
                    limb1: 0x4839cadf9e7e57a4bd893a46,
                    limb2: 0x2f626ec3ae724d42,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xdc0a0a4818d520e53921b15,
                    limb1: 0xc29776f63f048274380e19f2,
                    limb2: 0x228eb8c968234269,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3070d811be6edc7eb377544d,
                    limb1: 0xfd5fa8c4b6958d892f58d897,
                    limb2: 0x7aba01d16a627af8,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xa3934e1f40ebc9b5b4e3613f,
                    limb1: 0x77d47cb79d07aa2a0ae334af,
                    limb2: 0x1268fff3186a36f1,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc15f6b8637a1cca6d6e9a755,
                    limb1: 0x4699ca1e18b2f0541d9cc56c,
                    limb2: 0x515e60230831cf0f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb06ff47478886da35ffa3cef,
                    limb1: 0xcea13c5fba8c1650329b13b,
                    limb2: 0xf248ba55d59e781,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb52d9c8224958e6b803c9fa9,
                    limb1: 0xfcdff16f7bd2c4be0650162e,
                    limb2: 0x6273137c0830a2d8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xe38e174f7fc5ffd9e84b5b9f,
                    limb1: 0x49ce75caae9cbf3249b5d90d,
                    limb2: 0x4d55f0ac157d33fc,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x7feb8ee2e5b3ce3f1a7ac78a,
                    limb1: 0xd8a18902ade1bb4c84077b78,
                    limb2: 0x47d240f7b323cca9,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x3bdbf75a5f1bafe26d2f75ac,
                    limb1: 0xe00d882,
                    limb2: 0x4000000000000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x39e7daee22de287874db5058,
                    limb1: 0x71a6aa4ca664279fe8cf1888,
                    limb2: 0x5c0ea03a84199cee,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xcbc4f968ee51d696846702b8,
                    limb1: 0xc5f7119c86b15e0034d66723,
                    limb2: 0x33f2828318ec598b,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x1f18adb32d6be0033808e72,
                    limb1: 0x60d8b586e988298705112f7a,
                    limb2: 0x67e4ac1df51d9a05,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x77eb5551eb0d56a62b3ed5a8,
                    limb1: 0x3140e7545d0c2e8af212fc99,
                    limb2: 0x6374f958074fcbea,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xeffd0d1dd767c69b750e3927,
                    limb1: 0xbffd08cbc0f41356dadad90c,
                    limb2: 0x7cfd983f5797e654,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x4327baeb1c99df022ac6407a,
                    limb1: 0x4f8871d1561916dec145e294,
                    limb2: 0x13e801106317b001,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7a24d44ce3757af389e1c25f,
                    limb1: 0xa24f40f1c35f69a771b64cc9,
                    limb2: 0x426f4ee693901d07,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x262d46d9d4e68752bcef5cd3,
                    limb1: 0x28b1189a84acd5281ca452a1,
                    limb2: 0x146d8f9086e12cc4,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x468d05e5cf500a076d976798,
                    limb1: 0xa33e8b5a07df65765487cee5,
                    limb2: 0x395d4d0e29d35bd4,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xcbc4f968ee51d696846702b8,
                    limb1: 0xc5f7119c86b15e0034d66723,
                    limb2: 0x33f2828318ec598b,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xbbb46d7553d21b8460954703,
                    limb1: 0x9c1dde3f75c5c0ef63dd6655,
                    limb2: 0x1e75ef151a75663c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24e7c4a265c,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x3fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x53d06211622859c216de83d1,
                    limb1: 0x5f048eb63528b82c4e54e9e4,
                    limb2: 0x5232b53510b3068f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xcfeb28d623fa67a5b0e98984,
                    limb1: 0x7ff111f802a6486a79960107,
                    limb2: 0x77c71db723603719,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xccc5a3316c8bff6528f62c1f,
                    limb1: 0x64b7e8baf39ab3ef573c94ac,
                    limb2: 0x63e28a5423c40bcc,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xaeb1c985e973151fc2e81bf4,
                    limb1: 0x6d954fdd8db1ddb94bca1594,
                    limb2: 0x5cc49ffb70e48acc,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x89169e0442e8772d62499083,
                    limb1: 0xa95fbe5c77afb2964f2668c5,
                    limb2: 0x231928a1eb041350,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xd8167084dcfc9b173583ccc1,
                    limb1: 0x3c9c13d64addcf6b07312a69,
                    limb2: 0x4651a38c49ea2ae,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xf3880033cadcaa6c1be30043,
                    limb1: 0x1cbd3bfc84ae5e92813e98a2,
                    limb2: 0x7f2a8164ab69e63f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xacb53fe3b7a8404e6f9a7785,
                    limb1: 0xdcad3115a79d71aef63b3005,
                    limb2: 0x7131cb0f8b53b2b2,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x60758d090e9a3b510f9a9b11,
                    limb1: 0x909c6fc396a3f602ba0da041,
                    limb2: 0x2f816208b66cc575,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xcfeb28d623fa67a5b0e98984,
                    limb1: 0x7ff111f802a6486a79960107,
                    limb2: 0x77c71db723603719,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0x8638cf9a7108fde4317b1f26,
            limb1: 0xe90a7b511c773f00835dd2f,
            limb2: 0x447105d00a80586,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0xba95b2734eeb275309316815,
                limb1: 0x25bfa2d6ce88b93b060d61c6,
                limb2: 0x199fcdf66662adbd,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            4
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xa3a91b31cef02830cf12f239,
                    limb1: 0x468a2456eea968595d229b37,
                    limb2: 0x5c1f07540a13ab75,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x7de0220480e18c0b1c008163,
                    limb1: 0x9b4515295549022232b0c85b,
                    limb2: 0x292e098dc8444353,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_ED25519_7_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0x25e2646c734a82ce7d63ad2e,
                    limb1: 0xf809a96b62813c6421cc0d57,
                    limb2: 0x7d6159c2f8ad9b4,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x7126f1f76e7897265ebf4cfa,
                    limb1: 0xaa3c3dab3fc9bb13812515bc,
                    limb2: 0x59d7f09ddc9b1fc1,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x25e2646c734a82ce7d63ad2e,
                    limb1: 0xf809a96b62813c6421cc0d57,
                    limb2: 0x7d6159c2f8ad9b4,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x7126f1f76e7897265ebf4cfa,
                    limb1: 0xaa3c3dab3fc9bb13812515bc,
                    limb2: 0x59d7f09ddc9b1fc1,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x25e2646c734a82ce7d63ad2e,
                    limb1: 0xf809a96b62813c6421cc0d57,
                    limb2: 0x7d6159c2f8ad9b4,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x7126f1f76e7897265ebf4cfa,
                    limb1: 0xaa3c3dab3fc9bb13812515bc,
                    limb2: 0x59d7f09ddc9b1fc1,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x25e2646c734a82ce7d63ad2e,
                    limb1: 0xf809a96b62813c6421cc0d57,
                    limb2: 0x7d6159c2f8ad9b4,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x7126f1f76e7897265ebf4cfa,
                    limb1: 0xaa3c3dab3fc9bb13812515bc,
                    limb2: 0x59d7f09ddc9b1fc1,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x25e2646c734a82ce7d63ad2e,
                    limb1: 0xf809a96b62813c6421cc0d57,
                    limb2: 0x7d6159c2f8ad9b4,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x7126f1f76e7897265ebf4cfa,
                    limb1: 0xaa3c3dab3fc9bb13812515bc,
                    limb2: 0x59d7f09ddc9b1fc1,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x25e2646c734a82ce7d63ad2e,
                    limb1: 0xf809a96b62813c6421cc0d57,
                    limb2: 0x7d6159c2f8ad9b4,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x7126f1f76e7897265ebf4cfa,
                    limb1: 0xaa3c3dab3fc9bb13812515bc,
                    limb2: 0x59d7f09ddc9b1fc1,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0x25e2646c734a82ce7d63ad2e,
                    limb1: 0xf809a96b62813c6421cc0d57,
                    limb2: 0x7d6159c2f8ad9b4,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x7126f1f76e7897265ebf4cfa,
                    limb1: 0xaa3c3dab3fc9bb13812515bc,
                    limb2: 0x59d7f09ddc9b1fc1,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0x29e316ad39ddc4775a220eb23cf9d1fe, high: 0xba00ae27680891b6bb6204ee0db22d3
            },
            u256 {
                low: 0x62f252912353d45590bccb66e0631450, high: 0x530420103729e33c5507d2b909e7f78
            },
            u256 {
                low: 0xafdb4e0b01716f1d956a2f20ee283bb7, high: 0x580b70ecd34bcd7b7ed75b463d0fccd
            },
            u256 { low: 0x671493804fe973d261cec19fff83cec, high: 0x1e48c082951fe052c553b5d2f74429 },
            u256 {
                low: 0xecf150e6c6f149c70c15a57509c64c1d, high: 0x4b9ea389c89929692b035e01ca5a2f5
            },
            u256 {
                low: 0xc96ef1a5ac7074642734f9bbc7405255, high: 0xd664ba906c4e109c9a6e611613f718d
            },
            u256 {
                low: 0x37773772829fe7ba5d30db822348e1b7, high: 0x4274d5b12b34a24667fceeb8889832c
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0xed605bd84435bc4a9e7e221f,
                limb1: 0x310cddd98faf880c55dbc5e2,
                limb2: 0x2a11e6c6f5100600,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x9f65f09627ed28831d30be6a,
                limb1: 0x40228d0d400eb5a0509bc89,
                limb2: 0x44060fee41792a9c,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0xfc49076eeed7fc3b551f4243,
                limb1: 0x26ad8b33cd21e539fb0e08f2,
                limb2: 0xfb86a04409f5cb,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x1d1fd2ad3a8adc57eec444a2,
                limb1: 0x8703d217119eeb9fbfcf5fe4,
                limb2: 0x63070d0d1ca1655a,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0x9a8021fafb3f135d4f1d7702,
                limb1: 0x65cdc67a9f2384bb88c13ed6,
                limb2: 0x65c13102d4f6e44b,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xebbfe0ac55e2889f744f2c5b,
                limb1: 0x93882214f31da6e256f4b9fa,
                limb2: 0x3d9c56f013265aa8,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x65a9efe8bcb8a23319355137,
                    limb1: 0x89aba23812704480899ccf20,
                    limb2: 0x51013fe94bddb347,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xc0b653c7a6d856739228515c,
                    limb1: 0xfffffffffffffffebb33edee,
                    limb2: 0x3fffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x9b470ccc38596372bcfbed86,
                    limb1: 0x5fba3dcf90d8046c95d38cca,
                    limb2: 0x5e717bb8dd01c9c2,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xecbd3fbb487fc0e6e41e30a0,
                    limb1: 0xd6e978bb0dcf3b8f88582cc5,
                    limb2: 0x4e18039cdb65204a,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x54c16088d978de7d7e955390,
                    limb1: 0x170f17b2e7423b13af47c026,
                    limb2: 0x71c1e39bed322385,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x69bd1d8567174a8c5c68845,
                    limb1: 0xbaf86444210afcbb4d2ef370,
                    limb2: 0x5bedc3f54feeba83,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x10e920b505e656dad3865748,
                    limb1: 0x5274d1cd558ab67f73da77e3,
                    limb2: 0x43c30a7941697d5b,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x9ec4326814dff18dd50830e9,
                    limb1: 0xf5c1edd335837ee265657e2e,
                    limb2: 0x5e22aa47c8aaf777,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5834f723222477b196daede2,
                    limb1: 0x71d52c9cb5846e415f9a12dc,
                    limb2: 0x29823015fcca682a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9a466fbef7ac16a9da55ee82,
                    limb1: 0xfe61379564d564b7c82c19ca,
                    limb2: 0x9366bd57c9e23e7,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa7ec37c3e4cb4501b5b804c6,
                    limb1: 0x91521edcf2534243018c4327,
                    limb2: 0x3bc0288c82bb88a8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xecbd3fbb487fc0e6e41e30a0,
                    limb1: 0xd6e978bb0dcf3b8f88582cc5,
                    limb2: 0x4e18039cdb65204a,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0xfab949b3ea6f3114b099ee52,
                    limb1: 0x62cbe3df66b1ed04a4882932,
                    limb2: 0x36ba946d3eaf2266,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xbfa3e3fafdc0f890710bc7ee, limb1: 0x64b4fa3, limb2: 0x0, limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x23b9f76b2975fb3b96e321ce,
                    limb1: 0xc47e55d1ddab9a6e4fdee22e,
                    limb2: 0x7539a596d14fba8e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xddd494249ddd80f62d7d107c,
                    limb1: 0xe148cb60d05cde61e325e9b5,
                    limb2: 0x772e63c38c6b307f,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0xbac58ee226a9e69bd5259d52,
                    limb1: 0x3065e86e582d7debe80aa46f,
                    limb2: 0x79b918024e54ffa3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xbd81cd529a613365b62ae66c,
                    limb1: 0x213054d7bd6aba053a8607fe,
                    limb2: 0x7e2c7c0a35735d72,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x85e239e6143cc2dfa868d79b,
                    limb1: 0xb248cfb4a2ebd94bc677ff56,
                    limb2: 0x1ec55599771479be,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xa17e9a7cbdc6d50acff6fbcf,
                    limb1: 0x9127fae866574f8775b0002a,
                    limb2: 0x273ecfc78c0c6e12,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x95c6c6a3401436dcb1749cd8,
                    limb1: 0xcf27b28cc7835426895f2a3a,
                    limb2: 0x449ed4b50fa940f3,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xafac0c99ddb5a3f651bda300,
                    limb1: 0xad930dd346cd0ff1966c4738,
                    limb2: 0x7ed2e5e6cbbe0e0a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x305f2262d5e7dcca8f9f390e,
                    limb1: 0xf61636df3f26d844bb97988b,
                    limb2: 0x5288526a77097974,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xddd494249ddd80f62d7d107c,
                    limb1: 0xe148cb60d05cde61e325e9b5,
                    limb2: 0x772e63c38c6b307f,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x331cc0082c3aa7a6610e859b,
                    limb1: 0xee67a2ad5d81253d6891e931,
                    limb2: 0x5debeeafa36fc922,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24e7c4a265c,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x3fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x8369d2ece755c57c3cd136de,
                    limb1: 0xfe3659f38ff94566c08e575d,
                    limb2: 0x1d3bb16273028b6e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6936d69615e8f0675bc346a8,
                    limb1: 0x7384ae5193ba960a7c30b836,
                    limb2: 0x1943485ce6ff25e9,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x66cef93be1f3e5133ceee3fd,
                    limb1: 0x2b63e851946c31a864c9d498,
                    limb2: 0x1780d9164d72c09f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x862875d2212fcc713ccc4d52,
                    limb1: 0xd666fc061f5899df679f2e03,
                    limb2: 0x4f2ae0cd11a2670c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6bc813e658c3916b23b46488,
                    limb1: 0x2026b0e33a65318bea7614ee,
                    limb2: 0x746e51687f22997d,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x3bdd8c090d4ff6fd1ff34aec,
                    limb1: 0xef49d8fc3620c31b4f542934,
                    limb2: 0x224c2765798a0d53,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x95afbc6b093c6cf2125c304,
                    limb1: 0x22bc8ea0c2ac9e912a25603b,
                    limb2: 0x449137a0c9b41320,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa13292c2180365609cdc44df,
                    limb1: 0xd55db295210b5d8f3c4c3d43,
                    limb2: 0x37b67a7ef38ccffd,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x900efde493c7a70b358d4e0b,
                    limb1: 0x2fce3b00f174833d2c470dba,
                    limb2: 0x7a8a5e3618bc4a55,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6936d69615e8f0675bc346a8,
                    limb1: 0x7384ae5193ba960a7c30b836,
                    limb2: 0x1943485ce6ff25e9,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xb3ae3d68e5bc2de4a2a803e9,
            limb1: 0xa53e65d2190110e6a874d338,
            limb2: 0x1bcb05dd6ee8de4c,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            4
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0x7d748e6ec6641307baf0a99f,
                    limb1: 0x45e43d24ae407832dd8f56f8,
                    limb2: 0x6bd32c7466f5f299,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x782b7c30e6f6c8e0b3d0a0c7,
                    limb1: 0x1f56abeb7fc3c6e3b9bcac8f,
                    limb2: 0x1916be786dad59bd,
                    limb3: 0x0
                }
            }
        );
    }


    #[test]
    fn test_msm_ED25519_8_points() {
        let points = array![
            G1Point {
                x: u384 {
                    limb0: 0xedb668e911a46c44c6928c18,
                    limb1: 0x65ef9a35399a64463b47c656,
                    limb2: 0x1527971213a94d75,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x5b80b3e0c3605d6628fe3b58,
                    limb1: 0x79ff2006195af384541e9850,
                    limb2: 0x1f3c3fa099d7a402,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xedb668e911a46c44c6928c18,
                    limb1: 0x65ef9a35399a64463b47c656,
                    limb2: 0x1527971213a94d75,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x5b80b3e0c3605d6628fe3b58,
                    limb1: 0x79ff2006195af384541e9850,
                    limb2: 0x1f3c3fa099d7a402,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xedb668e911a46c44c6928c18,
                    limb1: 0x65ef9a35399a64463b47c656,
                    limb2: 0x1527971213a94d75,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x5b80b3e0c3605d6628fe3b58,
                    limb1: 0x79ff2006195af384541e9850,
                    limb2: 0x1f3c3fa099d7a402,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xedb668e911a46c44c6928c18,
                    limb1: 0x65ef9a35399a64463b47c656,
                    limb2: 0x1527971213a94d75,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x5b80b3e0c3605d6628fe3b58,
                    limb1: 0x79ff2006195af384541e9850,
                    limb2: 0x1f3c3fa099d7a402,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xedb668e911a46c44c6928c18,
                    limb1: 0x65ef9a35399a64463b47c656,
                    limb2: 0x1527971213a94d75,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x5b80b3e0c3605d6628fe3b58,
                    limb1: 0x79ff2006195af384541e9850,
                    limb2: 0x1f3c3fa099d7a402,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xedb668e911a46c44c6928c18,
                    limb1: 0x65ef9a35399a64463b47c656,
                    limb2: 0x1527971213a94d75,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x5b80b3e0c3605d6628fe3b58,
                    limb1: 0x79ff2006195af384541e9850,
                    limb2: 0x1f3c3fa099d7a402,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xedb668e911a46c44c6928c18,
                    limb1: 0x65ef9a35399a64463b47c656,
                    limb2: 0x1527971213a94d75,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x5b80b3e0c3605d6628fe3b58,
                    limb1: 0x79ff2006195af384541e9850,
                    limb2: 0x1f3c3fa099d7a402,
                    limb3: 0x0
                }
            },
            G1Point {
                x: u384 {
                    limb0: 0xedb668e911a46c44c6928c18,
                    limb1: 0x65ef9a35399a64463b47c656,
                    limb2: 0x1527971213a94d75,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x5b80b3e0c3605d6628fe3b58,
                    limb1: 0x79ff2006195af384541e9850,
                    limb2: 0x1f3c3fa099d7a402,
                    limb3: 0x0
                }
            },
        ]
            .span();
        let scalars = array![
            u256 {
                low: 0xeba0842465a5ac1f7b2ecfc5a53011a2, high: 0x813678bd5e8b89c11ab249d94d50a99
            },
            u256 {
                low: 0xf9fb4010dec772b7bb22fa316bc9e970, high: 0x35aacd8ecb03f486ed63ea464a2bc48
            },
            u256 {
                low: 0x7644d1839aabd22d75ef8aabb693f4ef, high: 0xf2df310572abb532b6b7b4229502326
            },
            u256 {
                low: 0x5e47c2a0eef671391ccdd34080e97f74, high: 0xb71a237a0ec3e5a24878d19586d7f41
            },
            u256 {
                low: 0xb934718f2d492ca241f4317df5141524, high: 0xc29e3bb4bc972ce531da6ac956c2129
            },
            u256 {
                low: 0x8d2ad9744a8636550a9d499ca2698c2d, high: 0xd233351aea6231508ef444a6e63ffa4
            },
            u256 {
                low: 0x354af1bdba5612f7600aa45e44e1b08c, high: 0x38791a621d4fb7e22587c8958ccf9b4
            },
            u256 {
                low: 0x7fe6a4e2a6f1e475b61f92b9cf600ec, high: 0xed5267965fd5f6993a25c9b6e3a52d7
            },
        ]
            .span();
        let scalars_digits_decompositions = Option::Some(
            array![
                (
                    array![
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                    ]
                        .span(),
                    array![
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                    ]
                        .span()
                ),
                (
                    array![
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x1,
                    ]
                        .span(),
                    array![
                        -0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x0,
                        -0x1,
                        0x1,
                        0x0,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x0,
                        0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x0,
                        0x0,
                        0x1,
                        0x1,
                        0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        -0x1,
                        0x0,
                        -0x1,
                        0x0,
                        0x1,
                        -0x1,
                        0x1,
                        0x0,
                        -0x1,
                        -0x1,
                        0x1,
                        0x1,
                        -0x1,
                        -0x1,
                        0x1,
                    ]
                        .span()
                ),
            ]
                .span()
        );
        let Q_low: G1Point = G1Point {
            x: u384 {
                limb0: 0x10b2333761feb046a8114934,
                limb1: 0x5ea92c3d74693a88d324895f,
                limb2: 0x471e68ba507bbfe,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x4d1fef83100ff0908623a59c,
                limb1: 0x92c98002a641534e3a11f655,
                limb2: 0x10e2ca10e509eef1,
                limb3: 0x0
            }
        };
        let Q_high: G1Point = G1Point {
            x: u384 {
                limb0: 0x97e1fd5caf4ada9c1e0c31f8,
                limb1: 0x13858e96db7ed3631a4b2c6,
                limb2: 0x1cb34300ea473ead,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0x83ee82715cc14b3749cd2308,
                limb1: 0x47d2f9572b9bf2f47d85bb18,
                limb2: 0x41296cf5ce614ead,
                limb3: 0x0
            }
        };
        let Q_high_shifted: G1Point = G1Point {
            x: u384 {
                limb0: 0xbed0b36f261a8aae4064127a,
                limb1: 0x31cd5c81d27a1c2130c770aa,
                limb2: 0x18dfdaf17bacdbb5,
                limb3: 0x0
            },
            y: u384 {
                limb0: 0xccfd9e11468eeb0cb0058d04,
                limb1: 0x3efa0ccebc8fab13dd4ef746,
                limb2: 0x5d54b7075db46f8e,
                limb3: 0x0
            }
        };
        let SumDlogDivLow: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x32bb009993501c63faf5717a,
                    limb1: 0x556d302f63b537d63fbaa07c,
                    limb2: 0x190c40b1d4ab6d02,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xcf1da8eac479ec0e1019adb4,
                    limb1: 0xffffffffffffffff2fe01962,
                    limb2: 0x3fffffffffffffff,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x586ebb0af5f9cb49f2108f89,
                    limb1: 0x5f94ab6ddea64913b9a7e844,
                    limb2: 0x3bb96f2b1350817f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x19763df8c5ce374915c2aa1,
                    limb1: 0x3b67398d51fc6130f193b04a,
                    limb2: 0x66668262474ef68c,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x62b35ed7e2e4a06b3527b162,
                    limb1: 0xb3a06bac3c9b8db53493c00d,
                    limb2: 0x67c419018fdcfe77,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x63070b189bfd4afabfd2bd49,
                    limb1: 0x27fc312028f7ee77daf007f5,
                    limb2: 0x7072eec82ea3f654,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x1be4964abc737da43d9fec6d,
                    limb1: 0x7cc3f5cfe6464b2f28b00e24,
                    limb2: 0x2e64384e995668fd,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0x7836ca01f344a07ce1e4dcc0,
                    limb1: 0x9cc16b6dc6d83beba79b2ace,
                    limb2: 0x7af15fa938eeb5f,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xbd295723d1b18dea6c3e713d,
                    limb1: 0x80f9b7c4131b20b50a65a98c,
                    limb2: 0x35bc350a04b8c16a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x9d5a1086ec5cf520a5005586,
                    limb1: 0xd0144ac5bfcf90ef5607fdf6,
                    limb2: 0x4a3598bfaf95c3f8,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6513e602a26bacd8eacca6c9,
                    limb1: 0x912c8c7b402186ea25609ea1,
                    limb2: 0x19081bfeb90a4065,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x19763df8c5ce374915c2aa1,
                    limb1: 0x3b67398d51fc6130f193b04a,
                    limb2: 0x66668262474ef68c,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHigh: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x60a4d352b675155cd6ce60b2,
                    limb1: 0x2ca4a050efa989be11b8acfb,
                    limb2: 0x48df25f80b37f390,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x4bf7e5e7fe7e0cf3d9ce8798,
                    limb1: 0x1d8e98a0,
                    limb2: 0x4000000000000000,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x72c239b6bf3c89b1d23d12f1,
                    limb1: 0xe64f1b634713c41f38035751,
                    limb2: 0x18a46a383c6cafa9,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7a6799ba3f10b91f1b6141dd,
                    limb1: 0x98d80ce158adae83931386e2,
                    limb2: 0x4e2525ed020f73dd,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x4adef15fb9394f0fd5833e3b,
                    limb1: 0x84537c24316f8d2b293cc8bb,
                    limb2: 0x2a20f37e8f5d3e5c,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6981b04bd68876183c5a032e,
                    limb1: 0x7ba415e14337e3cdeac8c713,
                    limb2: 0x5916fef75a9f97a,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x45d2c147f6f82be47232cc8b,
                    limb1: 0x13789566f8c9772cf1f1f752,
                    limb2: 0x3ba6c72b78e69db9,
                    limb3: 0x0
                },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xb2ec30f89eb32524e79da11e,
                    limb1: 0x1d2d81bf82e822aa7545f3b7,
                    limb2: 0x7d9f3f3431c05746,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x79270f59d1c0d4ed75036bd5,
                    limb1: 0xed25cee83590f56e1c470acc,
                    limb2: 0x4b0141908e14d916,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x688219b801342221454fe10,
                    limb1: 0xc848489d3726e489a52a57a,
                    limb2: 0xbb106f6c37512b,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7f6764ae6bae6b40caf92a1e,
                    limb1: 0x17e6fc70a88f01f5a3bc0dae,
                    limb2: 0x75f3170be2266e90,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x7a6799ba3f10b91f1b6141dd,
                    limb1: 0x98d80ce158adae83931386e2,
                    limb2: 0x4e2525ed020f73dd,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 },
                u384 { limb0: 0x0, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let SumDlogDivHighShifted: FunctionFelt = FunctionFelt {
            a_num: array![
                u384 {
                    limb0: 0x5326facb5922e701e3db69ae,
                    limb1: 0xbe4726b8ca2a46d86fa221bf,
                    limb2: 0x1f7b27f216064615,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xd784a91a5e09d24e7c4a265c,
                    limb1: 0xffffffffffffffff7c074593,
                    limb2: 0x3fffffffffffffff,
                    limb3: 0x0
                }
            ]
                .span(),
            a_den: array![
                u384 {
                    limb0: 0x146c2dd08cb3cb9a3c5798fc,
                    limb1: 0x4587dff9aae60c5fc693b44,
                    limb2: 0x4b18af8708093c7e,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa94d4f342a9a9ab5a18fbb7b,
                    limb1: 0xccfa4a94bfcdf6a89d93dc8e,
                    limb2: 0x4a6ce20d9a0be59d,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span(),
            b_num: array![
                u384 {
                    limb0: 0x4a6029aba28ed0f90444acb5,
                    limb1: 0xa128497186eb4c1f4e76c4e3,
                    limb2: 0x31a6fb1ecfad0869,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x6c689accad8e1f636b57d398,
                    limb1: 0xe3dabff1d9a98ef6061349c,
                    limb2: 0x5a3e30009c8f734d,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x5bdcb3eac32c18ac3a5c8bba,
                    limb1: 0xefaaf3281e29d394e9f6319a,
                    limb2: 0x632cd41435cb247e,
                    limb3: 0x0
                }
            ]
                .span(),
            b_den: array![
                u384 {
                    limb0: 0xbe70bf9acbad61e0286c6cad,
                    limb1: 0x74b52fd4815032638b521500,
                    limb2: 0x1f99f1facd392864,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xb71ae55da5d85cf0e4717dc8,
                    limb1: 0x4c393cc0e309b6ee2959ea58,
                    limb2: 0x6a3811a3d473d284,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x2ea4dd08a196a14f07411354,
                    limb1: 0x68da65bb57923783fae01dc,
                    limb2: 0x608068b9cf4dbdf9,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0x211158c83925ad293513b03c,
                    limb1: 0x35f05f0cfc299e9c6821f1a1,
                    limb2: 0x28675c5aadc2fb64,
                    limb3: 0x0
                },
                u384 {
                    limb0: 0xa94d4f342a9a9ab5a18fbb7b,
                    limb1: 0xccfa4a94bfcdf6a89d93dc8e,
                    limb2: 0x4a6ce20d9a0be59d,
                    limb3: 0x0
                },
                u384 { limb0: 0x1, limb1: 0x0, limb2: 0x0, limb3: 0x0 }
            ]
                .span()
        };
        let y_last_attempt: u384 = u384 {
            limb0: 0xb8e8a4f26bdba6fd26a5a719,
            limb1: 0xc1b33be5d5aeed66b7290151,
            limb2: 0x29cb827d0a7f8527,
            limb3: 0x0
        };
        let g_rhs_sqrt: Array<u384> = array![
            u384 {
                limb0: 0xa7552bb4cbc2ec1d9513c039,
                limb1: 0x1cd6af9764ae93ded0f5c0d0,
                limb2: 0x3b9a12b1d14064c4,
                limb3: 0x0
            }
        ];

        let res = msm_g1(
            points,
            scalars,
            scalars_digits_decompositions,
            Q_low,
            Q_high,
            Q_high_shifted,
            SumDlogDivLow,
            SumDlogDivHigh,
            SumDlogDivHighShifted,
            y_last_attempt,
            g_rhs_sqrt,
            4
        );
        assert!(
            res == G1Point {
                x: u384 {
                    limb0: 0xb30f309efeb005b52836a38,
                    limb1: 0x8d382de668087ab4c50bdc7a,
                    limb2: 0x4ab215c097e8bafc,
                    limb3: 0x0
                },
                y: u384 {
                    limb0: 0x618d0f711481ad1717bdd735,
                    limb1: 0xe47c145253698a643c466dd9,
                    limb2: 0x59f7731aeeb38cb3,
                    limb3: 0x0
                }
            }
        );
    }
}
